import*as _0 from"node:fs";import{existsSync as JP}from"node:fs";import ws,{resolve as QP,basename as e1}from"node:path";import{fileURLToPath as t1,pathToFileURL as n1}from"node:url";import{isatty as r1}from"tty";import i1,{stripVTControlCharacters as s1}from"node:util";import a1 from"util";import bs from"path";import o1 from"os";import u1 from"crypto";import c1 from"net";import l1 from"url";import Pu from"fs";import d1 from"child_process";import{BiMap as f1,nonNullable as Vt,invariant as Fe,defaultTheme as fn,
DefaultRelationshipColor as Nu,nonexhaustive as Ke,hierarchyDistance as h1,DefaultThemeColor as yo,nameFromFqn as $g,isThemeColor as A0,compareFqnHierarchically as p1,DefaultArrowType as ra,ComputedNode as Wf,extractStep as m1,ComputedView as Iu,delay as g1,DefaultLineStyle as y1,FqnRef as Ln,hasAtLeast as v1,LikeC4Model as ia,stringHash as w1,ThemeColors as b1,isSameHierarchy as x0,isAncestor as Dg,FqnExpr as vn,RelationExpr as Hf,GlobalFqn as E1,isNonEmptyArray as ur,toArray as Ou,imap as Lu,AsFqn as k1,
ancestorsFqn as R1,compareNatural as P0,MultiMap as $1,computeColorValues as D1,sortByFqnHierarchically as N0,isGlobalFqn as I0,parentFqn as O0,DeploymentElement as T1,isScopedElementView as S1,splitGlobalFqn as L0,LinkedList as F0,isAutoLayoutDirection as C1,isOrOperator as M0,isAndOperator as j0,ModelLayer as _1}from"@likec4/core";import{ComputedNode as B0,DefaultShapeSize as A1,DefaultTextSize as x1,DefaultPaddingSize as P1,AsFqn as N1,FqnRef as sa}from"@likec4/core/types";import{EventEmitter as I1}from"events";
import{Buffer as Tg}from"buffer";import{Graphviz as Sg}from"@hpcc-js/wasm-graphviz";import{resolveRulesExtendedViews as O1}from"@likec4/core/compute-view";import{MultiMap as Yn,DefaultWeakMap as q0,compareNatural as Cg,sortNaturalByFqn as L1,ancestorsFqn as F1}from"@likec4/core/utils";import Es,{hrtime as G0}from"node:process";import M1 from"boxen";import{spawn as j1}from"node:child_process";import{once as U0,on as B1}from"node:events";import{stat as q1}from"node:fs/promises";import{pipeline as G1}from"node:stream/promises";
import U1 from"node:os";import z0 from"fs/promises";import{LikeC4Model as z1}from"@likec4/core/model";const W1={},vo=H1(globalThis,W1);function H1(t,e){return new Proxy(t,{get(n,r,i){return r in e?e[r]:t[r]},set(n,r,i){return r in e&&delete e[r],t[r]=i,!0},deleteProperty(n,r){let i=!1;return r in e&&(delete e[r],i=!0),r in t&&(delete t[r],i=!0),i},ownKeys(n){const r=Reflect.ownKeys(t),i=Reflect.ownKeys(e),s=new Set(i);return[...r.filter(a=>!s.has(a)),...i]},defineProperty(n,r,i){return r in e&&delete e[r],
Reflect.defineProperty(t,r,i),!0},getOwnPropertyDescriptor(n,r){return r in e?Reflect.getOwnPropertyDescriptor(e,r):Reflect.getOwnPropertyDescriptor(t,r)},has(n,r){return r in e||r in t}})}function W0(t){return typeof t=="function"?t:V1(t)}function V1(t){if(t==null)return()=>!1;if(t==="fatal")return e=>e.level==="fatal";if(t==="error")return e=>e.level==="fatal"||e.level==="error";if(t==="warning")return e=>e.level==="fatal"||e.level==="error"||e.level==="warning";if(t==="info")return e=>e.level===
"fatal"||e.level==="error"||e.level==="warning"||e.level==="info";if(t==="debug")return()=>!0;throw new TypeError(`Invalid log level: ${t}.`)}const H0=["debug","info","warning","error","fatal"];function V0(t,e){const n=H0.indexOf(t);if(n<0)throw new TypeError(`Invalid log level: ${JSON.stringify(t)}.`);const r=H0.indexOf(e);if(r<0)throw new TypeError(`Invalid log level: ${JSON.stringify(e)}.`);return n-r}function K1(t=[]){return or.getLogger(t)}const _g=Symbol.for("logtape.rootLogger");class or{static getLogger(e=[]){
let n=_g in vo?vo[_g]??null:null;return n==null&&(n=new or(null,[]),vo[_g]=n),typeof e=="string"?n.getChild(e):e.length===0?n:n.getChild(e)}constructor(e,n){Object.defineProperty(this,"parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"children",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"category",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sinks",{enumerable:!0,configurable:!0,
writable:!0,value:void 0}),Object.defineProperty(this,"parentSinks",{enumerable:!0,configurable:!0,writable:!0,value:"inherit"}),Object.defineProperty(this,"filters",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lowestLevel",{enumerable:!0,configurable:!0,writable:!0,value:"debug"}),Object.defineProperty(this,"contextLocalStorage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.parent=e,this.children={},this.category=n,this.sinks=[],this.filters=
[]}getChild(e){const n=typeof e=="string"?e:e[0],r=this.children[n];let i=r instanceof or?r:r?.deref();return i==null&&(i=new or(this,[...this.category,n]),this.children[n]="WeakRef"in vo?new WeakRef(i):i),typeof e=="string"||e.length===1?i:i.getChild(e.slice(1))}reset(){for(;this.sinks.length>0;)this.sinks.shift();for(this.parentSinks="inherit";this.filters.length>0;)this.filters.shift();this.lowestLevel="debug"}resetDescendants(){for(const e of Object.values(this.children)){const n=e instanceof
or?e:e.deref();n?.resetDescendants()}this.reset()}with(e){return new R0(this,{...e})}filter(e){for(const n of this.filters)if(!n(e))return!1;return this.filters.length<1?this.parent?.filter(e)??!0:!0}*getSinks(e){if(!(this.lowestLevel===null||V0(e,this.lowestLevel)<0)){if(this.parent!=null&&this.parentSinks==="inherit")for(const n of this.parent.getSinks(e))yield n;for(const n of this.sinks)yield n}}emit(e,n){if(!(this.lowestLevel===null||V0(e.level,this.lowestLevel)<0||!this.filter(e))){for(const r of this.
getSinks(e.level))if(!n?.has(r))try{r(e)}catch(i){const s=new Set(n);s.add(r),Z1.log("fatal","Failed to emit a log record to sink {sink}: {error}",{sink:r,error:i,record:e},s)}}}log(e,n,r,i){const s=or.getLogger().contextLocalStorage?.getStore()??{};let a;const o=typeof r=="function"?{category:this.category,level:e,timestamp:Date.now(),get message(){return K0(n,this.properties)},rawMessage:n,get properties(){return a==null&&(a={...s,...r()}),a}}:{category:this.category,level:e,timestamp:Date.now(),
message:K0(n,{...s,...r}),rawMessage:n,properties:{...s,...r}};this.emit(o,i)}logLazily(e,n,r={}){const i=or.getLogger().contextLocalStorage?.getStore()??{};let s,a;function o(){if((a==null||s==null)&&(a=n((u,...c)=>(s=u,Z0(u,c))),s==null))throw new TypeError("No log record was made.");return[a,s]}this.emit({category:this.category,level:e,get message(){return o()[0]},get rawMessage(){return o()[1]},timestamp:Date.now(),properties:{...i,...r}})}logTemplate(e,n,r,i={}){const s=or.getLogger().contextLocalStorage?.
getStore()??{};this.emit({category:this.category,level:e,message:Z0(n,r),rawMessage:n,timestamp:Date.now(),properties:{...s,...i}})}debug(e,...n){typeof e=="string"?this.log("debug",e,n[0]??{}):typeof e=="function"?this.logLazily("debug",e):this.logTemplate("debug",e,n)}info(e,...n){typeof e=="string"?this.log("info",e,n[0]??{}):typeof e=="function"?this.logLazily("info",e):this.logTemplate("info",e,n)}warn(e,...n){typeof e=="string"?this.log("warning",e,n[0]??{}):typeof e=="function"?this.logLazily(
"warning",e):this.logTemplate("warning",e,n)}error(e,...n){typeof e=="string"?this.log("error",e,n[0]??{}):typeof e=="function"?this.logLazily("error",e):this.logTemplate("error",e,n)}fatal(e,...n){typeof e=="string"?this.log("fatal",e,n[0]??{}):typeof e=="function"?this.logLazily("fatal",e):this.logTemplate("fatal",e,n)}}class R0{constructor(e,n){Object.defineProperty(this,"logger",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"properties",{enumerable:!0,configurable:!0,
writable:!0,value:void 0}),this.logger=e,this.properties=n}get category(){return this.logger.category}get parent(){return this.logger.parent}getChild(e){return this.logger.getChild(e).with(this.properties)}with(e){return new R0(this.logger,{...this.properties,...e})}log(e,n,r,i){this.logger.log(e,n,typeof r=="function"?()=>({...this.properties,...r()}):{...this.properties,...r},i)}logLazily(e,n){this.logger.logLazily(e,n,this.properties)}logTemplate(e,n,r){this.logger.logTemplate(e,n,r,this.properties)}debug(e,...n){
typeof e=="string"?this.log("debug",e,n[0]??{}):typeof e=="function"?this.logLazily("debug",e):this.logTemplate("debug",e,n)}info(e,...n){typeof e=="string"?this.log("info",e,n[0]??{}):typeof e=="function"?this.logLazily("info",e):this.logTemplate("info",e,n)}warn(e,...n){typeof e=="string"?this.log("warning",e,n[0]??{}):typeof e=="function"?this.logLazily("warning",e):this.logTemplate("warning",e,n)}error(e,...n){typeof e=="string"?this.log("error",e,n[0]??{}):typeof e=="function"?this.logLazily(
"error",e):this.logTemplate("error",e,n)}fatal(e,...n){typeof e=="string"?this.log("fatal",e,n[0]??{}):typeof e=="function"?this.logLazily("fatal",e):this.logTemplate("fatal",e,n)}}const Z1=or.getLogger(["logtape","meta"]);function K0(t,e){const n=[];let r="";for(let i=0;i<t.length;i++){const s=t.charAt(i),a=t.charAt(i+1);if(s==="{"&&a==="{")r=r+s,i++;else if(s==="}"&&a==="}")r=r+s,i++;else if(s==="{")n.push(r),r="";else if(s==="}"){let o;r.match(/^\s|\s$/)?o=r in e?e[r]:e[r.trim()]:o=e[r],n.push(
o),r=""}else r=r+s}return n.push(r),n}function Z0(t,e){const n=[];for(let r=0;r<t.length;r++)n.push(t[r]),r<e.length&&n.push(e[r]);return n}function fi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function X1(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(
n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}function X0(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ag,Y0;function Y1(){if(Y0)return Ag;Y0=1;let t=null;if(typeof window>"u"&&("process"in
globalThis&&"versions"in globalThis.process&&"node"in globalThis.process.versions&&typeof globalThis.caches>"u"&&typeof globalThis.addEventListener!="function"||"Bun"in globalThis))try{t=[X0][0](`${["node","util"].join(":")}`)}catch{t=null}return Ag=t,Ag}var J1=Y1();const Vf=fi(J1),xg={debug:"DBG",info:"INF",warning:"WRN",error:"ERR",fatal:"FTL"},J0="Deno"in globalThis&&"inspect"in globalThis.Deno&&typeof globalThis.Deno.inspect=="function"?(t,e)=>globalThis.Deno.inspect(t,{strAbbreviateSize:1/0,
iterableLimit:1/0,...e}):Vf!=null&&"inspect"in Vf&&typeof Vf.inspect=="function"?(t,e)=>Vf.inspect(t,{maxArrayLength:1/0,maxStringLength:1/0,...e}):t=>JSON.stringify(t);function Q0(t={}){const e=t.timestamp==null||t.timestamp==="date-time-timezone"?a=>new Date(a).toISOString().replace("T"," ").replace("Z"," +00:00"):t.timestamp==="date-time-tz"?a=>new Date(a).toISOString().replace("T"," ").replace("Z"," +00"):t.timestamp==="date-time"?a=>new Date(a).toISOString().replace("T"," ").replace("Z",""):
t.timestamp==="time-timezone"?a=>new Date(a).toISOString().replace(/.*T/,"").replace("Z"," +00:00"):t.timestamp==="time-tz"?a=>new Date(a).toISOString().replace(/.*T/,"").replace("Z"," +00"):t.timestamp==="time"?a=>new Date(a).toISOString().replace(/.*T/,"").replace("Z",""):t.timestamp==="date"?a=>new Date(a).toISOString().replace(/T.*/,""):t.timestamp==="rfc3339"?a=>new Date(a).toISOString():t.timestamp,n=t.category??"\xB7",r=t.value??J0,i=t.level==null||t.level==="ABBR"?a=>xg[a]:t.level==="abb\
r"?a=>xg[a].toLowerCase():t.level==="FULL"?a=>a.toUpperCase():t.level==="full"?a=>a:t.level==="L"?a=>a.charAt(0).toUpperCase():t.level==="l"?a=>a.charAt(0):t.level,s=t.format??(({timestamp:a,level:o,category:u,message:c})=>`${a} [${o}] ${u}: ${c}`);return a=>{let o="";for(let d=0;d<a.message.length;d++)d%2===0?o+=a.message[d]:o+=r(a.message[d]);const u=e(a.timestamp),c=i(a.level),l=typeof n=="function"?n(a.category):a.category.join(n);return`${s({timestamp:u,level:c,category:l,message:o,record:a})}\

`}}Q0();const Pg="\x1B[0m",Ng={black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"},Ig={bold:"\x1B[1m",dim:"\x1B[2m",italic:"\x1B[3m",underline:"\x1B[4m",strikethrough:"\x1B[9m"},Q1={debug:"blue",info:"green",warning:"yellow",error:"red",fatal:"magenta"};function eE(t={}){const e=t.format,n=typeof t.timestampStyle>"u"?"dim":t.timestampStyle,r=t.timestampColor??null,i=`${n==null?"":Ig[n]}${r==null?"":Ng[r]}`,s=n==null&&
r==null?"":Pg,a=typeof t.levelStyle>"u"?"bold":t.levelStyle,o=t.levelColors??Q1,u=typeof t.categoryStyle>"u"?"dim":t.categoryStyle,c=t.categoryColor??null,l=`${u==null?"":Ig[u]}${c==null?"":Ng[c]}`,f=u==null&&c==null?"":Pg;return Q0({timestamp:"date-time-tz",value(d){return J0(d,{colors:!0})},...t,format({timestamp:d,level:h,category:p,message:w,record:v}){const g=o[v.level];return d=`${i}${d}${s}`,h=`${a==null?"":Ig[a]}${g==null?"":Ng[g]}${h}${a==null&&g==null?"":Pg}`,e==null?`${d} ${h} ${l}${p}\
:${f} ${w}`:e({timestamp:d,level:h,category:`${l}${p}${f}`,message:w,record:v})}})}eE();const eN={debug:"background-color: gray; color: white;",info:"background-color: white; color: black;",warning:"background-color: orange; color: black;",error:"background-color: red; color: white;",fatal:"background-color: maroon; color: white;"};function tN(t){let e="";const n=[];for(let s=0;s<t.message.length;s++)s%2===0?e+=t.message[s]:(e+="%o",n.push(t.message[s]));const r=new Date(t.timestamp);return[`%c${`${r.
getUTCHours().toString().padStart(2,"0")}:${r.getUTCMinutes().toString().padStart(2,"0")}:${r.getUTCSeconds().toString().padStart(2,"0")}.${r.getUTCMilliseconds().toString().padStart(3,"0")}`} %c${xg[t.level]}%c %c${t.category.join("\xB7")} %c${e}`,"color: gray;",eN[t.level],"background-color: default;","color: gray;","color: default;",...n]}function tE(t={}){const e=t.formatter??tN,n={debug:"debug",info:"info",warning:"warn",error:"error",fatal:"error",...t.levelMap??{}},r=t.console??globalThis.
console;return i=>{const s=e(i),a=n[i.level];if(a===void 0)throw new TypeError(`Invalid log level: ${i.level}.`);if(typeof s=="string"){const o=s.replace(/\r?\n$/,"");r[a](o)}else r[a](...s)}}let Og=null;const nE=new Set,Kf=new Set,nN=new Set;function rN(t){return t.category.length===0||t.category.length===1&&t.category[0]==="logtape"||t.category.length===2&&t.category[0]==="logtape"&&t.category[1]==="meta"}function iN(t){if(Og!=null&&!t.reset)throw new aa("Already configured; if you want to res\
et, turn on the reset flag.");if(nN.size>0)throw new aa("Previously configured async disposables are still active. Use configure() instead or explicitly dispose them using dispose().");rE();try{sN(t,!1)}catch(e){throw e instanceof aa&&rE(),e}}function sN(t,e){Og=t;let n=!1,r=!1;for(const s of t.loggers){rN(s)&&(n=!0);const a=or.getLogger(s.category);for(const o of s.sinks??[]){const u=t.sinks[o];if(!u)throw new aa(`Sink not found: ${o}.`);a.sinks.push(u)}a.parentSinks=s.parentSinks??"inherit",s.
lowestLevel!==void 0&&(a.lowestLevel=s.lowestLevel),s.level!==void 0&&(r=!0,a.filters.push(W0(s.level)));for(const o of s.filters??[]){const u=t.filters?.[o];if(u===void 0)throw new aa(`Filter not found: ${o}.`);a.filters.push(W0(u))}nE.add(a)}or.getLogger().contextLocalStorage=t.contextLocalStorage;for(const s of Object.values(t.sinks)){if(Symbol.asyncDispose in s)throw new aa("Async disposables cannot be used with configureSync().");Symbol.dispose in s&&Kf.add(s)}for(const s of Object.values(t.
filters??{}))if(!(s==null||typeof s=="string")){if(Symbol.asyncDispose in s)throw new aa("Async disposables cannot be used with configureSync().");Symbol.dispose in s&&Kf.add(s)}"process"in vo&&!("Deno"in vo)?process.on("exit",Lg):addEventListener("unload",Lg);const i=or.getLogger(["logtape","meta"]);n||i.sinks.push(tE()),i.info("LogTape loggers are configured.  Note that LogTape itself uses the meta logger, which has category {metaLoggerCategory}.  The meta logger purposes to log internal error\
s such as sink exceptions.  If you are seeing this message, the meta logger is automatically configured.  It's recommended to configure the meta logger with a separate sink so that you can easily notice if logging itself fails or is misconfigured.  To turn off this message, configure the meta logger with higher log levels than {dismissLevel}.  See also <https://logtape.org/manual/categories#meta-logger>.",{metaLoggerCategory:["logtape","meta"],dismissLevel:"info"}),r&&i.warn("The level option is\
 deprecated in favor of lowestLevel option.  Please update your configuration.  See also <https://logtape.org/manual/levels#configuring-severity-levels>.")}function rE(){Lg(),aN()}function aN(){const t=or.getLogger([]);t.resetDescendants(),delete t.contextLocalStorage,nE.clear(),Og=null}function Lg(){for(const t of Kf)t[Symbol.dispose]();Kf.clear()}class aa extends Error{constructor(e){super(e),this.name="ConfigureError"}}const oN=t=>{Fg.forEach(e=>{uN(t,e)})},Fg=["name","message","stack","cause",
"errors"],uN=(t,e)=>{const n=Mg(t,e);if(n!==void 0){if(cN(n)){_i(t,e,t[e]);return}lN(n)&&iE(t,e,n)}},Mg=(t,e)=>{const n=Object.getOwnPropertyDescriptor(t,e);if(n!==void 0)return n;const r=Object.getPrototypeOf(t);return r===null?void 0:Mg(r,e)},cN=({get:t,set:e})=>t!==void 0&&e===void 0,lN=({enumerable:t,writable:e})=>t||!e,_i=(t,e,n)=>{iE(t,e,{value:n})},iE=(t,e,n)=>{Object.defineProperty(t,e,{...n,..."get"in n||"set"in n?{}:{writable:!0},enumerable:!1,configurable:!0})},dN=(t,e)=>{if(Array.isArray(
t.errors)){const n=t.errors.filter(fN).map(e).filter(Boolean);_i(t,"errors",n)}else hN(t)?_i(t,"errors",[]):t.errors!==void 0&&pN(t)},fN=t=>t!==void 0,hN=t=>"AggregateError"in globalThis&&(t.name==="AggregateError"||t instanceof AggregateError),pN=t=>{delete t.errors,t.errors!==void 0&&_i(t,"errors",[])},mN=(t,e)=>{if(!("cause"in t))return;const n=t.cause===void 0?t.cause:e(t.cause);n===void 0?delete t.cause:_i(t,"cause",n)},sE=t=>gN(t)||yN(t),gN=t=>{try{return t instanceof Error}catch{return!1}},
yN=t=>{try{return vN.has(Object.prototype.toString.call(t))}catch{return!1}},vN=new Set(["[object Error]","[object DOMException]","[object DOMError]","[object Exception]"]);function Zf(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}const wN=t=>!Object.isExtensible(t)||Fg.some(e=>bN(t,e)||EN(t,e)),bN=(t,e)=>{const n=Object.getOwnPropertyDescriptor(
t,e);return n!==void 0&&!n.configurable},EN=(t,e)=>{try{return t[e],!1}catch{return!0}},jg=t=>{const e=kN(t.message,t.name);_i(t,"stack",e)},kN=(t="",e="Error")=>{const n=RN(e),{stack:r}=new n(t);return typeof r=="string"&&r!==""?r:`${e}: ${t}`},RN=t=>{const e={value:t,enumerable:!1,writable:!0,configurable:!0},n=Object.defineProperty(class extends Error{},"name",e);return Object.defineProperty(n.prototype,"name",e),n},$N=t=>{const e={};for(const n of DN(t))try{const r=t[n],{enumerable:i,configurable:s,
writable:a=!0}=Mg(t,n);Object.defineProperty(e,n,{value:r,enumerable:i,configurable:s,writable:a})}catch{}return e},DN=t=>{const e=TN(t);for(const n of Fg)SN(t,n)&&e.push(n);return e},TN=t=>{try{return Reflect.ownKeys(t)}catch{return[]}},SN=(t,e)=>{try{return e in t&&!Object.hasOwn(t,e)}catch{return!1}},aE=t=>{const{name:e,message:n,stack:r,cause:i,errors:s,...a}=$N(t),o=CN(n,a),u=PN(e,o);return n===o&&NN(u,a),Object.entries({name:e,stack:r,cause:i,errors:s}).forEach(([c,l])=>{IN(u,c,l)}),r===void 0&&
jg(u),u},CN=(t,e)=>typeof t=="string"&&t!==""?t:xN(_N(e)),_N=t=>{try{return JSON.stringify(t)}catch{return AN(t)}},AN=t=>{try{return String(t)}catch{return"Invalid error"}},xN=t=>t.length<oE?t:`${t.slice(0,oE)}...`,oE=1e3,PN=(t,e)=>t==="AggregateError"&&"AggregateError"in globalThis?new AggregateError([],e):t in uE?new uE[t](e):new Error(e),uE={Error,ReferenceError,TypeError,SyntaxError,RangeError,URIError,EvalError},NN=(t,e)=>{for(const n in e)n in t||(t[n]=e[n])},IN=(t,e,n)=>{n!==void 0&&_i(t,
e,n)},ON=t=>{try{const e=new Error(String(t));return jg(e),e}catch(e){return e}},{toString:LN}=Object.prototype,FN=t=>MN(t)?aE(t):sE(t)?jN(t)?aE(t):t:ON(t),MN=t=>{try{return Zf(t)}catch{return!1}},jN=t=>BN(t)||wN(t)||qN(t),BN=t=>{try{return LN.call(t)==="[object Object]"}catch{return!0}},qN=t=>typeof t.constructor!="function"||typeof t.constructor.name!="string"||t.constructor.name===""||t.constructor.prototype!==Object.getPrototypeOf(t),Xf=(t,{shallow:e=!1}={})=>cE(t,[],e),cE=(t,e,n)=>{if(e.includes(
t))return;const r=n?GN:s=>cE(s,[...e,t],n),i=FN(t);return UN(i,r),i},GN=t=>t,UN=(t,e)=>{zN(t),WN(t),HN(t),mN(t,e),dN(t,e),oN(t)},zN=t=>{if(Yf(t.name))return;const e=Object.getPrototypeOf(t).name,n=Yf(e)?e:t.constructor.name;_i(t,"name",n)},WN=t=>{Yf(t.message)||_i(t,"message","")},HN=t=>{Yf(t.stack)||jg(t)},Yf=t=>typeof t=="string"&&t!=="",VN=(t,e,n=t.name)=>{if(KN(e),typeof n!="string")throw new TypeError(`currentName must be a string: ${n}`);return n},KN=t=>{if(!ZN(t))throw new TypeError(`Erro\
rClass must be a class: ${t}`);if(!lE(t.prototype))throw new TypeError(`ErrorClass must inherit from Error: ${t}`);if(!XN(t))throw new TypeError(`ErrorClass must be have a valid constructor: ${t}`)},ZN=t=>typeof t=="function"&&typeof t.prototype=="object"&&t.prototype!==null,lE=t=>t!==null&&(t.name==="Error"||lE(Object.getPrototypeOf(t))),XN=t=>typeof t.prototype.constructor=="function",dE=(t,e,n)=>{Object.defineProperty(t,e,{value:n,enumerable:!1,writable:!0,configurable:!0})},YN=(t,e)=>{Object.
getPrototypeOf(t)!==e.prototype&&(JN(t,e),pE(t,"constructor"),QN(t,e))},JN=(t,e)=>{Object.setPrototypeOf(t,e.prototype)},QN=(t,e)=>{pE(t,"name");const n=fE(e.prototype);t.name!==n&&dE(t,"name",n)},fE=t=>eI(t)??tI(t)??fE(Object.getPrototypeOf(t)),eI=t=>Object.hasOwn(t,"name")&&hE(t.name)?t.name:void 0,tI=t=>typeof t.constructor=="function"&&hE(t.constructor.name)?t.constructor.name:void 0,hE=t=>typeof t=="string"&&t!=="",pE=(t,e)=>{Object.hasOwn(t,e)&&delete t[e]},nI=(t,e)=>{if(!rI(t,e))return;const n=sI(
t,e);dE(t,"stack",n)},rI=(t,e)=>e!==t.name&&e!==""&&t.stack.includes(e)&&iI(),iI=()=>{class t extends Error{}const e={value:mE,enumerable:!1,writable:!0,configurable:!0};Object.defineProperty(t,"name",e),Object.defineProperty(t.prototype,"name",e);const{stack:n}=new t("");return typeof n=="string"&&n.includes(mE)},mE="SetErrorClassError",sI=({name:t,stack:e},n)=>{if(e.startsWith(`${n}: `))return e.replace(n,t);const r=aI(n,t),[i,s]=r.find(([a])=>e.includes(a));return e.replace(i,s)},aI=(t,e)=>[[
`
${t}: `,`
${e}: `],[`${t}: `,`${e}: `],[`${t} `,`${e} `],[t,e]],oI=(t,e,n)=>{const r=Xf(t),i=VN(r,e,n);return YN(r,e),nI(r,i),r},uI=(t,e)=>e.configurable===!1?cI(t,e):fI(t,e),cI=(t,e)=>({...e,...lI(t,e),...dI(t,e)}),lI=(t,e)=>e.writable===!0&&t.writable===!1?{writable:!1}:{},dI=(t,e)=>t.hasValue&&"value"in e&&e.writable===!0?{value:t.value}:{},fI=(t,e)=>{const n=Fu(t.enumerable,e.enumerable,!0),r=Fu(t.writable,e.writable,!0),i=Fu(t.configurable,e.configurable,!0);return{...hI(t,e,r),enumerable:n,configurable:i}},
hI=(t,e,n)=>t.hasValue?{value:t.value,writable:n}:!gE(t)&&!gE(e)?{value:e.value,writable:n}:{get:Fu(t.get,e.get),set:Fu(t.set,e.set)},gE=({get:t,set:e})=>t!==void 0||e!==void 0,Fu=(t,e,n)=>t??e??n,pI=(t,e,n)=>{if(!mI(t))throw new TypeError(`Argument must be an object: ${t}`);if(!gI(e))throw new TypeError(`Property key must be a string, a symbol or an integer: ${e}`);return yI(n)},mI=t=>typeof t=="object"&&t!==null,gI=t=>{const e=typeof t;return e==="string"||e==="symbol"||e==="number"},yI=t=>{if(!Zf(
t))throw new TypeError(`Descriptor must be a plain object: ${t}`);const{enumerable:e,writable:n,configurable:r,value:i,get:s,set:a,...o}=t,u="value"in t;return vI({enumerable:e,writable:n,configurable:r,get:s,set:a,unknownProps:o,hasValue:u}),{enumerable:e,writable:n,configurable:r,value:i,get:s,set:a,hasValue:u}},vI=({enumerable:t,writable:e,configurable:n,get:r,set:i,unknownProps:s,hasValue:a})=>{yE(a,r,"get"),yE(a,i,"set"),Bg(t,"enumerable"),Bg(e,"writable"),Bg(n,"configurable"),bI(s)},yE=(t,e,n)=>{
if(wI(e,n),t&&e!==void 0)throw new TypeError(`Descriptor property "value" and "${n}" must not both be defined: ${e}`)},wI=(t,e)=>{if(t!==void 0&&typeof t!="function")throw new TypeError(`Descriptor property "${e}" must be a function: ${t}`)},Bg=(t,e)=>{if(t!==void 0&&typeof t!="boolean")throw new TypeError(`Descriptor property "${e}" must be a boolean: ${t}`)},bI=t=>{const[e]=Object.keys(t);if(e!==void 0)throw new TypeError(`Unknown descriptor property "${e}": ${t[e]}`)},EI=(t,e,n)=>{const r=pI(
t,e,n),i=vE(t,e),s=uI(r,i);return kI(t,e,s),t},vE=(t,e)=>{const n=Object.getOwnPropertyDescriptor(t,e);if(n!==void 0)return n;const r=Object.getPrototypeOf(t);return r===null?{}:vE(r,e)},kI=(t,e,n)=>{try{Object.defineProperty(t,e,n)}catch{}},RI=(t,e,n)=>{if(n!==void 0)return wE(t,e,n);try{delete t[e]}catch{}if(t[e]!==void 0)return wE(t,e)},wE=(t,e,n)=>{const r=$I(e);EI(t,e,{value:n,...r})},$I=t=>typeof t=="string"&&t.startsWith("_")?{enumerable:!1}:{},DI=(t,e,n={})=>{if(bE(t,"First argument"),bE(
e,"Second argument"),!Zf(n))throw new TypeError(`Options must be a plain object: ${n}`);const{soft:r=!1}=n;if(typeof r!="boolean")throw new TypeError(`Option "soft" must be a boolean: ${r}`);return{soft:r}},bE=(t,e)=>{if(t===void 0)throw new TypeError(`${e} is required.`);if(!TI(t))throw new TypeError(`${e} must be a plain object or an error: ${t}`)},TI=t=>Zf(t)||sE(t),SI=({error:t,props:e,propName:n,soft:r})=>CI(n)||!xI.call(e,n)||r&&t[n]!==void 0,CI=t=>t in _I||AI.has(t),_I=new Error("check"),
AI=new Set(["prototype","errors","cause"]),{propertyIsEnumerable:xI}=Object.prototype,PI=(t,e,n)=>{const{soft:r}=DI(t,e,n);for(const i of Reflect.ownKeys(e))NI({error:t,props:e,propName:i,soft:r});return t},NI=({error:t,props:e,propName:n,soft:r})=>{SI({error:t,props:e,propName:n,soft:r})||RI(t,n,e[n])},Jf=(t,e,n)=>{Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!1,configurable:!0})},II=(t,e)=>{if(t.errors===void 0)return;const n=t.errors.map(r=>e(r).error).filter(Boolean);Jf(t,"error\
s",n)},OI=({target:t,source:e,parent:n,child:r})=>{if(!EE(t)){LI(t,e);return}EE(e)&&Jf(t,"errors",[...r.errors,...n.errors])},LI=(t,e)=>{e.errors!==void 0&&Jf(t,"errors",e.errors)},EE=t=>t.errors!==void 0&&t.errors.length!==0,FI=(t,e,n=t.message)=>{if(typeof e!="string")throw new TypeError(`newMessage must be a string: ${e}`);if(typeof n!="string")throw new TypeError(`currentMessage must be a string: ${n}`);return n},MI=({name:t,stack:e},n,r)=>r!==""&&e.includes(r)?jI({name:t,stack:e,newMessage:n,
currentMessage:r}):qI(t,e,n),jI=({name:t,stack:e,newMessage:n,currentMessage:r})=>{const i=BI(t,n,r),[s,a]=i.find(([o])=>e.includes(o));return e.replace(s,a)},BI=(t,e,n)=>[[`${t}: ${n}`,`${t}: ${e}`],[`: ${n}`,`: ${e}`],[`
${n}`,`
${e}`],[` ${n}`,` ${e}`],[n,e]],qI=(t,e,n)=>{const r=`${t}: `,i=n.trimEnd();return e===t||e.startsWith(`${t}
`)?e.replace(t,`${r}${i}`):e.startsWith(r)?e.replace(r,`${r}${i}
`):`${r}${i}
${e}`},GI=(t,e,n)=>{const r=Xf(t),i=FI(r,e,n);return RE(r,"message",e),UI(r,e,i),r},UI=(t,e,n)=>{if(e===n||!zI())return;const r=MI(t,e,n);RE(t,"stack",r)},zI=()=>{const{stack:t}=new Error(kE);return typeof t=="string"&&t.includes(kE)},kE="set-error-message test message",RE=(t,e,n)=>{Object.defineProperty(t,e,{value:n,enumerable:!1,writable:!0,configurable:!0})},WI=(t,e,n)=>{if(typeof e!="string")throw new TypeError(`Second argument must be a message string: ${e}`);const r=Xf(t),i=HI(e,r.message);
return GI(r,i,n)},HI=(t,e)=>{const n=t.trim(),r=e.trim();return n===""?r:r===""?n:VI(n,r,t)},VI=(t,e,n)=>t.endsWith(KI)?n.endsWith(ZI)?`${t}
${e}`:`${t} ${e}`:`${e}
${t}`,KI=":",ZI=`
`,XI=({parent:t,child:e,target:n,stackError:r})=>{const i=t.message,s=r.message;return n.message=e.message,WI(n,i,s)},YI=(t,e)=>$E(t)===e,$E=t=>typeof t=="object"&&t!==null?t.stack:void 0,JI=({wrap:t,target:e,source:n,childHasStack:r})=>t===r?e:(Jf(e,"stack",n.stack),n),QI=t=>{const{wrap:e,name:n}=t;return typeof e!="boolean"?n==="Error":(Object.hasOwn(t,"wrap")&&delete t.wrap,e)},DE=t=>TE(t,[]).error,TE=(t,e)=>{if(e.includes(t))return{};const n=c=>TE(c,[...e,t]),r=$E(t),i=Xf(t,{shallow:!0}),s=YI(
i,r);II(i,n);const{parent:a,childHasStack:o}=eO(i,n);return{error:a,errorHasStack:s||o}},eO=(t,e)=>{const n=QI(t);if(t.cause===void 0)return{parent:t,childHasStack:!1};const{error:r,errorHasStack:i}=e(t.cause);return delete t.cause,{parent:tO({parent:t,child:r,childHasStack:i,wrap:n}),childHasStack:i}},tO=({parent:t,child:e,childHasStack:n,wrap:r})=>{if(e===void 0)return t;const[i,s]=r?[e,t]:[t,e],a=JI({wrap:r,target:i,source:s,childHasStack:n}),o=oI(i,i.constructor,a.name),u=XI({parent:t,child:e,
target:o,stackError:a});return OI({target:u,source:s,parent:t,child:e}),PI(u,s,{soft:!r})};function SE(t){return function(e,n){if(typeof n?.toJSON=="function"&&(n=n.toJSON()),!(n!==null&&typeof n=="object"))return n;if(t.has(n))return"[Circular]";t.add(n);const r=Array.isArray(n)?[]:{};for(const[i,s]of Object.entries(n))r[i]=SE(t)(i,s);return t.delete(n),r}}function nO(t,{indentation:e}={}){return JSON.stringify(t,SE(new WeakSet),e)}const CE=t=>t.split(`
`).map(e=>e.trim().replace("file://",""));function qg(t,e=2){return t=Array.isArray(t)?t:t.split(`
`),t.map(n=>`${" ".repeat(e)}${n}`).join(`
`)}function Jn(t){if(typeof t=="string")return t;if(t instanceof Error){const e=DE(t);if(e.stack){const n=CE(e.stack);return e.message+`
`+qg(n.slice(1))}return e.message}return nO(t)}function rO(t){const e=Object.values(t.properties).filter(n=>n instanceof Error).map(n=>{const r=DE(n);return r.stack&&(r.stack=CE(r.stack).join(`
`)),r});return e.length===0?null:e.length===1?e[0]:new AggregateError(e)}function iO(t,e){const n=rO(t.record);if(n){let r=n.message;return n.stack&&(r=r+`
`+qg(n.stack.split(`
`).slice(1))),r=`${uO.red}${r}${oO}`,{...t,message:t.message+`
`+qg(r)}}return t}const sO={debug:"DEBUG",info:"INFO ",warning:"WARN ",error:"ERROR",fatal:"FATAL"},aO=t=>sO[t],oO="\x1B[0m",uO={red:"\x1B[31m"};function cO(t){const e=({timestamp:n,level:r,category:i,message:s})=>`${n} ${r} ${i} ${s}`;return eE({timestamp:"time",level:aO,categoryStyle:"bold",categoryColor:"cyan",category:".",...t,format:n=>e(iO(n))})}function _E(t){return tE({formatter:cO(),...t})}const Fn=K1("likec4");function lO(t){return Fn.getChild(t)}let dO=!1;function fO(t){try{dO=!0;const e=t?.
sinks??{};iN({...t,sinks:{...e,console:e.console??_E()},loggers:[{category:["logtape","meta"],sinks:["console"],lowestLevel:"warning"},...t?.loggers??[{category:"likec4",sinks:["console"],lowestLevel:"debug"}]]})}catch(e){console.error(e)}}function Gg(t){if(t===null||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null||Symbol.iterator in t?!1:Symbol.toStringTag in t?Object.prototype.toString.call(t)==="[object Module\
]":!0}function Ug(t,e,n=".",r){if(!Gg(e))return Ug(t,{},n,r);const i=Object.assign({},e);for(const s in t){if(s==="__proto__"||s==="constructor")continue;const a=t[s];a!=null&&(r&&r(i,s,a,n)||(Array.isArray(a)&&Array.isArray(i[s])?i[s]=[...a,...i[s]]:Gg(a)&&Gg(i[s])?i[s]=Ug(a,i[s],(n?`${n}.`:"")+s.toString(),r):i[s]=a))}return i}function hO(t){return(...e)=>e.reduce((n,r)=>Ug(n,r,"",t),{})}const zg=hO();function Mt(t){return typeof t=="object"&&t!==null&&typeof t.$type=="string"}function $r(t){return typeof t==
"object"&&t!==null&&typeof t.$refText=="string"}function pO(t){return typeof t=="object"&&t!==null&&typeof t.name=="string"&&typeof t.type=="string"&&typeof t.path=="string"}function Qf(t){return typeof t=="object"&&t!==null&&Mt(t.container)&&$r(t.reference)&&typeof t.message=="string"}class AE{constructor(){this.subtypes={},this.allSubtypes={}}isInstance(e,n){return Mt(e)&&this.isSubtype(e.$type,n)}isSubtype(e,n){if(e===n)return!0;let r=this.subtypes[e];r||(r=this.subtypes[e]={});const i=r[n];if(i!==
void 0)return i;{const s=this.computeIsSubtype(e,n);return r[n]=s,s}}getAllSubTypes(e){const n=this.allSubtypes[e];if(n)return n;{const r=this.getAllTypes(),i=[];for(const s of r)this.isSubtype(s,e)&&i.push(s);return this.allSubtypes[e]=i,i}}}function ks(t){return typeof t=="object"&&t!==null&&Array.isArray(t.content)}function oa(t){return typeof t=="object"&&t!==null&&typeof t.tokenType=="object"}function xE(t){return ks(t)&&typeof t.fullText=="string"}class mn{constructor(e,n){this.startFn=e,this.
nextFn=n}iterator(){const e={state:this.startFn(),next:()=>this.nextFn(e.state),[Symbol.iterator]:()=>e};return e}[Symbol.iterator](){return this.iterator()}isEmpty(){return!!this.iterator().next().done}count(){const e=this.iterator();let n=0,r=e.next();for(;!r.done;)n++,r=e.next();return n}toArray(){const e=[],n=this.iterator();let r;do r=n.next(),r.value!==void 0&&e.push(r.value);while(!r.done);return e}toSet(){return new Set(this)}toMap(e,n){const r=this.map(i=>[e?e(i):i,n?n(i):i]);return new Map(
r)}toString(){return this.join()}concat(e){return new mn(()=>({first:this.startFn(),firstDone:!1,iterator:e[Symbol.iterator]()}),n=>{let r;if(!n.firstDone){do if(r=this.nextFn(n.first),!r.done)return r;while(!r.done);n.firstDone=!0}do if(r=n.iterator.next(),!r.done)return r;while(!r.done);return Qn})}join(e=","){const n=this.iterator();let r="",i,s=!1;do i=n.next(),i.done||(s&&(r+=e),r+=mO(i.value)),s=!0;while(!i.done);return r}indexOf(e,n=0){const r=this.iterator();let i=0,s=r.next();for(;!s.done;){
if(i>=n&&s.value===e)return i;s=r.next(),i++}return-1}every(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(!e(r.value))return!1;r=n.next()}return!0}some(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(e(r.value))return!0;r=n.next()}return!1}forEach(e){const n=this.iterator();let r=0,i=n.next();for(;!i.done;)e(i.value,r),i=n.next(),r++}map(e){return new mn(this.startFn,n=>{const{done:r,value:i}=this.nextFn(n);return r?Qn:{done:!1,value:e(i)}})}filter(e){return new mn(this.
startFn,n=>{let r;do if(r=this.nextFn(n),!r.done&&e(r.value))return r;while(!r.done);return Qn})}nonNullable(){return this.filter(e=>e!=null)}reduce(e,n){const r=this.iterator();let i=n,s=r.next();for(;!s.done;)i===void 0?i=s.value:i=e(i,s.value),s=r.next();return i}reduceRight(e,n){return this.recursiveReduce(this.iterator(),e,n)}recursiveReduce(e,n,r){const i=e.next();if(i.done)return r;const s=this.recursiveReduce(e,n,r);return s===void 0?i.value:n(s,i.value)}find(e){const n=this.iterator();let r=n.
next();for(;!r.done;){if(e(r.value))return r.value;r=n.next()}}findIndex(e){const n=this.iterator();let r=0,i=n.next();for(;!i.done;){if(e(i.value))return r;i=n.next(),r++}return-1}includes(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(r.value===e)return!0;r=n.next()}return!1}flatMap(e){return new mn(()=>({this:this.startFn()}),n=>{do{if(n.iterator){const s=n.iterator.next();if(s.done)n.iterator=void 0;else return s}const{done:r,value:i}=this.nextFn(n.this);if(!r){const s=e(i);if(eh(
s))n.iterator=s[Symbol.iterator]();else return{done:!1,value:s}}}while(n.iterator);return Qn})}flat(e){if(e===void 0&&(e=1),e<=0)return this;const n=e>1?this.flat(e-1):this;return new mn(()=>({this:n.startFn()}),r=>{do{if(r.iterator){const a=r.iterator.next();if(a.done)r.iterator=void 0;else return a}const{done:i,value:s}=n.nextFn(r.this);if(!i)if(eh(s))r.iterator=s[Symbol.iterator]();else return{done:!1,value:s}}while(r.iterator);return Qn})}head(){const n=this.iterator().next();if(!n.done)return n.
value}tail(e=1){return new mn(()=>{const n=this.startFn();for(let r=0;r<e;r++)if(this.nextFn(n).done)return n;return n},this.nextFn)}limit(e){return new mn(()=>({size:0,state:this.startFn()}),n=>(n.size++,n.size>e?Qn:this.nextFn(n.state)))}distinct(e){return new mn(()=>({set:new Set,internalState:this.startFn()}),n=>{let r;do if(r=this.nextFn(n.internalState),!r.done){const i=e?e(r.value):r.value;if(!n.set.has(i))return n.set.add(i),r}while(!r.done);return Qn})}exclude(e,n){const r=new Set;for(const i of e){
const s=n?n(i):i;r.add(s)}return this.filter(i=>{const s=n?n(i):i;return!r.has(s)})}}function mO(t){return typeof t=="string"?t:typeof t>"u"?"undefined":typeof t.toString=="function"?t.toString():Object.prototype.toString.call(t)}function eh(t){return!!t&&typeof t[Symbol.iterator]=="function"}const Mu=new mn(()=>{},()=>Qn),Qn=Object.freeze({done:!0,value:void 0});function rt(...t){if(t.length===1){const e=t[0];if(e instanceof mn)return e;if(eh(e))return new mn(()=>e[Symbol.iterator](),n=>n.next());
if(typeof e.length=="number")return new mn(()=>({index:0}),n=>n.index<e.length?{done:!1,value:e[n.index++]}:Qn)}return t.length>1?new mn(()=>({collIndex:0,arrIndex:0}),e=>{do{if(e.iterator){const n=e.iterator.next();if(!n.done)return n;e.iterator=void 0}if(e.array){if(e.arrIndex<e.array.length)return{done:!1,value:e.array[e.arrIndex++]};e.array=void 0,e.arrIndex=0}if(e.collIndex<t.length){const n=t[e.collIndex++];eh(n)?e.iterator=n[Symbol.iterator]():n&&typeof n.length=="number"&&(e.array=n)}}while(e.
iterator||e.array||e.collIndex<t.length);return Qn}):Mu}class wo extends mn{constructor(e,n,r){super(()=>({iterators:r?.includeRoot?[[e][Symbol.iterator]()]:[n(e)[Symbol.iterator]()],pruned:!1}),i=>{for(i.pruned&&(i.iterators.pop(),i.pruned=!1);i.iterators.length>0;){const a=i.iterators[i.iterators.length-1].next();if(a.done)i.iterators.pop();else return i.iterators.push(n(a.value)[Symbol.iterator]()),a}return Qn})}iterator(){const e={state:this.startFn(),next:()=>this.nextFn(e.state),prune:()=>{
e.state.pruned=!0},[Symbol.iterator]:()=>e};return e}}var Wg;(function(t){function e(s){return s.reduce((a,o)=>a+o,0)}t.sum=e;function n(s){return s.reduce((a,o)=>a*o,0)}t.product=n;function r(s){return s.reduce((a,o)=>Math.min(a,o))}t.min=r;function i(s){return s.reduce((a,o)=>Math.max(a,o))}t.max=i})(Wg||(Wg={}));function th(t){return new wo(t,e=>ks(e)?e.content:[],{includeRoot:!0})}function gO(t){return th(t).filter(oa)}function yO(t,e){for(;t.container;)if(t=t.container,t===e)return!0;return!1}
function Hg(t){return{start:{character:t.startColumn-1,line:t.startLine-1},end:{character:t.endColumn,line:t.endLine-1}}}function nh(t){if(!t)return;const{offset:e,end:n,range:r}=t;return{range:r,offset:e,end:n,length:n-e}}var Ai;(function(t){t[t.Before=0]="Before",t[t.After=1]="After",t[t.OverlapFront=2]="OverlapFront",t[t.OverlapBack=3]="OverlapBack",t[t.Inside=4]="Inside",t[t.Outside=5]="Outside"})(Ai||(Ai={}));function vO(t,e){if(t.end.line<e.start.line||t.end.line===e.start.line&&t.end.character<=
e.start.character)return Ai.Before;if(t.start.line>e.end.line||t.start.line===e.end.line&&t.start.character>=e.end.character)return Ai.After;const n=t.start.line>e.start.line||t.start.line===e.start.line&&t.start.character>=e.start.character,r=t.end.line<e.end.line||t.end.line===e.end.line&&t.end.character<=e.end.character;return n&&r?Ai.Inside:n?Ai.OverlapBack:r?Ai.OverlapFront:Ai.Outside}function PE(t,e){return vO(t,e)>Ai.After}const NE=/^[\w\p{L}]$/u;function ua(t,e,n=NE){if(t){if(e>0){const r=e-
t.offset,i=t.text.charAt(r);n.test(i)||e--}return OE(t,e)}}function Vg(t,e){if(t){const n=wO(t,!0);if(n&&IE(n,e))return n;if(xE(t)){const r=t.content.findIndex(i=>!i.hidden);for(let i=r-1;i>=0;i--){const s=t.content[i];if(IE(s,e))return s}}}}function IE(t,e){return oa(t)&&e.includes(t.tokenType.name)}function OE(t,e){if(oa(t))return t;if(ks(t)){const n=LE(t,e,!1);if(n)return OE(n,e)}}function Kg(t,e){if(oa(t))return t;if(ks(t)){const n=LE(t,e,!0);if(n)return Kg(n,e)}}function LE(t,e,n){let r=0,i=t.
content.length-1,s;for(;r<=i;){const a=Math.floor((r+i)/2),o=t.content[a];if(o.offset<=e&&o.end>e)return o;o.end<=e?(s=n?o:void 0,r=a+1):i=a-1}return s}function wO(t,e=!0){for(;t.container;){const n=t.container;let r=n.content.indexOf(t);for(;r>0;){r--;const i=n.content[r];if(e||!i.hidden)return i}t=n}}function bO(t,e=!0){for(;t.container;){const n=t.container;let r=n.content.indexOf(t);const i=n.content.length-1;for(;r<i;){r++;const s=n.content[r];if(e||!s.hidden)return s}t=n}}function EO(t,e){
const n=kO(t,e);return n?n.parent.content.slice(n.a+1,n.b):[]}function kO(t,e){const n=FE(t),r=FE(e);let i;for(let s=0;s<n.length&&s<r.length;s++){const a=n[s],o=r[s];if(a.parent===o.parent)i={parent:a.parent,a:a.index,b:o.index};else break}return i}function FE(t){const e=[];for(;t.container;){const n=t.container,r=n.content.indexOf(t);e.push({parent:n,index:r}),t=n}return e.reverse()}class ME extends Error{constructor(e,n){super(e?`${n} at ${e.range.start.line}:${e.range.start.character}`:n)}}function ju(t){
throw new Error("Error! The input value was not handled.")}const rh="AbstractRule",ih="AbstractType",Zg="Condition",jE="TypeDefinition",Xg="ValueLiteral",Bu="AbstractElement";function Yg(t){return at.isInstance(t,Bu)}const sh="ArrayLiteral",qu="ArrayType";function RO(t){return at.isInstance(t,qu)}const Gu="BooleanLiteral";function $O(t){return at.isInstance(t,Gu)}const Uu="Conjunction";function DO(t){return at.isInstance(t,Uu)}const zu="Disjunction";function TO(t){return at.isInstance(t,zu)}const ah="\
Grammar",Jg="GrammarImport",Wu="InferredType";function BE(t){return at.isInstance(t,Wu)}const Hu="Interface";function qE(t){return at.isInstance(t,Hu)}const Qg="NamedArgument",Vu="Negation";function SO(t){return at.isInstance(t,Vu)}const oh="NumberLiteral",uh="Parameter",Ku="ParameterReference";function CO(t){return at.isInstance(t,Ku)}const Zu="ParserRule";function Sn(t){return at.isInstance(t,Zu)}const Xu="ReferenceType";function _O(t){return at.isInstance(t,Xu)}const ch="ReturnType";function AO(t){
return at.isInstance(t,ch)}const Yu="SimpleType";function GE(t){return at.isInstance(t,Yu)}const lh="StringLiteral",bo="TerminalRule";function xi(t){return at.isInstance(t,bo)}const Ju="Type";function ey(t){return at.isInstance(t,Ju)}const ty="TypeAttribute",Qu="UnionType";function xO(t){return at.isInstance(t,Qu)}const ec="Action";function ca(t){return at.isInstance(t,ec)}const tc="Alternatives";function ny(t){return at.isInstance(t,tc)}const nc="Assignment";function hi(t){return at.isInstance(
t,nc)}const rc="CharacterRange";function PO(t){return at.isInstance(t,rc)}const ic="CrossReference";function sc(t){return at.isInstance(t,ic)}const ac="EndOfFile";function NO(t){return at.isInstance(t,ac)}const oc="Group";function Rs(t){return at.isInstance(t,oc)}const uc="Keyword";function pi(t){return at.isInstance(t,uc)}const cc="NegatedToken";function IO(t){return at.isInstance(t,cc)}const lc="RegexToken";function OO(t){return at.isInstance(t,lc)}const dc="RuleCall";function Pi(t){return at.
isInstance(t,dc)}const fc="TerminalAlternatives";function LO(t){return at.isInstance(t,fc)}const hc="TerminalGroup";function FO(t){return at.isInstance(t,hc)}const pc="TerminalRuleCall";function UE(t){return at.isInstance(t,pc)}const mc="UnorderedGroup";function ry(t){return at.isInstance(t,mc)}const gc="UntilToken";function MO(t){return at.isInstance(t,gc)}const yc="Wildcard";function jO(t){return at.isInstance(t,yc)}class zE extends AE{getAllTypes(){return[Bu,rh,ih,ec,tc,sh,qu,nc,Gu,rc,Zg,Uu,ic,
zu,ac,ah,Jg,oc,Wu,Hu,uc,Qg,cc,Vu,oh,uh,Ku,Zu,Xu,lc,ch,dc,Yu,lh,fc,hc,bo,pc,Ju,ty,jE,Qu,mc,gc,Xg,yc]}computeIsSubtype(e,n){switch(e){case ec:case tc:case nc:case rc:case ic:case ac:case oc:case uc:case cc:case lc:case dc:case fc:case hc:case pc:case mc:case gc:case yc:return this.isSubtype(Bu,n);case sh:case oh:case lh:return this.isSubtype(Xg,n);case qu:case Xu:case Yu:case Qu:return this.isSubtype(jE,n);case Gu:return this.isSubtype(Zg,n)||this.isSubtype(Xg,n);case Uu:case zu:case Vu:case Ku:return this.
isSubtype(Zg,n);case Wu:case Hu:case Ju:return this.isSubtype(ih,n);case Zu:return this.isSubtype(rh,n)||this.isSubtype(ih,n);case bo:return this.isSubtype(rh,n);default:return!1}}getReferenceType(e){const n=`${e.container.$type}:${e.property}`;switch(n){case"Action:type":case"CrossReference:type":case"Interface:superTypes":case"ParserRule:returnType":case"SimpleType:typeRef":return ih;case"Grammar:hiddenTokens":case"ParserRule:hiddenTokens":case"RuleCall:rule":return rh;case"Grammar:usedGrammar\
s":return ah;case"NamedArgument:parameter":case"ParameterReference:parameter":return uh;case"TerminalRuleCall:rule":return bo;default:throw new Error(`${n} is not a valid reference id.`)}}getTypeMetaData(e){switch(e){case Bu:return{name:Bu,properties:[{name:"cardinality"},{name:"lookahead"}]};case sh:return{name:sh,properties:[{name:"elements",defaultValue:[]}]};case qu:return{name:qu,properties:[{name:"elementType"}]};case Gu:return{name:Gu,properties:[{name:"true",defaultValue:!1}]};case Uu:return{
name:Uu,properties:[{name:"left"},{name:"right"}]};case zu:return{name:zu,properties:[{name:"left"},{name:"right"}]};case ah:return{name:ah,properties:[{name:"definesHiddenTokens",defaultValue:!1},{name:"hiddenTokens",defaultValue:[]},{name:"imports",defaultValue:[]},{name:"interfaces",defaultValue:[]},{name:"isDeclared",defaultValue:!1},{name:"name"},{name:"rules",defaultValue:[]},{name:"types",defaultValue:[]},{name:"usedGrammars",defaultValue:[]}]};case Jg:return{name:Jg,properties:[{name:"pa\
th"}]};case Wu:return{name:Wu,properties:[{name:"name"}]};case Hu:return{name:Hu,properties:[{name:"attributes",defaultValue:[]},{name:"name"},{name:"superTypes",defaultValue:[]}]};case Qg:return{name:Qg,properties:[{name:"calledByName",defaultValue:!1},{name:"parameter"},{name:"value"}]};case Vu:return{name:Vu,properties:[{name:"value"}]};case oh:return{name:oh,properties:[{name:"value"}]};case uh:return{name:uh,properties:[{name:"name"}]};case Ku:return{name:Ku,properties:[{name:"parameter"}]};case Zu:
return{name:Zu,properties:[{name:"dataType"},{name:"definesHiddenTokens",defaultValue:!1},{name:"definition"},{name:"entry",defaultValue:!1},{name:"fragment",defaultValue:!1},{name:"hiddenTokens",defaultValue:[]},{name:"inferredType"},{name:"name"},{name:"parameters",defaultValue:[]},{name:"returnType"},{name:"wildcard",defaultValue:!1}]};case Xu:return{name:Xu,properties:[{name:"referenceType"}]};case ch:return{name:ch,properties:[{name:"name"}]};case Yu:return{name:Yu,properties:[{name:"primit\
iveType"},{name:"stringType"},{name:"typeRef"}]};case lh:return{name:lh,properties:[{name:"value"}]};case bo:return{name:bo,properties:[{name:"definition"},{name:"fragment",defaultValue:!1},{name:"hidden",defaultValue:!1},{name:"name"},{name:"type"}]};case Ju:return{name:Ju,properties:[{name:"name"},{name:"type"}]};case ty:return{name:ty,properties:[{name:"defaultValue"},{name:"isOptional",defaultValue:!1},{name:"name"},{name:"type"}]};case Qu:return{name:Qu,properties:[{name:"types",defaultValue:[]}]};case ec:
return{name:ec,properties:[{name:"cardinality"},{name:"feature"},{name:"inferredType"},{name:"lookahead"},{name:"operator"},{name:"type"}]};case tc:return{name:tc,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case nc:return{name:nc,properties:[{name:"cardinality"},{name:"feature"},{name:"lookahead"},{name:"operator"},{name:"terminal"}]};case rc:return{name:rc,properties:[{name:"cardinality"},{name:"left"},{name:"lookahead"},{name:"right"}]};case ic:return{
name:ic,properties:[{name:"cardinality"},{name:"deprecatedSyntax",defaultValue:!1},{name:"lookahead"},{name:"terminal"},{name:"type"}]};case ac:return{name:ac,properties:[{name:"cardinality"},{name:"lookahead"}]};case oc:return{name:oc,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"guardCondition"},{name:"lookahead"}]};case uc:return{name:uc,properties:[{name:"cardinality"},{name:"lookahead"},{name:"value"}]};case cc:return{name:cc,properties:[{name:"cardinality"},{name:"\
lookahead"},{name:"terminal"}]};case lc:return{name:lc,properties:[{name:"cardinality"},{name:"lookahead"},{name:"regex"}]};case dc:return{name:dc,properties:[{name:"arguments",defaultValue:[]},{name:"cardinality"},{name:"lookahead"},{name:"rule"}]};case fc:return{name:fc,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case hc:return{name:hc,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case pc:return{name:pc,properties:[
{name:"cardinality"},{name:"lookahead"},{name:"rule"}]};case mc:return{name:mc,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case gc:return{name:gc,properties:[{name:"cardinality"},{name:"lookahead"},{name:"terminal"}]};case yc:return{name:yc,properties:[{name:"cardinality"},{name:"lookahead"}]};default:return{name:e,properties:[]}}}}const at=new zE;function iy(t){for(const[e,n]of Object.entries(t))e.startsWith("$")||(Array.isArray(n)?n.forEach((r,i)=>{Mt(
r)&&(r.$container=t,r.$containerProperty=e,r.$containerIndex=i)}):Mt(n)&&(n.$container=t,n.$containerProperty=e))}function cr(t,e){let n=t;for(;n;){if(e(n))return n;n=n.$container}}function mi(t,e){let n=t;for(;n;){if(e(n))return!0;n=n.$container}return!1}function vt(t){const n=dh(t).$document;if(!n)throw new Error("AST node has no document.");return n}function dh(t){for(;t.$container;)t=t.$container;return t}function vc(t,e){if(!t)throw new Error("Node must be an AstNode.");const n=e?.range;return new mn(
()=>({keys:Object.keys(t),keyIndex:0,arrayIndex:0}),r=>{for(;r.keyIndex<r.keys.length;){const i=r.keys[r.keyIndex];if(!i.startsWith("$")){const s=t[i];if(Mt(s)){if(r.keyIndex++,sy(s,n))return{done:!1,value:s}}else if(Array.isArray(s)){for(;r.arrayIndex<s.length;){const a=r.arrayIndex++,o=s[a];if(Mt(o)&&sy(o,n))return{done:!1,value:o}}r.arrayIndex=0}}r.keyIndex++}return Qn})}function gi(t,e){if(!t)throw new Error("Root node must be an AstNode.");return new wo(t,n=>vc(n,e))}function Ni(t,e){if(t){
if(e?.range&&!sy(t,e.range))return new wo(t,()=>[])}else throw new Error("Root node must be an AstNode.");return new wo(t,n=>vc(n,e),{includeRoot:!0})}function sy(t,e){var n;if(!e)return!0;const r=(n=t.$cstNode)===null||n===void 0?void 0:n.range;return r?PE(r,e):!1}function fh(t){return new mn(()=>({keys:Object.keys(t),keyIndex:0,arrayIndex:0}),e=>{for(;e.keyIndex<e.keys.length;){const n=e.keys[e.keyIndex];if(!n.startsWith("$")){const r=t[n];if($r(r))return e.keyIndex++,{done:!1,value:{reference:r,
container:t,property:n}};if(Array.isArray(r)){for(;e.arrayIndex<r.length;){const i=e.arrayIndex++,s=r[i];if($r(s))return{done:!1,value:{reference:s,container:t,property:n,index:i}}}e.arrayIndex=0}}e.keyIndex++}return Qn})}function BO(t,e=vt(t).parseResult.value){const n=[];return Ni(e).forEach(r=>{fh(r).forEach(i=>{i.reference.ref===t&&n.push(i.reference)})}),rt(n)}function ay(t,e){const n=t.getTypeMetaData(e.$type),r=e;for(const i of n.properties)i.defaultValue!==void 0&&r[i.name]===void 0&&(r[i.
name]=WE(i.defaultValue))}function WE(t){return Array.isArray(t)?[...t.map(WE)]:t}function oy(t,e){const n={$type:t.$type};for(const[r,i]of Object.entries(t))if(!r.startsWith("$"))if(Mt(i))n[r]=oy(i,e);else if($r(i))n[r]=e(n,r,i.$refNode,i.$refText);else if(Array.isArray(i)){const s=[];for(const a of i)Mt(a)?s.push(oy(a,e)):$r(a)?s.push(e(n,r,a.$refNode,a.$refText)):s.push(a);n[r]=s}else n[r]=i;return iy(n),n}const Eo={__proto__:null,assignMandatoryProperties:ay,copyAstNode:oy,findLocalReferences:BO,
findRootNode:dh,getContainerOfType:cr,getDocument:vt,hasContainerOfType:mi,linkContentToContainer:iy,streamAllContents:gi,streamAst:Ni,streamContents:vc,streamReferences:fh};function Ie(t){return t.charCodeAt(0)}function uy(t,e){Array.isArray(t)?t.forEach(function(n){e.push(n)}):e.push(t)}function wc(t,e){if(t[e]===!0)throw"duplicate flag "+e;t[e],t[e]=!0}function ko(t){if(t===void 0)throw Error("Internal Error - Should never get here!");return!0}function qO(){throw Error("Internal Error - Shoul\
d never get here!")}function HE(t){return t.type==="Character"}const hh=[];for(let t=Ie("0");t<=Ie("9");t++)hh.push(t);const ph=[Ie("_")].concat(hh);for(let t=Ie("a");t<=Ie("z");t++)ph.push(t);for(let t=Ie("A");t<=Ie("Z");t++)ph.push(t);const VE=[Ie(" "),Ie("\f"),Ie(`
`),Ie("\r"),Ie("	"),Ie("\v"),Ie("	"),Ie("\xA0"),Ie("\u1680"),Ie("\u2000"),Ie("\u2001"),Ie("\u2002"),Ie("\u2003"),Ie("\u2004"),Ie("\u2005"),Ie("\u2006"),Ie("\u2007"),Ie("\u2008"),Ie("\u2009"),Ie("\u200A"),Ie("\u2028"),Ie("\u2029"),Ie("\u202F"),Ie("\u205F"),Ie("\u3000"),Ie("\uFEFF")],GO=/[0-9a-fA-F]/,mh=/[0-9]/,UO=/[1-9]/;class KE{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=
e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");const n=this.disjunction();this.consumeChar("/");const r={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":wc(r,"global");break;case"i":wc(r,"ignoreCase");break;case"m":wc(r,"multiLine");break;case"u":wc(r,"unicode");break;case"y":wc(r,"sticky");break}if(this.idx!==this.input.length)
throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:n,loc:this.loc(0)}}disjunction(){const e=[],n=this.idx;for(e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(n)}}alternative(){const e=[],n=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(n)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){
const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let n;switch(this.popChar()){case"=":n="Lookahead";break;case"!":n="NegativeLookahead";break}ko(n);const r=this.disjunction();return this.consumeChar("\
)"),{type:n,value:r,loc:this.loc(e)}}return qO()}quantifier(e=!1){let n;const r=this.idx;switch(this.popChar()){case"*":n={atLeast:0,atMost:1/0};break;case"+":n={atLeast:1,atMost:1/0};break;case"?":n={atLeast:0,atMost:1};break;case"{":const i=this.integerIncludingZero();switch(this.popChar()){case"}":n={atLeast:i,atMost:i};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),n={atLeast:i,atMost:s}):n={atLeast:i,atMost:1/0},this.consumeChar("}");break}if(e===!0&&n===void 0)return;ko(
n);break}if(!(e===!0&&n===void 0)&&ko(n))return this.peekChar(0)==="?"?(this.consumeChar("?"),n.greedy=!1):n.greedy=!0,n.type="Quantifier",n.loc=this.loc(r),n}atom(){let e;const n=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===void 0&&this.isPatternCharacter()&&(e=this.patternCharacter()),ko(e))return e.loc=this.loc(n),this.isQuantifier()&&(e.quantifier=this.quantifier()),
e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[Ie(`
`),Ie("\r"),Ie("\u2028"),Ie("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.
regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,n=!1;switch(this.popChar()){case"d":e=hh;break;case"D":e=hh,n=!0;break;case"s":e=VE;break;case"S":e=VE,n=!0;break;case"w":e=ph;break;case"W":e=ph,n=!0;break}if(ko(e))return{type:"Set",value:e,complement:n}}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=Ie("\f");break;case"n":e=Ie(`
`);break;case"r":e=Ie("\r");break;case"t":e=Ie("	");break;case"v":e=Ie("\v");break}if(ko(e))return{type:"Character",value:e}}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===!1)throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:Ie("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){
return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:Ie(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:Ie(e)}}}characterClass(){const e=[];let n=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),n=!0);this.isClassAtom();){const r=this.classAtom();if(r.type,HE(r)&&this.isRangeDash()){this.consumeChar("-");const i=this.classAtom();if(i.type,HE(i)){if(i.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:i.
value})}else uy(r.value,e),e.push(Ie("-")),uy(i.value,e)}else uy(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:n,value:e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:Ie("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"\
x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++;break}const n=this.disjunction();this.consumeChar(")");const r={type:"Group",capturing:e,value:n};return e&&(r.idx=this.groupIdx),r}positiveInteger(){let e=this.popChar();if(UO.test(e)===!1)throw Error("Expecting a\
 positive integer");for(;mh.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(mh.test(e)===!1)throw Error("Expecting an integer");for(;mh.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:Ie(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return mh.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){
const e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let n="";for(let i=0;i<e;i++){const s=this.popChar();if(GO.test(s)===!1)throw Error("Expecting a HexDecimal digits");n+=s}return{type:"Character",value:parseInt(n,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(e!==void 0&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+
this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}}class gh{visitChildren(e){for(const n in e){const r=e[n];e.hasOwnProperty(n)&&(r.type!==void 0?this.visit(r):Array.isArray(r)&&r.forEach(i=>{this.visit(i)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"Sta\
rtAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.
visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}const ZE=/\r?\n/gm,zO=new KE;class WO extends gh{constructor(){super(...arguments),this.isStarting=!0,this.endRegexpStack=[],this.multiline=!1}get endRegex(){
return this.endRegexpStack.join("")}reset(e){this.multiline=!1,this.regex=e,this.startRegexp="",this.isStarting=!0,this.endRegexpStack=[]}visitGroup(e){e.quantifier&&(this.isStarting=!1,this.endRegexpStack=[])}visitCharacter(e){const n=String.fromCharCode(e.value);if(!this.multiline&&n===`
`&&(this.multiline=!0),e.quantifier)this.isStarting=!1,this.endRegexpStack=[];else{const r=yh(n);this.endRegexpStack.push(r),this.isStarting&&(this.startRegexp+=r)}}visitSet(e){if(!this.multiline){const n=this.regex.substring(e.loc.begin,e.loc.end),r=new RegExp(n);this.multiline=!!`
`.match(r)}if(e.quantifier)this.isStarting=!1,this.endRegexpStack=[];else{const n=this.regex.substring(e.loc.begin,e.loc.end);this.endRegexpStack.push(n),this.isStarting&&(this.startRegexp+=n)}}visitChildren(e){e.type==="Group"&&e.quantifier||super.visitChildren(e)}}const cy=new WO;function HO(t){try{return typeof t=="string"&&(t=new RegExp(t)),t=t.toString(),cy.reset(t),cy.visit(zO.pattern(t)),cy.multiline}catch{return!1}}const VO=`\f
\r	\v \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF`.split("");function ly(t){const e=typeof t=="string"?new RegExp(t):t;return VO.some(n=>e.test(n))}function yh(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function KO(t){return Array.prototype.map.call(t,e=>/\w/.test(e)?`[${e.toLowerCase()}${e.toUpperCase()}]`:yh(e)).join("")}function ZO(t,e){const n=XO(t),r=e.match(n);return!!r&&r[0].length>0}function XO(t){typeof t=="stri\
ng"&&(t=new RegExp(t));const e=t,n=t.source;let r=0;function i(){let s="",a;function o(c){s+=n.substr(r,c),r+=c}function u(c){s+="(?:"+n.substr(r,c)+"|$)",r+=c}for(;r<n.length;)switch(n[r]){case"\\":switch(n[r+1]){case"c":u(3);break;case"x":u(4);break;case"u":e.unicode?n[r+2]==="{"?u(n.indexOf("}",r)-r+1):u(6):u(2);break;case"p":case"P":e.unicode?u(n.indexOf("}",r)-r+1):u(2);break;case"k":u(n.indexOf(">",r)-r+1);break;default:u(2);break}break;case"[":a=/\[(?:\\.|.)*?\]/g,a.lastIndex=r,a=a.exec(n)||
[],u(a[0].length);break;case"|":case"^":case"$":case"*":case"+":case"?":o(1);break;case"{":a=/\{\d+,?\d*\}/g,a.lastIndex=r,a=a.exec(n),a?o(a[0].length):u(1);break;case"(":if(n[r+1]==="?")switch(n[r+2]){case":":s+="(?:",r+=3,s+=i()+"|$)";break;case"=":s+="(?=",r+=3,s+=i()+")";break;case"!":a=r,r+=3,i(),s+=n.substr(a,r-a);break;case"<":switch(n[r+3]){case"=":case"!":a=r,r+=4,i(),s+=n.substr(a,r-a);break;default:o(n.indexOf(">",r)-r+1),s+=i()+"|$)";break}break}else o(1),s+=i()+"|$)";break;case")":return++r,
s;default:u(1);break}return s}return new RegExp(i(),t.flags)}function vh(t){return t.rules.find(e=>Sn(e)&&e.entry)}function XE(t){return t.rules.filter(e=>xi(e)&&e.hidden)}function dy(t,e){const n=new Set,r=vh(t);if(!r)return new Set(t.rules);const i=[r].concat(XE(t));for(const a of i)YE(a,n,e);const s=new Set;for(const a of t.rules)(n.has(a.name)||xi(a)&&a.hidden)&&s.add(a);return s}function YE(t,e,n){e.add(t.name),gi(t).forEach(r=>{if(Pi(r)||n&&UE(r)){const i=r.rule.ref;i&&!e.has(i.name)&&YE(i,
e,n)}})}function fy(t){if(t.terminal)return t.terminal;if(t.type.ref){const e=gy(t.type.ref);return e?.terminal}}function JE(t){return t.hidden&&!ly(kc(t))}function Ro(t,e){return!t||!e?[]:hy(t,e,t.astNode,!0)}function Cn(t,e,n){if(!t||!e)return;const r=hy(t,e,t.astNode,!0);if(r.length!==0)return n!==void 0?n=Math.max(0,Math.min(n,r.length-1)):n=0,r[n]}function hy(t,e,n,r){if(!r){const i=cr(t.grammarSource,hi);if(i&&i.feature===e)return[t]}return ks(t)&&t.astNode===n?t.content.flatMap(i=>hy(i,e,
n,!1)):[]}function py(t,e){return t?my(t,e,t?.astNode):[]}function bc(t,e,n){if(!t)return;const r=my(t,e,t?.astNode);if(r.length!==0)return n!==void 0?n=Math.max(0,Math.min(n,r.length-1)):n=0,r[n]}function my(t,e,n){if(t.astNode!==n)return[];if(pi(t.grammarSource)&&t.grammarSource.value===e)return[t];const r=th(t).iterator();let i;const s=[];do if(i=r.next(),!i.done){const a=i.value;a.astNode===n?pi(a.grammarSource)&&a.grammarSource.value===e&&s.push(a):r.prune()}while(!i.done);return s}function QE(t){
var e;const n=t.astNode;for(;n===((e=t.container)===null||e===void 0?void 0:e.astNode);){const r=cr(t.grammarSource,hi);if(r)return r;t=t.container}}function gy(t){let e=t;return BE(e)&&(ca(e.$container)?e=e.$container.$container:Sn(e.$container)?e=e.$container:ju(e.$container)),ek(t,e,new Map)}function ek(t,e,n){var r;function i(s,a){let o;return cr(s,hi)||(o=ek(a,a,n)),n.set(t,o),o}if(n.has(t))return n.get(t);n.set(t,void 0);for(const s of gi(e)){if(hi(s)&&s.feature.toLowerCase()==="name")return n.
set(t,s),s;if(Pi(s)&&Sn(s.rule.ref))return i(s,s.rule.ref);if(GE(s)&&(!((r=s.typeRef)===null||r===void 0)&&r.ref))return i(s,s.typeRef.ref)}}function tk(t){const e=t.$container;if(Rs(e)){const n=e.elements,r=n.indexOf(t);for(let i=r-1;i>=0;i--){const s=n[i];if(ca(s))return s;{const a=gi(n[i]).find(ca);if(a)return a}}}if(Yg(e))return tk(e)}function $o(t,e){return t==="?"||t==="*"||Rs(e)&&!!e.guardCondition}function nk(t){return t==="*"||t==="+"}function YO(t){return t==="+="}function wh(t){return rk(
t,new Set)}function rk(t,e){if(e.has(t))return!0;e.add(t);for(const n of gi(t))if(Pi(n)){if(!n.rule.ref||Sn(n.rule.ref)&&!rk(n.rule.ref,e))return!1}else{if(hi(n))return!1;if(ca(n))return!1}return!!t.definition}function JO(t){return yy(t.type,new Set)}function yy(t,e){if(e.has(t))return!0;if(e.add(t),RO(t))return!1;if(_O(t))return!1;if(xO(t))return t.types.every(n=>yy(n,e));if(GE(t)){if(t.primitiveType!==void 0)return!0;if(t.stringType!==void 0)return!0;if(t.typeRef!==void 0){const n=t.typeRef.ref;
return ey(n)?yy(n.type,e):!1}else return!1}else return!1}function la(t){if(t.inferredType)return t.inferredType.name;if(t.dataType)return t.dataType;if(t.returnType){const e=t.returnType.ref;if(e){if(Sn(e))return e.name;if(qE(e)||ey(e))return e.name}}}function Ec(t){var e;if(Sn(t))return wh(t)?t.name:(e=la(t))!==null&&e!==void 0?e:t.name;if(qE(t)||ey(t)||AO(t))return t.name;if(ca(t)){const n=ik(t);if(n)return n}else if(BE(t))return t.name;throw new Error("Cannot get name of Unknown Type")}function ik(t){
var e;if(t.inferredType)return t.inferredType.name;if(!((e=t.type)===null||e===void 0)&&e.ref)return Ec(t.type.ref)}function QO(t){var e,n,r;return xi(t)?(n=(e=t.type)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:"string":wh(t)?t.name:(r=la(t))!==null&&r!==void 0?r:t.name}function sk(t){var e,n,r;return xi(t)?(n=(e=t.type)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:"string":(r=la(t))!==null&&r!==void 0?r:t.name}function kc(t){const e={s:!1,i:!1,u:!1},n=Do(t.definition,e),r=Object.
entries(e).filter(([,i])=>i).map(([i])=>i).join("");return new RegExp(n,r)}const vy=/[\s\S]/.source;function Do(t,e){if(LO(t))return eL(t);if(FO(t))return tL(t);if(PO(t))return iL(t);if(UE(t)){const n=t.rule.ref;if(!n)throw new Error("Missing rule reference.");return Ii(Do(n.definition),{cardinality:t.cardinality,lookahead:t.lookahead})}else{if(IO(t))return rL(t);if(MO(t))return nL(t);if(OO(t)){const n=t.regex.lastIndexOf("/"),r=t.regex.substring(1,n),i=t.regex.substring(n+1);return e&&(e.i=i.includes(
"i"),e.s=i.includes("s"),e.u=i.includes("u")),Ii(r,{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1})}else{if(jO(t))return Ii(vy,{cardinality:t.cardinality,lookahead:t.lookahead});throw new Error(`Invalid terminal element: ${t?.$type}`)}}}function eL(t){return Ii(t.elements.map(e=>Do(e)).join("|"),{cardinality:t.cardinality,lookahead:t.lookahead})}function tL(t){return Ii(t.elements.map(e=>Do(e)).join(""),{cardinality:t.cardinality,lookahead:t.lookahead})}function nL(t){return Ii(`${vy}*\
?${Do(t.terminal)}`,{cardinality:t.cardinality,lookahead:t.lookahead})}function rL(t){return Ii(`(?!${Do(t.terminal)})${vy}*?`,{cardinality:t.cardinality,lookahead:t.lookahead})}function iL(t){return t.right?Ii(`[${wy(t.left)}-${wy(t.right)}]`,{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1}):Ii(wy(t.left),{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1})}function wy(t){return yh(t.value)}function Ii(t,e){var n;return(e.wrap!==!1||e.lookahead)&&(t=`(${(n=e.lookahead)!==null&&n!==
void 0?n:""}${t})`),e.cardinality?`${t}${e.cardinality}`:t}const by={__proto__:null,findAssignment:QE,findNameAssignment:gy,findNodeForKeyword:bc,findNodeForProperty:Cn,findNodesForKeyword:py,findNodesForKeywordInternal:my,findNodesForProperty:Ro,getActionAtElement:tk,getActionType:ik,getAllReachableRules:dy,getCrossReferenceTerminal:fy,getEntryRule:vh,getExplicitRuleType:la,getHiddenRules:XE,getRuleType:sk,getRuleTypeName:QO,getTypeName:Ec,isArrayCardinality:nk,isArrayOperator:YO,isCommentTerminal:JE,
isDataType:JO,isDataTypeRule:wh,isOptionalCardinality:$o,terminalRegex:kc};function sL(t){const e=[],n=t.Grammar;for(const r of n.rules)xi(r)&&JE(r)&&HO(kc(r))&&e.push(r.name);return{multilineCommentRules:e,nameRegexp:NE}}var ak=typeof global=="object"&&global&&global.Object===Object&&global,aL=typeof self=="object"&&self&&self.Object===Object&&self,yi=ak||aL||Function("return this")(),Dr=yi.Symbol,ok=Object.prototype,oL=ok.hasOwnProperty,uL=ok.toString,Rc=Dr?Dr.toStringTag:void 0;function cL(t){
var e=oL.call(t,Rc),n=t[Rc];try{t[Rc]=void 0;var r=!0}catch{}var i=uL.call(t);return r&&(e?t[Rc]=n:delete t[Rc]),i}var lL=Object.prototype,dL=lL.toString;function fL(t){return dL.call(t)}var hL="[object Null]",pL="[object Undefined]",uk=Dr?Dr.toStringTag:void 0;function $s(t){return t==null?t===void 0?pL:hL:uk&&uk in Object(t)?cL(t):fL(t)}function Mr(t){return t!=null&&typeof t=="object"}var mL="[object Symbol]";function $c(t){return typeof t=="symbol"||Mr(t)&&$s(t)==mL}function bh(t,e){for(var n=-1,
r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var ot=Array.isArray,ck=Dr?Dr.prototype:void 0,lk=ck?ck.toString:void 0;function dk(t){if(typeof t=="string")return t;if(ot(t))return bh(t,dk)+"";if($c(t))return lk?lk.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var gL=/\s/;function yL(t){for(var e=t.length;e--&&gL.test(t.charAt(e)););return e}var vL=/^\s+/;function wL(t){return t&&t.slice(0,yL(t)+1).replace(vL,"")}function Tr(t){var e=typeof t;return t!=null&&(e=="object"||
e=="function")}var fk=NaN,bL=/^[-+]0x[0-9a-f]+$/i,EL=/^0b[01]+$/i,kL=/^0o[0-7]+$/i,RL=parseInt;function $L(t){if(typeof t=="number")return t;if($c(t))return fk;if(Tr(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Tr(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=wL(t);var n=EL.test(t);return n||kL.test(t)?RL(t.slice(2),n?2:8):bL.test(t)?fk:+t}var DL=1/0,TL=17976931348623157e292;function SL(t){if(!t)return t===0?t:0;if(t=$L(t),t===DL||t===-1/0){var e=t<0?-1:1;return e*TL}return t===t?
t:0}function Eh(t){var e=SL(t),n=e%1;return e===e?n?e-n:e:0}function da(t){return t}var CL="[object AsyncFunction]",_L="[object Function]",AL="[object GeneratorFunction]",xL="[object Proxy]";function Oi(t){if(!Tr(t))return!1;var e=$s(t);return e==_L||e==AL||e==CL||e==xL}var Ey=yi["__core-js_shared__"],hk=function(){var t=/[^.]+$/.exec(Ey&&Ey.keys&&Ey.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function PL(t){return!!hk&&hk in t}var NL=Function.prototype,IL=NL.toString;function fa(t){if(t!=
null){try{return IL.call(t)}catch{}try{return t+""}catch{}}return""}var OL=/[\\^$.*+?()[\]{}|]/g,LL=/^\[object .+?Constructor\]$/,FL=Function.prototype,ML=Object.prototype,jL=FL.toString,BL=ML.hasOwnProperty,qL=RegExp("^"+jL.call(BL).replace(OL,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function GL(t){if(!Tr(t)||PL(t))return!1;var e=Oi(t)?qL:LL;return e.test(fa(t))}function UL(t,e){return t?.[e]}function ha(t,e){var n=UL(t,e);return GL(n)?n:void 0}var ky=ha(
yi,"WeakMap"),pk=Object.create,zL=function(){function t(){}return function(e){if(!Tr(e))return{};if(pk)return pk(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function WL(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function an(){}function HL(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var VL=800,KL=16,ZL=Date.now;function XL(t){var e=0,
n=0;return function(){var r=ZL(),i=KL-(r-n);if(n=r,i>0){if(++e>=VL)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function YL(t){return function(){return t}}var kh=function(){try{var t=ha(Object,"defineProperty");return t({},"",{}),t}catch{}}(),JL=kh?function(t,e){return kh(t,"toString",{configurable:!0,enumerable:!1,value:YL(e),writable:!0})}:da,QL=XL(JL);function mk(t,e){for(var n=-1,r=t==null?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function gk(t,e,n,r){for(var i=t.length,
s=n+-1;++s<i;)if(e(t[s],s,t))return s;return-1}function eF(t){return t!==t}function tF(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function Ry(t,e,n){return e===e?tF(t,e,n):gk(t,eF,n)}function yk(t,e){var n=t==null?0:t.length;return!!n&&Ry(t,e,0)>-1}var nF=9007199254740991,rF=/^(?:0|[1-9]\d*)$/;function Rh(t,e){var n=typeof t;return e=e??nF,!!e&&(n=="number"||n!="symbol"&&rF.test(t))&&t>-1&&t%1==0&&t<e}function $y(t,e,n){e=="__proto__"&&kh?kh(t,e,{configurable:!0,enumerable:!0,
value:n,writable:!0}):t[e]=n}function Dc(t,e){return t===e||t!==t&&e!==e}var iF=Object.prototype,sF=iF.hasOwnProperty;function $h(t,e,n){var r=t[e];(!(sF.call(t,e)&&Dc(r,n))||n===void 0&&!(e in t))&&$y(t,e,n)}function Tc(t,e,n,r){var i=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var o=e[s],u=void 0;u===void 0&&(u=t[o]),i?$y(n,o,u):$h(n,o,u)}return n}var vk=Math.max;function aF(t,e,n){return e=vk(e===void 0?t.length-1:e,0),function(){for(var r=arguments,i=-1,s=vk(r.length-e,0),a=Array(s);++i<s;)
a[i]=r[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=r[i];return o[e]=n(a),WL(t,this,o)}}function Dy(t,e){return QL(aF(t,e,da),t+"")}var oF=9007199254740991;function Ty(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=oF}function vi(t){return t!=null&&Ty(t.length)&&!Oi(t)}function wk(t,e,n){if(!Tr(n))return!1;var r=typeof e;return(r=="number"?vi(n)&&Rh(e,n.length):r=="string"&&e in n)?Dc(n[e],t):!1}function uF(t){return Dy(function(e,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(s=
t.length>3&&typeof s=="function"?(i--,s):void 0,a&&wk(n[0],n[1],a)&&(s=i<3?void 0:s,i=1),e=Object(e);++r<i;){var o=n[r];o&&t(e,o,r,s)}return e})}var cF=Object.prototype;function Sc(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||cF;return t===n}function lF(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var dF="[object Arguments]";function bk(t){return Mr(t)&&$s(t)==dF}var Ek=Object.prototype,fF=Ek.hasOwnProperty,hF=Ek.propertyIsEnumerable,Dh=bk(function(){return arguments}())?
bk:function(t){return Mr(t)&&fF.call(t,"callee")&&!hF.call(t,"callee")};function pF(){return!1}var kk=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Rk=kk&&typeof module=="object"&&module&&!module.nodeType&&module,mF=Rk&&Rk.exports===kk,$k=mF?yi.Buffer:void 0,gF=$k?$k.isBuffer:void 0,Cc=gF||pF,yF="[object Arguments]",vF="[object Array]",wF="[object Boolean]",bF="[object Date]",EF="[object Error]",kF="[object Function]",RF="[object Map]",$F="[object Number]",DF="[object Object]",TF="\
[object RegExp]",SF="[object Set]",CF="[object String]",_F="[object WeakMap]",AF="[object ArrayBuffer]",xF="[object DataView]",PF="[object Float32Array]",NF="[object Float64Array]",IF="[object Int8Array]",OF="[object Int16Array]",LF="[object Int32Array]",FF="[object Uint8Array]",MF="[object Uint8ClampedArray]",jF="[object Uint16Array]",BF="[object Uint32Array]",Pt={};Pt[PF]=Pt[NF]=Pt[IF]=Pt[OF]=Pt[LF]=Pt[FF]=Pt[MF]=Pt[jF]=Pt[BF]=!0,Pt[yF]=Pt[vF]=Pt[AF]=Pt[wF]=Pt[xF]=Pt[bF]=Pt[EF]=Pt[kF]=Pt[RF]=Pt[$F]=
Pt[DF]=Pt[TF]=Pt[SF]=Pt[CF]=Pt[_F]=!1;function qF(t){return Mr(t)&&Ty(t.length)&&!!Pt[$s(t)]}function Th(t){return function(e){return t(e)}}var Dk=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_c=Dk&&typeof module=="object"&&module&&!module.nodeType&&module,GF=_c&&_c.exports===Dk,Sy=GF&&ak.process,Ds=function(){try{var t=_c&&_c.require&&_c.require("util").types;return t||Sy&&Sy.binding&&Sy.binding("util")}catch{}}(),Tk=Ds&&Ds.isTypedArray,Cy=Tk?Th(Tk):qF,UF=Object.prototype,zF=UF.
hasOwnProperty;function Sk(t,e){var n=ot(t),r=!n&&Dh(t),i=!n&&!r&&Cc(t),s=!n&&!r&&!i&&Cy(t),a=n||r||i||s,o=a?lF(t.length,String):[],u=o.length;for(var c in t)(e||zF.call(t,c))&&!(a&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Rh(c,u)))&&o.push(c);return o}function Ck(t,e){return function(n){return t(e(n))}}var WF=Ck(Object.keys,Object),HF=Object.prototype,VF=HF.hasOwnProperty;function _k(t){if(!Sc(t))return WF(t);var e=[];for(var n in Object(t))
VF.call(t,n)&&n!="constructor"&&e.push(n);return e}function Sr(t){return vi(t)?Sk(t):_k(t)}var KF=Object.prototype,ZF=KF.hasOwnProperty,lr=uF(function(t,e){if(Sc(e)||vi(e)){Tc(e,Sr(e),t);return}for(var n in e)ZF.call(e,n)&&$h(t,n,e[n])});function XF(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var YF=Object.prototype,JF=YF.hasOwnProperty;function QF(t){if(!Tr(t))return XF(t);var e=Sc(t),n=[];for(var r in t)r=="constructor"&&(e||!JF.call(t,r))||n.push(r);return n}function _y(t){
return vi(t)?Sk(t,!0):QF(t)}var eM=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,tM=/^\w*$/;function Ay(t,e){if(ot(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||$c(t)?!0:tM.test(t)||!eM.test(t)||e!=null&&t in Object(e)}var Ac=ha(Object,"create");function nM(){this.__data__=Ac?Ac(null):{},this.size=0}function rM(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var iM="__lodash_hash_undefined__",sM=Object.prototype,aM=sM.hasOwnProperty;
function oM(t){var e=this.__data__;if(Ac){var n=e[t];return n===iM?void 0:n}return aM.call(e,t)?e[t]:void 0}var uM=Object.prototype,cM=uM.hasOwnProperty;function lM(t){var e=this.__data__;return Ac?e[t]!==void 0:cM.call(e,t)}var dM="__lodash_hash_undefined__";function fM(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Ac&&e===void 0?dM:e,this}function pa(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}pa.prototype.clear=nM,pa.prototype.delete=
rM,pa.prototype.get=oM,pa.prototype.has=lM,pa.prototype.set=fM;function hM(){this.__data__=[],this.size=0}function Sh(t,e){for(var n=t.length;n--;)if(Dc(t[n][0],e))return n;return-1}var pM=Array.prototype,mM=pM.splice;function gM(t){var e=this.__data__,n=Sh(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():mM.call(e,n,1),--this.size,!0}function yM(t){var e=this.__data__,n=Sh(e,t);return n<0?void 0:e[n][1]}function vM(t){return Sh(this.__data__,t)>-1}function wM(t,e){var n=this.__data__,r=Sh(
n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function Li(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Li.prototype.clear=hM,Li.prototype.delete=gM,Li.prototype.get=yM,Li.prototype.has=vM,Li.prototype.set=wM;var xc=ha(yi,"Map");function bM(){this.size=0,this.__data__={hash:new pa,map:new(xc||Li),string:new pa}}function EM(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Ch(t,e){
var n=t.__data__;return EM(e)?n[typeof e=="string"?"string":"hash"]:n.map}function kM(t){var e=Ch(this,t).delete(t);return this.size-=e?1:0,e}function RM(t){return Ch(this,t).get(t)}function $M(t){return Ch(this,t).has(t)}function DM(t,e){var n=Ch(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function Fi(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Fi.prototype.clear=bM,Fi.prototype.delete=kM,Fi.prototype.get=RM,Fi.prototype.has=$M,
Fi.prototype.set=DM;var TM="Expected a function";function xy(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(TM);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var a=t.apply(this,r);return n.cache=s.set(i,a)||s,a};return n.cache=new(xy.Cache||Fi),n}xy.Cache=Fi;var SM=500;function CM(t){var e=xy(t,function(r){return n.size===SM&&n.clear(),r}),n=e.cache;return e}var _M=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,
AM=/\\(\\)?/g,xM=CM(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(_M,function(n,r,i,s){e.push(i?s.replace(AM,"$1"):r||n)}),e});function PM(t){return t==null?"":dk(t)}function _h(t,e){return ot(t)?t:Ay(t,e)?[t]:xM(PM(t))}function Pc(t){if(typeof t=="string"||$c(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function Py(t,e){e=_h(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[Pc(e[n++])];return n&&n==r?t:void 0}function NM(t,e,n){var r=t==null?void 0:Py(t,e);return r===
void 0?n:r}function Ny(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var Ak=Dr?Dr.isConcatSpreadable:void 0;function IM(t){return ot(t)||Dh(t)||!!(Ak&&t&&t[Ak])}function Iy(t,e,n,r,i){var s=-1,a=t.length;for(n||(n=IM),i||(i=[]);++s<a;){var o=t[s];n(o)?Ny(i,o):r||(i[i.length]=o)}return i}function Cr(t){var e=t==null?0:t.length;return e?Iy(t):[]}var xk=Ck(Object.getPrototypeOf,Object);function Pk(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>
0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=t[r+e];return s}function OM(t,e,n,r){var i=-1,s=t==null?0:t.length;for(r&&s&&(n=t[++i]);++i<s;)n=e(n,t[i],i,t);return n}function LM(){this.__data__=new Li,this.size=0}function FM(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function MM(t){return this.__data__.get(t)}function jM(t){return this.__data__.has(t)}var BM=200;function qM(t,e){var n=this.__data__;if(n instanceof Li){var r=n.__data__;if(!xc||r.length<BM-1)return r.push([t,e]),this.
size=++n.size,this;n=this.__data__=new Fi(r)}return n.set(t,e),this.size=n.size,this}function wi(t){var e=this.__data__=new Li(t);this.size=e.size}wi.prototype.clear=LM,wi.prototype.delete=FM,wi.prototype.get=MM,wi.prototype.has=jM,wi.prototype.set=qM;function GM(t,e){return t&&Tc(e,Sr(e),t)}function UM(t,e){return t&&Tc(e,_y(e),t)}var Nk=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ik=Nk&&typeof module=="object"&&module&&!module.nodeType&&module,zM=Ik&&Ik.exports===Nk,Ok=zM?yi.
Buffer:void 0,Lk=Ok?Ok.allocUnsafe:void 0;function WM(t,e){var n=t.length,r=Lk?Lk(n):new t.constructor(n);return t.copy(r),r}function Oy(t,e){for(var n=-1,r=t==null?0:t.length,i=0,s=[];++n<r;){var a=t[n];e(a,n,t)&&(s[i++]=a)}return s}function Fk(){return[]}var HM=Object.prototype,VM=HM.propertyIsEnumerable,Mk=Object.getOwnPropertySymbols,Ly=Mk?function(t){return t==null?[]:(t=Object(t),Oy(Mk(t),function(e){return VM.call(t,e)}))}:Fk;function KM(t,e){return Tc(t,Ly(t),e)}var ZM=Object.getOwnPropertySymbols,
jk=ZM?function(t){for(var e=[];t;)Ny(e,Ly(t)),t=xk(t);return e}:Fk;function XM(t,e){return Tc(t,jk(t),e)}function Bk(t,e,n){var r=e(t);return ot(t)?r:Ny(r,n(t))}function Fy(t){return Bk(t,Sr,Ly)}function YM(t){return Bk(t,_y,jk)}var My=ha(yi,"DataView"),jy=ha(yi,"Promise"),To=ha(yi,"Set"),qk="[object Map]",JM="[object Object]",Gk="[object Promise]",Uk="[object Set]",zk="[object WeakMap]",Wk="[object DataView]",QM=fa(My),e2=fa(xc),t2=fa(jy),n2=fa(To),r2=fa(ky),_r=$s;(My&&_r(new My(new ArrayBuffer(
1)))!=Wk||xc&&_r(new xc)!=qk||jy&&_r(jy.resolve())!=Gk||To&&_r(new To)!=Uk||ky&&_r(new ky)!=zk)&&(_r=function(t){var e=$s(t),n=e==JM?t.constructor:void 0,r=n?fa(n):"";if(r)switch(r){case QM:return Wk;case e2:return qk;case t2:return Gk;case n2:return Uk;case r2:return zk}return e});var i2=Object.prototype,s2=i2.hasOwnProperty;function a2(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&s2.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var Ah=yi.Uint8Array;function o2(t){
var e=new t.constructor(t.byteLength);return new Ah(e).set(new Ah(t)),e}function u2(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var c2=/\w*$/;function l2(t){var e=new t.constructor(t.source,c2.exec(t));return e.lastIndex=t.lastIndex,e}var Hk=Dr?Dr.prototype:void 0,Vk=Hk?Hk.valueOf:void 0;function d2(t){return Vk?Object(Vk.call(t)):{}}function f2(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var h2="[object Boolean]",p2="[object Date]",m2="[ob\
ject Map]",g2="[object Number]",y2="[object RegExp]",v2="[object Set]",w2="[object String]",b2="[object Symbol]",E2="[object ArrayBuffer]",k2="[object DataView]",R2="[object Float32Array]",$2="[object Float64Array]",D2="[object Int8Array]",T2="[object Int16Array]",S2="[object Int32Array]",C2="[object Uint8Array]",_2="[object Uint8ClampedArray]",A2="[object Uint16Array]",x2="[object Uint32Array]";function P2(t,e,n){var r=t.constructor;switch(e){case E2:return o2(t);case h2:case p2:return new r(+t);case k2:
return u2(t);case R2:case $2:case D2:case T2:case S2:case C2:case _2:case A2:case x2:return f2(t);case m2:return new r;case g2:case w2:return new r(t);case y2:return l2(t);case v2:return new r;case b2:return d2(t)}}function N2(t){return typeof t.constructor=="function"&&!Sc(t)?zL(xk(t)):{}}var I2="[object Map]";function O2(t){return Mr(t)&&_r(t)==I2}var Kk=Ds&&Ds.isMap,L2=Kk?Th(Kk):O2,F2="[object Set]";function M2(t){return Mr(t)&&_r(t)==F2}var Zk=Ds&&Ds.isSet,j2=Zk?Th(Zk):M2,B2=2,Xk="[object Ar\
guments]",q2="[object Array]",G2="[object Boolean]",U2="[object Date]",z2="[object Error]",Yk="[object Function]",W2="[object GeneratorFunction]",H2="[object Map]",V2="[object Number]",Jk="[object Object]",K2="[object RegExp]",Z2="[object Set]",X2="[object String]",Y2="[object Symbol]",J2="[object WeakMap]",Q2="[object ArrayBuffer]",ej="[object DataView]",tj="[object Float32Array]",nj="[object Float64Array]",rj="[object Int8Array]",ij="[object Int16Array]",sj="[object Int32Array]",aj="[object Ui\
nt8Array]",oj="[object Uint8ClampedArray]",uj="[object Uint16Array]",cj="[object Uint32Array]",Ct={};Ct[Xk]=Ct[q2]=Ct[Q2]=Ct[ej]=Ct[G2]=Ct[U2]=Ct[tj]=Ct[nj]=Ct[rj]=Ct[ij]=Ct[sj]=Ct[H2]=Ct[V2]=Ct[Jk]=Ct[K2]=Ct[Z2]=Ct[X2]=Ct[Y2]=Ct[aj]=Ct[oj]=Ct[uj]=Ct[cj]=!0,Ct[z2]=Ct[Yk]=Ct[J2]=!1;function xh(t,e,n,r,i,s){var a,o=e&B2;if(a!==void 0)return a;if(!Tr(t))return t;var u=ot(t);if(u)return a=a2(t),HL(t,a);var c=_r(t),l=c==Yk||c==W2;if(Cc(t))return WM(t);if(c==Jk||c==Xk||l&&!i)return a=l?{}:N2(t),o?XM(t,
UM(a,t)):KM(t,GM(a,t));if(!Ct[c])return i?t:{};a=P2(t,c),s||(s=new wi);var f=s.get(t);if(f)return f;s.set(t,a),j2(t)?t.forEach(function(p){a.add(xh(p,e,n,p,t,s))}):L2(t)&&t.forEach(function(p,w){a.set(w,xh(p,e,n,w,t,s))});var d=Fy,h=u?void 0:d(t);return mk(h||t,function(p,w){h&&(w=p,p=t[w]),$h(a,w,xh(p,e,n,w,t,s))}),a}var lj=4;function wn(t){return xh(t,lj)}function Nc(t){for(var e=-1,n=t==null?0:t.length,r=0,i=[];++e<n;){var s=t[e];s&&(i[r++]=s)}return i}var dj="__lodash_hash_undefined__";function fj(t){
return this.__data__.set(t,dj),this}function hj(t){return this.__data__.has(t)}function So(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Fi;++e<n;)this.add(t[e])}So.prototype.add=So.prototype.push=fj,So.prototype.has=hj;function Qk(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function By(t,e){return t.has(e)}var pj=1,mj=2;function eR(t,e,n,r,i,s){var a=n&pj,o=t.length,u=e.length;if(o!=u&&!(a&&u>o))return!1;var c=s.get(t),l=s.get(e);if(c&&l)return c==e&&
l==t;var f=-1,d=!0,h=n&mj?new So:void 0;for(s.set(t,e),s.set(e,t);++f<o;){var p=t[f],w=e[f];if(r)var v=a?r(w,p,f,e,t,s):r(p,w,f,t,e,s);if(v!==void 0){if(v)continue;d=!1;break}if(h){if(!Qk(e,function(g,b){if(!By(h,b)&&(p===g||i(p,g,n,r,s)))return h.push(b)})){d=!1;break}}else if(!(p===w||i(p,w,n,r,s))){d=!1;break}}return s.delete(t),s.delete(e),d}function gj(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n}function qy(t){var e=-1,n=Array(t.size);return t.forEach(function(r){
n[++e]=r}),n}var yj=1,vj=2,wj="[object Boolean]",bj="[object Date]",Ej="[object Error]",kj="[object Map]",Rj="[object Number]",$j="[object RegExp]",Dj="[object Set]",Tj="[object String]",Sj="[object Symbol]",Cj="[object ArrayBuffer]",_j="[object DataView]",tR=Dr?Dr.prototype:void 0,Gy=tR?tR.valueOf:void 0;function Aj(t,e,n,r,i,s,a){switch(n){case _j:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Cj:return!(t.byteLength!=e.byteLength||!s(new Ah(t),new Ah(
e)));case wj:case bj:case Rj:return Dc(+t,+e);case Ej:return t.name==e.name&&t.message==e.message;case $j:case Tj:return t==e+"";case kj:var o=gj;case Dj:var u=r&yj;if(o||(o=qy),t.size!=e.size&&!u)return!1;var c=a.get(t);if(c)return c==e;r|=vj,a.set(t,e);var l=eR(o(t),o(e),r,i,s,a);return a.delete(t),l;case Sj:if(Gy)return Gy.call(t)==Gy.call(e)}return!1}var xj=1,Pj=Object.prototype,Nj=Pj.hasOwnProperty;function Ij(t,e,n,r,i,s){var a=n&xj,o=Fy(t),u=o.length,c=Fy(e),l=c.length;if(u!=l&&!a)return!1;
for(var f=u;f--;){var d=o[f];if(!(a?d in e:Nj.call(e,d)))return!1}var h=s.get(t),p=s.get(e);if(h&&p)return h==e&&p==t;var w=!0;s.set(t,e),s.set(e,t);for(var v=a;++f<u;){d=o[f];var g=t[d],b=e[d];if(r)var k=a?r(b,g,d,e,t,s):r(g,b,d,t,e,s);if(!(k===void 0?g===b||i(g,b,n,r,s):k)){w=!1;break}v||(v=d=="constructor")}if(w&&!v){var _=t.constructor,I=e.constructor;_!=I&&"constructor"in t&&"constructor"in e&&!(typeof _=="function"&&_ instanceof _&&typeof I=="function"&&I instanceof I)&&(w=!1)}return s.delete(
t),s.delete(e),w}var Oj=1,nR="[object Arguments]",rR="[object Array]",Ph="[object Object]",Lj=Object.prototype,iR=Lj.hasOwnProperty;function Fj(t,e,n,r,i,s){var a=ot(t),o=ot(e),u=a?rR:_r(t),c=o?rR:_r(e);u=u==nR?Ph:u,c=c==nR?Ph:c;var l=u==Ph,f=c==Ph,d=u==c;if(d&&Cc(t)){if(!Cc(e))return!1;a=!0,l=!1}if(d&&!l)return s||(s=new wi),a||Cy(t)?eR(t,e,n,r,i,s):Aj(t,e,u,n,r,i,s);if(!(n&Oj)){var h=l&&iR.call(t,"__wrapped__"),p=f&&iR.call(e,"__wrapped__");if(h||p){var w=h?t.value():t,v=p?e.value():e;return s||
(s=new wi),i(w,v,n,r,s)}}return d?(s||(s=new wi),Ij(t,e,n,r,i,s)):!1}function Uy(t,e,n,r,i){return t===e?!0:t==null||e==null||!Mr(t)&&!Mr(e)?t!==t&&e!==e:Fj(t,e,n,r,Uy,i)}var Mj=1,jj=2;function Bj(t,e,n,r){var i=n.length,s=i;if(t==null)return!s;for(t=Object(t);i--;){var a=n[i];if(a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<s;){a=n[i];var o=a[0],u=t[o],c=a[1];if(a[2]){if(u===void 0&&!(o in t))return!1}else{var l=new wi,f;if(!(f===void 0?Uy(c,u,Mj|jj,r,l):f))return!1}}return!0}function sR(t){
return t===t&&!Tr(t)}function qj(t){for(var e=Sr(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,sR(i)]}return e}function aR(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}function Gj(t){var e=qj(t);return e.length==1&&e[0][2]?aR(e[0][0],e[0][1]):function(n){return n===t||Bj(n,t,e)}}function Uj(t,e){return t!=null&&e in Object(t)}function oR(t,e,n){e=_h(e,t);for(var r=-1,i=e.length,s=!1;++r<i;){var a=Pc(e[r]);if(!(s=t!=null&&n(t,a)))break;t=t[a]}return s||++r!=
i?s:(i=t==null?0:t.length,!!i&&Ty(i)&&Rh(a,i)&&(ot(t)||Dh(t)))}function zj(t,e){return t!=null&&oR(t,e,Uj)}var Wj=1,Hj=2;function Vj(t,e){return Ay(t)&&sR(e)?aR(Pc(t),e):function(n){var r=NM(n,t);return r===void 0&&r===e?zj(n,t):Uy(e,r,Wj|Hj)}}function Kj(t){return function(e){return e?.[t]}}function Zj(t){return function(e){return Py(e,t)}}function Xj(t){return Ay(t)?Kj(Pc(t)):Zj(t)}function jr(t){return typeof t=="function"?t:t==null?da:typeof t=="object"?ot(t)?Vj(t[0],t[1]):Gj(t):Xj(t)}function Yj(t,e,n,r){
for(var i=-1,s=t==null?0:t.length;++i<s;){var a=t[i];e(r,a,n(a),t)}return r}function Jj(t){return function(e,n,r){for(var i=-1,s=Object(e),a=r(e),o=a.length;o--;){var u=a[++i];if(n(s[u],u,s)===!1)break}return e}}var Qj=Jj();function eB(t,e){return t&&Qj(t,e,Sr)}function tB(t,e){return function(n,r){if(n==null)return n;if(!vi(n))return t(n,r);for(var i=n.length,s=-1,a=Object(n);++s<i&&r(a[s],s,a)!==!1;);return n}}var ma=tB(eB);function nB(t,e,n,r){return ma(t,function(i,s,a){e(r,i,n(i),a)}),r}function rB(t,e){
return function(n,r){var i=ot(n)?Yj:nB,s=e?e():{};return i(n,t,jr(r),s)}}var uR=Object.prototype,iB=uR.hasOwnProperty,zy=Dy(function(t,e){t=Object(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&wk(e[0],e[1],i)&&(r=1);++n<r;)for(var s=e[n],a=_y(s),o=-1,u=a.length;++o<u;){var c=a[o],l=t[c];(l===void 0||Dc(l,uR[c])&&!iB.call(t,c))&&(t[c]=s[c])}return t});function cR(t){return Mr(t)&&vi(t)}var sB=200;function aB(t,e,n,r){var i=-1,s=yk,a=!0,o=t.length,u=[],c=e.length;if(!o)return u;e.length>=sB&&(s=
By,a=!1,e=new So(e));e:for(;++i<o;){var l=t[i],f=l;if(l=l!==0?l:0,a&&f===f){for(var d=c;d--;)if(e[d]===f)continue e;u.push(l)}else s(e,f,r)||u.push(l)}return u}var Nh=Dy(function(t,e){return cR(t)?aB(t,Iy(e,1,cR,!0)):[]});function Co(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}function bn(t,e,n){var r=t==null?0:t.length;return r?(e=e===void 0?1:Eh(e),Pk(t,e<0?0:e,r)):[]}function Ic(t,e,n){var r=t==null?0:t.length;return r?(e=e===void 0?1:Eh(e),e=r-e,Pk(t,0,e<0?0:e)):[]}function oB(t){return typeof t==
"function"?t:da}function xe(t,e){var n=ot(t)?mk:ma;return n(t,oB(e))}function uB(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function cB(t,e){var n=!0;return ma(t,function(r,i,s){return n=!!e(r,i,s),n}),n}function Br(t,e,n){var r=ot(t)?uB:cB;return r(t,jr(e))}function lR(t,e){var n=[];return ma(t,function(r,i,s){e(r,i,s)&&n.push(r)}),n}function dr(t,e){var n=ot(t)?Oy:lR;return n(t,jr(e))}function lB(t){return function(e,n,r){var i=Object(e);if(!vi(e)){var s=jr(
n);e=Sr(e),n=function(o){return s(i[o],o,i)}}var a=t(e,n,r);return a>-1?i[s?e[a]:a]:void 0}}var dB=Math.max;function fB(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var i=n==null?0:Eh(n);return i<0&&(i=dB(r+i,0)),gk(t,jr(e),i)}var _o=lB(fB);function qr(t){return t&&t.length?t[0]:void 0}function hB(t,e){var n=-1,r=vi(t)?Array(t.length):[];return ma(t,function(i,s,a){r[++n]=e(i,s,a)}),r}function Re(t,e){var n=ot(t)?bh:hB;return n(t,jr(e))}function fr(t,e){return Iy(Re(t,e))}var pB=Object.prototype,
mB=pB.hasOwnProperty,gB=rB(function(t,e,n){mB.call(t,n)?t[n].push(e):$y(t,n,[e])}),yB=Object.prototype,vB=yB.hasOwnProperty;function wB(t,e){return t!=null&&vB.call(t,e)}function Pe(t,e){return t!=null&&oR(t,e,wB)}var bB="[object String]";function er(t){return typeof t=="string"||!ot(t)&&Mr(t)&&$s(t)==bB}function EB(t,e){return bh(e,function(n){return t[n]})}function on(t){return t==null?[]:EB(t,Sr(t))}var kB=Math.max;function Mn(t,e,n,r){t=vi(t)?t:on(t),n=n?Eh(n):0;var i=t.length;return n<0&&(n=
kB(i+n,0)),er(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&Ry(t,e,n)>-1}function dR(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var i=0;return Ry(t,e,i)}var RB="[object Map]",$B="[object Set]",DB=Object.prototype,TB=DB.hasOwnProperty;function $t(t){if(t==null)return!0;if(vi(t)&&(ot(t)||typeof t=="string"||typeof t.splice=="function"||Cc(t)||Cy(t)||Dh(t)))return!t.length;var e=_r(t);if(e==RB||e==$B)return!t.size;if(Sc(t))return!_k(t).length;for(var n in t)if(TB.call(t,n))return!1;return!0}var SB="[object R\
egExp]";function CB(t){return Mr(t)&&$s(t)==SB}var fR=Ds&&Ds.isRegExp,Mi=fR?Th(fR):CB;function ji(t){return t===void 0}function _B(t,e){return t<e}function AB(t,e,n){for(var r=-1,i=t.length;++r<i;){var s=t[r],a=e(s);if(a!=null&&(o===void 0?a===a&&!$c(a):n(a,o)))var o=a,u=s}return u}function xB(t){return t&&t.length?AB(t,da,_B):void 0}var PB="Expected a function";function NB(t){if(typeof t!="function")throw new TypeError(PB);return function(){var e=arguments;switch(e.length){case 0:return!t.call(
this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function IB(t,e,n,r){if(!Tr(t))return t;e=_h(e,t);for(var i=-1,s=e.length,a=s-1,o=t;o!=null&&++i<s;){var u=Pc(e[i]),c=n;if(u==="__proto__"||u==="constructor"||u==="prototype")return t;if(i!=a){var l=o[u];c=void 0,c===void 0&&(c=Tr(l)?l:Rh(e[i+1])?[]:{})}$h(o,u,c),o=o[u]}return t}function OB(t,e,n){for(var r=-1,i=e.length,s={};++r<i;){var a=e[r],o=Py(t,a);n(
o,a)&&IB(s,_h(a,t),o)}return s}function Gr(t,e){if(t==null)return{};var n=bh(YM(t),function(r){return[r]});return e=jr(e),OB(t,n,function(r,i){return e(r,i[0])})}function LB(t,e,n,r,i){return i(t,function(s,a,o){n=r?(r=!1,s):e(n,s,a,o)}),n}function jn(t,e,n){var r=ot(t)?OM:LB,i=arguments.length<3;return r(t,jr(e),n,i,ma)}function Ih(t,e){var n=ot(t)?Oy:lR;return n(t,NB(jr(e)))}function FB(t,e){var n;return ma(t,function(r,i,s){return n=e(r,i,s),!n}),!!n}function hR(t,e,n){var r=ot(t)?Qk:FB;return r(
t,jr(e))}var MB=1/0,jB=To&&1/qy(new To([,-0]))[1]==MB?function(t){return new To(t)}:an,BB=200;function pR(t,e,n){var r=-1,i=yk,s=t.length,a=!0,o=[],u=o;if(s>=BB){var c=e?null:jB(t);if(c)return qy(c);a=!1,i=By,u=new So}else u=e?[]:o;e:for(;++r<s;){var l=t[r],f=e?e(l):l;if(l=l!==0?l:0,a&&f===f){for(var d=u.length;d--;)if(u[d]===f)continue e;e&&u.push(f),o.push(l)}else i(u,f,n)||(u!==o&&u.push(f),o.push(l))}return o}function Wy(t){return t&&t.length?pR(t):[]}function qB(t,e){return t&&t.length?pR(t,
jr(e)):[]}function Hy(t){console&&console.error&&console.error(`Error: ${t}`)}function mR(t){console&&console.warn&&console.warn(`Warning: ${t}`)}function gR(t){const e=new Date().getTime(),n=t();return{time:new Date().getTime()-e,value:n}}function yR(t){function e(){}e.prototype=t;const n=new e;function r(){return typeof n.bar}return r(),r(),t}function GB(t){return UB(t)?t.LABEL:t.name}function UB(t){return er(t.LABEL)&&t.LABEL!==""}class bi{get definition(){return this._definition}set definition(e){
this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),xe(this.definition,n=>{n.accept(e)})}}class Bn extends bi{constructor(e){super([]),this.idx=1,lr(this,Gr(e,n=>n!==void 0))}set definition(e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class Ao extends bi{constructor(e){super(e.definition),this.orgText="",lr(this,Gr(e,n=>n!==void 0))}}class tr extends bi{constructor(e){super(e.definition),this.ignoreAmbiguities=
!1,lr(this,Gr(e,n=>n!==void 0))}}class En extends bi{constructor(e){super(e.definition),this.idx=1,lr(this,Gr(e,n=>n!==void 0))}}class hr extends bi{constructor(e){super(e.definition),this.idx=1,lr(this,Gr(e,n=>n!==void 0))}}class pr extends bi{constructor(e){super(e.definition),this.idx=1,lr(this,Gr(e,n=>n!==void 0))}}class zt extends bi{constructor(e){super(e.definition),this.idx=1,lr(this,Gr(e,n=>n!==void 0))}}class nr extends bi{constructor(e){super(e.definition),this.idx=1,lr(this,Gr(e,n=>n!==
void 0))}}class rr extends bi{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,lr(this,Gr(e,n=>n!==void 0))}}class Nt{constructor(e){this.idx=1,lr(this,Gr(e,n=>n!==void 0))}accept(e){e.visit(this)}}function zB(t){return Re(t,Oh)}function Oh(t){function e(n){return Re(n,Oh)}if(t instanceof Bn){const n={type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};return er(t.label)&&(n.
label=t.label),n}else{if(t instanceof tr)return{type:"Alternative",definition:e(t.definition)};if(t instanceof En)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof hr)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof pr)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:Oh(new Nt({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof nr)return{type:"RepetitionWithSeparator",idx:t.idx,separator:Oh(new Nt(
{terminalType:t.separator})),definition:e(t.definition)};if(t instanceof zt)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof rr)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof Nt){const n={type:"Terminal",name:t.terminalType.name,label:GB(t.terminalType),idx:t.idx};er(t.label)&&(n.terminalLabel=t.label);const r=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(n.pattern=Mi(r)?r.source:r),n}else{if(t instanceof Ao)return{type:"Rul\
e",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}}class xo{visit(e){const n=e;switch(n.constructor){case Bn:return this.visitNonTerminal(n);case tr:return this.visitAlternative(n);case En:return this.visitOption(n);case hr:return this.visitRepetitionMandatory(n);case pr:return this.visitRepetitionMandatoryWithSeparator(n);case nr:return this.visitRepetitionWithSeparator(n);case zt:return this.visitRepetition(n);case rr:return this.visitAlternation(
n);case Nt:return this.visitTerminal(n);case Ao:return this.visitRule(n);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function WB(t){return t instanceof tr||t instanceof En||t instanceof zt||t instanceof hr||t instanceof pr||t instanceof nr||t instanceof Nt||t instanceof
Ao}function Lh(t,e=[]){return t instanceof En||t instanceof zt||t instanceof nr?!0:t instanceof rr?hR(t.definition,r=>Lh(r,e)):t instanceof Bn&&Mn(e,t)?!1:t instanceof bi?(t instanceof Bn&&e.push(t),Br(t.definition,r=>Lh(r,e))):!1}function HB(t){return t instanceof rr}function Ei(t){if(t instanceof Bn)return"SUBRULE";if(t instanceof En)return"OPTION";if(t instanceof rr)return"OR";if(t instanceof hr)return"AT_LEAST_ONE";if(t instanceof pr)return"AT_LEAST_ONE_SEP";if(t instanceof nr)return"MANY_SE\
P";if(t instanceof zt)return"MANY";if(t instanceof Nt)return"CONSUME";throw Error("non exhaustive match")}class Fh{walk(e,n=[]){xe(e.definition,(r,i)=>{const s=bn(e.definition,i+1);if(r instanceof Bn)this.walkProdRef(r,s,n);else if(r instanceof Nt)this.walkTerminal(r,s,n);else if(r instanceof tr)this.walkFlat(r,s,n);else if(r instanceof En)this.walkOption(r,s,n);else if(r instanceof hr)this.walkAtLeastOne(r,s,n);else if(r instanceof pr)this.walkAtLeastOneSep(r,s,n);else if(r instanceof nr)this.walkManySep(
r,s,n);else if(r instanceof zt)this.walkMany(r,s,n);else if(r instanceof rr)this.walkOr(r,s,n);else throw Error("non exhaustive match")})}walkTerminal(e,n,r){}walkProdRef(e,n,r){}walkFlat(e,n,r){const i=n.concat(r);this.walk(e,i)}walkOption(e,n,r){const i=n.concat(r);this.walk(e,i)}walkAtLeastOne(e,n,r){const i=[new En({definition:e.definition})].concat(n,r);this.walk(e,i)}walkAtLeastOneSep(e,n,r){const i=vR(e,n,r);this.walk(e,i)}walkMany(e,n,r){const i=[new En({definition:e.definition})].concat(
n,r);this.walk(e,i)}walkManySep(e,n,r){const i=vR(e,n,r);this.walk(e,i)}walkOr(e,n,r){const i=n.concat(r);xe(e.definition,s=>{const a=new tr({definition:[s]});this.walk(a,i)})}}function vR(t,e,n){return[new En({definition:[new Nt({terminalType:t.separator})].concat(t.definition)})].concat(e,n)}function Oc(t){if(t instanceof Bn)return Oc(t.referencedRule);if(t instanceof Nt)return ZB(t);if(WB(t))return VB(t);if(HB(t))return KB(t);throw Error("non exhaustive match")}function VB(t){let e=[];const n=t.
definition;let r=0,i=n.length>r,s,a=!0;for(;i&&a;)s=n[r],a=Lh(s),e=e.concat(Oc(s)),r=r+1,i=n.length>r;return Wy(e)}function KB(t){const e=Re(t.definition,n=>Oc(n));return Wy(Cr(e))}function ZB(t){return[t.terminalType]}const wR="_~IN~_";class XB extends Fh{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,n,r){}walkProdRef(e,n,r){const i=JB(e.referencedRule,e.idx)+this.topProd.name,s=n.concat(r),a=new tr({definition:s}),
o=Oc(a);this.follows[i]=o}}function YB(t){const e={};return xe(t,n=>{const r=new XB(n).startWalking();lr(e,r)}),e}function JB(t,e){return t.name+e+wR}let Mh={};const QB=new KE;function jh(t){const e=t.toString();if(Mh.hasOwnProperty(e))return Mh[e];{const n=QB.pattern(e);return Mh[e]=n,n}}function eq(){Mh={}}const bR="Complement Sets are not supported for first char optimization",Bh=`Unable to use "first char" lexer optimizations:
`;function tq(t,e=!1){try{const n=jh(t);return Vy(n.value,{},n.flags.ignoreCase)}catch(n){if(n.message===bR)e&&mR(`${Bh}	Unable to optimize: < ${t.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let r="";e&&(r=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Hy(`${Bh}
	Failed parsing: < ${t.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+r)}}return[]}function Vy(t,e,n){switch(t.type){case"Disjunction":for(let i=0;i<t.value.length;i++)Vy(t.value[i],e,n);break;case"Alternative":const r=t.value;for(let i=0;i<r.length;i++){const s=r[i];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const a=s;switch(a.type){case"Character":qh(a.value,e,n);break;case"\
Set":if(a.complement===!0)throw Error(bR);xe(a.value,u=>{if(typeof u=="number")qh(u,e,n);else{const c=u;if(n===!0)for(let l=c.from;l<=c.to;l++)qh(l,e,n);else{for(let l=c.from;l<=c.to&&l<Fc;l++)qh(l,e,n);if(c.to>=Fc){const l=c.from>=Fc?c.from:Fc,f=c.to,d=Ts(l),h=Ts(f);for(let p=d;p<=h;p++)e[p]=p}}}});break;case"Group":Vy(a.value,e,n);break;default:throw Error("Non Exhaustive Match")}const o=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&Ky(a)===!1||a.type!=="Group"&&o===!1)break}
break;default:throw Error("non exhaustive match!")}return on(e)}function qh(t,e,n){const r=Ts(t);e[r]=r,n===!0&&nq(t,e)}function nq(t,e){const n=String.fromCharCode(t),r=n.toUpperCase();if(r!==n){const i=Ts(r.charCodeAt(0));e[i]=i}else{const i=n.toLowerCase();if(i!==n){const s=Ts(i.charCodeAt(0));e[s]=s}}}function ER(t,e){return _o(t.value,n=>{if(typeof n=="number")return Mn(e,n);{const r=n;return _o(e,i=>r.from<=i&&i<=r.to)!==void 0}})}function Ky(t){const e=t.quantifier;return e&&e.atLeast===0?
!0:t.value?ot(t.value)?Br(t.value,Ky):Ky(t.value):!1}class rq extends gh{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){Mn(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?ER(e,this.targetCharCodes)===void 0&&(this.found=!0):ER(e,this.targetCharCodes)!==void 0&&
(this.found=!0)}}function Zy(t,e){if(e instanceof RegExp){const n=jh(e),r=new rq(t);return r.visit(n),r.found}else return _o(e,n=>Mn(t,n.charCodeAt(0)))!==void 0}const ga="PATTERN",Lc="defaultMode",Gh="modes";let kR=typeof new RegExp("(?:)").sticky=="boolean";function iq(t,e){e=zy(e,{useSticky:kR,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(b,k)=>k()});const n=e.tracer;n("initCharCodeToOptimizedIndexMap",()=>{Sq()});let r;n("Reject Lexer.NA",()=>{r=Ih(t,b=>b[ga]===ir.NA)});let i=!1,s;n("Transform Patterns",()=>{i=!1,s=Re(r,b=>{const k=b[ga];if(Mi(k)){const _=k.source;return _.length===1&&_!=="^"&&_!=="$"&&_!=="."&&!k.ignoreCase?_:_.length===2&&_[0]==="\\"&&!Mn(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],_[1])?_[1]:e.useSticky?$R(k):RR(k)}else{if(Oi(k))return i=!0,{exec:k};if(typeof k=="object")return i=
!0,k;if(typeof k=="string"){if(k.length===1)return k;{const _=k.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),I=new RegExp(_);return e.useSticky?$R(I):RR(I)}}else throw Error("non exhaustive match")}})});let a,o,u,c,l;n("misc mapping",()=>{a=Re(r,b=>b.tokenTypeIdx),o=Re(r,b=>{const k=b.GROUP;if(k!==ir.SKIPPED){if(er(k))return k;if(ji(k))return!1;throw Error("non exhaustive match")}}),u=Re(r,b=>{const k=b.LONGER_ALT;if(k)return ot(k)?Re(k,I=>dR(r,I)):[dR(r,k)]}),c=Re(r,b=>b.PUSH_MODE),l=Re(r,b=>Pe(b,"POP\
_MODE"))});let f;n("Line Terminator Handling",()=>{const b=SR(e.lineTerminatorCharacters);f=Re(r,k=>!1),e.positionTracking!=="onlyOffset"&&(f=Re(r,k=>Pe(k,"LINE_BREAKS")?!!k.LINE_BREAKS:TR(k,b)===!1&&Zy(b,k.PATTERN)))});let d,h,p,w;n("Misc Mapping #2",()=>{d=Re(r,DR),h=Re(s,$q),p=jn(r,(b,k)=>{const _=k.GROUP;return er(_)&&_!==ir.SKIPPED&&(b[_]=[]),b},{}),w=Re(s,(b,k)=>({pattern:s[k],longerAlt:u[k],canLineTerminator:f[k],isCustom:d[k],short:h[k],group:o[k],push:c[k],pop:l[k],tokenTypeIdx:a[k],tokenType:r[k]}))});
let v=!0,g=[];return e.safeMode||n("First Char Optimization",()=>{g=jn(r,(b,k,_)=>{if(typeof k.PATTERN=="string"){const I=k.PATTERN.charCodeAt(0),Z=Ts(I);Xy(b,Z,w[_])}else if(ot(k.START_CHARS_HINT)){let I;xe(k.START_CHARS_HINT,Z=>{const J=typeof Z=="string"?Z.charCodeAt(0):Z,ue=Ts(J);I!==ue&&(I=ue,Xy(b,ue,w[_]))})}else if(Mi(k.PATTERN))if(k.PATTERN.unicode)v=!1,e.ensureOptimizations&&Hy(`${Bh}	Unable to analyze < ${k.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const I=tq(k.PATTERN,e.ensureOptimizations);$t(I)&&(v=!1),xe(I,Z=>{Xy(b,Z,w[_])})}else e.ensureOptimizations&&Hy(`${Bh}	TokenType: <${k.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),v=!1;return b},[])}),{emptyGroups:p,patternIdxToConfig:w,charCodeToPatternIdxToConfig:g,hasCustom:i,canBeOptimized:v}}function sq(t,e){let n=[];const r=oq(t);n=n.concat(r.errors);const i=uq(r.valid),s=i.valid;return n=n.concat(i.errors),n=n.concat(aq(s)),n=n.concat(gq(s)),n=n.concat(yq(s,e)),n=n.concat(vq(s)),n}function aq(t){let e=[];const n=dr(t,r=>Mi(r[ga]));return e=e.concat(lq(n)),e=e.concat(hq(
n)),e=e.concat(pq(n)),e=e.concat(mq(n)),e=e.concat(dq(n)),e}function oq(t){const e=dr(t,i=>!Pe(i,ga)),n=Re(e,i=>({message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:Wt.MISSING_PATTERN,tokenTypes:[i]})),r=Nh(t,e);return{errors:n,valid:r}}function uq(t){const e=dr(t,i=>{const s=i[ga];return!Mi(s)&&!Oi(s)&&!Pe(s,"exec")&&!er(s)}),n=Re(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or \
an Object matching the {ICustomPattern} interface.",type:Wt.INVALID_PATTERN,tokenTypes:[i]})),r=Nh(t,e);return{errors:n,valid:r}}const cq=/[^\\][$]/;function lq(t){class e extends gh{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const n=dr(t,i=>{const s=i.PATTERN;try{const a=jh(s),o=new e;return o.visit(a),o.found}catch{return cq.test(s.source)}});return Re(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Wt.EOI_ANCHOR_FOUND,tokenTypes:[i]}))}function dq(t){const e=dr(t,r=>r.PATTERN.test(""));return Re(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:Wt.EMPTY_MATCH_PATTERN,tokenTypes:[r]}))}const fq=/[^\\[][\^]|^\^/;function hq(t){class e extends gh{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const n=dr(t,i=>{const s=i.PATTERN;
try{const a=jh(s),o=new e;return o.visit(a),o.found}catch{return fq.test(s.source)}});return Re(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Wt.SOI_ANCHOR_FOUND,tokenTypes:[i]}))}function pq(t){const e=dr(t,r=>{const i=r[ga];return i instanceof RegExp&&(i.multiline||i.global)});return Re(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Wt.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}))}function mq(t){const e=[];let n=Re(t,s=>jn(t,(a,o)=>(s.PATTERN.source===o.PATTERN.source&&!Mn(e,o)&&o.
PATTERN!==ir.NA&&(e.push(o),a.push(o)),a),[]));n=Nc(n);const r=dr(n,s=>s.length>1);return Re(r,s=>{const a=Re(s,u=>u.name);return{message:`The same RegExp pattern ->${qr(s).PATTERN}<-has been used in all of the following Token Types: ${a.join(", ")} <-`,type:Wt.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function gq(t){const e=dr(t,r=>{if(!Pe(r,"GROUP"))return!1;const i=r.GROUP;return i!==ir.SKIPPED&&i!==ir.NA&&!er(i)});return Re(e,r=>({message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be\
 Lexer.SKIPPED/Lexer.NA/A String",type:Wt.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}))}function yq(t,e){const n=dr(t,i=>i.PUSH_MODE!==void 0&&!Mn(e,i.PUSH_MODE));return Re(n,i=>({message:`Token Type: ->${i.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${i.PUSH_MODE}<-which does not exist`,type:Wt.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}))}function vq(t){const e=[],n=jn(t,(r,i,s)=>{const a=i.PATTERN;return a===ir.NA||(er(a)?r.push({str:a,idx:s,tokenType:i}):Mi(a)&&bq(a)&&r.push({str:a.
source,idx:s,tokenType:i})),r},[]);return xe(t,(r,i)=>{xe(n,({str:s,idx:a,tokenType:o})=>{if(i<a&&wq(s,r.PATTERN)){const u=`Token: ->${o.name}<- can never be matched.
Because it appears AFTER the Token Type ->${r.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:Wt.UNREACHABLE_PATTERN,tokenTypes:[r,o]})}})}),e}function wq(t,e){if(Mi(e)){const n=e.exec(t);return n!==null&&n.index===0}else{if(Oi(e))return e(t,0,[],{});if(Pe(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function bq(t){return _o([".","\\","[","]","|","^","$","(",")","?","*","+","{"],n=>t.source.indexOf(n)!==-1)===void 0}function RR(t){
const e=t.ignoreCase?"i":"";return new RegExp(`^(?:${t.source})`,e)}function $R(t){const e=t.ignoreCase?"iy":"y";return new RegExp(`${t.source}`,e)}function Eq(t,e,n){const r=[];return Pe(t,Lc)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Lc+`> property in its definition
`,type:Wt.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Pe(t,Gh)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Gh+`> property in its definition
`,type:Wt.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Pe(t,Gh)&&Pe(t,Lc)&&!Pe(t.modes,t.defaultMode)&&r.push({message:`A MultiMode Lexer cannot be initialized with a ${Lc}: <${t.defaultMode}>which does not exist
`,type:Wt.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Pe(t,Gh)&&xe(t.modes,(i,s)=>{xe(i,(a,o)=>{if(ji(a))r.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${o}>
`,type:Wt.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(Pe(a,"LONGER_ALT")){const u=ot(a.LONGER_ALT)?a.LONGER_ALT:[a.LONGER_ALT];xe(u,c=>{!ji(c)&&!Mn(i,c)&&r.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${c.name}> on token <${a.name}> outside of mode <${s}>
`,type:Wt.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),r}function kq(t,e,n){const r=[];let i=!1;const s=Nc(Cr(on(t.modes))),a=Ih(s,u=>u[ga]===ir.NA),o=SR(n);return e&&xe(a,u=>{const c=TR(u,o);if(c!==!1){const f={message:Tq(u,c),type:c.issue,tokenType:u};r.push(f)}else Pe(u,"LINE_BREAKS")?u.LINE_BREAKS===!0&&(i=!0):Zy(o,u.PATTERN)&&(i=!0)}),e&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Wt.NO_LINE_BREAKS_FLAGS}),r}function Rq(t){const e={},n=Sr(t);return xe(n,r=>{const i=t[r];if(ot(i))e[r]=[];else throw Error("non exhaustive match")}),e}function DR(t){const e=t.PATTERN;if(Mi(e))return!1;if(Oi(e))return!0;if(Pe(e,"exec"))return!0;if(er(e))return!1;throw Error("non exhaustive match")}function $q(t){return er(t)&&t.length===1?t.charCodeAt(0):!1}const Dq={test:function(t){const e=t.length;for(let n=this.lastIndex;n<e;n++){const r=t.charCodeAt(n);if(r===10)return this.
lastIndex=n+1,!0;if(r===13)return t.charCodeAt(n+1)===10?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function TR(t,e){if(Pe(t,"LINE_BREAKS"))return!1;if(Mi(t.PATTERN)){try{Zy(e,t.PATTERN)}catch(n){return{issue:Wt.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}else{if(er(t.PATTERN))return!1;if(DR(t))return{issue:Wt.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function Tq(t,e){if(e.issue===Wt.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usag\
e in pattern.
	The problem is in the <${t.name}> Token Type
	 Root cause: ${e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===Wt.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${t.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function SR(t){return Re(t,n=>er(n)?n.charCodeAt(0):n)}function Xy(t,e,n){t[e]===void 0?t[e]=[n]:t[e].push(n)}const Fc=256;let Uh=[];function Ts(t){return t<Fc?t:Uh[t]}function Sq(){if($t(Uh)){Uh=new Array(65536);for(let t=0;t<65536;t++)Uh[t]=t>255?255+~~(t/255):t}}function Mc(t,e){const n=t.tokenTypeIdx;return n===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[n]===
!0}function zh(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}let CR=1;const _R={};function jc(t){const e=Cq(t);_q(e),xq(e),Aq(e),xe(e,n=>{n.isParent=n.categoryMatches.length>0})}function Cq(t){let e=wn(t),n=t,r=!0;for(;r;){n=Nc(Cr(Re(n,s=>s.CATEGORIES)));const i=Nh(n,e);e=e.concat(i),$t(i)?r=!1:n=i}return e}function _q(t){xe(t,e=>{xR(e)||(_R[CR]=e,e.tokenTypeIdx=CR++),PR(e)&&!ot(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),PR(e)||(e.CATEGORIES=[]),Pq(e)||(e.categoryMatches=[]),Nq(e)||(e.categoryMatchesMap=
{})})}function Aq(t){xe(t,e=>{e.categoryMatches=[],xe(e.categoryMatchesMap,(n,r)=>{e.categoryMatches.push(_R[r].tokenTypeIdx)})})}function xq(t){xe(t,e=>{AR([],e)})}function AR(t,e){xe(t,n=>{e.categoryMatchesMap[n.tokenTypeIdx]=!0}),xe(e.CATEGORIES,n=>{const r=t.concat(e);Mn(r,n)||AR(r,n)})}function xR(t){return Pe(t,"tokenTypeIdx")}function PR(t){return Pe(t,"CATEGORIES")}function Pq(t){return Pe(t,"categoryMatches")}function Nq(t){return Pe(t,"categoryMatchesMap")}function Iq(t){return Pe(t,"t\
okenTypeIdx")}const Yy={buildUnableToPopLexerModeMessage(t){return`Unable to pop Lexer Mode after encountering Token ->${t.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(t,e,n,r,i){return`unexpected character: ->${t.charAt(e)}<- at offset: ${e}, skipped ${n} characters.`}};var Wt;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.
DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=
10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",t[t.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(Wt||(Wt={}));const Bc={deferDefinitionErrorsHandling:!1,
positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:Yy,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(Bc);class ir{constructor(e,n=Bc){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(i,s)=>{if(this.traceInitPerf===!0){this.
traceInitIndent++;const a=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${a}--> <${i}>`);const{time:o,value:u}=gR(s),c=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&c(`${a}<-- <${i}> time: ${o}ms`),this.traceInitIndent--,u}else return s()},typeof n=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=lr({},Bc,n);const r=this.config.traceInitPerf;r===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof r=="number"&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let i,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===Bc.lineTerminatorsPattern)this.config.lineTerminatorsPattern=Dq;else if(this.config.lineTerminatorCharacters===
Bc.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(n.safeMode&&n.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),ot(e)?i={modes:{defaultMode:wn(e)},defaultMode:Lc}:(s=!1,i=wn(e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",
()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(Eq(i,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(kq(i,this.trackStartLines,this.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},xe(i.modes,(o,u)=>{i.modes[u]=Ih(o,c=>ji(c))});const a=Sr(i.modes);if(xe(i.modes,(o,u)=>{this.TRACE_INIT(`Mode: <${u}> processing`,()=>{if(this.modes.push(u),
this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(sq(o,a))}),$t(this.lexerDefinitionErrors)){jc(o);let c;this.TRACE_INIT("analyzeTokenTypes",()=>{c=iq(o,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:n.positionTracking,ensureOptimizations:n.ensureOptimizations,safeMode:n.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[u]=c.patternIdxToConfig,this.charCodeToPatternIdxToConfig[u]=
c.charCodeToPatternIdxToConfig,this.emptyGroups=lr({},this.emptyGroups,c.emptyGroups),this.hasCustom=c.hasCustom||this.hasCustom,this.canModeBeOptimized[u]=c.canBeOptimized}})}),this.defaultMode=i.defaultMode,!$t(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const u=Re(this.lexerDefinitionErrors,c=>c.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}xe(this.lexerDefinitionWarning,o=>{mR(o.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(kR?(this.chopInput=da,this.match=this.matchWithTest):(this.updateLastIndex=an,this.match=this.matchWithExec),s&&(this.handleModes=an),this.trackStartLines===!1&&(this.computeNewColumn=da),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=an),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.
positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optim\
ization Warnings",()=>{const o=jn(this.canModeBeOptimized,(u,c,l)=>(c===!1&&u.push(l),u),[]);if(n.ensureOptimizations&&!$t(o))throw Error(`Lexer Modes: < ${o.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{eq()}),this.TRACE_INIT("toFastProperties",()=>{yR(this)})})}tokenize(e,n=this.defaultMode){if(!$t(this.lexerDefinitionErrors)){const i=Re(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}return this.tokenizeInternal(e,n)}tokenizeInternal(e,n){let r,i,s,a,o,u,c,l,f,d,h,p,w,v,g;const b=e,k=b.length;let _=0,I=0;const Z=this.hasCustom?0:Math.floor(e.length/10),J=new Array(Z),ue=[];let ae=this.trackStartLines?1:void 0,$e=this.trackStartLines?1:void 0;const B=Rq(this.emptyGroups),T=this.trackStartLines,$=this.config.lineTerminatorsPattern;let j=0,A=[],P=[];const L=[],Q=[];Object.freeze(Q);let H;function S(){return A}function re(Le){const he=Ts(Le),Ce=P[he];return Ce===void 0?Q:Ce}
const ke=Le=>{if(L.length===1&&Le.tokenType.PUSH_MODE===void 0){const he=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Le);ue.push({offset:Le.startOffset,line:Le.startLine,column:Le.startColumn,length:Le.image.length,message:he})}else{L.pop();const he=Co(L);A=this.patternIdxToConfig[he],P=this.charCodeToPatternIdxToConfig[he],j=A.length;const Ce=this.canModeBeOptimized[he]&&this.config.safeMode===!1;P&&Ce?H=re:H=S}};function je(Le){L.push(Le),P=this.charCodeToPatternIdxToConfig[Le],
A=this.patternIdxToConfig[Le],j=A.length,j=A.length;const he=this.canModeBeOptimized[Le]&&this.config.safeMode===!1;P&&he?H=re:H=S}je.call(this,n);let M;const V=this.config.recoveryEnabled;for(;_<k;){u=null;const Le=b.charCodeAt(_),he=H(Le),Ce=he.length;for(r=0;r<Ce;r++){M=he[r];const Be=M.pattern;c=null;const pe=M.short;if(pe!==!1?Le===pe&&(u=Be):M.isCustom===!0?(g=Be.exec(b,_,J,B),g!==null?(u=g[0],g.payload!==void 0&&(c=g.payload)):u=null):(this.updateLastIndex(Be,_),u=this.match(Be,e,_)),u!==
null){if(o=M.longerAlt,o!==void 0){const O=o.length;for(s=0;s<O;s++){const U=A[o[s]],ge=U.pattern;if(l=null,U.isCustom===!0?(g=ge.exec(b,_,J,B),g!==null?(a=g[0],g.payload!==void 0&&(l=g.payload)):a=null):(this.updateLastIndex(ge,_),a=this.match(ge,e,_)),a&&a.length>u.length){u=a,c=l,M=U;break}}}break}}if(u!==null){if(f=u.length,d=M.group,d!==void 0&&(h=M.tokenTypeIdx,p=this.createTokenInstance(u,_,h,M.tokenType,ae,$e,f),this.handlePayload(p,c),d===!1?I=this.addToken(J,I,p):B[d].push(p)),e=this.chopInput(
e,f),_=_+f,$e=this.computeNewColumn($e,f),T===!0&&M.canLineTerminator===!0){let Be=0,pe,O;$.lastIndex=0;do pe=$.test(u),pe===!0&&(O=$.lastIndex-1,Be++);while(pe===!0);Be!==0&&(ae=ae+Be,$e=f-O,this.updateTokenEndLineColumnLocation(p,d,O,Be,ae,$e,f))}this.handleModes(M,ke,je,p)}else{const Be=_,pe=ae,O=$e;let U=V===!1;for(;U===!1&&_<k;)for(e=this.chopInput(e,1),_++,i=0;i<j;i++){const ge=A[i],z=ge.pattern,me=ge.short;if(me!==!1?b.charCodeAt(_)===me&&(U=!0):ge.isCustom===!0?U=z.exec(b,_,J,B)!==null:(this.
updateLastIndex(z,_),U=z.exec(e)!==null),U===!0)break}if(w=_-Be,$e=this.computeNewColumn($e,w),v=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(b,Be,w,pe,O),ue.push({offset:Be,line:pe,column:O,length:w,message:v}),V===!1)break}}return this.hasCustom||(J.length=I),{tokens:J,groups:B,errors:ue}}handleModes(e,n,r,i){if(e.pop===!0){const s=e.push;n(i),s!==void 0&&r.call(this,s)}else e.push!==void 0&&r.call(this,e.push)}chopInput(e,n){return e.substring(n)}updateLastIndex(e,n){e.lastIndex=
n}updateTokenEndLineColumnLocation(e,n,r,i,s,a,o){let u,c;n!==void 0&&(u=r===o-1,c=u?-1:0,i===1&&u===!0||(e.endLine=s+c,e.endColumn=a-1+-c))}computeNewColumn(e,n){return e+n}createOffsetOnlyToken(e,n,r,i){return{image:e,startOffset:n,tokenTypeIdx:r,tokenType:i}}createStartOnlyToken(e,n,r,i,s,a){return{image:e,startOffset:n,startLine:s,startColumn:a,tokenTypeIdx:r,tokenType:i}}createFullToken(e,n,r,i,s,a,o){return{image:e,startOffset:n,endOffset:n+o-1,startLine:s,endLine:s,startColumn:a,endColumn:a+
o-1,tokenTypeIdx:r,tokenType:i}}addTokenUsingPush(e,n,r){return e.push(r),n}addTokenUsingMemberAccess(e,n,r){return e[n]=r,n++,n}handlePayloadNoCustom(e,n){}handlePayloadWithCustom(e,n){n!==null&&(e.payload=n)}matchWithTest(e,n,r){return e.test(n)===!0?n.substring(r,e.lastIndex):null}matchWithExec(e,n){const r=e.exec(n);return r!==null?r[0]:null}}ir.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used \
to for example to completely ignore whitespace.",ir.NA=/NOT_APPLICABLE/;function Po(t){return NR(t)?t.LABEL:t.name}function NR(t){return er(t.LABEL)&&t.LABEL!==""}const Oq="parent",IR="categories",OR="label",LR="group",FR="push_mode",MR="pop_mode",jR="longer_alt",BR="line_breaks",qR="start_chars_hint";function GR(t){return Lq(t)}function Lq(t){const e=t.pattern,n={};if(n.name=t.name,ji(e)||(n.PATTERN=e),Pe(t,Oq))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return Pe(t,IR)&&(n.CATEGORIES=t[IR]),jc([n]),Pe(t,OR)&&(n.LABEL=t[OR]),Pe(t,LR)&&(n.GROUP=t[LR]),Pe(t,MR)&&(n.POP_MODE=t[MR]),Pe(t,FR)&&(n.PUSH_MODE=t[FR]),Pe(t,jR)&&(n.LONGER_ALT=t[jR]),Pe(t,BR)&&(n.LINE_BREAKS=t[BR]),Pe(t,qR)&&(n.START_CHARS_HINT=t[qR]),n}const Ss=GR({name:"EOF",pattern:ir.NA});jc([Ss]);function Jy(t,e,n,r,i,s,a,o){return{image:e,startOffset:n,endOffset:r,startLine:i,endLine:s,startColumn:a,
endColumn:o,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function UR(t,e){return Mc(t,e)}const No={buildMismatchTokenMessage({expected:t,actual:e,previous:n,ruleName:r}){return`Expecting ${NR(t)?`--> ${Po(t)} <--`:`token of type --> ${t.name} <--`} but found --> '${e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:t,ruleName:e}){return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage({expectedPathsPerAlt:t,actual:e,previous:n,customUserDescription:r,ruleName:i}){
const s="Expecting: ",o=`
but found: '`+qr(e).image+"'";if(r)return s+r+o;{const u=jn(t,(d,h)=>d.concat(h),[]),c=Re(u,d=>`[${Re(d,h=>Po(h)).join(", ")}]`),f=`one of these possible Token sequences:
${Re(c,(d,h)=>`  ${h+1}. ${d}`).join(`
`)}`;return s+f+o}},buildEarlyExitMessage({expectedIterationPaths:t,actual:e,customUserDescription:n,ruleName:r}){const i="Expecting: ",a=`
but found: '`+qr(e).image+"'";if(n)return i+n+a;{const u=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${Re(t,c=>`[${Re(c,l=>Po(l)).join(",")}]`).join(" ,")}>`;return i+u+a}}};Object.freeze(No);const Fq={buildRuleNotFoundError(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-"}},ya={buildDuplicateFoundError(t,e){function n(l){return l instanceof Nt?l.terminalType.name:l instanceof Bn?l.nonTerminalName:""}const r=t.name,i=qr(e),s=i.idx,a=Ei(i),o=n(i),u=s>0;let c=`->${a}${u?s:""}<- ${o?`with argument: ->${o}<-`:""}
                  appears more than once (${e.length} times) in the top level rule: ->${r}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,`
`),c},buildNamespaceConflictError(t){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${t.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(t){const e=Re(t.prefixPath,i=>Po(i)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;return`Ambiguous alternatives: <${t.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(t){const e=Re(t.prefixPath,i=>Po(i)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;let r=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(" ,")}> in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError(t){let e=Ei(t.repetition);return t.repetition.idx!==0&&(e+=t.repetition.idx),`The repetition <${e}> within Rule <${t.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(t){return"deprecated"},buildEmptyAlternationError(t){return`Ambiguous empty alternative: <${t.emptyChoiceIdx+1}> in <OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(t){return`An Alternation cannot have more than 256 alternatives:
<OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
 has ${t.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(t){const e=t.topLevelRule.name,n=Re(t.leftRecursionPath,s=>s.name),r=`${e} --> ${n.concat([e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${r}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(t){return"deprecated"},buildDuplicateRuleNameError(t){let e;return t.topLevelRule instanceof Ao?e=t.topLevelRule.name:e=t.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${t.grammarName}<-`}};function Mq(t,e){const n=new jq(t,e);return n.resolveRefs(),n.errors}class jq extends xo{constructor(e,n){super(),this.nameToTopRule=e,this.errMsgProvider=n,this.errors=[]}resolveRefs(){
xe(on(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){const n=this.nameToTopRule[e.nonTerminalName];if(n)e.referencedRule=n;else{const r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:qn.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}class Bq extends Fh{constructor(e,n){super(),this.topProd=e,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=
0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=wn(this.path.ruleStack).reverse(),this.occurrenceStack=wn(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,n=[]){this.found||super.walk(e,n)}walkProdRef(e,n,r){if(e.referencedRule.name===
this.nextProductionName&&e.idx===this.nextProductionOccurrence){const i=n.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,i)}}updateExpectedNext(){$t(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class qq extends Bq{constructor(e,n){super(e,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=
this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,n,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const i=n.concat(r),s=new tr({definition:i});this.possibleTokTypes=Oc(s),this.found=!0}}}class Wh extends Fh{constructor(e,n){super(),this.topRule=e,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}
class Gq extends Wh{walkMany(e,n,r){if(e.idx===this.occurrence){const i=qr(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Nt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkMany(e,n,r)}}class zR extends Wh{walkManySep(e,n,r){if(e.idx===this.occurrence){const i=qr(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Nt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkManySep(e,n,r)}}class Uq extends Wh{walkAtLeastOne(e,n,r){
if(e.idx===this.occurrence){const i=qr(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Nt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOne(e,n,r)}}class WR extends Wh{walkAtLeastOneSep(e,n,r){if(e.idx===this.occurrence){const i=qr(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Nt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOneSep(e,n,r)}}function Qy(t,e,n=[]){n=wn(n);let r=[],i=0;function s(o){
return o.concat(bn(t,i+1))}function a(o){const u=Qy(s(o),e,n);return r.concat(u)}for(;n.length<e&&i<t.length;){const o=t[i];if(o instanceof tr)return a(o.definition);if(o instanceof Bn)return a(o.definition);if(o instanceof En)r=a(o.definition);else if(o instanceof hr){const u=o.definition.concat([new zt({definition:o.definition})]);return a(u)}else if(o instanceof pr){const u=[new tr({definition:o.definition}),new zt({definition:[new Nt({terminalType:o.separator})].concat(o.definition)})];return a(
u)}else if(o instanceof nr){const u=o.definition.concat([new zt({definition:[new Nt({terminalType:o.separator})].concat(o.definition)})]);r=a(u)}else if(o instanceof zt){const u=o.definition.concat([new zt({definition:o.definition})]);r=a(u)}else{if(o instanceof rr)return xe(o.definition,u=>{$t(u.definition)===!1&&(r=a(u.definition))}),r;if(o instanceof Nt)n.push(o.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:n,suffixDef:bn(t,i)}),r}function HR(t,e,n,r){const i="\
EXIT_NONE_TERMINAL",s=[i],a="EXIT_ALTERNATIVE";let o=!1;const u=e.length,c=u-r-1,l=[],f=[];for(f.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!$t(f);){const d=f.pop();if(d===a){o&&Co(f).idx<=c&&f.pop();continue}const h=d.def,p=d.idx,w=d.ruleStack,v=d.occurrenceStack;if($t(h))continue;const g=h[0];if(g===i){const b={idx:p,def:bn(h),ruleStack:Ic(w),occurrenceStack:Ic(v)};f.push(b)}else if(g instanceof Nt)if(p<u-1){const b=p+1,k=e[b];if(n(k,g.terminalType)){const _={idx:b,def:bn(h),ruleStack:w,
occurrenceStack:v};f.push(_)}}else if(p===u-1)l.push({nextTokenType:g.terminalType,nextTokenOccurrence:g.idx,ruleStack:w,occurrenceStack:v}),o=!0;else throw Error("non exhaustive match");else if(g instanceof Bn){const b=wn(w);b.push(g.nonTerminalName);const k=wn(v);k.push(g.idx);const _={idx:p,def:g.definition.concat(s,bn(h)),ruleStack:b,occurrenceStack:k};f.push(_)}else if(g instanceof En){const b={idx:p,def:bn(h),ruleStack:w,occurrenceStack:v};f.push(b),f.push(a);const k={idx:p,def:g.definition.
concat(bn(h)),ruleStack:w,occurrenceStack:v};f.push(k)}else if(g instanceof hr){const b=new zt({definition:g.definition,idx:g.idx}),k=g.definition.concat([b],bn(h)),_={idx:p,def:k,ruleStack:w,occurrenceStack:v};f.push(_)}else if(g instanceof pr){const b=new Nt({terminalType:g.separator}),k=new zt({definition:[b].concat(g.definition),idx:g.idx}),_=g.definition.concat([k],bn(h)),I={idx:p,def:_,ruleStack:w,occurrenceStack:v};f.push(I)}else if(g instanceof nr){const b={idx:p,def:bn(h),ruleStack:w,occurrenceStack:v};
f.push(b),f.push(a);const k=new Nt({terminalType:g.separator}),_=new zt({definition:[k].concat(g.definition),idx:g.idx}),I=g.definition.concat([_],bn(h)),Z={idx:p,def:I,ruleStack:w,occurrenceStack:v};f.push(Z)}else if(g instanceof zt){const b={idx:p,def:bn(h),ruleStack:w,occurrenceStack:v};f.push(b),f.push(a);const k=new zt({definition:g.definition,idx:g.idx}),_=g.definition.concat([k],bn(h)),I={idx:p,def:_,ruleStack:w,occurrenceStack:v};f.push(I)}else if(g instanceof rr)for(let b=g.definition.length-
1;b>=0;b--){const k=g.definition[b],_={idx:p,def:k.definition.concat(bn(h)),ruleStack:w,occurrenceStack:v};f.push(_),f.push(a)}else if(g instanceof tr)f.push({idx:p,def:g.definition.concat(bn(h)),ruleStack:w,occurrenceStack:v});else if(g instanceof Ao)f.push(zq(g,p,w,v));else throw Error("non exhaustive match")}return l}function zq(t,e,n,r){const i=wn(n);i.push(t.name);const s=wn(r);return s.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:s}}var jt;(function(t){t[t.OPTION=0]="OPTION",
t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(jt||(jt={}));function ev(t){if(t instanceof En||t==="Option")return jt.OPTION;if(t instanceof zt||t==="Repetition")return jt.REPETITION;if(t instanceof hr||t==="RepetitionMandatory")return jt.REPETITION_MANDATORY;if(t instanceof pr||t==="Rep\
etitionMandatoryWithSeparator")return jt.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof nr||t==="RepetitionWithSeparator")return jt.REPETITION_WITH_SEPARATOR;if(t instanceof rr||t==="Alternation")return jt.ALTERNATION;throw Error("non exhaustive match")}function VR(t){const{occurrence:e,rule:n,prodType:r,maxLookahead:i}=t,s=ev(r);return s===jt.ALTERNATION?Hh(e,n,i):Vh(e,n,s,i)}function Wq(t,e,n,r,i,s){const a=Hh(t,e,n),o=YR(a)?zh:Mc;return s(a,r,o,i)}function Hq(t,e,n,r,i,s){const a=Vh(t,e,
i,n),o=YR(a)?zh:Mc;return s(a[0],o,r)}function Vq(t,e,n,r){const i=t.length,s=Br(t,a=>Br(a,o=>o.length===1));if(e)return function(a){const o=Re(a,u=>u.GATE);for(let u=0;u<i;u++){const c=t[u],l=c.length,f=o[u];if(!(f!==void 0&&f.call(this)===!1))e:for(let d=0;d<l;d++){const h=c[d],p=h.length;for(let w=0;w<p;w++){const v=this.LA(w+1);if(n(v,h[w])===!1)continue e}return u}}};if(s&&!r){const a=Re(t,u=>Cr(u)),o=jn(a,(u,c,l)=>(xe(c,f=>{Pe(u,f.tokenTypeIdx)||(u[f.tokenTypeIdx]=l),xe(f.categoryMatches,d=>{
Pe(u,d)||(u[d]=l)})}),u),{});return function(){const u=this.LA(1);return o[u.tokenTypeIdx]}}else return function(){for(let a=0;a<i;a++){const o=t[a],u=o.length;e:for(let c=0;c<u;c++){const l=o[c],f=l.length;for(let d=0;d<f;d++){const h=this.LA(d+1);if(n(h,l[d])===!1)continue e}return a}}}}function Kq(t,e,n){const r=Br(t,s=>s.length===1),i=t.length;if(r&&!n){const s=Cr(t);if(s.length===1&&$t(s[0].categoryMatches)){const o=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}else{
const a=jn(s,(o,u,c)=>(o[u.tokenTypeIdx]=!0,xe(u.categoryMatches,l=>{o[l]=!0}),o),[]);return function(){const o=this.LA(1);return a[o.tokenTypeIdx]===!0}}}else return function(){e:for(let s=0;s<i;s++){const a=t[s],o=a.length;for(let u=0;u<o;u++){const c=this.LA(u+1);if(e(c,a[u])===!1)continue e}return!0}return!1}}class Zq extends Fh{constructor(e,n,r){super(),this.topProd=e,this.targetOccurrence=n,this.targetProdType=r}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,n,r,i){
return e.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=r.concat(i),!0):!1}walkOption(e,n,r){this.checkIsTarget(e,jt.OPTION,n,r)||super.walkOption(e,n,r)}walkAtLeastOne(e,n,r){this.checkIsTarget(e,jt.REPETITION_MANDATORY,n,r)||super.walkOption(e,n,r)}walkAtLeastOneSep(e,n,r){this.checkIsTarget(e,jt.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||super.walkOption(e,n,r)}walkMany(e,n,r){this.checkIsTarget(e,jt.REPETITION,n,r)||super.walkOption(e,n,r)}walkManySep(e,n,r){this.checkIsTarget(
e,jt.REPETITION_WITH_SEPARATOR,n,r)||super.walkOption(e,n,r)}}class KR extends xo{constructor(e,n,r){super(),this.targetOccurrence=e,this.targetProdType=n,this.targetRef=r,this.result=[]}checkIsTarget(e,n){e.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,jt.OPTION)}visitRepetition(e){this.checkIsTarget(e,jt.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,jt.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){
this.checkIsTarget(e,jt.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,jt.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,jt.ALTERNATION)}}function ZR(t){const e=new Array(t);for(let n=0;n<t;n++)e[n]=[];return e}function tv(t){let e=[""];for(let n=0;n<t.length;n++){const r=t[n],i=[];for(let s=0;s<e.length;s++){const a=e[s];i.push(a+"_"+r.tokenTypeIdx);for(let o=0;o<r.categoryMatches.length;o++){const u="_"+r.categoryMatches[o];i.push(
a+u)}}e=i}return e}function Xq(t,e,n){for(let r=0;r<t.length;r++){if(r===n)continue;const i=t[r];for(let s=0;s<e.length;s++){const a=e[s];if(i[a]===!0)return!1}}return!0}function XR(t,e){const n=Re(t,a=>Qy([a],1)),r=ZR(n.length),i=Re(n,a=>{const o={};return xe(a,u=>{const c=tv(u.partialPath);xe(c,l=>{o[l]=!0})}),o});let s=n;for(let a=1;a<=e;a++){const o=s;s=ZR(o.length);for(let u=0;u<o.length;u++){const c=o[u];for(let l=0;l<c.length;l++){const f=c[l].partialPath,d=c[l].suffixDef,h=tv(f);if(Xq(i,
h,u)||$t(d)||f.length===e){const w=r[u];if(nv(w,f)===!1){w.push(f);for(let v=0;v<h.length;v++){const g=h[v];i[u][g]=!0}}}else{const w=Qy(d,a+1,f);s[u]=s[u].concat(w),xe(w,v=>{const g=tv(v.partialPath);xe(g,b=>{i[u][b]=!0})})}}}}return r}function Hh(t,e,n,r){const i=new KR(t,jt.ALTERNATION,r);return e.accept(i),XR(i.result,n)}function Vh(t,e,n,r){const i=new KR(t,n);e.accept(i);const s=i.result,o=new Zq(e,t,n).startWalking(),u=new tr({definition:s}),c=new tr({definition:o});return XR([u,c],r)}function nv(t,e){
e:for(let n=0;n<t.length;n++){const r=t[n];if(r.length===e.length){for(let i=0;i<r.length;i++){const s=e[i],a=r[i];if((s===a||a.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function Yq(t,e){return t.length<e.length&&Br(t,(n,r)=>{const i=e[r];return n===i||i.categoryMatchesMap[n.tokenTypeIdx]})}function YR(t){return Br(t,e=>Br(e,n=>Br(n,r=>$t(r.categoryMatches))))}function Jq(t){const e=t.lookaheadStrategy.validate({rules:t.rules,tokenTypes:t.tokenTypes,grammarName:t.
grammarName});return Re(e,n=>Object.assign({type:qn.CUSTOM_LOOKAHEAD_VALIDATION},n))}function Qq(t,e,n,r){const i=fr(t,u=>e4(u,n)),s=f4(t,e,n),a=fr(t,u=>u4(u,n)),o=fr(t,u=>r4(u,t,r,n));return i.concat(s,a,o)}function e4(t,e){const n=new n4;t.accept(n);const r=n.allProductions,i=gB(r,t4),s=Gr(i,o=>o.length>1);return Re(on(s),o=>{const u=qr(o),c=e.buildDuplicateFoundError(t,o),l=Ei(u),f={message:c,type:qn.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:l,occurrence:u.idx},d=JR(u);return d&&(f.parameter=
d),f})}function t4(t){return`${Ei(t)}_#_${t.idx}_#_${JR(t)}`}function JR(t){return t instanceof Nt?t.terminalType.name:t instanceof Bn?t.nonTerminalName:""}class n4 extends xo{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.
push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function r4(t,e,n,r){const i=[];if(jn(e,(a,o)=>o.name===t.name?a+1:a,0)>1){const a=r.buildDuplicateRuleNameError({topLevelRule:t,grammarName:n});i.push({message:a,type:qn.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}function i4(t,e,n){const r=[];let i;return Mn(e,t)||(i=`Invalid rule override, rule: ->${t}<- cannot be overridden in the grammar: ->${n}\
<-as it is not defined in any of the super grammars `,r.push({message:i,type:qn.INVALID_RULE_OVERRIDE,ruleName:t})),r}function QR(t,e,n,r=[]){const i=[],s=Kh(e.definition);if($t(s))return[];{const a=t.name;Mn(s,t)&&i.push({message:n.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:r}),type:qn.LEFT_RECURSION,ruleName:a});const u=Nh(s,r.concat([t])),c=fr(u,l=>{const f=wn(r);return f.push(l),QR(t,l,n,f)});return i.concat(c)}}function Kh(t){let e=[];if($t(t))return e;const n=qr(t);if(n instanceof
Bn)e.push(n.referencedRule);else if(n instanceof tr||n instanceof En||n instanceof hr||n instanceof pr||n instanceof nr||n instanceof zt)e=e.concat(Kh(n.definition));else if(n instanceof rr)e=Cr(Re(n.definition,s=>Kh(s.definition)));else if(!(n instanceof Nt))throw Error("non exhaustive match");const r=Lh(n),i=t.length>1;if(r&&i){const s=bn(t);return e.concat(Kh(s))}else return e}class rv extends xo{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(
e)}}function s4(t,e){const n=new rv;t.accept(n);const r=n.alternations;return fr(r,s=>{const a=Ic(s.definition);return fr(a,(o,u)=>{const c=HR([o],[],Mc,1);return $t(c)?[{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:s,emptyChoiceIdx:u}),type:qn.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:s.idx,alternative:u+1}]:[]})})}function a4(t,e,n){const r=new rv;t.accept(r);let i=r.alternations;return i=Ih(i,a=>a.ignoreAmbiguities===!0),fr(i,a=>{const o=a.idx,u=a.maxLookahead||e,c=Hh(
o,t,u,a),l=l4(c,a,t,n),f=d4(c,a,t,n);return l.concat(f)})}class o4 extends xo{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function u4(t,e){const n=new rv;t.accept(n);const r=n.alternations;return fr(r,s=>s.definition.length>255?[{message:e.buildTooManyAlternativesError(
{topLevelRule:t,alternation:s}),type:qn.TOO_MANY_ALTS,ruleName:t.name,occurrence:s.idx}]:[])}function c4(t,e,n){const r=[];return xe(t,i=>{const s=new o4;i.accept(s);const a=s.allProductions;xe(a,o=>{const u=ev(o),c=o.maxLookahead||e,l=o.idx,d=Vh(l,i,u,c)[0];if($t(Cr(d))){const h=n.buildEmptyRepetitionError({topLevelRule:i,repetition:o});r.push({message:h,type:qn.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function l4(t,e,n,r){const i=[],s=jn(t,(o,u,c)=>(e.definition[c].ignoreAmbiguities===!0||
xe(u,l=>{const f=[c];xe(t,(d,h)=>{c!==h&&nv(d,l)&&e.definition[h].ignoreAmbiguities!==!0&&f.push(h)}),f.length>1&&!nv(i,l)&&(i.push(l),o.push({alts:f,path:l}))}),o),[]);return Re(s,o=>{const u=Re(o.alts,l=>l+1);return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:u,prefixPath:o.path}),type:qn.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:e.idx,alternatives:o.alts}})}function d4(t,e,n,r){const i=jn(t,(a,o,u)=>{const c=Re(o,l=>({idx:u,path:l}));return a.concat(
c)},[]);return Nc(fr(i,a=>{if(e.definition[a.idx].ignoreAmbiguities===!0)return[];const u=a.idx,c=a.path,l=dr(i,d=>e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<u&&Yq(d.path,c));return Re(l,d=>{const h=[d.idx+1,u+1],p=e.idx===0?"":e.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:h,prefixPath:d.path}),type:qn.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:p,alternatives:h}})}))}function f4(t,e,n){const r=[],i=Re(e,s=>s.name);return xe(
t,s=>{const a=s.name;if(Mn(i,a)){const o=n.buildNamespaceConflictError(s);r.push({message:o,type:qn.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),r}function h4(t){const e=zy(t,{errMsgProvider:Fq}),n={};return xe(t.rules,r=>{n[r.name]=r}),Mq(n,e.errMsgProvider)}function p4(t){return t=zy(t,{errMsgProvider:ya}),Qq(t.rules,t.tokenTypes,t.errMsgProvider,t.grammarName)}const e$="MismatchedTokenException",t$="NoViableAltException",n$="EarlyExitException",r$="NotAllInputParsedException",i$=[e$,t$,n$,
r$];Object.freeze(i$);function Zh(t){return Mn(i$,t.name)}class Xh extends Error{constructor(e,n){super(e),this.token=n,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class s$ extends Xh{constructor(e,n,r){super(e,n),this.previousToken=r,this.name=e$}}class m4 extends Xh{constructor(e,n,r){super(e,n),this.previousToken=r,this.name=t$}}class g4 extends Xh{constructor(e,n){super(e,n),this.name=r$}}class y4 extends Xh{constructor(e,n,r){
super(e,n),this.previousToken=r,this.name=n$}}const iv={},a$="InRuleRecoveryException";class v4 extends Error{constructor(e){super(e),this.name=a$}}class w4{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Pe(e,"recoveryEnabled")?e.recoveryEnabled:Bi.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=b4)}getTokenToInsert(e){const n=Jy(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return n.isInsertedInRecovery=!0,n}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){
return!0}tryInRepetitionRecovery(e,n,r,i){const s=this.findReSyncTokenType(),a=this.exportLexerState(),o=[];let u=!1;const c=this.LA(1);let l=this.LA(1);const f=()=>{const d=this.LA(0),h=this.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:d,ruleName:this.getCurrRuleFullName()}),p=new s$(h,c,this.LA(0));p.resyncedTokens=Ic(o),this.SAVE_ERROR(p)};for(;!u;)if(this.tokenMatcher(l,i)){f();return}else if(r.call(this)){f(),e.apply(this,n);return}else this.tokenMatcher(l,s)?
u=!0:(l=this.SKIP_TOKEN(),this.addToResyncTokens(l,o));this.importLexerState(a)}shouldInRepetitionRecoveryBeTried(e,n,r){return!(r===!1||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,n)))}getFollowsForInRuleRecovery(e,n){const r=this.getCurrentGrammarPath(e,n);return this.getNextPossibleTokenTypes(r)}tryInRuleRecovery(e,n){if(this.canRecoverWithSingleTokenInsertion(e,n))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(
e)){const r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new v4("sad sad panda")}canPerformInRuleRecovery(e,n){return this.canRecoverWithSingleTokenInsertion(e,n)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,n){if(!this.canTokenTypeBeInsertedInRecovery(e)||$t(n))return!1;const r=this.LA(1);return _o(n,s=>this.tokenMatcher(r,s))!==void 0}canRecoverWithSingleTokenDeletion(e){return this.canTokenTypeBeDeletedInRecovery(e)?this.tokenMatcher(this.LA(2),e):!1}isInCurrentRuleReSyncSet(e){
const n=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(n);return Mn(r,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let n=this.LA(1),r=2;for(;;){const i=_o(e,s=>UR(n,s));if(i!==void 0)return i;n=this.LA(r),r++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return iv;const e=this.getLastExplicitRuleShortName(),n=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:n,inRule:this.
shortRuleNameToFullName(r)}}buildFullFollowKeyStack(){const e=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return Re(e,(r,i)=>i===0?iv:{ruleName:this.shortRuleNameToFullName(r),idxInCallingRule:n[i],inRule:this.shortRuleNameToFullName(e[i-1])})}flattenFollowSet(){const e=Re(this.buildFullFollowKeyStack(),n=>this.getFollowSetFromFollowKey(n));return Cr(e)}getFollowSetFromFollowKey(e){if(e===iv)return[Ss];const n=e.ruleName+e.idxInCallingRule+wR+e.inRule;return this.resyncFollows[n]}addToResyncTokens(e,n){
return this.tokenMatcher(e,Ss)||n.push(e),n}reSyncTo(e){const n=[];let r=this.LA(1);for(;this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,n);return Ic(n)}attemptInRepetitionRecovery(e,n,r,i,s,a,o){}getCurrentGrammarPath(e,n){const r=this.getHumanReadableRuleStack(),i=wn(this.RULE_OCCURRENCE_STACK);return{ruleStack:r,occurrenceStack:i,lastTok:e,lastTokOccurrence:n}}getHumanReadableRuleStack(){return Re(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}}function b4(t,e,n,r,i,s,a){
const o=this.getKeyForAutomaticLookahead(r,i);let u=this.firstAfterRepMap[o];if(u===void 0){const d=this.getCurrRuleFullName(),h=this.getGAstProductions()[d];u=new s(h,i).startWalking(),this.firstAfterRepMap[o]=u}let c=u.token,l=u.occurrence;const f=u.isEndOfRule;this.RULE_STACK.length===1&&f&&c===void 0&&(c=Ss,l=1),!(c===void 0||l===void 0)&&this.shouldInRepetitionRecoveryBeTried(c,l,a)&&this.tryInRepetitionRecovery(t,e,n,c)}const E4=4,Cs=8,o$=1<<Cs,u$=2<<Cs,sv=3<<Cs,av=4<<Cs,ov=5<<Cs,Yh=6<<Cs;
function uv(t,e,n){return n|e|t}class cv{constructor(e){var n;this.maxLookahead=(n=e?.maxLookahead)!==null&&n!==void 0?n:Bi.maxLookahead}validate(e){const n=this.validateNoLeftRecursion(e.rules);if($t(n)){const r=this.validateEmptyOrAlternatives(e.rules),i=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...n,...r,...i,...s]}return n}validateNoLeftRecursion(e){return fr(e,n=>QR(n,n,ya))}validateEmptyOrAlternatives(e){
return fr(e,n=>s4(n,ya))}validateAmbiguousAlternationAlternatives(e,n){return fr(e,r=>a4(r,n,ya))}validateSomeNonEmptyLookaheadPath(e,n){return c4(e,n,ya)}buildLookaheadForAlternation(e){return Wq(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,Vq)}buildLookaheadForOptional(e){return Hq(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,ev(e.prodType),Kq)}}class k4{initLooksAhead(e){this.dynamicTokensEnabled=Pe(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:
Bi.dynamicTokensEnabled,this.maxLookahead=Pe(e,"maxLookahead")?e.maxLookahead:Bi.maxLookahead,this.lookaheadStrategy=Pe(e,"lookaheadStrategy")?e.lookaheadStrategy:new cv({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){xe(e,n=>{this.TRACE_INIT(`${n.name} Rule Lookahead`,()=>{const{alternation:r,repetition:i,option:s,repetitionMandatory:a,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:u}=$4(n);xe(r,c=>{const l=c.idx===0?"":c.idx;this.TRACE_INIT(
`${Ei(c)}${l}`,()=>{const f=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:c.idx,rule:n,maxLookahead:c.maxLookahead||this.maxLookahead,hasPredicates:c.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),d=uv(this.fullRuleNameToShort[n.name],o$,c.idx);this.setLaFuncCache(d,f)})}),xe(i,c=>{this.computeLookaheadFunc(n,c.idx,sv,"Repetition",c.maxLookahead,Ei(c))}),xe(s,c=>{this.computeLookaheadFunc(n,c.idx,u$,"Option",c.maxLookahead,Ei(c))}),xe(a,c=>{this.computeLookaheadFunc(
n,c.idx,av,"RepetitionMandatory",c.maxLookahead,Ei(c))}),xe(o,c=>{this.computeLookaheadFunc(n,c.idx,Yh,"RepetitionMandatoryWithSeparator",c.maxLookahead,Ei(c))}),xe(u,c=>{this.computeLookaheadFunc(n,c.idx,ov,"RepetitionWithSeparator",c.maxLookahead,Ei(c))})})})}computeLookaheadFunc(e,n,r,i,s,a){this.TRACE_INIT(`${a}${n===0?"":n}`,()=>{const o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:n,rule:e,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,
prodType:i}),u=uv(this.fullRuleNameToShort[e.name],r,n);this.setLaFuncCache(u,o)})}getKeyForAutomaticLookahead(e,n){const r=this.getLastExplicitRuleShortName();return uv(r,e,n)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,n){this.lookAheadFuncsCache.set(e,n)}}class R4 extends xo{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.
dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){
this.dslMethods.alternation.push(e)}}const Jh=new R4;function $4(t){Jh.reset(),t.accept(Jh);const e=Jh.dslMethods;return Jh.reset(),e}function c$(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function l$(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&
(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function D4(t,e,n){t.children[n]===void 0?t.children[n]=[e]:t.children[n].push(e)}function T4(t,e,n){t.children[e]===void 0?t.children[e]=[n]:t.children[e].push(n)}const S4="name";function d$(t,e){Object.defineProperty(t,S4,{enumerable:!1,configurable:!0,writable:!1,value:e})}function C4(t,e){const n=Sr(t),r=n.length;for(let i=0;i<r;i++){const s=n[i],a=t[s],o=a.length;for(let u=0;u<o;u++){const c=a[u];c.tokenTypeIdx===void 0&&
this[c.name](c.children,e)}}}function _4(t,e){const n=function(){};d$(n,t+"BaseSemantics");const r={visit:function(i,s){if(ot(i)&&(i=i[0]),!ji(i))return this[i.name](i.children,s)},validateVisitor:function(){const i=x4(this,e);if(!$t(i)){const s=Re(i,a=>a.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return n.prototype=r,n.prototype.constructor=n,n._RULE_NAMES=e,n}function A4(t,e,n){const r=function(){};d$(r,t+"BaseSemanticsWithDefaults");const i=Object.create(n.prototype);return xe(e,s=>{i[s]=C4}),r.prototype=i,r.prototype.constructor=r,r}var lv;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(lv||(lv={}));function x4(t,e){return P4(t,e)}function P4(t,e){const n=dr(e,i=>Oi(t[i])===!1),r=Re(n,i=>({msg:`Missing visitor method: <${i}> o\
n ${t.constructor.name} CST Visitor.`,type:lv.MISSING_METHOD,methodName:i}));return Nc(r)}class N4{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=Pe(e,"nodeLocationTracking")?e.nodeLocationTracking:Bi.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=an,this.cstFinallyStateUpdate=an,this.cstPostTerminal=an,this.cstPostNonTerminal=an,this.cstPostRule=an;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=
l$,this.setNodeLocationFromNode=l$,this.cstPostRule=an,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=an,this.setNodeLocationFromNode=an,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=c$,this.setNodeLocationFromNode=c$,this.cstPostRule=an,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):
(this.setNodeLocationFromToken=an,this.setNodeLocationFromNode=an,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=an,this.setNodeLocationFromNode=an,this.cstPostRule=an,this.setInitialNodeLocation=an;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,
endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const n=this.LA(1);e.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const n={name:e,children:Object.
create(null)};this.setInitialNodeLocation(n),this.CST_STACK.push(n)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const n=this.LA(0),r=e.location;r.startOffset<=n.startOffset?(r.endOffset=n.endOffset,r.endLine=n.endLine,r.endColumn=n.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)}cstPostRuleOnlyOffset(e){const n=this.LA(0),r=e.location;r.startOffset<=n.startOffset?r.endOffset=n.endOffset:r.startOffset=NaN}cstPostTerminal(e,n){const r=this.CST_STACK[this.CST_STACK.
length-1];D4(r,n,e),this.setNodeLocationFromToken(r.location,n)}cstPostNonTerminal(e,n){const r=this.CST_STACK[this.CST_STACK.length-1];T4(r,n,e),this.setNodeLocationFromNode(r.location,e.location)}getBaseCstVisitorConstructor(){if(ji(this.baseCstVisitorConstructor)){const e=_4(this.className,Sr(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(ji(this.baseCstVisitorWithDefaultsConstructor)){const e=A4(
this.className,Sr(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class I4{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=
0,this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):tp}LA(e){const n=this.currIdx+e;return n<0||this.tokVectorLength<=n?tp:this.tokVector[n]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){
this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class O4{ACTION(e){return e.call(this)}consume(e,n,r){return this.consumeInternal(n,e,r)}subrule(e,n,r){return this.subruleInternal(n,e,r)}option(e,n){return this.optionInternal(n,e)}or(e,n){return this.orInternal(n,e)}many(e,n){return this.manyInternal(e,n)}atLeastOne(e,n){return this.atLeastOneInternal(e,n)}CONSUME(e,n){return this.consumeInternal(
e,0,n)}CONSUME1(e,n){return this.consumeInternal(e,1,n)}CONSUME2(e,n){return this.consumeInternal(e,2,n)}CONSUME3(e,n){return this.consumeInternal(e,3,n)}CONSUME4(e,n){return this.consumeInternal(e,4,n)}CONSUME5(e,n){return this.consumeInternal(e,5,n)}CONSUME6(e,n){return this.consumeInternal(e,6,n)}CONSUME7(e,n){return this.consumeInternal(e,7,n)}CONSUME8(e,n){return this.consumeInternal(e,8,n)}CONSUME9(e,n){return this.consumeInternal(e,9,n)}SUBRULE(e,n){return this.subruleInternal(e,0,n)}SUBRULE1(e,n){
return this.subruleInternal(e,1,n)}SUBRULE2(e,n){return this.subruleInternal(e,2,n)}SUBRULE3(e,n){return this.subruleInternal(e,3,n)}SUBRULE4(e,n){return this.subruleInternal(e,4,n)}SUBRULE5(e,n){return this.subruleInternal(e,5,n)}SUBRULE6(e,n){return this.subruleInternal(e,6,n)}SUBRULE7(e,n){return this.subruleInternal(e,7,n)}SUBRULE8(e,n){return this.subruleInternal(e,8,n)}SUBRULE9(e,n){return this.subruleInternal(e,9,n)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(
e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.
orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(
9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){
return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(
1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,n,r=np){if(Mn(this.definedRulesNames,
e)){const a={message:ya.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:qn.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(a)}this.definedRulesNames.push(e);const i=this.defineRule(e,n,r);return this[e]=i,i}OVERRIDE_RULE(e,n,r=np){const i=i4(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(i);const s=this.defineRule(e,n,r);return this[e]=s,s}BACKTRACK(e,n){return function(){this.isBackTrackingStack.push(1);const r=this.
saveRecogState();try{return e.apply(this,n),!0}catch(i){if(Zh(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return zB(on(this.gastProductionsCache))}}class L4{initRecognizerEngine(e,n){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=zh,this.subruleIdx=0,this.definedRulesNames=[],this.
tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Pe(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(ot(e)){if($t(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(ot(e))this.tokensMap=jn(e,(s,a)=>(s[a.name]=a,s),{});else if(Pe(e,"modes")&&Br(Cr(on(e.modes)),Iq)){const s=Cr(on(e.modes)),a=Wy(s);this.tokensMap=jn(a,(o,u)=>(o[u.name]=u,o),{})}else if(Tr(e))this.tokensMap=wn(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=Ss;const r=Pe(e,"modes")?Cr(on(e.modes)):on(e),i=Br(r,s=>$t(s.categoryMatches));this.
tokenMatcher=i?zh:Mc,jc(on(this.tokensMap))}defineRule(e,n,r){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const i=Pe(r,"resyncEnabled")?r.resyncEnabled:np.resyncEnabled,s=Pe(r,"recoveryValueFunc")?r.recoveryValueFunc:np.recoveryValueFunc,a=this.ruleShortNameIdx<<E4+Cs;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;let o;return this.outputCst===!0?o=function(...l){try{this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,l);const f=this.CST_STACK[this.CST_STACK.
length-1];return this.cstPostRule(f),f}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}}:o=function(...l){try{return this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,l)}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(o,{ruleName:e,originalGrammarAction:n})}invokeRuleCatch(e,n,r){const i=this.RULE_STACK.length===1,s=n&&!this.isBackTracking()&&this.recoveryEnabled;if(Zh(e)){const a=e;if(s){const o=this.
findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))if(a.resyncedTokens=this.reSyncTo(o),this.outputCst){const u=this.CST_STACK[this.CST_STACK.length-1];return u.recoveredNode=!0,u}else return r(e);else{if(this.outputCst){const u=this.CST_STACK[this.CST_STACK.length-1];u.recoveredNode=!0,a.partialCstResult=u}throw a}}else{if(i)return this.moveToTerminatedState(),r(e);throw a}}else throw e}optionInternal(e,n){const r=this.getKeyForAutomaticLookahead(u$,n);return this.optionInternalLogic(e,n,
r)}optionInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof e!="function"){s=e.DEF;const a=e.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(this)}}else s=e;if(i.call(this)===!0)return s.call(this)}atLeastOneInternal(e,n){const r=this.getKeyForAutomaticLookahead(av,e);return this.atLeastOneInternalLogic(e,n,r)}atLeastOneInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="function"){s=n.DEF;const a=n.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(
this)}}else s=n;if(i.call(this)===!0){let a=this.doSingleRepetition(s);for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(e,jt.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,n],i,av,e,Uq)}atLeastOneSepFirstInternal(e,n){const r=this.getKeyForAutomaticLookahead(Yh,e);this.atLeastOneSepFirstInternalLogic(e,n,r)}atLeastOneSepFirstInternalLogic(e,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(
this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,WR],o,Yh,e,WR)}else throw this.raiseEarlyExitException(e,jt.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)}manyInternal(e,n){const r=this.getKeyForAutomaticLookahead(sv,e);return this.manyInternalLogic(e,n,r)}manyInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="f\
unction"){s=n.DEF;const o=n.GATE;if(o!==void 0){const u=i;i=()=>o.call(this)&&u.call(this)}}else s=n;let a=!0;for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[e,n],i,sv,e,Gq,a)}manySepFirstInternal(e,n){const r=this.getKeyForAutomaticLookahead(ov,e);this.manySepFirstInternalLogic(e,n,r)}manySepFirstInternalLogic(e,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.
LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,zR],o,ov,e,zR)}}repetitionSepSecondInternal(e,n,r,i,s){for(;r();)this.CONSUME(n),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,r,i,s],r,Yh,e,s)}doSingleRepetition(e){const n=this.getLexerPosition();return e.call(this),this.getLexerPosition()>n}orInternal(e,n){const r=this.getKeyForAutomaticLookahead(o$,n),
i=ot(e)?e:e.DEF,a=this.getLaFuncFromCache(r).call(this,i);if(a!==void 0)return i[a].ALT.call(this);this.raiseNoAltException(n,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const e=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new g4(n,e))}}subruleInternal(e,n,r){let i;try{
const s=r!==void 0?r.ARGS:void 0;return this.subruleIdx=n,i=e.apply(this,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),i}catch(s){throw this.subruleInternalError(s,r,e.ruleName)}}subruleInternalError(e,n,r){throw Zh(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:r),delete e.partialCstResult),e}consumeInternal(e,n,r){let i;try{const s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):
this.consumeInternalError(e,s,r)}catch(s){i=this.consumeInternalRecovery(e,n,s)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,i),i}consumeInternalError(e,n,r){let i;const s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:n,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new s$(i,n,s))}consumeInternalRecovery(e,n,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.
isBackTracking()){const i=this.getFollowsForInRuleRecovery(e,n);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===a$?r:s}}else throw r}saveRecogState(){const e=this.errors,n=wn(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,n,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.
cstInvocationStateUpdate(n)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),Ss)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class F4{initErrorHandler(e){this.
_errors=[],this.errorMessageProvider=Pe(e,"errorMessageProvider")?e.errorMessageProvider:Bi.errorMessageProvider}SAVE_ERROR(e){if(Zh(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:wn(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return wn(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,n,r){const i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],
o=Vh(e,s,n,this.maxLookahead)[0],u=[];for(let l=1;l<=this.maxLookahead;l++)u.push(this.LA(l));const c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:u,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new y4(c,this.LA(1),this.LA(0)))}raiseNoAltException(e,n){const r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=Hh(e,i,this.maxLookahead),a=[];for(let c=1;c<=this.maxLookahead;c++)a.push(this.LA(c));const o=this.LA(0),u=this.
errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:a,previous:o,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new m4(u,this.LA(1),o))}}class M4{initContentAssist(){}computeContentAssist(e,n){const r=this.gastProductionsCache[e];if(ji(r))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return HR([r],n,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const n=qr(e.ruleStack),i=this.getGAstProductions()[n];return new qq(
i,e).startWalking()}}const Qh={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Qh);const f$=!0,h$=Math.pow(2,Cs)-1,p$=GR({name:"RECORDING_PHASE_TOKEN",pattern:ir.NA});jc([p$]);const m$=Jy(p$,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(m$);const j4={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class B4{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){const n=e>0?e:"";this[`CONSUME${n}`]=function(r,i){return this.consumeInternalRecord(r,e,i)},this[`SUBRULE${n}`]=function(r,i){return this.subruleInternalRecord(r,e,i)},this[`OPTION${n}`]=function(r){return this.optionInternalRecord(
r,e)},this[`OR${n}`]=function(r){return this.orInternalRecord(r,e)},this[`MANY${n}`]=function(r){this.manyInternalRecord(e,r)},this[`MANY_SEP${n}`]=function(r){this.manySepFirstInternalRecord(e,r)},this[`AT_LEAST_ONE${n}`]=function(r){this.atLeastOneInternalRecord(e,r)},this[`AT_LEAST_ONE_SEP${n}`]=function(r){this.atLeastOneSepFirstInternalRecord(e,r)}}this.consume=function(e,n,r){return this.consumeInternalRecord(n,e,r)},this.subrule=function(e,n,r){return this.subruleInternalRecord(n,e,r)},this.
option=function(e,n){return this.optionInternalRecord(n,e)},this.or=function(e,n){return this.orInternalRecord(n,e)},this.many=function(e,n){this.manyInternalRecord(e,n)},this.atLeastOne=function(e,n){this.atLeastOneInternalRecord(e,n)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const e=this;for(let n=0;n<10;n++){const r=n>0?n:"";delete e[`CONSUME${r}`],delete e[`\
SUBRULE${r}`],delete e[`OPTION${r}`],delete e[`OR${r}`],delete e[`MANY${r}`],delete e[`MANY_SEP${r}`],delete e[`AT_LEAST_ONE${r}`],delete e[`AT_LEAST_ONE_SEP${r}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,n){return()=>!0}LA_RECORD(e){return tp}topLevelRuleRecord(e,n){try{const r=new Ao({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),
n.call(this),this.recordingProdStack.pop(),r}catch(r){if(r.KNOWN_RECORDER_ERROR!==!0)try{r.message=r.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw r}throw r}}optionInternalRecord(e,n){return qc.call(this,En,e,n)}atLeastOneInternalRecord(e,n){qc.call(this,hr,n,e)}atLeastOneSepFirstInternalRecord(e,n){qc.call(this,pr,n,e,f$)}manyInternalRecord(e,n){qc.call(this,zt,n,e)}manySepFirstInternalRecord(e,n){qc.call(this,nr,n,e,f$)}orInternalRecord(e,n){return q4.call(this,e,n)}subruleInternalRecord(e,n,r){if(ep(n),!e||Pe(e,"ruleName")===!1){const o=new Error(`<SUBRULE${g$(
n)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const i=Co(this.recordingProdStack),s=e.ruleName,a=new Bn({idx:n,nonTerminalName:s,label:r?.LABEL,referencedRule:void 0});return i.definition.push(a),this.outputCst?j4:Qh}consumeInternalRecord(e,n,r){if(ep(n),!xR(e)){const a=new Error(`<CONSUME${g$(n)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const i=Co(this.recordingProdStack),s=new Nt({idx:n,terminalType:e,label:r?.LABEL});return i.definition.push(s),m$}}function qc(t,e,n,r=!1){ep(n);const i=Co(this.recordingProdStack),s=Oi(e)?e:e.DEF,a=new t({definition:[],idx:n});return r&&(a.separator=e.SEP),Pe(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),s.call(this),i.definition.push(a),this.recordingProdStack.
pop(),Qh}function q4(t,e){ep(e);const n=Co(this.recordingProdStack),r=ot(t)===!1,i=r===!1?t:t.DEF,s=new rr({definition:[],idx:e,ignoreAmbiguities:r&&t.IGNORE_AMBIGUITIES===!0});Pe(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD);const a=hR(i,o=>Oi(o.GATE));return s.hasPredicates=a,n.definition.push(s),xe(i,o=>{const u=new tr({definition:[]});s.definition.push(u),Pe(o,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=o.IGNORE_AMBIGUITIES:Pe(o,"GATE")&&(u.ignoreAmbiguities=!0),this.recordingProdStack.
push(u),o.ALT.call(this),this.recordingProdStack.pop()}),Qh}function g$(t){return t===0?"":`${t}`}function ep(t){if(t<0||t>h$){const e=new Error(`Invalid DSL Method idx value: <${t}>
	Idx value must be a none negative value smaller than ${h$+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}class G4{initPerformanceTracer(e){if(Pe(e,"traceInitPerf")){const n=e.traceInitPerf,r=typeof n=="number";this.traceInitMaxIdent=r?n:1/0,this.traceInitPerf=r?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=Bi.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,n){if(this.traceInitPerf===!0){this.traceInitIndent++;const r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&
console.log(`${r}--> <${e}>`);const{time:i,value:s}=gR(n),a=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(`${r}<-- <${e}> time: ${i}ms`),this.traceInitIndent--,s}else return n()}}function U4(t,e){e.forEach(n=>{const r=n.prototype;Object.getOwnPropertyNames(r).forEach(i=>{if(i==="constructor")return;const s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(t.prototype,i,s):t.prototype[i]=n.prototype[i]})})}const tp=Jy(Ss,"",NaN,NaN,
NaN,NaN,NaN,NaN);Object.freeze(tp);const Bi=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:No,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),np=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var qn;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",
t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",t[t.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAH\
EAD_VALIDATION"})(qn||(qn={}));function y$(t=void 0){return function(){return t}}class qf{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;const n=this.className;this.TRACE_INIT("toFastProps",()=>{yR(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),xe(this.definedRulesNames,
i=>{const a=this[i].originalGrammarAction;let o;this.TRACE_INIT(`${i} Rule`,()=>{o=this.topLevelRuleRecord(i,a)}),this.gastProductionsCache[i]=o})}finally{this.disableRecording()}});let r=[];if(this.TRACE_INIT("Grammar Resolving",()=>{r=h4({rules:on(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(r)}),this.TRACE_INIT("Grammar Validations",()=>{if($t(r)&&this.skipValidations===!1){const i=p4({rules:on(this.gastProductionsCache),tokenTypes:on(this.tokensMap),errMsgProvider:ya,
grammarName:n}),s=Jq({lookaheadStrategy:this.lookaheadStrategy,rules:on(this.gastProductionsCache),tokenTypes:on(this.tokensMap),grammarName:n});this.definitionErrors=this.definitionErrors.concat(i,s)}}),$t(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const i=YB(on(this.gastProductionsCache));this.resyncFollows=i}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var i,s;(s=(i=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(i,{rules:on(
this.gastProductionsCache)}),this.preComputeLookaheadFunctions(on(this.gastProductionsCache))})),!qf.DEFER_DEFINITION_ERRORS_HANDLING&&!$t(this.definitionErrors))throw e=Re(this.definitionErrors,i=>i.message),new Error(`Parser Definition Errors detected:
 ${e.join(`
-------------------------------
`)}`)})}constructor(e,n){this.definitionErrors=[],this.selfAnalysisDone=!1;const r=this;if(r.initErrorHandler(n),r.initLexerAdapter(),r.initLooksAhead(n),r.initRecognizerEngine(e,n),r.initRecoverable(n),r.initTreeBuilder(n),r.initContentAssist(),r.initGastRecorder(n),r.initPerformanceTracer(n),Pe(n,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=Pe(n,"skipValidations")?n.skipValidations:Bi.skipValidations}}qf.DEFER_DEFINITION_ERRORS_HANDLING=!1,U4(qf,[w4,k4,N4,I4,L4,O4,F4,M4,B4,G4]);class z4 extends qf{constructor(e,n=Bi){const r=wn(n);r.outputCst=!1,super(e,r)}}function Io(t,e,n){return`${t.name}_${e}_${n}`}const _s=1,W4=2,v$=4,w$=5,Gc=7,H4=8,V4=9,K4=10,Z4=11,b$=12;class dv{constructor(e){this.target=e}isEpsilon(){return!1}}class fv extends dv{constructor(e,n){super(e),this.tokenType=n}}class E$ extends dv{constructor(e){
super(e)}isEpsilon(){return!0}}class hv extends dv{constructor(e,n,r){super(e),this.rule=n,this.followState=r}isEpsilon(){return!0}}function X4(t){const e={decisionMap:{},decisionStates:[],ruleToStartState:new Map,ruleToStopState:new Map,states:[]};Y4(e,t);const n=t.length;for(let r=0;r<n;r++){const i=t[r],s=va(e,i,i);s!==void 0&&u3(e,i,s)}return e}function Y4(t,e){const n=e.length;for(let r=0;r<n;r++){const i=e[r],s=hn(t,i,void 0,{type:W4}),a=hn(t,i,void 0,{type:Gc});s.stop=a,t.ruleToStartState.
set(i,s),t.ruleToStopState.set(i,a)}}function k$(t,e,n){return n instanceof Nt?pv(t,e,n.terminalType,n):n instanceof Bn?o3(t,e,n):n instanceof rr?n3(t,e,n):n instanceof En?r3(t,e,n):n instanceof zt?J4(t,e,n):n instanceof nr?Q4(t,e,n):n instanceof hr?e3(t,e,n):n instanceof pr?t3(t,e,n):va(t,e,n)}function J4(t,e,n){const r=hn(t,e,n,{type:w$});As(t,r);const i=Oo(t,e,r,n,va(t,e,n));return $$(t,e,n,i)}function Q4(t,e,n){const r=hn(t,e,n,{type:w$});As(t,r);const i=Oo(t,e,r,n,va(t,e,n)),s=pv(t,e,n.separator,
n);return $$(t,e,n,i,s)}function e3(t,e,n){const r=hn(t,e,n,{type:v$});As(t,r);const i=Oo(t,e,r,n,va(t,e,n));return R$(t,e,n,i)}function t3(t,e,n){const r=hn(t,e,n,{type:v$});As(t,r);const i=Oo(t,e,r,n,va(t,e,n)),s=pv(t,e,n.separator,n);return R$(t,e,n,i,s)}function n3(t,e,n){const r=hn(t,e,n,{type:_s});As(t,r);const i=Re(n.definition,a=>k$(t,e,a));return Oo(t,e,r,n,...i)}function r3(t,e,n){const r=hn(t,e,n,{type:_s});As(t,r);const i=Oo(t,e,r,n,va(t,e,n));return i3(t,e,n,i)}function va(t,e,n){const r=dr(
Re(n.definition,i=>k$(t,e,i)),i=>i!==void 0);return r.length===1?r[0]:r.length===0?void 0:a3(t,r)}function R$(t,e,n,r,i){const s=r.left,a=r.right,o=hn(t,e,n,{type:Z4});As(t,o);const u=hn(t,e,n,{type:b$});return s.loopback=o,u.loopback=o,t.decisionMap[Io(e,i?"RepetitionMandatoryWithSeparator":"RepetitionMandatory",n.idx)]=o,Qt(a,o),i===void 0?(Qt(o,s),Qt(o,u)):(Qt(o,u),Qt(o,i.left),Qt(i.right,s)),{left:s,right:u}}function $$(t,e,n,r,i){const s=r.left,a=r.right,o=hn(t,e,n,{type:K4});As(t,o);const u=hn(
t,e,n,{type:b$}),c=hn(t,e,n,{type:V4});return o.loopback=c,u.loopback=c,Qt(o,s),Qt(o,u),Qt(a,c),i!==void 0?(Qt(c,u),Qt(c,i.left),Qt(i.right,s)):Qt(c,o),t.decisionMap[Io(e,i?"RepetitionWithSeparator":"Repetition",n.idx)]=o,{left:o,right:u}}function i3(t,e,n,r){const i=r.left,s=r.right;return Qt(i,s),t.decisionMap[Io(e,"Option",n.idx)]=i,r}function As(t,e){return t.decisionStates.push(e),e.decision=t.decisionStates.length-1,e.decision}function Oo(t,e,n,r,...i){const s=hn(t,e,r,{type:H4,start:n});n.
end=s;for(const o of i)o!==void 0?(Qt(n,o.left),Qt(o.right,s)):Qt(n,s);const a={left:n,right:s};return t.decisionMap[Io(e,s3(r),r.idx)]=n,a}function s3(t){if(t instanceof rr)return"Alternation";if(t instanceof En)return"Option";if(t instanceof zt)return"Repetition";if(t instanceof nr)return"RepetitionWithSeparator";if(t instanceof hr)return"RepetitionMandatory";if(t instanceof pr)return"RepetitionMandatoryWithSeparator";throw new Error("Invalid production type encountered")}function a3(t,e){const n=e.
length;for(let s=0;s<n-1;s++){const a=e[s];let o;a.left.transitions.length===1&&(o=a.left.transitions[0]);const u=o instanceof hv,c=o,l=e[s+1].left;a.left.type===_s&&a.right.type===_s&&o!==void 0&&(u&&c.followState===a.right||o.target===a.right)?(u?c.followState=l:o.target=l,c3(t,a.right)):Qt(a.right,l)}const r=e[0],i=e[n-1];return{left:r.left,right:i.right}}function pv(t,e,n,r){const i=hn(t,e,r,{type:_s}),s=hn(t,e,r,{type:_s});return mv(i,new fv(s,n)),{left:i,right:s}}function o3(t,e,n){const r=n.
referencedRule,i=t.ruleToStartState.get(r),s=hn(t,e,n,{type:_s}),a=hn(t,e,n,{type:_s}),o=new hv(i,r,a);return mv(s,o),{left:s,right:a}}function u3(t,e,n){const r=t.ruleToStartState.get(e);Qt(r,n.left);const i=t.ruleToStopState.get(e);return Qt(n.right,i),{left:r,right:i}}function Qt(t,e){const n=new E$(e);mv(t,n)}function hn(t,e,n,r){const i=Object.assign({atn:t,production:n,epsilonOnlyTransitions:!1,rule:e,transitions:[],nextTokenWithinRule:[],stateNumber:t.states.length},r);return t.states.push(
i),i}function mv(t,e){t.transitions.length===0&&(t.epsilonOnlyTransitions=e.isEpsilon()),t.transitions.push(e)}function c3(t,e){t.states.splice(t.states.indexOf(e),1)}const rp={};class gv{constructor(){this.map={},this.configs=[]}get size(){return this.configs.length}finalize(){this.map={}}add(e){const n=D$(e);n in this.map||(this.map[n]=this.configs.length,this.configs.push(e))}get elements(){return this.configs}get alts(){return Re(this.configs,e=>e.alt)}get key(){let e="";for(const n in this.
map)e+=n+":";return e}}function D$(t,e=!0){return`${e?`a${t.alt}`:""}s${t.state.stateNumber}:${t.stack.map(n=>n.stateNumber.toString()).join("_")}`}function l3(t,e){const n={};return r=>{const i=r.toString();let s=n[i];return s!==void 0||(s={atnStartState:t,decision:e,states:{}},n[i]=s),s}}class T${constructor(){this.predicates=[]}is(e){return e>=this.predicates.length||this.predicates[e]}set(e,n){this.predicates[e]=n}toString(){let e="";const n=this.predicates.length;for(let r=0;r<n;r++)e+=this.
predicates[r]===!0?"1":"0";return e}}const S$=new T$;class d3 extends cv{constructor(e){var n;super(),this.logging=(n=e?.logging)!==null&&n!==void 0?n:r=>console.log(r)}initialize(e){this.atn=X4(e.rules),this.dfas=f3(this.atn)}validateAmbiguousAlternationAlternatives(){return[]}validateEmptyOrAlternatives(){return[]}buildLookaheadForAlternation(e){const{prodOccurrence:n,rule:r,hasPredicates:i,dynamicTokensEnabled:s}=e,a=this.dfas,o=this.logging,u=Io(r,"Alternation",n),l=this.atn.decisionMap[u].decision,
f=Re(VR({maxLookahead:1,occurrence:n,prodType:"Alternation",rule:r}),d=>Re(d,h=>h[0]));if(C$(f,!1)&&!s){const d=jn(f,(h,p,w)=>(xe(p,v=>{v&&(h[v.tokenTypeIdx]=w,xe(v.categoryMatches,g=>{h[g]=w}))}),h),{});return i?function(h){var p;const w=this.LA(1),v=d[w.tokenTypeIdx];if(h!==void 0&&v!==void 0){const g=(p=h[v])===null||p===void 0?void 0:p.GATE;if(g!==void 0&&g.call(this)===!1)return}return v}:function(){const h=this.LA(1);return d[h.tokenTypeIdx]}}else return i?function(d){const h=new T$,p=d===
void 0?0:d.length;for(let v=0;v<p;v++){const g=d?.[v].GATE;h.set(v,g===void 0||g.call(this))}const w=yv.call(this,a,l,h,o);return typeof w=="number"?w:void 0}:function(){const d=yv.call(this,a,l,S$,o);return typeof d=="number"?d:void 0}}buildLookaheadForOptional(e){const{prodOccurrence:n,rule:r,prodType:i,dynamicTokensEnabled:s}=e,a=this.dfas,o=this.logging,u=Io(r,i,n),l=this.atn.decisionMap[u].decision,f=Re(VR({maxLookahead:1,occurrence:n,prodType:i,rule:r}),d=>Re(d,h=>h[0]));if(C$(f)&&f[0][0]&&
!s){const d=f[0],h=Cr(d);if(h.length===1&&$t(h[0].categoryMatches)){const w=h[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===w}}else{const p=jn(h,(w,v)=>(v!==void 0&&(w[v.tokenTypeIdx]=!0,xe(v.categoryMatches,g=>{w[g]=!0})),w),{});return function(){const w=this.LA(1);return p[w.tokenTypeIdx]===!0}}}return function(){const d=yv.call(this,a,l,S$,o);return typeof d=="object"?!1:d===0}}}function C$(t,e=!0){const n=new Set;for(const r of t){const i=new Set;for(const s of r){if(s===
void 0){if(e)break;return!1}const a=[s.tokenTypeIdx].concat(s.categoryMatches);for(const o of a)if(n.has(o)){if(!i.has(o))return!1}else n.add(o),i.add(o)}}return!0}function f3(t){const e=t.decisionStates.length,n=Array(e);for(let r=0;r<e;r++)n[r]=l3(t.decisionStates[r],r);return n}function yv(t,e,n,r){const i=t[e](n);let s=i.start;if(s===void 0){const o=R3(i.atnStartState);s=x$(i,_$(o)),i.start=s}return h3.apply(this,[i,s,n,r])}function h3(t,e,n,r){let i=e,s=1;const a=[];let o=this.LA(s++);for(;;){
let u=w3(i,o);if(u===void 0&&(u=p3.apply(this,[t,i,o,s,n,r])),u===rp)return v3(a,i,o);if(u.isAcceptState===!0)return u.prediction;i=u,a.push(o),o=this.LA(s++)}}function p3(t,e,n,r,i,s){const a=b3(e.configs,n,i);if(a.size===0)return A$(t,e,n,rp),rp;let o=_$(a);const u=k3(a,i);if(u!==void 0)o.isAcceptState=!0,o.prediction=u,o.configs.uniqueAlt=u;else if(S3(a)){const c=xB(a.alts);o.isAcceptState=!0,o.prediction=c,o.configs.uniqueAlt=c,m3.apply(this,[t,r,a.alts,s])}return o=A$(t,e,n,o),o}function m3(t,e,n,r){
const i=[];for(let c=1;c<=e;c++)i.push(this.LA(c).tokenType);const s=t.atnStartState,a=s.rule,o=s.production,u=g3({topLevelRule:a,ambiguityIndices:n,production:o,prefixPath:i});r(u)}function g3(t){const e=Re(t.prefixPath,i=>Po(i)).join(", "),n=t.production.idx===0?"":t.production.idx;let r=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(", ")}> in <${y3(t.production)}${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r}function y3(t){if(t instanceof Bn)return"SUBRULE";if(t instanceof En)return"OPTION";if(t instanceof rr)return"OR";if(t instanceof hr)return"AT_LEAST_ONE";if(t instanceof pr)return"AT_LEAST_ONE_SEP";if(t instanceof nr)return"MANY_SEP";if(t instanceof zt)return"MANY";if(t instanceof Nt)return"CONSUME";throw Error("non exhaustive match")}function v3(t,e,n){const r=fr(e.configs.elements,s=>s.state.transitions),i=qB(r.filter(s=>s instanceof fv).map(s=>s.tokenType),s=>s.tokenTypeIdx);
return{actualToken:n,possibleTokenTypes:i,tokenPath:t}}function w3(t,e){return t.edges[e.tokenTypeIdx]}function b3(t,e,n){const r=new gv,i=[];for(const a of t.elements){if(n.is(a.alt)===!1)continue;if(a.state.type===Gc){i.push(a);continue}const o=a.state.transitions.length;for(let u=0;u<o;u++){const c=a.state.transitions[u],l=E3(c,e);l!==void 0&&r.add({state:l,alt:a.alt,stack:a.stack})}}let s;if(i.length===0&&r.size===1&&(s=r),s===void 0){s=new gv;for(const a of r.elements)ip(a,s)}if(i.length>0&&
!D3(s))for(const a of i)s.add(a);return s}function E3(t,e){if(t instanceof fv&&UR(e,t.tokenType))return t.target}function k3(t,e){let n;for(const r of t.elements)if(e.is(r.alt)===!0){if(n===void 0)n=r.alt;else if(n!==r.alt)return}return n}function _$(t){return{configs:t,edges:{},isAcceptState:!1,prediction:-1}}function A$(t,e,n,r){return r=x$(t,r),e.edges[n.tokenTypeIdx]=r,r}function x$(t,e){if(e===rp)return e;const n=e.configs.key,r=t.states[n];return r!==void 0?r:(e.configs.finalize(),t.states[n]=
e,e)}function R3(t){const e=new gv,n=t.transitions.length;for(let r=0;r<n;r++){const s={state:t.transitions[r].target,alt:r,stack:[]};ip(s,e)}return e}function ip(t,e){const n=t.state;if(n.type===Gc){if(t.stack.length>0){const i=[...t.stack],a={state:i.pop(),alt:t.alt,stack:i};ip(a,e)}else e.add(t);return}n.epsilonOnlyTransitions||e.add(t);const r=n.transitions.length;for(let i=0;i<r;i++){const s=n.transitions[i],a=$3(t,s);a!==void 0&&ip(a,e)}}function $3(t,e){if(e instanceof E$)return{state:e.target,
alt:t.alt,stack:t.stack};if(e instanceof hv){const n=[...t.stack,e.followState];return{state:e.target,alt:t.alt,stack:n}}}function D3(t){for(const e of t.elements)if(e.state.type===Gc)return!0;return!1}function T3(t){for(const e of t.elements)if(e.state.type!==Gc)return!1;return!0}function S3(t){if(T3(t))return!0;const e=C3(t.elements);return _3(e)&&!A3(e)}function C3(t){const e=new Map;for(const n of t){const r=D$(n,!1);let i=e.get(r);i===void 0&&(i={},e.set(r,i)),i[n.alt]=!0}return e}function _3(t){
for(const e of Array.from(t.values()))if(Object.keys(e).length>1)return!0;return!1}function A3(t){for(const e of Array.from(t.values()))if(Object.keys(e).length===1)return!0;return!1}var P$;(function(t){function e(n){return typeof n=="string"}t.is=e})(P$||(P$={}));var vv;(function(t){function e(n){return typeof n=="string"}t.is=e})(vv||(vv={}));var N$;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})(N$||(N$=
{}));var sp;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})(sp||(sp={}));var yt;(function(t){function e(r,i){return r===Number.MAX_VALUE&&(r=sp.MAX_VALUE),i===Number.MAX_VALUE&&(i=sp.MAX_VALUE),{line:r,character:i}}t.create=e;function n(r){let i=r;return G.objectLiteral(i)&&G.uinteger(i.line)&&G.uinteger(i.character)}t.is=n})(yt||(yt={}));var it;(function(t){function e(r,i,s,a){if(G.uinteger(r)&&G.uinteger(i)&&G.uinteger(
s)&&G.uinteger(a))return{start:yt.create(r,i),end:yt.create(s,a)};if(yt.is(r)&&yt.is(i))return{start:r,end:i};throw new Error(`Range#create called with invalid arguments[${r}, ${i}, ${s}, ${a}]`)}t.create=e;function n(r){let i=r;return G.objectLiteral(i)&&yt.is(i.start)&&yt.is(i.end)}t.is=n})(it||(it={}));var ap;(function(t){function e(r,i){return{uri:r,range:i}}t.create=e;function n(r){let i=r;return G.objectLiteral(i)&&it.is(i.range)&&(G.string(i.uri)||G.undefined(i.uri))}t.is=n})(ap||(ap={}));
var I$;(function(t){function e(r,i,s,a){return{targetUri:r,targetRange:i,targetSelectionRange:s,originSelectionRange:a}}t.create=e;function n(r){let i=r;return G.objectLiteral(i)&&it.is(i.targetRange)&&G.string(i.targetUri)&&it.is(i.targetSelectionRange)&&(it.is(i.originSelectionRange)||G.undefined(i.originSelectionRange))}t.is=n})(I$||(I$={}));var wv;(function(t){function e(r,i,s,a){return{red:r,green:i,blue:s,alpha:a}}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&G.numberRange(
i.red,0,1)&&G.numberRange(i.green,0,1)&&G.numberRange(i.blue,0,1)&&G.numberRange(i.alpha,0,1)}t.is=n})(wv||(wv={}));var O$;(function(t){function e(r,i){return{range:r,color:i}}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&it.is(i.range)&&wv.is(i.color)}t.is=n})(O$||(O$={}));var L$;(function(t){function e(r,i,s){return{label:r,textEdit:i,additionalTextEdits:s}}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&G.string(i.label)&&(G.undefined(i.textEdit)||sr.is(i))&&(G.undefined(
i.additionalTextEdits)||G.typedArray(i.additionalTextEdits,sr.is))}t.is=n})(L$||(L$={}));var F$;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(F$||(F$={}));var M$;(function(t){function e(r,i,s,a,o,u){const c={startLine:r,endLine:i};return G.defined(s)&&(c.startCharacter=s),G.defined(a)&&(c.endCharacter=a),G.defined(o)&&(c.kind=o),G.defined(u)&&(c.collapsedText=u),c}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&G.uinteger(i.startLine)&&G.uinteger(i.startLine)&&
(G.undefined(i.startCharacter)||G.uinteger(i.startCharacter))&&(G.undefined(i.endCharacter)||G.uinteger(i.endCharacter))&&(G.undefined(i.kind)||G.string(i.kind))}t.is=n})(M$||(M$={}));var bv;(function(t){function e(r,i){return{location:r,message:i}}t.create=e;function n(r){let i=r;return G.defined(i)&&ap.is(i.location)&&G.string(i.message)}t.is=n})(bv||(bv={}));var wa;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(wa||(wa={}));var j$;(function(t){t.Unnecessary=1,t.Deprecated=2})(j$||
(j$={}));var B$;(function(t){function e(n){const r=n;return G.objectLiteral(r)&&G.string(r.href)}t.is=e})(B$||(B$={}));var op;(function(t){function e(r,i,s,a,o,u){let c={range:r,message:i};return G.defined(s)&&(c.severity=s),G.defined(a)&&(c.code=a),G.defined(o)&&(c.source=o),G.defined(u)&&(c.relatedInformation=u),c}t.create=e;function n(r){var i;let s=r;return G.defined(s)&&it.is(s.range)&&G.string(s.message)&&(G.number(s.severity)||G.undefined(s.severity))&&(G.integer(s.code)||G.string(s.code)||
G.undefined(s.code))&&(G.undefined(s.codeDescription)||G.string((i=s.codeDescription)===null||i===void 0?void 0:i.href))&&(G.string(s.source)||G.undefined(s.source))&&(G.undefined(s.relatedInformation)||G.typedArray(s.relatedInformation,bv.is))}t.is=n})(op||(op={}));var Lo;(function(t){function e(r,i,...s){let a={title:r,command:i};return G.defined(s)&&s.length>0&&(a.arguments=s),a}t.create=e;function n(r){let i=r;return G.defined(i)&&G.string(i.title)&&G.string(i.command)}t.is=n})(Lo||(Lo={}));
var sr;(function(t){function e(s,a){return{range:s,newText:a}}t.replace=e;function n(s,a){return{range:{start:s,end:s},newText:a}}t.insert=n;function r(s){return{range:s,newText:""}}t.del=r;function i(s){const a=s;return G.objectLiteral(a)&&G.string(a.newText)&&it.is(a.range)}t.is=i})(sr||(sr={}));var Ev;(function(t){function e(r,i,s){const a={label:r};return i!==void 0&&(a.needsConfirmation=i),s!==void 0&&(a.description=s),a}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&G.string(
i.label)&&(G.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(G.string(i.description)||i.description===void 0)}t.is=n})(Ev||(Ev={}));var Fo;(function(t){function e(n){const r=n;return G.string(r)}t.is=e})(Fo||(Fo={}));var q$;(function(t){function e(s,a,o){return{range:s,newText:a,annotationId:o}}t.replace=e;function n(s,a,o){return{range:{start:s,end:s},newText:a,annotationId:o}}t.insert=n;function r(s,a){return{range:s,newText:"",annotationId:a}}t.del=r;function i(s){const a=s;return sr.
is(a)&&(Ev.is(a.annotationId)||Fo.is(a.annotationId))}t.is=i})(q$||(q$={}));var kv;(function(t){function e(r,i){return{textDocument:r,edits:i}}t.create=e;function n(r){let i=r;return G.defined(i)&&Sv.is(i.textDocument)&&Array.isArray(i.edits)}t.is=n})(kv||(kv={}));var Rv;(function(t){function e(r,i,s){let a={kind:"create",uri:r};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),s!==void 0&&(a.annotationId=s),a}t.create=e;function n(r){let i=r;return i&&i.kind===
"create"&&G.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||G.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||G.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Fo.is(i.annotationId))}t.is=n})(Rv||(Rv={}));var $v;(function(t){function e(r,i,s,a){let o={kind:"rename",oldUri:r,newUri:i};return s!==void 0&&(s.overwrite!==void 0||s.ignoreIfExists!==void 0)&&(o.options=s),a!==void 0&&(o.annotationId=a),o}t.create=e;function n(r){let i=r;return i&&i.
kind==="rename"&&G.string(i.oldUri)&&G.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||G.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||G.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Fo.is(i.annotationId))}t.is=n})($v||($v={}));var Dv;(function(t){function e(r,i,s){let a={kind:"delete",uri:r};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),s!==void 0&&(a.annotationId=s),a}t.create=e;function n(r){let i=r;
return i&&i.kind==="delete"&&G.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||G.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||G.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||Fo.is(i.annotationId))}t.is=n})(Dv||(Dv={}));var Tv;(function(t){function e(n){let r=n;return r&&(r.changes!==void 0||r.documentChanges!==void 0)&&(r.documentChanges===void 0||r.documentChanges.every(i=>G.string(i.kind)?Rv.is(i)||$v.is(i)||Dv.is(i):kv.is(i)))}t.
is=e})(Tv||(Tv={}));var G$;(function(t){function e(r){return{uri:r}}t.create=e;function n(r){let i=r;return G.defined(i)&&G.string(i.uri)}t.is=n})(G$||(G$={}));var U$;(function(t){function e(r,i){return{uri:r,version:i}}t.create=e;function n(r){let i=r;return G.defined(i)&&G.string(i.uri)&&G.integer(i.version)}t.is=n})(U$||(U$={}));var Sv;(function(t){function e(r,i){return{uri:r,version:i}}t.create=e;function n(r){let i=r;return G.defined(i)&&G.string(i.uri)&&(i.version===null||G.integer(i.version))}
t.is=n})(Sv||(Sv={}));var z$;(function(t){function e(r,i,s,a){return{uri:r,languageId:i,version:s,text:a}}t.create=e;function n(r){let i=r;return G.defined(i)&&G.string(i.uri)&&G.string(i.languageId)&&G.integer(i.version)&&G.string(i.text)}t.is=n})(z$||(z$={}));var Cv;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function e(n){const r=n;return r===t.PlainText||r===t.Markdown}t.is=e})(Cv||(Cv={}));var Uc;(function(t){function e(n){const r=n;return G.objectLiteral(n)&&Cv.is(r.kind)&&G.
string(r.value)}t.is=e})(Uc||(Uc={}));var Bt;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Bt||(Bt={}));var Gn;(function(t){t.PlainText=1,t.Snippet=2})(Gn||(Gn={}));var W$;(function(t){t.Deprecated=1})(W$||(W$={}));var H$;
(function(t){function e(r,i,s){return{newText:r,insert:i,replace:s}}t.create=e;function n(r){const i=r;return i&&G.string(i.newText)&&it.is(i.insert)&&it.is(i.replace)}t.is=n})(H$||(H$={}));var V$;(function(t){t.asIs=1,t.adjustIndentation=2})(V$||(V$={}));var K$;(function(t){function e(n){const r=n;return r&&(G.string(r.detail)||r.detail===void 0)&&(G.string(r.description)||r.description===void 0)}t.is=e})(K$||(K$={}));var Z$;(function(t){function e(n){return{label:n}}t.create=e})(Z$||(Z$={}));var X$;
(function(t){function e(n,r){return{items:n||[],isIncomplete:!!r}}t.create=e})(X$||(X$={}));var up;(function(t){function e(r){return r.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=e;function n(r){const i=r;return G.string(i)||G.objectLiteral(i)&&G.string(i.language)&&G.string(i.value)}t.is=n})(up||(up={}));var Y$;(function(t){function e(n){let r=n;return!!r&&G.objectLiteral(r)&&(Uc.is(r.contents)||up.is(r.contents)||G.typedArray(r.contents,up.is))&&(n.range===void 0||it.is(n.range))}t.
is=e})(Y$||(Y$={}));var J$;(function(t){function e(n,r){return r?{label:n,documentation:r}:{label:n}}t.create=e})(J$||(J$={}));var Q$;(function(t){function e(n,r,...i){let s={label:n};return G.defined(r)&&(s.documentation=r),G.defined(i)?s.parameters=i:s.parameters=[],s}t.create=e})(Q$||(Q$={}));var eD;(function(t){t.Text=1,t.Read=2,t.Write=3})(eD||(eD={}));var tD;(function(t){function e(n,r){let i={range:n};return G.number(r)&&(i.kind=r),i}t.create=e})(tD||(tD={}));var Ur;(function(t){t.File=1,
t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(Ur||(Ur={}));var nD;(function(t){t.Deprecated=1})(nD||(nD={}));var rD;(function(t){function e(n,r,i,s,a){let o={name:n,kind:r,location:{uri:s,range:i}};return a&&(o.containerName=a),o}
t.create=e})(rD||(rD={}));var iD;(function(t){function e(n,r,i,s){return s!==void 0?{name:n,kind:r,location:{uri:i,range:s}}:{name:n,kind:r,location:{uri:i}}}t.create=e})(iD||(iD={}));var sD;(function(t){function e(r,i,s,a,o,u){let c={name:r,detail:i,kind:s,range:a,selectionRange:o};return u!==void 0&&(c.children=u),c}t.create=e;function n(r){let i=r;return i&&G.string(i.name)&&G.number(i.kind)&&it.is(i.range)&&it.is(i.selectionRange)&&(i.detail===void 0||G.string(i.detail))&&(i.deprecated===void 0||
G.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}t.is=n})(sD||(sD={}));var aD;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(aD||(aD={}));var cp;(function(t){t.Invoked=1,t.Automatic=2})(cp||(cp={}));var oD;
(function(t){function e(r,i,s){let a={diagnostics:r};return i!=null&&(a.only=i),s!=null&&(a.triggerKind=s),a}t.create=e;function n(r){let i=r;return G.defined(i)&&G.typedArray(i.diagnostics,op.is)&&(i.only===void 0||G.typedArray(i.only,G.string))&&(i.triggerKind===void 0||i.triggerKind===cp.Invoked||i.triggerKind===cp.Automatic)}t.is=n})(oD||(oD={}));var uD;(function(t){function e(r,i,s){let a={title:r},o=!0;return typeof i=="string"?(o=!1,a.kind=i):Lo.is(i)?a.command=i:a.edit=i,o&&s!==void 0&&(a.
kind=s),a}t.create=e;function n(r){let i=r;return i&&G.string(i.title)&&(i.diagnostics===void 0||G.typedArray(i.diagnostics,op.is))&&(i.kind===void 0||G.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||Lo.is(i.command))&&(i.isPreferred===void 0||G.boolean(i.isPreferred))&&(i.edit===void 0||Tv.is(i.edit))}t.is=n})(uD||(uD={}));var cD;(function(t){function e(r,i){let s={range:r};return G.defined(i)&&(s.data=i),s}t.create=e;function n(r){let i=r;return G.defined(i)&&it.is(
i.range)&&(G.undefined(i.command)||Lo.is(i.command))}t.is=n})(cD||(cD={}));var lD;(function(t){function e(r,i){return{tabSize:r,insertSpaces:i}}t.create=e;function n(r){let i=r;return G.defined(i)&&G.uinteger(i.tabSize)&&G.boolean(i.insertSpaces)}t.is=n})(lD||(lD={}));var dD;(function(t){function e(r,i,s){return{range:r,target:i,data:s}}t.create=e;function n(r){let i=r;return G.defined(i)&&it.is(i.range)&&(G.undefined(i.target)||G.string(i.target))}t.is=n})(dD||(dD={}));var fD;(function(t){function e(r,i){
return{range:r,parent:i}}t.create=e;function n(r){let i=r;return G.objectLiteral(i)&&it.is(i.range)&&(i.parent===void 0||t.is(i.parent))}t.is=n})(fD||(fD={}));var Je;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="ke\
yword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(Je||(Je={}));var ut;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(ut||(ut={}));var hD;(function(t){function e(n){const r=n;return G.
objectLiteral(r)&&(r.resultId===void 0||typeof r.resultId=="string")&&Array.isArray(r.data)&&(r.data.length===0||typeof r.data[0]=="number")}t.is=e})(hD||(hD={}));var pD;(function(t){function e(r,i){return{range:r,text:i}}t.create=e;function n(r){const i=r;return i!=null&&it.is(i.range)&&G.string(i.text)}t.is=n})(pD||(pD={}));var mD;(function(t){function e(r,i,s){return{range:r,variableName:i,caseSensitiveLookup:s}}t.create=e;function n(r){const i=r;return i!=null&&it.is(i.range)&&G.boolean(i.caseSensitiveLookup)&&
(G.string(i.variableName)||i.variableName===void 0)}t.is=n})(mD||(mD={}));var gD;(function(t){function e(r,i){return{range:r,expression:i}}t.create=e;function n(r){const i=r;return i!=null&&it.is(i.range)&&(G.string(i.expression)||i.expression===void 0)}t.is=n})(gD||(gD={}));var yD;(function(t){function e(r,i){return{frameId:r,stoppedLocation:i}}t.create=e;function n(r){const i=r;return G.defined(i)&&it.is(r.stoppedLocation)}t.is=n})(yD||(yD={}));var _v;(function(t){t.Type=1,t.Parameter=2;function e(n){
return n===1||n===2}t.is=e})(_v||(_v={}));var Av;(function(t){function e(r){return{value:r}}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&(i.tooltip===void 0||G.string(i.tooltip)||Uc.is(i.tooltip))&&(i.location===void 0||ap.is(i.location))&&(i.command===void 0||Lo.is(i.command))}t.is=n})(Av||(Av={}));var vD;(function(t){function e(r,i,s){const a={position:r,label:i};return s!==void 0&&(a.kind=s),a}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&yt.is(i.position)&&(G.
string(i.label)||G.typedArray(i.label,Av.is))&&(i.kind===void 0||_v.is(i.kind))&&i.textEdits===void 0||G.typedArray(i.textEdits,sr.is)&&(i.tooltip===void 0||G.string(i.tooltip)||Uc.is(i.tooltip))&&(i.paddingLeft===void 0||G.boolean(i.paddingLeft))&&(i.paddingRight===void 0||G.boolean(i.paddingRight))}t.is=n})(vD||(vD={}));var wD;(function(t){function e(n){return{kind:"snippet",value:n}}t.createSnippet=e})(wD||(wD={}));var bD;(function(t){function e(n,r,i,s){return{insertText:n,filterText:r,range:i,
command:s}}t.create=e})(bD||(bD={}));var ED;(function(t){function e(n){return{items:n}}t.create=e})(ED||(ED={}));var kD;(function(t){t.Invoked=0,t.Automatic=1})(kD||(kD={}));var RD;(function(t){function e(n,r){return{range:n,text:r}}t.create=e})(RD||(RD={}));var $D;(function(t){function e(n,r){return{triggerKind:n,selectedCompletionInfo:r}}t.create=e})($D||($D={}));var DD;(function(t){function e(n){const r=n;return G.objectLiteral(r)&&vv.is(r.uri)&&G.string(r.name)}t.is=e})(DD||(DD={}));var TD;(function(t){
function e(s,a,o,u){return new x3(s,a,o,u)}t.create=e;function n(s){let a=s;return!!(G.defined(a)&&G.string(a.uri)&&(G.undefined(a.languageId)||G.string(a.languageId))&&G.uinteger(a.lineCount)&&G.func(a.getText)&&G.func(a.positionAt)&&G.func(a.offsetAt))}t.is=n;function r(s,a){let o=s.getText(),u=i(a,(l,f)=>{let d=l.range.start.line-f.range.start.line;return d===0?l.range.start.character-f.range.start.character:d}),c=o.length;for(let l=u.length-1;l>=0;l--){let f=u[l],d=s.offsetAt(f.range.start),
h=s.offsetAt(f.range.end);if(h<=c)o=o.substring(0,d)+f.newText+o.substring(h,o.length);else throw new Error("Overlapping edit");c=d}return o}t.applyEdits=r;function i(s,a){if(s.length<=1)return s;const o=s.length/2|0,u=s.slice(0,o),c=s.slice(o);i(u,a),i(c,a);let l=0,f=0,d=0;for(;l<u.length&&f<c.length;)a(u[l],c[f])<=0?s[d++]=u[l++]:s[d++]=c[f++];for(;l<u.length;)s[d++]=u[l++];for(;f<c.length;)s[d++]=c[f++];return s}})(TD||(TD={}));let x3=class{constructor(e,n,r,i){this._uri=e,this._languageId=n,
this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}update(e,n){this._content=e.text,this._version=n,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let e=[],n=this._content,r=!0;for(let i=0;i<n.length;i++){r&&(e.push(i),r=!1);let s=n.charAt(
i);r=s==="\r"||s===`
`,s==="\r"&&i+1<n.length&&n.charAt(i+1)===`
`&&i++}r&&n.length>0&&e.push(n.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let n=this.getLineOffsets(),r=0,i=n.length;if(i===0)return yt.create(0,e);for(;r<i;){let a=Math.floor((r+i)/2);n[a]>e?i=a:r=a+1}let s=r-1;return yt.create(s,e-n[s])}offsetAt(e){let n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;let r=n[e.line],i=e.line+1<n.length?n[e.line+1]:this._content.length;return Math.
max(Math.min(r+e.character,i),r)}get lineCount(){return this.getLineOffsets().length}};var G;(function(t){const e=Object.prototype.toString;function n(h){return typeof h<"u"}t.defined=n;function r(h){return typeof h>"u"}t.undefined=r;function i(h){return h===!0||h===!1}t.boolean=i;function s(h){return e.call(h)==="[object String]"}t.string=s;function a(h){return e.call(h)==="[object Number]"}t.number=a;function o(h,p,w){return e.call(h)==="[object Number]"&&p<=h&&h<=w}t.numberRange=o;function u(h){
return e.call(h)==="[object Number]"&&-2147483648<=h&&h<=2147483647}t.integer=u;function c(h){return e.call(h)==="[object Number]"&&0<=h&&h<=2147483647}t.uinteger=c;function l(h){return e.call(h)==="[object Function]"}t.func=l;function f(h){return h!==null&&typeof h=="object"}t.objectLiteral=f;function d(h,p){return Array.isArray(h)&&h.every(p)}t.typedArray=d})(G||(G={}));class P3{constructor(){this.nodeStack=[]}get current(){var e;return(e=this.nodeStack[this.nodeStack.length-1])!==null&&e!==void 0?
e:this.rootNode}buildRootNode(e){return this.rootNode=new CD(e),this.rootNode.root=this.rootNode,this.nodeStack=[this.rootNode],this.rootNode}buildCompositeNode(e){const n=new Pv;return n.grammarSource=e,n.root=this.rootNode,this.current.content.push(n),this.nodeStack.push(n),n}buildLeafNode(e,n){const r=new xv(e.startOffset,e.image.length,Hg(e),e.tokenType,!n);return r.grammarSource=n,r.root=this.rootNode,this.current.content.push(r),r}removeNode(e){const n=e.container;if(n){const r=n.content.indexOf(
e);r>=0&&n.content.splice(r,1)}}addHiddenNodes(e){const n=[];for(const s of e){const a=new xv(s.startOffset,s.image.length,Hg(s),s.tokenType,!0);a.root=this.rootNode,n.push(a)}let r=this.current,i=!1;if(r.content.length>0){r.content.push(...n);return}for(;r.container;){const s=r.container.content.indexOf(r);if(s>0){r.container.content.splice(s,0,...n),i=!0;break}r=r.container}i||this.rootNode.content.unshift(...n)}construct(e){const n=this.current;typeof e.$type=="string"&&(this.current.astNode=
e),e.$cstNode=n;const r=this.nodeStack.pop();r?.content.length===0&&this.removeNode(r)}}class SD{get parent(){return this.container}get feature(){return this.grammarSource}get hidden(){return!1}get astNode(){var e,n;const r=typeof((e=this._astNode)===null||e===void 0?void 0:e.$type)=="string"?this._astNode:(n=this.container)===null||n===void 0?void 0:n.astNode;if(!r)throw new Error("This node has no associated AST element");return r}set astNode(e){this._astNode=e}get element(){return this.astNode}get text(){
return this.root.fullText.substring(this.offset,this.end)}}class xv extends SD{get offset(){return this._offset}get length(){return this._length}get end(){return this._offset+this._length}get hidden(){return this._hidden}get tokenType(){return this._tokenType}get range(){return this._range}constructor(e,n,r,i,s=!1){super(),this._hidden=s,this._offset=e,this._tokenType=i,this._length=n,this._range=r}}class Pv extends SD{constructor(){super(...arguments),this.content=new $0(this)}get children(){return this.
content}get offset(){var e,n;return(n=(e=this.firstNonHiddenNode)===null||e===void 0?void 0:e.offset)!==null&&n!==void 0?n:0}get length(){return this.end-this.offset}get end(){var e,n;return(n=(e=this.lastNonHiddenNode)===null||e===void 0?void 0:e.end)!==null&&n!==void 0?n:0}get range(){const e=this.firstNonHiddenNode,n=this.lastNonHiddenNode;if(e&&n){if(this._rangeCache===void 0){const{range:r}=e,{range:i}=n;this._rangeCache={start:r.start,end:i.end.line<r.start.line?r.start:i.end}}return this.
_rangeCache}else return{start:yt.create(0,0),end:yt.create(0,0)}}get firstNonHiddenNode(){for(const e of this.content)if(!e.hidden)return e;return this.content[0]}get lastNonHiddenNode(){for(let e=this.content.length-1;e>=0;e--){const n=this.content[e];if(!n.hidden)return n}return this.content[this.content.length-1]}}class $0 extends Array{constructor(e){super(),this.parent=e,Object.setPrototypeOf(this,$0.prototype)}push(...e){return this.addParents(e),super.push(...e)}unshift(...e){return this.
addParents(e),super.unshift(...e)}splice(e,n,...r){return this.addParents(r),super.splice(e,n,...r)}addParents(e){for(const n of e)n.container=this.parent}}class CD extends Pv{get text(){return this._text.substring(this.offset,this.end)}get fullText(){return this._text}constructor(e){super(),this._text="",this._text=e??""}}const Nv=Symbol("Datatype");function Iv(t){return t.$type===Nv}const _D="\u200B",AD=t=>t.endsWith(_D)?t:t+_D;class xD{constructor(e){this._unorderedGroups=new Map,this.allRules=
new Map,this.lexer=e.parser.Lexer;const n=this.lexer.definition,r=e.LanguageMetaData.mode==="production";this.wrapper=new F3(n,Object.assign(Object.assign({},e.parser.ParserConfig),{skipValidations:r,errorMessageProvider:e.parser.ParserErrorMessageProvider}))}alternatives(e,n){this.wrapper.wrapOr(e,n)}optional(e,n){this.wrapper.wrapOption(e,n)}many(e,n){this.wrapper.wrapMany(e,n)}atLeastOne(e,n){this.wrapper.wrapAtLeastOne(e,n)}getRule(e){return this.allRules.get(e)}isRecording(){return this.wrapper.
IS_RECORDING}get unorderedGroups(){return this._unorderedGroups}getRuleStack(){return this.wrapper.RULE_STACK}finalize(){this.wrapper.wrapSelfAnalysis()}}class N3 extends xD{get current(){return this.stack[this.stack.length-1]}constructor(e){super(e),this.nodeBuilder=new P3,this.stack=[],this.assignmentMap=new Map,this.linker=e.references.Linker,this.converter=e.parser.ValueConverter,this.astReflection=e.shared.AstReflection}rule(e,n){const r=this.computeRuleType(e),i=this.wrapper.DEFINE_RULE(AD(
e.name),this.startImplementation(r,n).bind(this));return this.allRules.set(e.name,i),e.entry&&(this.mainRule=i),i}computeRuleType(e){if(!e.fragment){if(wh(e))return Nv;{const n=la(e);return n??e.name}}}parse(e,n={}){this.nodeBuilder.buildRootNode(e);const r=this.lexerResult=this.lexer.tokenize(e);this.wrapper.input=r.tokens;const i=n.rule?this.allRules.get(n.rule):this.mainRule;if(!i)throw new Error(n.rule?`No rule found with name '${n.rule}'`:"No main rule available.");const s=i.call(this.wrapper,
{});return this.nodeBuilder.addHiddenNodes(r.hidden),this.unorderedGroups.clear(),this.lexerResult=void 0,{value:s,lexerErrors:r.errors,lexerReport:r.report,parserErrors:this.wrapper.errors}}startImplementation(e,n){return r=>{const i=!this.isRecording()&&e!==void 0;if(i){const a={$type:e};this.stack.push(a),e===Nv&&(a.value="")}let s;try{s=n(r)}catch{s=void 0}return s===void 0&&i&&(s=this.construct()),s}}extractHiddenTokens(e){const n=this.lexerResult.hidden;if(!n.length)return[];const r=e.startOffset;
for(let i=0;i<n.length;i++)if(n[i].startOffset>r)return n.splice(0,i);return n.splice(0,n.length)}consume(e,n,r){const i=this.wrapper.wrapConsume(e,n);if(!this.isRecording()&&this.isValidToken(i)){const s=this.extractHiddenTokens(i);this.nodeBuilder.addHiddenNodes(s);const a=this.nodeBuilder.buildLeafNode(i,r),{assignment:o,isCrossRef:u}=this.getAssignment(r),c=this.current;if(o){const l=pi(r)?i.image:this.converter.convert(i.image,a);this.assign(o.operator,o.feature,l,a,u)}else if(Iv(c)){let l=i.
image;pi(r)||(l=this.converter.convert(l,a).toString()),c.value+=l}}}isValidToken(e){return!e.isInsertedInRecovery&&!isNaN(e.startOffset)&&typeof e.endOffset=="number"&&!isNaN(e.endOffset)}subrule(e,n,r,i,s){let a;!this.isRecording()&&!r&&(a=this.nodeBuilder.buildCompositeNode(i));const o=this.wrapper.wrapSubrule(e,n,s);!this.isRecording()&&a&&a.length>0&&this.performSubruleAssignment(o,i,a)}performSubruleAssignment(e,n,r){const{assignment:i,isCrossRef:s}=this.getAssignment(n);if(i)this.assign(i.
operator,i.feature,e,r,s);else if(!i){const a=this.current;if(Iv(a))a.value+=e.toString();else if(typeof e=="object"&&e){const u=this.assignWithoutOverride(e,a);this.stack.pop(),this.stack.push(u)}}}action(e,n){if(!this.isRecording()){let r=this.current;if(n.feature&&n.operator){r=this.construct(),this.nodeBuilder.removeNode(r.$cstNode),this.nodeBuilder.buildCompositeNode(n).content.push(r.$cstNode);const s={$type:e};this.stack.push(s),this.assign(n.operator,n.feature,r,r.$cstNode,!1)}else r.$type=
e}}construct(){if(this.isRecording())return;const e=this.current;return iy(e),this.nodeBuilder.construct(e),this.stack.pop(),Iv(e)?this.converter.convert(e.value,e.$cstNode):(ay(this.astReflection,e),e)}getAssignment(e){if(!this.assignmentMap.has(e)){const n=cr(e,hi);this.assignmentMap.set(e,{assignment:n,isCrossRef:n?sc(n.terminal):!1})}return this.assignmentMap.get(e)}assign(e,n,r,i,s){const a=this.current;let o;switch(s&&typeof r=="string"?o=this.linker.buildReference(a,n,i,r):o=r,e){case"=":{
a[n]=o;break}case"?=":{a[n]=!0;break}case"+=":Array.isArray(a[n])||(a[n]=[]),a[n].push(o)}}assignWithoutOverride(e,n){for(const[i,s]of Object.entries(n)){const a=e[i];a===void 0?e[i]=s:Array.isArray(a)&&Array.isArray(s)&&(s.push(...a),e[i]=s)}const r=e.$cstNode;return r&&(r.astNode=void 0,e.$cstNode=void 0),e}get definitionErrors(){return this.wrapper.definitionErrors}}class I3{buildMismatchTokenMessage(e){return No.buildMismatchTokenMessage(e)}buildNotAllInputParsedMessage(e){return No.buildNotAllInputParsedMessage(
e)}buildNoViableAltMessage(e){return No.buildNoViableAltMessage(e)}buildEarlyExitMessage(e){return No.buildEarlyExitMessage(e)}}class PD extends I3{buildMismatchTokenMessage({expected:e,actual:n}){return`Expecting ${e.LABEL?"`"+e.LABEL+"`":e.name.endsWith(":KW")?`keyword '${e.name.substring(0,e.name.length-3)}'`:`token of type '${e.name}'`} but found \`${n.image}\`.`}buildNotAllInputParsedMessage({firstRedundant:e}){return`Expecting end of file but found \`${e.image}\`.`}}class O3 extends xD{constructor(){
super(...arguments),this.tokens=[],this.elementStack=[],this.lastElementStack=[],this.nextTokenIndex=0,this.stackSize=0}action(){}construct(){}parse(e){this.resetState();const n=this.lexer.tokenize(e,{mode:"partial"});return this.tokens=n.tokens,this.wrapper.input=[...this.tokens],this.mainRule.call(this.wrapper,{}),this.unorderedGroups.clear(),{tokens:this.tokens,elementStack:[...this.lastElementStack],tokenIndex:this.nextTokenIndex}}rule(e,n){const r=this.wrapper.DEFINE_RULE(AD(e.name),this.startImplementation(
n).bind(this));return this.allRules.set(e.name,r),e.entry&&(this.mainRule=r),r}resetState(){this.elementStack=[],this.lastElementStack=[],this.nextTokenIndex=0,this.stackSize=0}startImplementation(e){return n=>{const r=this.keepStackSize();try{e(n)}finally{this.resetStackSize(r)}}}removeUnexpectedElements(){this.elementStack.splice(this.stackSize)}keepStackSize(){const e=this.elementStack.length;return this.stackSize=e,e}resetStackSize(e){this.removeUnexpectedElements(),this.stackSize=e}consume(e,n,r){
this.wrapper.wrapConsume(e,n),this.isRecording()||(this.lastElementStack=[...this.elementStack,r],this.nextTokenIndex=this.currIdx+1)}subrule(e,n,r,i,s){this.before(i),this.wrapper.wrapSubrule(e,n,s),this.after(i)}before(e){this.isRecording()||this.elementStack.push(e)}after(e){if(!this.isRecording()){const n=this.elementStack.lastIndexOf(e);n>=0&&this.elementStack.splice(n)}}get currIdx(){return this.wrapper.currIdx}}const L3={recoveryEnabled:!0,nodeLocationTracking:"full",skipValidations:!0,errorMessageProvider:new PD};
class F3 extends z4{constructor(e,n){const r=n&&"maxLookahead"in n;super(e,Object.assign(Object.assign(Object.assign({},L3),{lookaheadStrategy:r?new cv({maxLookahead:n.maxLookahead}):new d3({logging:n.skipValidations?()=>{}:void 0})}),n))}get IS_RECORDING(){return this.RECORDING_PHASE}DEFINE_RULE(e,n){return this.RULE(e,n)}wrapSelfAnalysis(){this.performSelfAnalysis()}wrapConsume(e,n){return this.consume(e,n)}wrapSubrule(e,n,r){return this.subrule(e,n,{ARGS:[r]})}wrapOr(e,n){this.or(e,n)}wrapOption(e,n){
this.option(e,n)}wrapMany(e,n){this.many(e,n)}wrapAtLeastOne(e,n){this.atLeastOne(e,n)}}function ND(t,e,n){return M3({parser:e,tokens:n,ruleNames:new Map},t),e}function M3(t,e){const n=dy(e,!1),r=rt(e.rules).filter(Sn).filter(i=>n.has(i));for(const i of r){const s=Object.assign(Object.assign({},t),{consume:1,optional:1,subrule:1,many:1,or:1});t.parser.rule(i,ba(s,i.definition))}}function ba(t,e,n=!1){let r;if(pi(e))r=W3(t,e);else if(ca(e))r=j3(t,e);else if(hi(e))r=ba(t,e.terminal);else if(sc(e))
r=ID(t,e);else if(Pi(e))r=B3(t,e);else if(ny(e))r=G3(t,e);else if(ry(e))r=U3(t,e);else if(Rs(e))r=z3(t,e);else if(NO(e)){const i=t.consume++;r=()=>t.parser.consume(i,Ss,e)}else throw new ME(e.$cstNode,`Unexpected element type: ${e.$type}`);return OD(t,n?void 0:lp(e),r,e.cardinality)}function j3(t,e){const n=Ec(e);return()=>t.parser.action(n,e)}function B3(t,e){const n=e.rule.ref;if(Sn(n)){const r=t.subrule++,i=n.fragment,s=e.arguments.length>0?q3(n,e.arguments):()=>({});return a=>t.parser.subrule(
r,LD(t,n),i,e,s(a))}else if(xi(n)){const r=t.consume++,i=Ov(t,n.name);return()=>t.parser.consume(r,i,e)}else if(n)ju();else throw new ME(e.$cstNode,`Undefined rule: ${e.rule.$refText}`)}function q3(t,e){const n=e.map(r=>qi(r.value));return r=>{const i={};for(let s=0;s<n.length;s++){const a=t.parameters[s],o=n[s];i[a.name]=o(r)}return i}}function qi(t){if(TO(t)){const e=qi(t.left),n=qi(t.right);return r=>e(r)||n(r)}else if(DO(t)){const e=qi(t.left),n=qi(t.right);return r=>e(r)&&n(r)}else if(SO(t)){
const e=qi(t.value);return n=>!e(n)}else if(CO(t)){const e=t.parameter.ref.name;return n=>n!==void 0&&n[e]===!0}else if($O(t)){const e=!!t.true;return()=>e}ju()}function G3(t,e){if(e.elements.length===1)return ba(t,e.elements[0]);{const n=[];for(const i of e.elements){const s={ALT:ba(t,i,!0)},a=lp(i);a&&(s.GATE=qi(a)),n.push(s)}const r=t.or++;return i=>t.parser.alternatives(r,n.map(s=>{const a={ALT:()=>s.ALT(i)},o=s.GATE;return o&&(a.GATE=()=>o(i)),a}))}}function U3(t,e){if(e.elements.length===1)
return ba(t,e.elements[0]);const n=[];for(const o of e.elements){const u={ALT:ba(t,o,!0)},c=lp(o);c&&(u.GATE=qi(c)),n.push(u)}const r=t.or++,i=(o,u)=>{const c=u.getRuleStack().join("-");return`uGroup_${o}_${c}`},s=o=>t.parser.alternatives(r,n.map((u,c)=>{const l={ALT:()=>!0},f=t.parser;l.ALT=()=>{if(u.ALT(o),!f.isRecording()){const h=i(r,f);f.unorderedGroups.get(h)||f.unorderedGroups.set(h,[]);const p=f.unorderedGroups.get(h);typeof p?.[c]>"u"&&(p[c]=!0)}};const d=u.GATE;return d?l.GATE=()=>d(o):
l.GATE=()=>{const h=f.unorderedGroups.get(i(r,f));return!h?.[c]},l})),a=OD(t,lp(e),s,"*");return o=>{a(o),t.parser.isRecording()||t.parser.unorderedGroups.delete(i(r,t.parser))}}function z3(t,e){const n=e.elements.map(r=>ba(t,r));return r=>n.forEach(i=>i(r))}function lp(t){if(Rs(t))return t.guardCondition}function ID(t,e,n=e.terminal){if(n)if(Pi(n)&&Sn(n.rule.ref)){const r=n.rule.ref,i=t.subrule++;return s=>t.parser.subrule(i,LD(t,r),!1,e,s)}else if(Pi(n)&&xi(n.rule.ref)){const r=t.consume++,i=Ov(
t,n.rule.ref.name);return()=>t.parser.consume(r,i,e)}else if(pi(n)){const r=t.consume++,i=Ov(t,n.value);return()=>t.parser.consume(r,i,e)}else throw new Error("Could not build cross reference parser");else{if(!e.type.ref)throw new Error("Could not resolve reference to type: "+e.type.$refText);const r=gy(e.type.ref),i=r?.terminal;if(!i)throw new Error("Could not find name assignment for type: "+Ec(e.type.ref));return ID(t,e,i)}}function W3(t,e){const n=t.consume++,r=t.tokens[e.value];if(!r)throw new Error(
"Could not find token for keyword: "+e.value);return()=>t.parser.consume(n,r,e)}function OD(t,e,n,r){const i=e&&qi(e);if(!r)if(i){const s=t.or++;return a=>t.parser.alternatives(s,[{ALT:()=>n(a),GATE:()=>i(a)},{ALT:y$(),GATE:()=>!i(a)}])}else return n;if(r==="*"){const s=t.many++;return a=>t.parser.many(s,{DEF:()=>n(a),GATE:i?()=>i(a):void 0})}else if(r==="+"){const s=t.many++;if(i){const a=t.or++;return o=>t.parser.alternatives(a,[{ALT:()=>t.parser.atLeastOne(s,{DEF:()=>n(o)}),GATE:()=>i(o)},{ALT:y$(),
GATE:()=>!i(o)}])}else return a=>t.parser.atLeastOne(s,{DEF:()=>n(a)})}else if(r==="?"){const s=t.optional++;return a=>t.parser.optional(s,{DEF:()=>n(a),GATE:i?()=>i(a):void 0})}else ju()}function LD(t,e){const n=H3(t,e),r=t.parser.getRule(n);if(!r)throw new Error(`Rule "${n}" not found."`);return r}function H3(t,e){if(Sn(e))return e.name;if(t.ruleNames.has(e))return t.ruleNames.get(e);{let n=e,r=n.$container,i=e.$type;for(;!Sn(r);)(Rs(r)||ny(r)||ry(r))&&(i=r.elements.indexOf(n).toString()+":"+i),
n=r,r=r.$container;return i=r.name+":"+i,t.ruleNames.set(e,i),i}}function Ov(t,e){const n=t.tokens[e];if(!n)throw new Error(`Token "${e}" not found."`);return n}function V3(t){const e=t.Grammar,n=t.parser.Lexer,r=new O3(t);return ND(e,r,n.definition),r.finalize(),r}function K3(t){const e=Z3(t);return e.finalize(),e}function Z3(t){const e=t.Grammar,n=t.parser.Lexer,r=new N3(t);return ND(e,r,n.definition)}class X3{constructor(){this.diagnostics=[]}buildTokens(e,n){const r=rt(dy(e,!1)),i=this.buildTerminalTokens(
r),s=this.buildKeywordTokens(r,i,n);return i.forEach(a=>{const o=a.PATTERN;typeof o=="object"&&o&&"test"in o&&ly(o)?s.unshift(a):s.push(a)}),s}flushLexingReport(e){return{diagnostics:this.popDiagnostics()}}popDiagnostics(){const e=[...this.diagnostics];return this.diagnostics=[],e}buildTerminalTokens(e){return e.filter(xi).filter(n=>!n.fragment).map(n=>this.buildTerminalToken(n)).toArray()}buildTerminalToken(e){const n=kc(e),r=this.requiresCustomPattern(n)?this.regexPatternFunction(n):n,i={name:e.
name,PATTERN:r};return typeof r=="function"&&(i.LINE_BREAKS=!0),e.hidden&&(i.GROUP=ly(n)?ir.SKIPPED:"hidden"),i}requiresCustomPattern(e){return e.flags.includes("u")||e.flags.includes("s")?!0:!!(e.source.includes("?<=")||e.source.includes("?<!"))}regexPatternFunction(e){const n=new RegExp(e,e.flags+"y");return(r,i)=>(n.lastIndex=i,n.exec(r))}buildKeywordTokens(e,n,r){return e.filter(Sn).flatMap(i=>gi(i).filter(pi)).distinct(i=>i.value).toArray().sort((i,s)=>s.value.length-i.value.length).map(i=>this.
buildKeywordToken(i,n,!!r?.caseInsensitive))}buildKeywordToken(e,n,r){const i=this.buildKeywordPattern(e,r),s={name:e.value,PATTERN:i,LONGER_ALT:this.findLongerAlt(e,n)};return typeof i=="function"&&(s.LINE_BREAKS=!0),s}buildKeywordPattern(e,n){return n?new RegExp(KO(e.value)):e.value}findLongerAlt(e,n){return n.reduce((r,i)=>{const s=i?.PATTERN;return s?.source&&ZO("^"+s.source+"$",e.value)&&r.push(i),r},[])}}class Y3{convert(e,n){let r=n.grammarSource;if(sc(r)&&(r=fy(r)),Pi(r)){const i=r.rule.
ref;if(!i)throw new Error("This cst node was not parsed by a rule.");return this.runConverter(i,e,n)}return e}runConverter(e,n,r){var i;switch(e.name.toUpperCase()){case"INT":return Gi.convertInt(n);case"STRING":return Gi.convertString(n);case"ID":return Gi.convertID(n)}switch((i=sk(e))===null||i===void 0?void 0:i.toLowerCase()){case"number":return Gi.convertNumber(n);case"boolean":return Gi.convertBoolean(n);case"bigint":return Gi.convertBigint(n);case"date":return Gi.convertDate(n);default:return n}}}
var Gi;(function(t){function e(c){let l="";for(let f=1;f<c.length-1;f++){const d=c.charAt(f);if(d==="\\"){const h=c.charAt(++f);l+=n(h)}else l+=d}return l}t.convertString=e;function n(c){switch(c){case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";case"v":return"\v";case"0":return"\0";default:return c}}function r(c){return c.charAt(0)==="^"?c.substring(1):c}t.convertID=r;function i(c){return parseInt(c)}t.convertInt=i;function s(c){return BigInt(c)}t.convertBigint=s;function a(c){return new Date(c)}t.convertDate=a;function o(c){return Number(c)}t.convertNumber=o;function u(c){return c.toLowerCase()==="true"}t.convertBoolean=u})(Gi||(Gi={}));var Ea={},dp={},FD;function ka(){if(FD)return dp;FD=1,Object.
defineProperty(dp,"__esModule",{value:!0});let t;function e(){if(t===void 0)throw new Error("No runtime abstraction layer installed");return t}return function(n){function r(i){if(i===void 0)throw new Error("No runtime abstraction layer provided");t=i}n.install=r}(e||(e={})),dp.default=e,dp}var kn={},MD;function zc(){if(MD)return kn;MD=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.stringArray=kn.array=kn.func=kn.error=kn.number=kn.string=kn.boolean=void 0;function t(o){return o===!0||o===
!1}kn.boolean=t;function e(o){return typeof o=="string"||o instanceof String}kn.string=e;function n(o){return typeof o=="number"||o instanceof Number}kn.number=n;function r(o){return o instanceof Error}kn.error=r;function i(o){return typeof o=="function"}kn.func=i;function s(o){return Array.isArray(o)}kn.array=s;function a(o){return s(o)&&o.every(u=>e(u))}return kn.stringArray=a,kn}var Ra={},jD;function Mo(){if(jD)return Ra;jD=1,Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.Emitter=Ra.Event=
void 0;const t=ka();var e;(function(i){const s={dispose(){}};i.None=function(){return s}})(e||(Ra.Event=e={}));class n{add(s,a=null,o){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(s),this._contexts.push(a),Array.isArray(o)&&o.push({dispose:()=>this.remove(s,a)})}remove(s,a=null){if(!this._callbacks)return;let o=!1;for(let u=0,c=this._callbacks.length;u<c;u++)if(this._callbacks[u]===s)if(this._contexts[u]===a){this._callbacks.splice(u,1),this._contexts.splice(u,1);
return}else o=!0;if(o)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...s){if(!this._callbacks)return[];const a=[],o=this._callbacks.slice(0),u=this._contexts.slice(0);for(let c=0,l=o.length;c<l;c++)try{a.push(o[c].apply(u[c],s))}catch(f){(0,t.default)().console.error(f)}return a}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class r{constructor(s){this._options=s}get event(){
return this._event||(this._event=(s,a,o)=>{this._callbacks||(this._callbacks=new n),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(s,a);const u={dispose:()=>{this._callbacks&&(this._callbacks.remove(s,a),u.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(o)&&o.push(u),u}),this._event}fire(s){this._callbacks&&
this._callbacks.invoke.call(this._callbacks,s)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}return Ra.Emitter=r,r._noop=function(){},Ra}var BD;function fp(){if(BD)return Ea;BD=1,Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.CancellationTokenSource=Ea.CancellationToken=void 0;const t=ka(),e=zc(),n=Mo();var r;(function(o){o.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:n.Event.None}),o.Cancelled=Object.freeze({isCancellationRequested:!0,
onCancellationRequested:n.Event.None});function u(c){const l=c;return l&&(l===o.None||l===o.Cancelled||e.boolean(l.isCancellationRequested)&&!!l.onCancellationRequested)}o.is=u})(r||(Ea.CancellationToken=r={}));const i=Object.freeze(function(o,u){const c=(0,t.default)().timer.setTimeout(o.bind(u),0);return{dispose(){c.dispose()}}});class s{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){
return this._isCancelled}get onCancellationRequested(){return this._isCancelled?i:(this._emitter||(this._emitter=new n.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class a{get token(){return this._token||(this._token=new s),this._token}cancel(){this._token?this._token.cancel():this._token=r.Cancelled}dispose(){this._token?this._token instanceof s&&this._token.dispose():this._token=r.None}}return Ea.CancellationTokenSource=a,Ea}var Dt=fp();
function J3(){return new Promise(t=>{typeof setImmediate>"u"?setTimeout(t,0):setImmediate(t)})}let hp=0,Q3=10;function eG(){return hp=performance.now(),new Dt.CancellationTokenSource}const pp=Symbol("OperationCancelled");function mp(t){return t===pp}async function en(t){if(t===Dt.CancellationToken.None)return;const e=performance.now();if(e-hp>=Q3&&(hp=e,await J3(),hp=performance.now()),t.isCancellationRequested)throw pp}class Lv{constructor(){this.promise=new Promise((e,n)=>{this.resolve=r=>(e(r),
this),this.reject=r=>(n(r),this)})}}class Uf{constructor(e,n,r,i){this._uri=e,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){const n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}update(e,n){for(const r of e)if(Uf.isIncremental(r)){const i=UD(r.range),s=this.offsetAt(i.start),a=this.offsetAt(i.
end);this._content=this._content.substring(0,s)+r.text+this._content.substring(a,this._content.length);const o=Math.max(i.start.line,0),u=Math.max(i.end.line,0);let c=this._lineOffsets;const l=qD(r.text,!1,s);if(u-o===l.length)for(let d=0,h=l.length;d<h;d++)c[d+o+1]=l[d];else l.length<1e4?c.splice(o+1,u-o,...l):this._lineOffsets=c=c.slice(0,o+1).concat(l,c.slice(u+1));const f=r.text.length-(a-s);if(f!==0)for(let d=o+1+l.length,h=c.length;d<h;d++)c[d]=c[d]+f}else if(Uf.isFull(r))this._content=r.text,
this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=n}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=qD(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const n=this.getLineOffsets();let r=0,i=n.length;if(i===0)return{line:0,character:e};for(;r<i;){const a=Math.floor((r+i)/2);n[a]>e?i=a:r=a+1}const s=r-1;return e=this.ensureBeforeEOL(e,n[s]),{line:s,character:e-n[s]}}offsetAt(e){const n=this.
getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;const r=n[e.line];if(e.character<=0)return r;const i=e.line+1<n.length?n[e.line+1]:this._content.length,s=Math.min(r+e.character,i);return this.ensureBeforeEOL(s,r)}ensureBeforeEOL(e,n){for(;e>n&&GD(this._content.charCodeAt(e-1));)e--;return e}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){const n=e;return n!=null&&typeof n.text=="string"&&n.range!==void 0&&(n.rangeLength===void 0||
typeof n.rangeLength=="number")}static isFull(e){const n=e;return n!=null&&typeof n.text=="string"&&n.range===void 0&&n.rangeLength===void 0}}var gp;(function(t){function e(i,s,a,o){return new Uf(i,s,a,o)}t.create=e;function n(i,s,a){if(i instanceof Uf)return i.update(s,a),i;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=n;function r(i,s){const a=i.getText(),o=Fv(s.map(tG),(l,f)=>{const d=l.range.start.line-f.range.start.line;return d===0?l.range.
start.character-f.range.start.character:d});let u=0;const c=[];for(const l of o){const f=i.offsetAt(l.range.start);if(f<u)throw new Error("Overlapping edit");f>u&&c.push(a.substring(u,f)),l.newText.length&&c.push(l.newText),u=i.offsetAt(l.range.end)}return c.push(a.substr(u)),c.join("")}t.applyEdits=r})(gp||(gp={}));function Fv(t,e){if(t.length<=1)return t;const n=t.length/2|0,r=t.slice(0,n),i=t.slice(n);Fv(r,e),Fv(i,e);let s=0,a=0,o=0;for(;s<r.length&&a<i.length;)e(r[s],i[a])<=0?t[o++]=r[s++]:t[o++]=
i[a++];for(;s<r.length;)t[o++]=r[s++];for(;a<i.length;)t[o++]=i[a++];return t}function qD(t,e,n=0){const r=e?[n]:[];for(let i=0;i<t.length;i++){const s=t.charCodeAt(i);GD(s)&&(s===13&&i+1<t.length&&t.charCodeAt(i+1)===10&&i++,r.push(n+i+1))}return r}function GD(t){return t===13||t===10}function UD(t){const e=t.start,n=t.end;return e.line>n.line||e.line===n.line&&e.character>n.character?{start:n,end:e}:t}function tG(t){const e=UD(t.range);return e!==t.range?{newText:t.newText,range:e}:t}var zD;(()=>{
var t={975:B=>{function T(A){if(typeof A!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(A))}function $(A,P){for(var L,Q="",H=0,S=-1,re=0,ke=0;ke<=A.length;++ke){if(ke<A.length)L=A.charCodeAt(ke);else{if(L===47)break;L=47}if(L===47){if(!(S===ke-1||re===1))if(S!==ke-1&&re===2){if(Q.length<2||H!==2||Q.charCodeAt(Q.length-1)!==46||Q.charCodeAt(Q.length-2)!==46){if(Q.length>2){var je=Q.lastIndexOf("/");if(je!==Q.length-1){je===-1?(Q="",H=0):H=(Q=Q.slice(0,je)).length-
1-Q.lastIndexOf("/"),S=ke,re=0;continue}}else if(Q.length===2||Q.length===1){Q="",H=0,S=ke,re=0;continue}}P&&(Q.length>0?Q+="/..":Q="..",H=2)}else Q.length>0?Q+="/"+A.slice(S+1,ke):Q=A.slice(S+1,ke),H=ke-S-1;S=ke,re=0}else L===46&&re!==-1?++re:re=-1}return Q}var j={resolve:function(){for(var A,P="",L=!1,Q=arguments.length-1;Q>=-1&&!L;Q--){var H;Q>=0?H=arguments[Q]:(A===void 0&&(A=process.cwd()),H=A),T(H),H.length!==0&&(P=H+"/"+P,L=H.charCodeAt(0)===47)}return P=$(P,!L),L?P.length>0?"/"+P:"/":P.length>
0?P:"."},normalize:function(A){if(T(A),A.length===0)return".";var P=A.charCodeAt(0)===47,L=A.charCodeAt(A.length-1)===47;return(A=$(A,!P)).length!==0||P||(A="."),A.length>0&&L&&(A+="/"),P?"/"+A:A},isAbsolute:function(A){return T(A),A.length>0&&A.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var A,P=0;P<arguments.length;++P){var L=arguments[P];T(L),L.length>0&&(A===void 0?A=L:A+="/"+L)}return A===void 0?".":j.normalize(A)},relative:function(A,P){if(T(A),T(P),A===P||(A=
j.resolve(A))===(P=j.resolve(P)))return"";for(var L=1;L<A.length&&A.charCodeAt(L)===47;++L);for(var Q=A.length,H=Q-L,S=1;S<P.length&&P.charCodeAt(S)===47;++S);for(var re=P.length-S,ke=H<re?H:re,je=-1,M=0;M<=ke;++M){if(M===ke){if(re>ke){if(P.charCodeAt(S+M)===47)return P.slice(S+M+1);if(M===0)return P.slice(S+M)}else H>ke&&(A.charCodeAt(L+M)===47?je=M:M===0&&(je=0));break}var V=A.charCodeAt(L+M);if(V!==P.charCodeAt(S+M))break;V===47&&(je=M)}var Le="";for(M=L+je+1;M<=Q;++M)M!==Q&&A.charCodeAt(M)!==
47||(Le.length===0?Le+="..":Le+="/..");return Le.length>0?Le+P.slice(S+je):(S+=je,P.charCodeAt(S)===47&&++S,P.slice(S))},_makeLong:function(A){return A},dirname:function(A){if(T(A),A.length===0)return".";for(var P=A.charCodeAt(0),L=P===47,Q=-1,H=!0,S=A.length-1;S>=1;--S)if((P=A.charCodeAt(S))===47){if(!H){Q=S;break}}else H=!1;return Q===-1?L?"/":".":L&&Q===1?"//":A.slice(0,Q)},basename:function(A,P){if(P!==void 0&&typeof P!="string")throw new TypeError('"ext" argument must be a string');T(A);var L,
Q=0,H=-1,S=!0;if(P!==void 0&&P.length>0&&P.length<=A.length){if(P.length===A.length&&P===A)return"";var re=P.length-1,ke=-1;for(L=A.length-1;L>=0;--L){var je=A.charCodeAt(L);if(je===47){if(!S){Q=L+1;break}}else ke===-1&&(S=!1,ke=L+1),re>=0&&(je===P.charCodeAt(re)?--re==-1&&(H=L):(re=-1,H=ke))}return Q===H?H=ke:H===-1&&(H=A.length),A.slice(Q,H)}for(L=A.length-1;L>=0;--L)if(A.charCodeAt(L)===47){if(!S){Q=L+1;break}}else H===-1&&(S=!1,H=L+1);return H===-1?"":A.slice(Q,H)},extname:function(A){T(A);for(var P=-1,
L=0,Q=-1,H=!0,S=0,re=A.length-1;re>=0;--re){var ke=A.charCodeAt(re);if(ke!==47)Q===-1&&(H=!1,Q=re+1),ke===46?P===-1?P=re:S!==1&&(S=1):P!==-1&&(S=-1);else if(!H){L=re+1;break}}return P===-1||Q===-1||S===0||S===1&&P===Q-1&&P===L+1?"":A.slice(P,Q)},format:function(A){if(A===null||typeof A!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof A);return function(P,L){var Q=L.dir||L.root,H=L.base||(L.name||"")+(L.ext||"");return Q?Q===L.root?Q+H:Q+"/"+
H:H}(0,A)},parse:function(A){T(A);var P={root:"",dir:"",base:"",ext:"",name:""};if(A.length===0)return P;var L,Q=A.charCodeAt(0),H=Q===47;H?(P.root="/",L=1):L=0;for(var S=-1,re=0,ke=-1,je=!0,M=A.length-1,V=0;M>=L;--M)if((Q=A.charCodeAt(M))!==47)ke===-1&&(je=!1,ke=M+1),Q===46?S===-1?S=M:V!==1&&(V=1):S!==-1&&(V=-1);else if(!je){re=M+1;break}return S===-1||ke===-1||V===0||V===1&&S===ke-1&&S===re+1?ke!==-1&&(P.base=P.name=re===0&&H?A.slice(1,ke):A.slice(re,ke)):(re===0&&H?(P.name=A.slice(1,S),P.base=
A.slice(1,ke)):(P.name=A.slice(re,S),P.base=A.slice(re,ke)),P.ext=A.slice(S,ke)),re>0?P.dir=A.slice(0,re-1):H&&(P.dir="/"),P},sep:"/",delimiter:":",win32:null,posix:null};j.posix=j,B.exports=j}},e={};function n(B){var T=e[B];if(T!==void 0)return T.exports;var $=e[B]={exports:{}};return t[B]($,$.exports,n),$.exports}n.d=(B,T)=>{for(var $ in T)n.o(T,$)&&!n.o(B,$)&&Object.defineProperty(B,$,{enumerable:!0,get:T[$]})},n.o=(B,T)=>Object.prototype.hasOwnProperty.call(B,T),n.r=B=>{typeof Symbol<"u"&&Symbol.
toStringTag&&Object.defineProperty(B,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(B,"__esModule",{value:!0})};var r={};let i;n.r(r),n.d(r,{URI:()=>d,Utils:()=>$e}),typeof process=="object"?i=process.platform==="win32":typeof navigator=="object"&&(i=navigator.userAgent.indexOf("Windows")>=0);const s=/^\w[\w\d+.-]*$/,a=/^\//,o=/^\/\//;function u(B,T){if(!B.scheme&&T)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${B.authority}", path: "${B.path}", query: "${B.
query}", fragment: "${B.fragment}"}`);if(B.scheme&&!s.test(B.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(B.path){if(B.authority){if(!a.test(B.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(o.test(B.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}
const c="",l="/",f=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class d{static isUri(T){return T instanceof d||!!T&&typeof T.authority=="string"&&typeof T.fragment=="string"&&typeof T.path=="string"&&typeof T.query=="string"&&typeof T.scheme=="string"&&typeof T.fsPath=="string"&&typeof T.with=="function"&&typeof T.toString=="function"}scheme;authority;path;query;fragment;constructor(T,$,j,A,P,L=!1){typeof T=="object"?(this.scheme=T.scheme||c,this.authority=T.authority||c,this.path=
T.path||c,this.query=T.query||c,this.fragment=T.fragment||c):(this.scheme=function(Q,H){return Q||H?Q:"file"}(T,L),this.authority=$||c,this.path=function(Q,H){switch(Q){case"https":case"http":case"file":H?H[0]!==l&&(H=l+H):H=l}return H}(this.scheme,j||c),this.query=A||c,this.fragment=P||c,u(this,L))}get fsPath(){return b(this)}with(T){if(!T)return this;let{scheme:$,authority:j,path:A,query:P,fragment:L}=T;return $===void 0?$=this.scheme:$===null&&($=c),j===void 0?j=this.authority:j===null&&(j=c),
A===void 0?A=this.path:A===null&&(A=c),P===void 0?P=this.query:P===null&&(P=c),L===void 0?L=this.fragment:L===null&&(L=c),$===this.scheme&&j===this.authority&&A===this.path&&P===this.query&&L===this.fragment?this:new p($,j,A,P,L)}static parse(T,$=!1){const j=f.exec(T);return j?new p(j[2]||c,Z(j[4]||c),Z(j[5]||c),Z(j[7]||c),Z(j[9]||c),$):new p(c,c,c,c,c)}static file(T){let $=c;if(i&&(T=T.replace(/\\/g,l)),T[0]===l&&T[1]===l){const j=T.indexOf(l,2);j===-1?($=T.substring(2),T=l):($=T.substring(2,j),
T=T.substring(j)||l)}return new p("file",$,T,c,c)}static from(T){const $=new p(T.scheme,T.authority,T.path,T.query,T.fragment);return u($,!0),$}toString(T=!1){return k(this,T)}toJSON(){return this}static revive(T){if(T){if(T instanceof d)return T;{const $=new p(T);return $._formatted=T.external,$._fsPath=T._sep===h?T.fsPath:null,$}}return T}}const h=i?1:void 0;class p extends d{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=b(this)),this._fsPath}toString(T=!1){return T?
k(this,!0):(this._formatted||(this._formatted=k(this,!1)),this._formatted)}toJSON(){const T={$mid:1};return this._fsPath&&(T.fsPath=this._fsPath,T._sep=h),this._formatted&&(T.external=this._formatted),this.path&&(T.path=this.path),this.scheme&&(T.scheme=this.scheme),this.authority&&(T.authority=this.authority),this.query&&(T.query=this.query),this.fragment&&(T.fragment=this.fragment),T}}const w={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"\
%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function v(B,T,$){let j,A=-1;for(let P=0;P<B.length;P++){const L=B.charCodeAt(P);if(L>=97&&L<=122||L>=65&&L<=90||L>=48&&L<=57||L===45||L===46||L===95||L===126||T&&L===47||$&&L===91||$&&L===93||$&&L===58)A!==-1&&(j+=encodeURIComponent(B.substring(A,P)),A=-1),j!==void 0&&(j+=B.charAt(P));else{j===void 0&&(j=B.substr(0,P));const Q=w[L];Q!==void 0?(A!==-1&&(j+=encodeURIComponent(B.substring(A,P)),A=-1),j+=Q):A===-1&&(A=P)}}return A!==
-1&&(j+=encodeURIComponent(B.substring(A))),j!==void 0?j:B}function g(B){let T;for(let $=0;$<B.length;$++){const j=B.charCodeAt($);j===35||j===63?(T===void 0&&(T=B.substr(0,$)),T+=w[j]):T!==void 0&&(T+=B[$])}return T!==void 0?T:B}function b(B,T){let $;return $=B.authority&&B.path.length>1&&B.scheme==="file"?`//${B.authority}${B.path}`:B.path.charCodeAt(0)===47&&(B.path.charCodeAt(1)>=65&&B.path.charCodeAt(1)<=90||B.path.charCodeAt(1)>=97&&B.path.charCodeAt(1)<=122)&&B.path.charCodeAt(2)===58?B.path[1].
toLowerCase()+B.path.substr(2):B.path,i&&($=$.replace(/\//g,"\\")),$}function k(B,T){const $=T?g:v;let j="",{scheme:A,authority:P,path:L,query:Q,fragment:H}=B;if(A&&(j+=A,j+=":"),(P||A==="file")&&(j+=l,j+=l),P){let S=P.indexOf("@");if(S!==-1){const re=P.substr(0,S);P=P.substr(S+1),S=re.lastIndexOf(":"),S===-1?j+=$(re,!1,!1):(j+=$(re.substr(0,S),!1,!1),j+=":",j+=$(re.substr(S+1),!1,!0)),j+="@"}P=P.toLowerCase(),S=P.lastIndexOf(":"),S===-1?j+=$(P,!1,!0):(j+=$(P.substr(0,S),!1,!0),j+=P.substr(S))}if(L){
if(L.length>=3&&L.charCodeAt(0)===47&&L.charCodeAt(2)===58){const S=L.charCodeAt(1);S>=65&&S<=90&&(L=`/${String.fromCharCode(S+32)}:${L.substr(3)}`)}else if(L.length>=2&&L.charCodeAt(1)===58){const S=L.charCodeAt(0);S>=65&&S<=90&&(L=`${String.fromCharCode(S+32)}:${L.substr(2)}`)}j+=$(L,!0,!1)}return Q&&(j+="?",j+=$(Q,!1,!1)),H&&(j+="#",j+=T?H:v(H,!1,!1)),j}function _(B){try{return decodeURIComponent(B)}catch{return B.length>3?B.substr(0,3)+_(B.substr(3)):B}}const I=/(%[0-9A-Za-z][0-9A-Za-z])+/g;
function Z(B){return B.match(I)?B.replace(I,T=>_(T)):B}var J=n(975);const ue=J.posix||J,ae="/";var $e;(function(B){B.joinPath=function(T,...$){return T.with({path:ue.join(T.path,...$)})},B.resolvePath=function(T,...$){let j=T.path,A=!1;j[0]!==ae&&(j=ae+j,A=!0);let P=ue.resolve(j,...$);return A&&P[0]===ae&&!T.authority&&(P=P.substring(1)),T.with({path:P})},B.dirname=function(T){if(T.path.length===0||T.path===ae)return T;let $=ue.dirname(T.path);return $.length===1&&$.charCodeAt(0)===46&&($=""),T.
with({path:$})},B.basename=function(T){return ue.basename(T.path)},B.extname=function(T){return ue.extname(T.path)}})($e||($e={})),zD=r})();const{URI:_t,Utils:Wc}=zD;var Tt;(function(t){t.basename=Wc.basename,t.dirname=Wc.dirname,t.extname=Wc.extname,t.joinPath=Wc.joinPath,t.resolvePath=Wc.resolvePath;const e=typeof process=="object"&&(process==null?void 0:process.platform)==="win32";function n(s,a){return s?.toString()===a?.toString()}t.equals=n;function r(s,a){const o=typeof s=="string"?_t.parse(
s).path:s.path,u=typeof a=="string"?_t.parse(a).path:a.path,c=o.split("/").filter(p=>p.length>0),l=u.split("/").filter(p=>p.length>0);if(e){const p=/^[A-Z]:$/;if(c[0]&&p.test(c[0])&&(c[0]=c[0].toLowerCase()),l[0]&&p.test(l[0])&&(l[0]=l[0].toLowerCase()),c[0]!==l[0])return u.substring(1)}let f=0;for(;f<c.length&&c[f]===l[f];f++);const d="../".repeat(c.length-f),h=l.slice(f).join("/");return d+h}t.relative=r;function i(s){return _t.parse(s.toString()).toString()}t.normalize=i})(Tt||(Tt={}));var Ze;
(function(t){t[t.Changed=0]="Changed",t[t.Parsed=1]="Parsed",t[t.IndexedContent=2]="IndexedContent",t[t.ComputedScopes=3]="ComputedScopes",t[t.Linked=4]="Linked",t[t.IndexedReferences=5]="IndexedReferences",t[t.Validated=6]="Validated"})(Ze||(Ze={}));class nG{constructor(e){this.serviceRegistry=e.ServiceRegistry,this.textDocuments=e.workspace.TextDocuments,this.fileSystemProvider=e.workspace.FileSystemProvider}async fromUri(e,n=Dt.CancellationToken.None){const r=await this.fileSystemProvider.readFile(
e);return this.createAsync(e,r,n)}fromTextDocument(e,n,r){return n=n??_t.parse(e.uri),Dt.CancellationToken.is(r)?this.createAsync(n,e,r):this.create(n,e,r)}fromString(e,n,r){return Dt.CancellationToken.is(r)?this.createAsync(n,e,r):this.create(n,e,r)}fromModel(e,n){return this.create(n,{$model:e})}create(e,n,r){if(typeof n=="string"){const i=this.parse(e,n,r);return this.createLangiumDocument(i,e,void 0,n)}else if("$model"in n){const i={value:n.$model,parserErrors:[],lexerErrors:[]};return this.
createLangiumDocument(i,e)}else{const i=this.parse(e,n.getText(),r);return this.createLangiumDocument(i,e,n)}}async createAsync(e,n,r){if(typeof n=="string"){const i=await this.parseAsync(e,n,r);return this.createLangiumDocument(i,e,void 0,n)}else{const i=await this.parseAsync(e,n.getText(),r);return this.createLangiumDocument(i,e,n)}}createLangiumDocument(e,n,r,i){let s;if(r)s={parseResult:e,uri:n,state:Ze.Parsed,references:[],textDocument:r};else{const a=this.createTextDocumentGetter(n,i);s={parseResult:e,
uri:n,state:Ze.Parsed,references:[],get textDocument(){return a()}}}return e.value.$document=s,s}async update(e,n){var r,i;const s=(r=e.parseResult.value.$cstNode)===null||r===void 0?void 0:r.root.fullText,a=(i=this.textDocuments)===null||i===void 0?void 0:i.get(e.uri.toString()),o=a?a.getText():await this.fileSystemProvider.readFile(e.uri);if(a)Object.defineProperty(e,"textDocument",{value:a});else{const u=this.createTextDocumentGetter(e.uri,o);Object.defineProperty(e,"textDocument",{get:u})}return s!==
o&&(e.parseResult=await this.parseAsync(e.uri,o,n),e.parseResult.value.$document=e),e.state=Ze.Parsed,e}parse(e,n,r){return this.serviceRegistry.getServices(e).parser.LangiumParser.parse(n,r)}parseAsync(e,n,r){return this.serviceRegistry.getServices(e).parser.AsyncParser.parse(n,r)}createTextDocumentGetter(e,n){const r=this.serviceRegistry;let i;return()=>i??(i=gp.create(e.toString(),r.getServices(e).LanguageMetaData.languageId,0,n??""))}}class WD{constructor(e){this.documentMap=new Map,this.langiumDocumentFactory=
e.workspace.LangiumDocumentFactory,this.serviceRegistry=e.ServiceRegistry}get all(){return rt(this.documentMap.values())}addDocument(e){const n=e.uri.toString();if(this.documentMap.has(n))throw new Error(`A document with the URI '${n}' is already present.`);this.documentMap.set(n,e)}getDocument(e){const n=e.toString();return this.documentMap.get(n)}async getOrCreateDocument(e,n){let r=this.getDocument(e);return r||(r=await this.langiumDocumentFactory.fromUri(e,n),this.addDocument(r),r)}createDocument(e,n,r){
if(r)return this.langiumDocumentFactory.fromString(n,e,r).then(i=>(this.addDocument(i),i));{const i=this.langiumDocumentFactory.fromString(n,e);return this.addDocument(i),i}}hasDocument(e){return this.documentMap.has(e.toString())}invalidateDocument(e){const n=e.toString(),r=this.documentMap.get(n);return r&&(this.serviceRegistry.getServices(e).references.Linker.unlink(r),r.state=Ze.Changed,r.precomputedScopes=void 0,r.diagnostics=void 0),r}deleteDocument(e){const n=e.toString(),r=this.documentMap.
get(n);return r&&(r.state=Ze.Changed,this.documentMap.delete(n)),r}}const Mv=Symbol("ref_resolving");class rG{constructor(e){this.reflection=e.shared.AstReflection,this.langiumDocuments=()=>e.shared.workspace.LangiumDocuments,this.scopeProvider=e.references.ScopeProvider,this.astNodeLocator=e.workspace.AstNodeLocator}async link(e,n=Dt.CancellationToken.None){for(const r of Ni(e.parseResult.value))await en(n),fh(r).forEach(i=>this.doLink(i,e))}doLink(e,n){var r;const i=e.reference;if(i._ref===void 0){
i._ref=Mv;try{const s=this.getCandidate(e);if(Qf(s))i._ref=s;else if(i._nodeDescription=s,this.langiumDocuments().hasDocument(s.documentUri)){const a=this.loadAstNode(s);i._ref=a??this.createLinkingError(e,s)}else i._ref=void 0}catch(s){console.error(`An error occurred while resolving reference to '${i.$refText}':`,s);const a=(r=s.message)!==null&&r!==void 0?r:String(s);i._ref=Object.assign(Object.assign({},e),{message:`An error occurred while resolving reference to '${i.$refText}': ${a}`})}n.references.
push(i)}}unlink(e){for(const n of e.references)delete n._ref,delete n._nodeDescription;e.references=[]}getCandidate(e){const r=this.scopeProvider.getScope(e).getElement(e.reference.$refText);return r??this.createLinkingError(e)}buildReference(e,n,r,i){const s=this,a={$refNode:r,$refText:i,get ref(){var o;if(Mt(this._ref))return this._ref;if(pO(this._nodeDescription)){const u=s.loadAstNode(this._nodeDescription);this._ref=u??s.createLinkingError({reference:a,container:e,property:n},this._nodeDescription)}else if(this.
_ref===void 0){this._ref=Mv;const u=dh(e).$document,c=s.getLinkedNode({reference:a,container:e,property:n});if(c.error&&u&&u.state<Ze.ComputedScopes)return this._ref=void 0;this._ref=(o=c.node)!==null&&o!==void 0?o:c.error,this._nodeDescription=c.descr,u?.references.push(this)}else if(this._ref===Mv)throw new Error(`Cyclic reference resolution detected: ${s.astNodeLocator.getAstNodePath(e)}/${n} (symbol '${i}')`);return Mt(this._ref)?this._ref:void 0},get $nodeDescription(){return this._nodeDescription},
get error(){return Qf(this._ref)?this._ref:void 0}};return a}getLinkedNode(e){var n;try{const r=this.getCandidate(e);if(Qf(r))return{error:r};const i=this.loadAstNode(r);return i?{node:i,descr:r}:{descr:r,error:this.createLinkingError(e,r)}}catch(r){console.error(`An error occurred while resolving reference to '${e.reference.$refText}':`,r);const i=(n=r.message)!==null&&n!==void 0?n:String(r);return{error:Object.assign(Object.assign({},e),{message:`An error occurred while resolving reference to \
'${e.reference.$refText}': ${i}`})}}}loadAstNode(e){if(e.node)return e.node;const n=this.langiumDocuments().getDocument(e.documentUri);if(n)return this.astNodeLocator.getAstNode(n.parseResult.value,e.path)}createLinkingError(e,n){const r=dh(e.container).$document;r&&r.state<Ze.ComputedScopes&&console.warn(`Attempted reference resolution before document reached ComputedScopes state (${r.uri}).`);const i=this.reflection.getReferenceType(e);return Object.assign(Object.assign({},e),{message:`Could n\
ot resolve reference to ${i} named '${e.reference.$refText}'.`,targetDescription:n})}}function yp(t){return typeof t.name=="string"}class HD{getName(e){if(yp(e))return e.name}getNameNode(e){return Cn(e.$cstNode,"name")}}class iG{constructor(e){this.nameProvider=e.references.NameProvider,this.index=e.shared.workspace.IndexManager,this.nodeLocator=e.workspace.AstNodeLocator}findDeclaration(e){if(e){const n=QE(e),r=e.astNode;if(n&&r){const i=r[n.feature];if($r(i))return i.ref;if(Array.isArray(i)){for(const s of i)
if($r(s)&&s.$refNode&&s.$refNode.offset<=e.offset&&s.$refNode.end>=e.end)return s.ref}}if(r){const i=this.nameProvider.getNameNode(r);if(i&&(i===e||yO(e,i)))return r}}}findDeclarationNode(e){const n=this.findDeclaration(e);if(n?.$cstNode){const r=this.nameProvider.getNameNode(n);return r??n.$cstNode}}findReferences(e,n){const r=[];if(n.includeDeclaration){const s=this.getReferenceToSelf(e);s&&r.push(s)}let i=this.index.findAllReferences(e,this.nodeLocator.getAstNodePath(e));return n.documentUri&&
(i=i.filter(s=>Tt.equals(s.sourceUri,n.documentUri))),r.push(...i),rt(r)}getReferenceToSelf(e){const n=this.nameProvider.getNameNode(e);if(n){const r=vt(e),i=this.nodeLocator.getAstNodePath(e);return{sourceUri:r.uri,sourcePath:i,targetUri:r.uri,targetPath:i,segment:nh(n),local:!0}}}}class $a{constructor(e){if(this.map=new Map,e)for(const[n,r]of e)this.add(n,r)}get size(){return Wg.sum(rt(this.map.values()).map(e=>e.length))}clear(){this.map.clear()}delete(e,n){if(n===void 0)return this.map.delete(
e);{const r=this.map.get(e);if(r){const i=r.indexOf(n);if(i>=0)return r.length===1?this.map.delete(e):r.splice(i,1),!0}return!1}}get(e){var n;return(n=this.map.get(e))!==null&&n!==void 0?n:[]}has(e,n){if(n===void 0)return this.map.has(e);{const r=this.map.get(e);return r?r.indexOf(n)>=0:!1}}add(e,n){return this.map.has(e)?this.map.get(e).push(n):this.map.set(e,[n]),this}addAll(e,n){return this.map.has(e)?this.map.get(e).push(...n):this.map.set(e,Array.from(n)),this}forEach(e){this.map.forEach((n,r)=>n.
forEach(i=>e(i,r,this)))}[Symbol.iterator](){return this.entries().iterator()}entries(){return rt(this.map.entries()).flatMap(([e,n])=>n.map(r=>[e,r]))}keys(){return rt(this.map.keys())}values(){return rt(this.map.values()).flat()}entriesGroupedByKey(){return rt(this.map.entries())}}class VD{get size(){return this.map.size}constructor(e){if(this.map=new Map,this.inverse=new Map,e)for(const[n,r]of e)this.set(n,r)}clear(){this.map.clear(),this.inverse.clear()}set(e,n){return this.map.set(e,n),this.
inverse.set(n,e),this}get(e){return this.map.get(e)}getKey(e){return this.inverse.get(e)}delete(e){const n=this.map.get(e);return n!==void 0?(this.map.delete(e),this.inverse.delete(n),!0):!1}}class KD{constructor(e){this.nameProvider=e.references.NameProvider,this.descriptions=e.workspace.AstNodeDescriptionProvider}async computeExports(e,n=Dt.CancellationToken.None){return this.computeExportsForNode(e.parseResult.value,e,void 0,n)}async computeExportsForNode(e,n,r=vc,i=Dt.CancellationToken.None){
const s=[];this.exportNode(e,s,n);for(const a of r(e))await en(i),this.exportNode(a,s,n);return s}exportNode(e,n,r){const i=this.nameProvider.getName(e);i&&n.push(this.descriptions.createDescription(e,i,r))}async computeLocalScopes(e,n=Dt.CancellationToken.None){const r=e.parseResult.value,i=new $a;for(const s of gi(r))await en(n),this.processNode(s,e,i);return i}processNode(e,n,r){const i=e.$container;if(i){const s=this.nameProvider.getName(e);s&&r.add(i,this.descriptions.createDescription(e,s,
n))}}}class Da{constructor(e,n,r){var i;this.elements=e,this.outerScope=n,this.caseInsensitive=(i=r?.caseInsensitive)!==null&&i!==void 0?i:!1}getAllElements(){return this.outerScope?this.elements.concat(this.outerScope.getAllElements()):this.elements}getElement(e){const n=this.caseInsensitive?this.elements.find(r=>r.name.toLowerCase()===e.toLowerCase()):this.elements.find(r=>r.name===e);if(n)return n;if(this.outerScope)return this.outerScope.getElement(e)}}class ZD{constructor(e,n,r){var i;this.
elements=new Map,this.caseInsensitive=(i=r?.caseInsensitive)!==null&&i!==void 0?i:!1;for(const s of e){const a=this.caseInsensitive?s.name.toLowerCase():s.name;this.elements.set(a,s)}this.outerScope=n}getElement(e){const n=this.caseInsensitive?e.toLowerCase():e,r=this.elements.get(n);if(r)return r;if(this.outerScope)return this.outerScope.getElement(e)}getAllElements(){let e=rt(this.elements.values());return this.outerScope&&(e=e.concat(this.outerScope.getAllElements())),e}}const sG={getElement(){},
getAllElements(){return Mu}};class XD{constructor(){this.toDispose=[],this.isDisposed=!1}onDispose(e){this.toDispose.push(e)}dispose(){this.throwIfDisposed(),this.clear(),this.isDisposed=!0,this.toDispose.forEach(e=>e.dispose())}throwIfDisposed(){if(this.isDisposed)throw new Error("This cache has already been disposed")}}class aG extends XD{constructor(){super(...arguments),this.cache=new Map}has(e){return this.throwIfDisposed(),this.cache.has(e)}set(e,n){this.throwIfDisposed(),this.cache.set(e,
n)}get(e,n){if(this.throwIfDisposed(),this.cache.has(e))return this.cache.get(e);if(n){const r=n();return this.cache.set(e,r),r}else return}delete(e){return this.throwIfDisposed(),this.cache.delete(e)}clear(){this.throwIfDisposed(),this.cache.clear()}}class oG extends XD{constructor(e){super(),this.cache=new Map,this.converter=e??(n=>n)}has(e,n){return this.throwIfDisposed(),this.cacheForContext(e).has(n)}set(e,n,r){this.throwIfDisposed(),this.cacheForContext(e).set(n,r)}get(e,n,r){this.throwIfDisposed();
const i=this.cacheForContext(e);if(i.has(n))return i.get(n);if(r){const s=r();return i.set(n,s),s}else return}delete(e,n){return this.throwIfDisposed(),this.cacheForContext(e).delete(n)}clear(e){if(this.throwIfDisposed(),e){const n=this.converter(e);this.cache.delete(n)}else this.cache.clear()}cacheForContext(e){const n=this.converter(e);let r=this.cache.get(n);return r||(r=new Map,this.cache.set(n,r)),r}}class vp extends aG{constructor(e,n){super(),n?(this.toDispose.push(e.workspace.DocumentBuilder.
onBuildPhase(n,()=>{this.clear()})),this.toDispose.push(e.workspace.DocumentBuilder.onUpdate((r,i)=>{i.length>0&&this.clear()}))):this.toDispose.push(e.workspace.DocumentBuilder.onUpdate(()=>{this.clear()}))}}class YD{constructor(e){this.reflection=e.shared.AstReflection,this.nameProvider=e.references.NameProvider,this.descriptions=e.workspace.AstNodeDescriptionProvider,this.indexManager=e.shared.workspace.IndexManager,this.globalScopeCache=new vp(e.shared)}getScope(e){const n=[],r=this.reflection.
getReferenceType(e),i=vt(e.container).precomputedScopes;if(i){let a=e.container;do{const o=i.get(a);o.length>0&&n.push(rt(o).filter(u=>this.reflection.isSubtype(u.type,r))),a=a.$container}while(a)}let s=this.getGlobalScope(r,e);for(let a=n.length-1;a>=0;a--)s=this.createScope(n[a],s);return s}createScope(e,n,r){return new Da(rt(e),n,r)}createScopeForNodes(e,n,r){const i=rt(e).map(s=>{const a=this.nameProvider.getName(s);if(a)return this.descriptions.createDescription(s,a)}).nonNullable();return new Da(
i,n,r)}getGlobalScope(e,n){return this.globalScopeCache.get(e,()=>new ZD(this.indexManager.allElements(e)))}}function uG(t){return typeof t.$comment=="string"}function JD(t){return typeof t=="object"&&!!t&&("$ref"in t||"$error"in t)}class cG{constructor(e){this.ignoreProperties=new Set(["$container","$containerProperty","$containerIndex","$document","$cstNode"]),this.langiumDocuments=e.shared.workspace.LangiumDocuments,this.astNodeLocator=e.workspace.AstNodeLocator,this.nameProvider=e.references.
NameProvider,this.commentProvider=e.documentation.CommentProvider}serialize(e,n){const r=n??{},i=n?.replacer,s=(o,u)=>this.replacer(o,u,r),a=i?(o,u)=>i(o,u,s):s;try{return this.currentDocument=vt(e),JSON.stringify(e,a,n?.space)}finally{this.currentDocument=void 0}}deserialize(e,n){const r=n??{},i=JSON.parse(e);return this.linkNode(i,i,r),i}replacer(e,n,{refText:r,sourceText:i,textRegions:s,comments:a,uriConverter:o}){var u,c,l,f;if(!this.ignoreProperties.has(e))if($r(n)){const d=n.ref,h=r?n.$refText:
void 0;if(d){const p=vt(d);let w="";this.currentDocument&&this.currentDocument!==p&&(o?w=o(p.uri,n):w=p.uri.toString());const v=this.astNodeLocator.getAstNodePath(d);return{$ref:`${w}#${v}`,$refText:h}}else return{$error:(c=(u=n.error)===null||u===void 0?void 0:u.message)!==null&&c!==void 0?c:"Could not resolve reference",$refText:h}}else if(Mt(n)){let d;if(s&&(d=this.addAstNodeRegionWithAssignmentsTo(Object.assign({},n)),(!e||n.$document)&&d?.$textRegion&&(d.$textRegion.documentURI=(l=this.currentDocument)===
null||l===void 0?void 0:l.uri.toString())),i&&!e&&(d??(d=Object.assign({},n)),d.$sourceText=(f=n.$cstNode)===null||f===void 0?void 0:f.text),a){d??(d=Object.assign({},n));const h=this.commentProvider.getComment(n);h&&(d.$comment=h.replace(/\r/g,""))}return d??n}else return n}addAstNodeRegionWithAssignmentsTo(e){const n=r=>({offset:r.offset,end:r.end,length:r.length,range:r.range});if(e.$cstNode){const r=e.$textRegion=n(e.$cstNode),i=r.assignments={};return Object.keys(e).filter(s=>!s.startsWith(
"$")).forEach(s=>{const a=Ro(e.$cstNode,s).map(n);a.length!==0&&(i[s]=a)}),e}}linkNode(e,n,r,i,s,a){for(const[u,c]of Object.entries(e))if(Array.isArray(c))for(let l=0;l<c.length;l++){const f=c[l];JD(f)?c[l]=this.reviveReference(e,u,n,f,r):Mt(f)&&this.linkNode(f,n,r,e,u,l)}else JD(c)?e[u]=this.reviveReference(e,u,n,c,r):Mt(c)&&this.linkNode(c,n,r,e,u);const o=e;o.$container=i,o.$containerProperty=s,o.$containerIndex=a}reviveReference(e,n,r,i,s){let a=i.$refText,o=i.$error;if(i.$ref){const u=this.
getRefNode(r,i.$ref,s.uriConverter);if(Mt(u))return a||(a=this.nameProvider.getName(u)),{$refText:a??"",ref:u};o=u}if(o){const u={$refText:a??""};return u.error={container:e,property:n,message:o,reference:u},u}else return}getRefNode(e,n,r){try{const i=n.indexOf("#");if(i===0){const u=this.astNodeLocator.getAstNode(e,n.substring(1));return u||"Could not resolve path: "+n}if(i<0){const u=r?r(n):_t.parse(n),c=this.langiumDocuments.getDocument(u);return c?c.parseResult.value:"Could not find document\
 for URI: "+n}const s=r?r(n.substring(0,i)):_t.parse(n.substring(0,i)),a=this.langiumDocuments.getDocument(s);if(!a)return"Could not find document for URI: "+n;if(i===n.length-1)return a.parseResult.value;const o=this.astNodeLocator.getAstNode(a.parseResult.value,n.substring(i+1));return o||"Could not resolve URI: "+n}catch(i){return String(i)}}}class lG{get map(){return this.fileExtensionMap}constructor(e){this.languageIdMap=new Map,this.fileExtensionMap=new Map,this.textDocuments=e?.workspace.
TextDocuments}register(e){const n=e.LanguageMetaData;for(const r of n.fileExtensions)this.fileExtensionMap.has(r)&&console.warn(`The file extension ${r} is used by multiple languages. It is now assigned to '${n.languageId}'.`),this.fileExtensionMap.set(r,e);this.languageIdMap.set(n.languageId,e),this.languageIdMap.size===1?this.singleton=e:this.singleton=void 0}getServices(e){var n,r;if(this.singleton!==void 0)return this.singleton;if(this.languageIdMap.size===0)throw new Error("The service regi\
stry is empty. Use `register` to register the services of a language.");const i=(r=(n=this.textDocuments)===null||n===void 0?void 0:n.get(e))===null||r===void 0?void 0:r.languageId;if(i!==void 0){const o=this.languageIdMap.get(i);if(o)return o}const s=Tt.extname(e),a=this.fileExtensionMap.get(s);if(!a)throw i?new Error(`The service registry contains no services for the extension '${s}' for language '${i}'.`):new Error(`The service registry contains no services for the extension '${s}'.`);return a}hasServices(e){
try{return this.getServices(e),!0}catch{return!1}}get all(){return Array.from(this.languageIdMap.values())}}function Hc(t){return{code:t}}var wp;(function(t){t.all=["fast","slow","built-in"]})(wp||(wp={}));class dG{constructor(e){this.entries=new $a,this.entriesBefore=[],this.entriesAfter=[],this.reflection=e.shared.AstReflection}register(e,n=this,r="fast"){if(r==="built-in")throw new Error("The 'built-in' category is reserved for lexer, parser, and linker errors.");for(const[i,s]of Object.entries(
e)){const a=s;if(Array.isArray(a))for(const o of a){const u={check:this.wrapValidationException(o,n),category:r};this.addEntry(i,u)}else if(typeof a=="function"){const o={check:this.wrapValidationException(a,n),category:r};this.addEntry(i,o)}else ju()}}wrapValidationException(e,n){return async(r,i,s)=>{await this.handleException(()=>e.call(n,r,i,s),"An error occurred during validation",i,r)}}async handleException(e,n,r,i){try{await e()}catch(s){if(mp(s))throw s;console.error(`${n}:`,s),s instanceof
Error&&s.stack&&console.error(s.stack);const a=s instanceof Error?s.message:String(s);r("error",`${n}: ${a}`,{node:i})}}addEntry(e,n){if(e==="AstNode"){this.entries.add("AstNode",n);return}for(const r of this.reflection.getAllSubTypes(e))this.entries.add(r,n)}getChecks(e,n){let r=rt(this.entries.get(e)).concat(this.entries.get("AstNode"));return n&&(r=r.filter(i=>n.includes(i.category))),r.map(i=>i.check)}registerBeforeDocument(e,n=this){this.entriesBefore.push(this.wrapPreparationException(e,"A\
n error occurred during set-up of the validation",n))}registerAfterDocument(e,n=this){this.entriesAfter.push(this.wrapPreparationException(e,"An error occurred during tear-down of the validation",n))}wrapPreparationException(e,n,r){return async(i,s,a,o)=>{await this.handleException(()=>e.call(r,i,s,a,o),n,s,i)}}get checksBefore(){return this.entriesBefore}get checksAfter(){return this.entriesAfter}}class fG{constructor(e){this.validationRegistry=e.validation.ValidationRegistry,this.metadata=e.LanguageMetaData}async validateDocument(e,n={},r=Dt.
CancellationToken.None){const i=e.parseResult,s=[];if(await en(r),(!n.categories||n.categories.includes("built-in"))&&(this.processLexingErrors(i,s,n),n.stopAfterLexingErrors&&s.some(a=>{var o;return((o=a.data)===null||o===void 0?void 0:o.code)===zr.LexingError})||(this.processParsingErrors(i,s,n),n.stopAfterParsingErrors&&s.some(a=>{var o;return((o=a.data)===null||o===void 0?void 0:o.code)===zr.ParsingError}))||(this.processLinkingErrors(e,s,n),n.stopAfterLinkingErrors&&s.some(a=>{var o;return((o=
a.data)===null||o===void 0?void 0:o.code)===zr.LinkingError}))))return s;try{s.push(...await this.validateAst(i.value,n,r))}catch(a){if(mp(a))throw a;console.error("An error occurred during validation:",a)}return await en(r),s}processLexingErrors(e,n,r){var i,s,a;const o=[...e.lexerErrors,...(s=(i=e.lexerReport)===null||i===void 0?void 0:i.diagnostics)!==null&&s!==void 0?s:[]];for(const u of o){const c=(a=u.severity)!==null&&a!==void 0?a:"error",l={severity:jv(c),range:{start:{line:u.line-1,character:u.
column-1},end:{line:u.line-1,character:u.column+u.length-1}},message:u.message,data:pG(c),source:this.getSource()};n.push(l)}}processParsingErrors(e,n,r){for(const i of e.parserErrors){let s;if(isNaN(i.token.startOffset)){if("previousToken"in i){const a=i.previousToken;if(isNaN(a.startOffset)){const o={line:0,character:0};s={start:o,end:o}}else{const o={line:a.endLine-1,character:a.endColumn};s={start:o,end:o}}}}else s=Hg(i.token);if(s){const a={severity:jv("error"),range:s,message:i.message,data:Hc(
zr.ParsingError),source:this.getSource()};n.push(a)}}}processLinkingErrors(e,n,r){for(const i of e.references){const s=i.error;if(s){const a={node:s.container,property:s.property,index:s.index,data:{code:zr.LinkingError,containerType:s.container.$type,property:s.property,refText:s.reference.$refText}};n.push(this.toDiagnostic("error",s.message,a))}}}async validateAst(e,n,r=Dt.CancellationToken.None){const i=[],s=(a,o,u)=>{i.push(this.toDiagnostic(a,o,u))};return await this.validateAstBefore(e,n,
s,r),await this.validateAstNodes(e,n,s,r),await this.validateAstAfter(e,n,s,r),i}async validateAstBefore(e,n,r,i=Dt.CancellationToken.None){var s;const a=this.validationRegistry.checksBefore;for(const o of a)await en(i),await o(e,r,(s=n.categories)!==null&&s!==void 0?s:[],i)}async validateAstNodes(e,n,r,i=Dt.CancellationToken.None){await Promise.all(Ni(e).map(async s=>{await en(i);const a=this.validationRegistry.getChecks(s.$type,n.categories);for(const o of a)await o(s,r,i)}))}async validateAstAfter(e,n,r,i=Dt.
CancellationToken.None){var s;const a=this.validationRegistry.checksAfter;for(const o of a)await en(i),await o(e,r,(s=n.categories)!==null&&s!==void 0?s:[],i)}toDiagnostic(e,n,r){return{message:n,range:hG(r),severity:jv(e),code:r.code,codeDescription:r.codeDescription,tags:r.tags,relatedInformation:r.relatedInformation,data:r.data,source:this.getSource()}}getSource(){return this.metadata.languageId}}function hG(t){if(t.range)return t.range;let e;return typeof t.property=="string"?e=Cn(t.node.$cstNode,
t.property,t.index):typeof t.keyword=="string"&&(e=bc(t.node.$cstNode,t.keyword,t.index)),e??(e=t.node.$cstNode),e?e.range:{start:{line:0,character:0},end:{line:0,character:0}}}function jv(t){switch(t){case"error":return 1;case"warning":return 2;case"info":return 3;case"hint":return 4;default:throw new Error("Invalid diagnostic severity: "+t)}}function pG(t){switch(t){case"error":return Hc(zr.LexingError);case"warning":return Hc(zr.LexingWarning);case"info":return Hc(zr.LexingInfo);case"hint":return Hc(
zr.LexingHint);default:throw new Error("Invalid diagnostic severity: "+t)}}var zr;(function(t){t.LexingError="lexing-error",t.LexingWarning="lexing-warning",t.LexingInfo="lexing-info",t.LexingHint="lexing-hint",t.ParsingError="parsing-error",t.LinkingError="linking-error"})(zr||(zr={}));class QD{constructor(e){this.astNodeLocator=e.workspace.AstNodeLocator,this.nameProvider=e.references.NameProvider}createDescription(e,n,r){const i=r??vt(e);n??(n=this.nameProvider.getName(e));const s=this.astNodeLocator.
getAstNodePath(e);if(!n)throw new Error(`Node at path ${s} has no name.`);let a;const o=()=>{var u;return a??(a=nh((u=this.nameProvider.getNameNode(e))!==null&&u!==void 0?u:e.$cstNode))};return{node:e,name:n,get nameSegment(){return o()},selectionSegment:nh(e.$cstNode),type:e.$type,documentUri:i.uri,path:s}}}class mG{constructor(e){this.nodeLocator=e.workspace.AstNodeLocator}async createDescriptions(e,n=Dt.CancellationToken.None){const r=[],i=e.parseResult.value;for(const s of Ni(i))await en(n),
fh(s).filter(a=>!Qf(a)).forEach(a=>{const o=this.createDescription(a);o&&r.push(o)});return r}createDescription(e){const n=e.reference.$nodeDescription,r=e.reference.$refNode;if(!n||!r)return;const i=vt(e.container).uri;return{sourceUri:i,sourcePath:this.nodeLocator.getAstNodePath(e.container),targetUri:n.documentUri,targetPath:n.path,segment:nh(r),local:Tt.equals(n.documentUri,i)}}}class gG{constructor(){this.segmentSeparator="/",this.indexSeparator="@"}getAstNodePath(e){if(e.$container){const n=this.
getAstNodePath(e.$container),r=this.getPathSegment(e);return n+this.segmentSeparator+r}return""}getPathSegment({$containerProperty:e,$containerIndex:n}){if(!e)throw new Error("Missing '$containerProperty' in AST node.");return n!==void 0?e+this.indexSeparator+n:e}getAstNode(e,n){return n.split(this.segmentSeparator).reduce((i,s)=>{if(!i||s.length===0)return i;const a=s.indexOf(this.indexSeparator);if(a>0){const o=s.substring(0,a),u=parseInt(s.substring(a+1)),c=i[o];return c?.[u]}return i[s]},e)}}
var yG=Mo();class vG{constructor(e){this._ready=new Lv,this.settings={},this.workspaceConfig=!1,this.onConfigurationSectionUpdateEmitter=new yG.Emitter,this.serviceRegistry=e.ServiceRegistry}get ready(){return this._ready.promise}initialize(e){var n,r;this.workspaceConfig=(r=(n=e.capabilities.workspace)===null||n===void 0?void 0:n.configuration)!==null&&r!==void 0?r:!1}async initialized(e){if(this.workspaceConfig){if(e.register){const n=this.serviceRegistry.all;e.register({section:n.map(r=>this.
toSectionName(r.LanguageMetaData.languageId))})}if(e.fetchConfiguration){const n=this.serviceRegistry.all.map(i=>({section:this.toSectionName(i.LanguageMetaData.languageId)})),r=await e.fetchConfiguration(n);n.forEach((i,s)=>{this.updateSectionConfiguration(i.section,r[s])})}}this._ready.resolve()}updateConfiguration(e){e.settings&&Object.keys(e.settings).forEach(n=>{const r=e.settings[n];this.updateSectionConfiguration(n,r),this.onConfigurationSectionUpdateEmitter.fire({section:n,configuration:r})})}updateSectionConfiguration(e,n){
this.settings[e]=n}async getConfiguration(e,n){await this.ready;const r=this.toSectionName(e);if(this.settings[r])return this.settings[r][n]}toSectionName(e){return`${e}`}get onConfigurationSectionUpdate(){return this.onConfigurationSectionUpdateEmitter.event}}var Ta;(function(t){function e(n){return{dispose:async()=>await n()}}t.create=e})(Ta||(Ta={}));class wG{constructor(e){this.updateBuildOptions={validation:{categories:["built-in","fast"]}},this.updateListeners=[],this.buildPhaseListeners=new $a,
this.documentPhaseListeners=new $a,this.buildState=new Map,this.documentBuildWaiters=new Map,this.currentState=Ze.Changed,this.langiumDocuments=e.workspace.LangiumDocuments,this.langiumDocumentFactory=e.workspace.LangiumDocumentFactory,this.textDocuments=e.workspace.TextDocuments,this.indexManager=e.workspace.IndexManager,this.serviceRegistry=e.ServiceRegistry}async build(e,n={},r=Dt.CancellationToken.None){var i,s;for(const a of e){const o=a.uri.toString();if(a.state===Ze.Validated){if(typeof n.
validation=="boolean"&&n.validation)a.state=Ze.IndexedReferences,a.diagnostics=void 0,this.buildState.delete(o);else if(typeof n.validation=="object"){const u=this.buildState.get(o),c=(i=u?.result)===null||i===void 0?void 0:i.validationChecks;if(c){const f=((s=n.validation.categories)!==null&&s!==void 0?s:wp.all).filter(d=>!c.includes(d));f.length>0&&(this.buildState.set(o,{completed:!1,options:{validation:Object.assign(Object.assign({},n.validation),{categories:f})},result:u.result}),a.state=Ze.
IndexedReferences)}}}else this.buildState.delete(o)}this.currentState=Ze.Changed,await this.emitUpdate(e.map(a=>a.uri),[]),await this.buildDocuments(e,n,r)}async update(e,n,r=Dt.CancellationToken.None){this.currentState=Ze.Changed;for(const a of n)this.langiumDocuments.deleteDocument(a),this.buildState.delete(a.toString()),this.indexManager.remove(a);for(const a of e){if(!this.langiumDocuments.invalidateDocument(a)){const u=this.langiumDocumentFactory.fromModel({$type:"INVALID"},a);u.state=Ze.Changed,
this.langiumDocuments.addDocument(u)}this.buildState.delete(a.toString())}const i=rt(e).concat(n).map(a=>a.toString()).toSet();this.langiumDocuments.all.filter(a=>!i.has(a.uri.toString())&&this.shouldRelink(a,i)).forEach(a=>{this.serviceRegistry.getServices(a.uri).references.Linker.unlink(a),a.state=Math.min(a.state,Ze.ComputedScopes),a.diagnostics=void 0}),await this.emitUpdate(e,n),await en(r);const s=this.sortDocuments(this.langiumDocuments.all.filter(a=>{var o;return a.state<Ze.Linked||!(!((o=
this.buildState.get(a.uri.toString()))===null||o===void 0)&&o.completed)}).toArray());await this.buildDocuments(s,this.updateBuildOptions,r)}async emitUpdate(e,n){await Promise.all(this.updateListeners.map(r=>r(e,n)))}sortDocuments(e){let n=0,r=e.length-1;for(;n<r;){for(;n<e.length&&this.hasTextDocument(e[n]);)n++;for(;r>=0&&!this.hasTextDocument(e[r]);)r--;n<r&&([e[n],e[r]]=[e[r],e[n]])}return e}hasTextDocument(e){var n;return!!(!((n=this.textDocuments)===null||n===void 0)&&n.get(e.uri))}shouldRelink(e,n){
return e.references.some(r=>r.error!==void 0)?!0:this.indexManager.isAffected(e,n)}onUpdate(e){return this.updateListeners.push(e),Ta.create(()=>{const n=this.updateListeners.indexOf(e);n>=0&&this.updateListeners.splice(n,1)})}async buildDocuments(e,n,r){this.prepareBuild(e,n),await this.runCancelable(e,Ze.Parsed,r,s=>this.langiumDocumentFactory.update(s,r)),await this.runCancelable(e,Ze.IndexedContent,r,s=>this.indexManager.updateContent(s,r)),await this.runCancelable(e,Ze.ComputedScopes,r,async s=>{
const a=this.serviceRegistry.getServices(s.uri).references.ScopeComputation;s.precomputedScopes=await a.computeLocalScopes(s,r)}),await this.runCancelable(e,Ze.Linked,r,s=>this.serviceRegistry.getServices(s.uri).references.Linker.link(s,r)),await this.runCancelable(e,Ze.IndexedReferences,r,s=>this.indexManager.updateReferences(s,r));const i=e.filter(s=>this.shouldValidate(s));await this.runCancelable(i,Ze.Validated,r,s=>this.validate(s,r));for(const s of e){const a=this.buildState.get(s.uri.toString());
a&&(a.completed=!0)}}prepareBuild(e,n){for(const r of e){const i=r.uri.toString(),s=this.buildState.get(i);(!s||s.completed)&&this.buildState.set(i,{completed:!1,options:n,result:s?.result})}}async runCancelable(e,n,r,i){const s=e.filter(o=>o.state<n);for(const o of s)await en(r),await i(o),o.state=n,await this.notifyDocumentPhase(o,n,r);const a=e.filter(o=>o.state===n);await this.notifyBuildPhase(a,n,r),this.currentState=n}onBuildPhase(e,n){return this.buildPhaseListeners.add(e,n),Ta.create(()=>{
this.buildPhaseListeners.delete(e,n)})}onDocumentPhase(e,n){return this.documentPhaseListeners.add(e,n),Ta.create(()=>{this.documentPhaseListeners.delete(e,n)})}waitUntil(e,n,r){let i;if(n&&"path"in n?i=n:r=n,r??(r=Dt.CancellationToken.None),i){const s=this.langiumDocuments.getDocument(i);if(s&&s.state>e)return Promise.resolve(i)}return this.currentState>=e?Promise.resolve(void 0):r.isCancellationRequested?Promise.reject(pp):new Promise((s,a)=>{const o=this.onBuildPhase(e,()=>{if(o.dispose(),u.dispose(),
i){const c=this.langiumDocuments.getDocument(i);s(c?.uri)}else s(void 0)}),u=r.onCancellationRequested(()=>{o.dispose(),u.dispose(),a(pp)})})}async notifyDocumentPhase(e,n,r){const s=this.documentPhaseListeners.get(n).slice();for(const a of s)try{await a(e,r)}catch(o){if(!mp(o))throw o}}async notifyBuildPhase(e,n,r){if(e.length===0)return;const s=this.buildPhaseListeners.get(n).slice();for(const a of s)await en(r),await a(e,r)}shouldValidate(e){return!!this.getBuildOptions(e).validation}async validate(e,n){
var r,i;const s=this.serviceRegistry.getServices(e.uri).validation.DocumentValidator,a=this.getBuildOptions(e).validation,o=typeof a=="object"?a:void 0,u=await s.validateDocument(e,o,n);e.diagnostics?e.diagnostics.push(...u):e.diagnostics=u;const c=this.buildState.get(e.uri.toString());if(c){(r=c.result)!==null&&r!==void 0||(c.result={});const l=(i=o?.categories)!==null&&i!==void 0?i:wp.all;c.result.validationChecks?c.result.validationChecks.push(...l):c.result.validationChecks=[...l]}}getBuildOptions(e){
var n,r;return(r=(n=this.buildState.get(e.uri.toString()))===null||n===void 0?void 0:n.options)!==null&&r!==void 0?r:{}}}class eT{constructor(e){this.symbolIndex=new Map,this.symbolByTypeIndex=new oG,this.referenceIndex=new Map,this.documents=e.workspace.LangiumDocuments,this.serviceRegistry=e.ServiceRegistry,this.astReflection=e.AstReflection}findAllReferences(e,n){const r=vt(e).uri,i=[];return this.referenceIndex.forEach(s=>{s.forEach(a=>{Tt.equals(a.targetUri,r)&&a.targetPath===n&&i.push(a)})}),
rt(i)}allElements(e,n){let r=rt(this.symbolIndex.keys());return n&&(r=r.filter(i=>!n||n.has(i))),r.map(i=>this.getFileDescriptions(i,e)).flat()}getFileDescriptions(e,n){var r;return n?this.symbolByTypeIndex.get(e,n,()=>{var s;return((s=this.symbolIndex.get(e))!==null&&s!==void 0?s:[]).filter(o=>this.astReflection.isSubtype(o.type,n))}):(r=this.symbolIndex.get(e))!==null&&r!==void 0?r:[]}remove(e){const n=e.toString();this.symbolIndex.delete(n),this.symbolByTypeIndex.clear(n),this.referenceIndex.
delete(n)}async updateContent(e,n=Dt.CancellationToken.None){const i=await this.serviceRegistry.getServices(e.uri).references.ScopeComputation.computeExports(e,n),s=e.uri.toString();this.symbolIndex.set(s,i),this.symbolByTypeIndex.clear(s)}async updateReferences(e,n=Dt.CancellationToken.None){const i=await this.serviceRegistry.getServices(e.uri).workspace.ReferenceDescriptionProvider.createDescriptions(e,n);this.referenceIndex.set(e.uri.toString(),i)}isAffected(e,n){const r=this.referenceIndex.get(
e.uri.toString());return r?r.some(i=>!i.local&&n.has(i.targetUri.toString())):!1}}class tT{constructor(e){this.initialBuildOptions={},this._ready=new Lv,this.serviceRegistry=e.ServiceRegistry,this.langiumDocuments=e.workspace.LangiumDocuments,this.documentBuilder=e.workspace.DocumentBuilder,this.fileSystemProvider=e.workspace.FileSystemProvider,this.mutex=e.workspace.WorkspaceLock}get ready(){return this._ready.promise}get workspaceFolders(){return this.folders}initialize(e){var n;this.folders=(n=
e.workspaceFolders)!==null&&n!==void 0?n:void 0}initialized(e){return this.mutex.write(n=>{var r;return this.initializeWorkspace((r=this.folders)!==null&&r!==void 0?r:[],n)})}async initializeWorkspace(e,n=Dt.CancellationToken.None){const r=await this.performStartup(e);await en(n),await this.documentBuilder.build(r,this.initialBuildOptions,n)}async performStartup(e){const n=this.serviceRegistry.all.flatMap(s=>s.LanguageMetaData.fileExtensions),r=[],i=s=>{r.push(s),this.langiumDocuments.hasDocument(
s.uri)||this.langiumDocuments.addDocument(s)};return await this.loadAdditionalDocuments(e,i),await Promise.all(e.map(s=>[s,this.getRootFolder(s)]).map(async s=>this.traverseFolder(...s,n,i))),this._ready.resolve(),r}loadAdditionalDocuments(e,n){return Promise.resolve()}getRootFolder(e){return _t.parse(e.uri)}async traverseFolder(e,n,r,i){const s=await this.fileSystemProvider.readDirectory(n);await Promise.all(s.map(async a=>{if(this.includeEntry(e,a,r)){if(a.isDirectory)await this.traverseFolder(
e,a.uri,r,i);else if(a.isFile){const o=await this.langiumDocuments.getOrCreateDocument(a.uri);i(o)}}}))}includeEntry(e,n,r){const i=Tt.basename(n.uri);if(i.startsWith("."))return!1;if(n.isDirectory)return i!=="node_modules"&&i!=="out";if(n.isFile){const s=Tt.extname(n.uri);return r.includes(s)}return!1}}class bG{buildUnexpectedCharactersMessage(e,n,r,i,s){return Yy.buildUnexpectedCharactersMessage(e,n,r,i,s)}buildUnableToPopLexerModeMessage(e){return Yy.buildUnableToPopLexerModeMessage(e)}}const EG={
mode:"full"};class kG{constructor(e){this.errorMessageProvider=e.parser.LexerErrorMessageProvider,this.tokenBuilder=e.parser.TokenBuilder;const n=this.tokenBuilder.buildTokens(e.Grammar,{caseInsensitive:e.LanguageMetaData.caseInsensitive});this.tokenTypes=this.toTokenTypeDictionary(n);const r=rT(n)?Object.values(n):n,i=e.LanguageMetaData.mode==="production";this.chevrotainLexer=new ir(r,{positionTracking:"full",skipValidations:i,errorMessageProvider:this.errorMessageProvider})}get definition(){return this.
tokenTypes}tokenize(e,n=EG){var r,i,s;const a=this.chevrotainLexer.tokenize(e);return{tokens:a.tokens,errors:a.errors,hidden:(r=a.groups.hidden)!==null&&r!==void 0?r:[],report:(s=(i=this.tokenBuilder).flushLexingReport)===null||s===void 0?void 0:s.call(i,e)}}toTokenTypeDictionary(e){if(rT(e))return e;const n=nT(e)?Object.values(e.modes).flat():e,r={};return n.forEach(i=>r[i.name]=i),r}}function RG(t){return Array.isArray(t)&&(t.length===0||"name"in t[0])}function nT(t){return t&&"modes"in t&&"de\
faultMode"in t}function rT(t){return!RG(t)&&!nT(t)}function $G(t,e,n){let r,i;typeof t=="string"?(i=e,r=n):(i=t.range.start,r=e),i||(i=yt.create(0,0));const s=iT(t),a=qv(r),o=SG({lines:s,position:i,options:a});return PG({index:0,tokens:o,position:i})}function DG(t,e){const n=qv(e),r=iT(t);if(r.length===0)return!1;const i=r[0],s=r[r.length-1],a=n.start,o=n.end;return!!a?.exec(i)&&!!o?.exec(s)}function iT(t){let e="";return typeof t=="string"?e=t:e=t.text,e.split(ZE)}const sT=/\s*(@([\p{L}][\p{L}\p{N}]*)?)/uy,
TG=/\{(@[\p{L}][\p{L}\p{N}]*)(\s*)([^\r\n}]+)?\}/gu;function SG(t){var e,n,r;const i=[];let s=t.position.line,a=t.position.character;for(let o=0;o<t.lines.length;o++){const u=o===0,c=o===t.lines.length-1;let l=t.lines[o],f=0;if(u&&t.options.start){const h=(e=t.options.start)===null||e===void 0?void 0:e.exec(l);h&&(f=h.index+h[0].length)}else{const h=(n=t.options.line)===null||n===void 0?void 0:n.exec(l);h&&(f=h.index+h[0].length)}if(c){const h=(r=t.options.end)===null||r===void 0?void 0:r.exec(l);
h&&(l=l.substring(0,h.index))}if(l=l.substring(0,xG(l)),Bv(l,f)>=l.length){if(i.length>0){const h=yt.create(s,a);i.push({type:"break",content:"",range:it.create(h,h)})}}else{sT.lastIndex=f;const h=sT.exec(l);if(h){const p=h[0],w=h[1],v=yt.create(s,a+f),g=yt.create(s,a+f+p.length);i.push({type:"tag",content:w,range:it.create(v,g)}),f+=p.length,f=Bv(l,f)}if(f<l.length){const p=l.substring(f),w=Array.from(p.matchAll(TG));i.push(...CG(w,p,s,a+f))}}s++,a=0}return i.length>0&&i[i.length-1].type==="bre\
ak"?i.slice(0,-1):i}function CG(t,e,n,r){const i=[];if(t.length===0){const s=yt.create(n,r),a=yt.create(n,r+e.length);i.push({type:"text",content:e,range:it.create(s,a)})}else{let s=0;for(const o of t){const u=o.index,c=e.substring(s,u);c.length>0&&i.push({type:"text",content:e.substring(s,u),range:it.create(yt.create(n,s+r),yt.create(n,u+r))});let l=c.length+1;const f=o[1];if(i.push({type:"inline-tag",content:f,range:it.create(yt.create(n,s+l+r),yt.create(n,s+l+f.length+r))}),l+=f.length,o.length===
4){l+=o[2].length;const d=o[3];i.push({type:"text",content:d,range:it.create(yt.create(n,s+l+r),yt.create(n,s+l+d.length+r))})}else i.push({type:"text",content:"",range:it.create(yt.create(n,s+l+r),yt.create(n,s+l+r))});s=u+o[0].length}const a=e.substring(s);a.length>0&&i.push({type:"text",content:a,range:it.create(yt.create(n,s+r),yt.create(n,s+r+a.length))})}return i}const _G=/\S/,AG=/\s*$/;function Bv(t,e){const n=t.substring(e).match(_G);return n?e+n.index:t.length}function xG(t){const e=t.match(
AG);if(e&&typeof e.index=="number")return e.index}function PG(t){var e,n,r,i;const s=yt.create(t.position.line,t.position.character);if(t.tokens.length===0)return new cT([],it.create(s,s));const a=[];for(;t.index<t.tokens.length;){const c=NG(t,a[a.length-1]);c&&a.push(c)}const o=(n=(e=a[0])===null||e===void 0?void 0:e.range.start)!==null&&n!==void 0?n:s,u=(i=(r=a[a.length-1])===null||r===void 0?void 0:r.range.end)!==null&&i!==void 0?i:s;return new cT(a,it.create(o,u))}function NG(t,e){const n=t.
tokens[t.index];if(n.type==="tag")return oT(t,!1);if(n.type==="text"||n.type==="inline-tag")return aT(t);IG(n,e),t.index++}function IG(t,e){if(e){const n=new lT("",t.range);"inlines"in e?e.inlines.push(n):e.content.inlines.push(n)}}function aT(t){let e=t.tokens[t.index];const n=e;let r=e;const i=[];for(;e&&e.type!=="break"&&e.type!=="tag";)i.push(OG(t)),r=e,e=t.tokens[t.index];return new zv(i,it.create(n.range.start,r.range.end))}function OG(t){return t.tokens[t.index].type==="inline-tag"?oT(t,!0):
uT(t)}function oT(t,e){const n=t.tokens[t.index++],r=n.content.substring(1),i=t.tokens[t.index];if(i?.type==="text")if(e){const s=uT(t);return new Uv(r,new zv([s],s.range),e,it.create(n.range.start,s.range.end))}else{const s=aT(t);return new Uv(r,s,e,it.create(n.range.start,s.range.end))}else{const s=n.range;return new Uv(r,new zv([],s),e,s)}}function uT(t){const e=t.tokens[t.index++];return new lT(e.content,e.range)}function qv(t){if(!t)return qv({start:"/**",end:"*/",line:"*"});const{start:e,end:n,
line:r}=t;return{start:Gv(e,!0),end:Gv(n,!1),line:Gv(r,!0)}}function Gv(t,e){if(typeof t=="string"||typeof t=="object"){const n=typeof t=="string"?yh(t):t.source;return e?new RegExp(`^\\s*${n}`):new RegExp(`\\s*${n}\\s*$`)}else return t}class cT{constructor(e,n){this.elements=e,this.range=n}getTag(e){return this.getAllTags().find(n=>n.name===e)}getTags(e){return this.getAllTags().filter(n=>n.name===e)}getAllTags(){return this.elements.filter(e=>"name"in e)}toString(){let e="";for(const n of this.
elements)if(e.length===0)e=n.toString();else{const r=n.toString();e+=dT(e)+r}return e.trim()}toMarkdown(e){let n="";for(const r of this.elements)if(n.length===0)n=r.toMarkdown(e);else{const i=r.toMarkdown(e);n+=dT(n)+i}return n.trim()}}class Uv{constructor(e,n,r,i){this.name=e,this.content=n,this.inline=r,this.range=i}toString(){let e=`@${this.name}`;const n=this.content.toString();return this.content.inlines.length===1?e=`${e} ${n}`:this.content.inlines.length>1&&(e=`${e}
${n}`),this.inline?`{${e}}`:e}toMarkdown(e){var n,r;return(r=(n=e?.renderTag)===null||n===void 0?void 0:n.call(e,this))!==null&&r!==void 0?r:this.toMarkdownDefault(e)}toMarkdownDefault(e){const n=this.content.toMarkdown(e);if(this.inline){const s=LG(this.name,n,e??{});if(typeof s=="string")return s}let r="";e?.tag==="italic"||e?.tag===void 0?r="*":e?.tag==="bold"?r="**":e?.tag==="bold-italic"&&(r="***");let i=`${r}@${this.name}${r}`;return this.content.inlines.length===1?i=`${i} \u2014 ${n}`:this.
content.inlines.length>1&&(i=`${i}
${n}`),this.inline?`{${i}}`:i}}function LG(t,e,n){var r,i;if(t==="linkplain"||t==="linkcode"||t==="link"){const s=e.indexOf(" ");let a=e;if(s>0){const u=Bv(e,s);a=e.substring(u),e=e.substring(0,s)}return(t==="linkcode"||t==="link"&&n.link==="code")&&(a=`\`${a}\``),(i=(r=n.renderLink)===null||r===void 0?void 0:r.call(n,e,a))!==null&&i!==void 0?i:FG(e,a)}}function FG(t,e){try{return _t.parse(t,!0),`[${e}](${t})`}catch{return t}}class zv{constructor(e,n){this.inlines=e,this.range=n}toString(){let e="";
for(let n=0;n<this.inlines.length;n++){const r=this.inlines[n],i=this.inlines[n+1];e+=r.toString(),i&&i.range.start.line>r.range.start.line&&(e+=`
`)}return e}toMarkdown(e){let n="";for(let r=0;r<this.inlines.length;r++){const i=this.inlines[r],s=this.inlines[r+1];n+=i.toMarkdown(e),s&&s.range.start.line>i.range.start.line&&(n+=`
`)}return n}}class lT{constructor(e,n){this.text=e,this.range=n}toString(){return this.text}toMarkdown(){return this.text}}function dT(t){return t.endsWith(`
`)?`
`:`

`}class MG{constructor(e){this.indexManager=e.shared.workspace.IndexManager,this.commentProvider=e.documentation.CommentProvider}getDocumentation(e){const n=this.commentProvider.getComment(e);if(n&&DG(n))return $G(n).toMarkdown({renderLink:(i,s)=>this.documentationLinkRenderer(e,i,s),renderTag:i=>this.documentationTagRenderer(e,i)})}documentationLinkRenderer(e,n,r){var i;const s=(i=this.findNameInPrecomputedScopes(e,n))!==null&&i!==void 0?i:this.findNameInGlobalScope(e,n);if(s&&s.nameSegment){const a=s.
nameSegment.range.start.line+1,o=s.nameSegment.range.start.character+1,u=s.documentUri.with({fragment:`L${a},${o}`});return`[${r}](${u.toString()})`}else return}documentationTagRenderer(e,n){}findNameInPrecomputedScopes(e,n){const i=vt(e).precomputedScopes;if(!i)return;let s=e;do{const o=i.get(s).find(u=>u.name===n);if(o)return o;s=s.$container}while(s)}findNameInGlobalScope(e,n){return this.indexManager.allElements().find(i=>i.name===n)}}class jG{constructor(e){this.grammarConfig=()=>e.parser.GrammarConfig}getComment(e){
var n;return uG(e)?e.$comment:(n=Vg(e.$cstNode,this.grammarConfig().multilineCommentRules))===null||n===void 0?void 0:n.text}}class BG{constructor(e){this.syncParser=e.parser.LangiumParser}parse(e,n){return Promise.resolve(this.syncParser.parse(e))}}class qG{constructor(){this.previousTokenSource=new Dt.CancellationTokenSource,this.writeQueue=[],this.readQueue=[],this.done=!0}write(e){this.cancelWrite();const n=eG();return this.previousTokenSource=n,this.enqueue(this.writeQueue,e,n.token)}read(e){
return this.enqueue(this.readQueue,e)}enqueue(e,n,r=Dt.CancellationToken.None){const i=new Lv,s={action:n,deferred:i,cancellationToken:r};return e.push(s),this.performNextOperation(),i.promise}async performNextOperation(){if(!this.done)return;const e=[];if(this.writeQueue.length>0)e.push(this.writeQueue.shift());else if(this.readQueue.length>0)e.push(...this.readQueue.splice(0,this.readQueue.length));else return;this.done=!1,await Promise.all(e.map(async({action:n,deferred:r,cancellationToken:i})=>{
try{const s=await Promise.resolve().then(()=>n(i));r.resolve(s)}catch(s){mp(s)?r.resolve(void 0):r.reject(s)}})),this.done=!0,this.performNextOperation()}cancelWrite(){this.previousTokenSource.cancel()}}class GG{constructor(e){this.grammarElementIdMap=new VD,this.tokenTypeIdMap=new VD,this.grammar=e.Grammar,this.lexer=e.parser.Lexer,this.linker=e.references.Linker}dehydrate(e){return{lexerErrors:e.lexerErrors,lexerReport:e.lexerReport?this.dehydrateLexerReport(e.lexerReport):void 0,parserErrors:e.
parserErrors.map(n=>Object.assign(Object.assign({},n),{message:n.message})),value:this.dehydrateAstNode(e.value,this.createDehyrationContext(e.value))}}dehydrateLexerReport(e){return e}createDehyrationContext(e){const n=new Map,r=new Map;for(const i of Ni(e))n.set(i,{});if(e.$cstNode)for(const i of th(e.$cstNode))r.set(i,{});return{astNodes:n,cstNodes:r}}dehydrateAstNode(e,n){const r=n.astNodes.get(e);r.$type=e.$type,r.$containerIndex=e.$containerIndex,r.$containerProperty=e.$containerProperty,e.
$cstNode!==void 0&&(r.$cstNode=this.dehydrateCstNode(e.$cstNode,n));for(const[i,s]of Object.entries(e))if(!i.startsWith("$"))if(Array.isArray(s)){const a=[];r[i]=a;for(const o of s)Mt(o)?a.push(this.dehydrateAstNode(o,n)):$r(o)?a.push(this.dehydrateReference(o,n)):a.push(o)}else Mt(s)?r[i]=this.dehydrateAstNode(s,n):$r(s)?r[i]=this.dehydrateReference(s,n):s!==void 0&&(r[i]=s);return r}dehydrateReference(e,n){const r={};return r.$refText=e.$refText,e.$refNode&&(r.$refNode=n.cstNodes.get(e.$refNode)),
r}dehydrateCstNode(e,n){const r=n.cstNodes.get(e);return xE(e)?r.fullText=e.fullText:r.grammarSource=this.getGrammarElementId(e.grammarSource),r.hidden=e.hidden,r.astNode=n.astNodes.get(e.astNode),ks(e)?r.content=e.content.map(i=>this.dehydrateCstNode(i,n)):oa(e)&&(r.tokenType=e.tokenType.name,r.offset=e.offset,r.length=e.length,r.startLine=e.range.start.line,r.startColumn=e.range.start.character,r.endLine=e.range.end.line,r.endColumn=e.range.end.character),r}hydrate(e){const n=e.value,r=this.createHydrationContext(
n);return"$cstNode"in n&&this.hydrateCstNode(n.$cstNode,r),{lexerErrors:e.lexerErrors,lexerReport:e.lexerReport,parserErrors:e.parserErrors,value:this.hydrateAstNode(n,r)}}createHydrationContext(e){const n=new Map,r=new Map;for(const s of Ni(e))n.set(s,{});let i;if(e.$cstNode)for(const s of th(e.$cstNode)){let a;"fullText"in s?(a=new CD(s.fullText),i=a):"content"in s?a=new Pv:"tokenType"in s&&(a=this.hydrateCstLeafNode(s)),a&&(r.set(s,a),a.root=i)}return{astNodes:n,cstNodes:r}}hydrateAstNode(e,n){
const r=n.astNodes.get(e);r.$type=e.$type,r.$containerIndex=e.$containerIndex,r.$containerProperty=e.$containerProperty,e.$cstNode&&(r.$cstNode=n.cstNodes.get(e.$cstNode));for(const[i,s]of Object.entries(e))if(!i.startsWith("$"))if(Array.isArray(s)){const a=[];r[i]=a;for(const o of s)Mt(o)?a.push(this.setParent(this.hydrateAstNode(o,n),r)):$r(o)?a.push(this.hydrateReference(o,r,i,n)):a.push(o)}else Mt(s)?r[i]=this.setParent(this.hydrateAstNode(s,n),r):$r(s)?r[i]=this.hydrateReference(s,r,i,n):s!==
void 0&&(r[i]=s);return r}setParent(e,n){return e.$container=n,e}hydrateReference(e,n,r,i){return this.linker.buildReference(n,r,i.cstNodes.get(e.$refNode),e.$refText)}hydrateCstNode(e,n,r=0){const i=n.cstNodes.get(e);if(typeof e.grammarSource=="number"&&(i.grammarSource=this.getGrammarElement(e.grammarSource)),i.astNode=n.astNodes.get(e.astNode),ks(i))for(const s of e.content){const a=this.hydrateCstNode(s,n,r++);i.content.push(a)}return i}hydrateCstLeafNode(e){const n=this.getTokenType(e.tokenType),
r=e.offset,i=e.length,s=e.startLine,a=e.startColumn,o=e.endLine,u=e.endColumn,c=e.hidden;return new xv(r,i,{start:{line:s,character:a},end:{line:o,character:u}},n,c)}getTokenType(e){return this.lexer.definition[e]}getGrammarElementId(e){if(e)return this.grammarElementIdMap.size===0&&this.createGrammarElementIdMap(),this.grammarElementIdMap.get(e)}getGrammarElement(e){return this.grammarElementIdMap.size===0&&this.createGrammarElementIdMap(),this.grammarElementIdMap.getKey(e)}createGrammarElementIdMap(){
let e=0;for(const n of Ni(this.grammar))Yg(n)&&this.grammarElementIdMap.set(n,e++)}}function fT(t){return{documentation:{CommentProvider:e=>new jG(e),DocumentationProvider:e=>new MG(e)},parser:{AsyncParser:e=>new BG(e),GrammarConfig:e=>sL(e),LangiumParser:e=>K3(e),CompletionParser:e=>V3(e),ValueConverter:()=>new Y3,TokenBuilder:()=>new X3,Lexer:e=>new kG(e),ParserErrorMessageProvider:()=>new PD,LexerErrorMessageProvider:()=>new bG},workspace:{AstNodeLocator:()=>new gG,AstNodeDescriptionProvider:e=>new QD(
e),ReferenceDescriptionProvider:e=>new mG(e)},references:{Linker:e=>new rG(e),NameProvider:()=>new HD,ScopeProvider:e=>new YD(e),ScopeComputation:e=>new KD(e),References:e=>new iG(e)},serializer:{Hydrator:e=>new GG(e),JsonSerializer:e=>new cG(e)},validation:{DocumentValidator:e=>new fG(e),ValidationRegistry:e=>new dG(e)},shared:()=>t.shared}}function hT(t){return{ServiceRegistry:e=>new lG(e),workspace:{LangiumDocuments:e=>new WD(e),LangiumDocumentFactory:e=>new nG(e),DocumentBuilder:e=>new wG(e),
IndexManager:e=>new eT(e),WorkspaceManager:e=>new tT(e),FileSystemProvider:e=>t.fileSystemProvider(e),WorkspaceLock:()=>new qG,ConfigurationProvider:e=>new vG(e)}}}var bp;(function(t){t.merge=(e,n)=>kp(kp({},e),n)})(bp||(bp={}));function Ep(t,e,n,r,i,s,a,o,u){const c=[t,e,n,r,i,s,a,o,u].reduce(kp,{});return mT(c)}const pT=Symbol("isProxy");function Wv(t){if(t&&t[pT])for(const e of Object.values(t))Wv(e);return t}function mT(t,e){const n=new Proxy({},{deleteProperty:()=>!1,set:()=>{throw new Error(
"Cannot set property on injected service container")},get:(r,i)=>i===pT?!0:yT(r,i,t,e||n),getOwnPropertyDescriptor:(r,i)=>(yT(r,i,t,e||n),Object.getOwnPropertyDescriptor(r,i)),has:(r,i)=>i in t,ownKeys:()=>[...Object.getOwnPropertyNames(t)]});return n}const gT=Symbol();function yT(t,e,n,r){if(e in t){if(t[e]instanceof Error)throw new Error("Construction failure. Please make sure that your dependencies are constructable.",{cause:t[e]});if(t[e]===gT)throw new Error('Cycle detected. Please make "'+
String(e)+'" lazy. Visit https://langium.org/docs/reference/configuration-services/#resolving-cyclic-dependencies');return t[e]}else if(e in n){const i=n[e];t[e]=gT;try{t[e]=typeof i=="function"?i(r):mT(i,r)}catch(s){throw t[e]=s instanceof Error?s:void 0,s}return t[e]}else return}function kp(t,e){if(e){for(const[n,r]of Object.entries(e))if(r!==void 0){const i=t[n];i!==null&&r!==null&&typeof i=="object"&&typeof r=="object"?t[n]=kp(i,r):t[n]=r}}return t}class UG{readFile(){throw new Error("No fil\
e system is available.")}async readDirectory(){return[]}}const vT={fileSystemProvider:()=>new UG},zG={Grammar:()=>{},LanguageMetaData:()=>({caseInsensitive:!1,fileExtensions:[".langium"],languageId:"langium"})},WG={AstReflection:()=>new zE};function HG(){const t=Ep(hT(vT),WG),e=Ep(fT({shared:t}),zG);return t.ServiceRegistry.register(e),e}function VG(t){var e;const n=HG(),r=n.serializer.JsonSerializer.deserialize(t);return n.shared.workspace.LangiumDocumentFactory.fromModel(r,_t.parse(`memory://${(e=
r.name)!==null&&e!==void 0?e:"grammar"}.langium`)),r}var KG={done:!0,hasNext:!1},Vc={done:!1,hasNext:!1},ZG=()=>KG,XG=t=>({hasNext:!0,next:t,done:!1});function et(t,...e){let n=t,r=e.map(s=>"lazy"in s?YG(s):void 0),i=0;for(;i<e.length;){if(r[i]===void 0||!JG(n)){let u=e[i];n=u(n),i+=1;continue}let s=[];for(let u=i;u<e.length;u++){let c=r[u];if(c===void 0||(s.push(c),c.isSingle))break}let a=[];for(let u of n)if(wT(u,a,s))break;let{isSingle:o}=s.at(-1);n=o?a[0]:a,i+=s.length}return n}function wT(t,e,n){
if(n.length===0)return e.push(t),!1;let r=t,i=Vc,s=!1;for(let[a,o]of n.entries()){let{index:u,items:c}=o;if(c.push(r),i=o(r,u,c),o.index+=1,i.hasNext){if(i.hasMany??!1){for(let l of i.next)if(wT(l,e,n.slice(a+1)))return!0;return s}r=i.next}if(!i.hasNext)break;i.done&&(s=!0)}return i.hasNext&&e.push(r),s}function YG(t){let{lazy:e,lazyArgs:n}=t,r=e(...n);return Object.assign(r,{isSingle:e.single??!1,index:0,items:[]})}function JG(t){return typeof t=="string"||typeof t=="object"&&t!==null&&Symbol.iterator in
t}function bT(t,e){let n=e.length-t.length;if(n===1){let[r,...i]=e;return et(r,{lazy:t,lazyArgs:i})}if(n===0){let r={lazy:t,lazyArgs:e};return Object.assign(i=>et(i,r),r)}throw new Error("Wrong number of arguments")}function QG(t,e,n){let r=i=>t(i,...e);return n===void 0?r:Object.assign(r,{lazy:n,lazyArgs:e})}function Et(t,e,n){let r=t.length-e.length;if(r===0)return t(...e);if(r===1)return QG(t,e,n);throw new Error("Wrong number of arguments")}function Rp(...t){return Et(Object.values,t)}function jo(...t){
return bT(eU,t)}function eU(){let t=new Set;return e=>t.has(e)?Vc:(t.add(e),{done:!1,hasNext:!0,next:e})}function tU(...t){return Et(nU,t,rU)}var nU=(t,e)=>e<0?[]:t.slice(0,e);function rU(t){if(t<=0)return ZG;let e=t;return n=>(e-=1,{done:e<=0,hasNext:!0,next:n})}function Ar(...t){return Et(iU,t)}var iU=(t,e)=>t.length>=e,ET={asc:(t,e)=>t>e,desc:(t,e)=>t<e};function sU(t,e){let[n,...r]=e;if(!aU(n)){let s=Hv(...r);return t(n,s)}let i=Hv(n,...r);return s=>t(s,i)}function Hv(t,e,...n){let r=typeof t==
"function"?t:t[0],i=typeof t=="function"?"asc":t[1],{[i]:s}=ET,a=e===void 0?void 0:Hv(e,...n);return(o,u)=>{let c=r(o),l=r(u);return s(c,l)?1:s(l,c)?-1:a?.(o,u)??0}}function aU(t){if(kT(t))return!0;if(typeof t!="object"||!Array.isArray(t))return!1;let[e,n,...r]=t;return kT(e)&&typeof n=="string"&&n in ET&&r.length===0}var kT=t=>typeof t=="function"&&t.length===1;function oU(...t){return Et(uU,t)}function uU(t,e){return e(t),t}function RT(...t){return Et(cU,t)}function cU(t,e){let n=[...t];return n.
sort(e),n}function lU(...t){return sU(dU,t)}var dU=(t,e)=>[...t].sort(e);function Vv(...t){return Et(fU,t)}var fU=(t,e,n)=>t.reduce(e,n);function hU(...t){return Et(pU,t)}function pU(t){return[...t].reverse()}function Ui(...t){return Et(mU,t)}var mU=(t,e)=>t[e];function Bo(...t){return Et(gU,t)}function gU(t,e){let n={};for(let[r,i]of Object.entries(t)){let s=e(i,r,t);n[r]=s}return n}function fe(t){return!!t}function Kc(...t){return Et(Object.keys,t)}function Zc(...t){return Et(yU,t)}var yU=t=>t.
at(-1);function Ht(...t){return Et(vU,t,wU)}var vU=(t,e)=>t.map(e),wU=t=>(e,n,r)=>({done:!1,hasNext:!0,next:t(e,n,r)});function ki(...t){return Et(bU,t)}function bU(t,e){let n={};for(let[r,i]of t.entries()){let[s,a]=e(i,r,t);n[s]=a}return n}function $p(t){return typeof t=="number"&&!Number.isNaN(t)}function EU(t){return t instanceof Promise}function Kv(t){return typeof t=="string"}function tn(t){return t===void 0?!0:typeof t=="string"||Array.isArray(t)?t.length===0:Object.keys(t).length===0}function Un(t){
return t!=null}function kU(t){return e=>!t(e)}function Ft(t){return t==null}function $T(t){return Array.isArray(t)}function Zv(t){return typeof t=="boolean"}function Rn(t){return t!==void 0}function RU(t,{triggerAt:e="end",minQuietPeriodMs:n,maxBurstDurationMs:r,minGapMs:i,reducer:s=$U}){let a,o,u,c,l=()=>{let h=u;h!==void 0&&(u=void 0,t(h),o=setTimeout(f,i))},f=()=>{clearTimeout(o),o=void 0,a===void 0&&l()},d=()=>{clearTimeout(a),a=void 0,c=void 0,o===void 0&&l()};return{call:(...h)=>{let p=a===
void 0&&o===void 0;if((e!=="start"||p)&&(u=s(u,...h)),!(a===void 0&&!p)){{clearTimeout(a);let w=Date.now();c??=w;let v=Math.min(n,r-(w-c));a=setTimeout(d,v)}e!=="end"&&p&&l()}},cancel:()=>{clearTimeout(a),a=void 0,c=void 0,clearTimeout(o),o=void 0,u=void 0},flush:()=>{d(),f()},get isIdle(){return a===void 0&&o===void 0}}}var $U=()=>"";function qo(...t){return Et(DU,t)}var DU=(t,e)=>{let n=new Map;for(let[r,i]of t.entries()){let s=e(i,r,t);if(s!==void 0){let a=n.get(s);a===void 0&&(a=[],n.set(s,a)),
a.push(i)}}return Object.fromEntries(n)};function TU(){return SU}var SU=t=>t;function Xc(...t){return Et(CU,t)}function CU(t,e){let n={};for(let[r,i]of t.entries()){let s=e(i,r,t);n[s]=i}return n}function Wr(...t){return Et(_U,t,AU)}var _U=(t,e)=>t.flatMap(e),AU=t=>(e,n,r)=>{let i=t(e,n,r);return Array.isArray(i)?{done:!1,hasNext:!0,hasMany:!0,next:i}:{done:!1,hasNext:!0,next:i}};function xU(...t){return Et(PU,t,NU)}function PU(t,e){return t.forEach(e),t}var NU=t=>(e,n,r)=>(t(e,n,r),{done:!1,hasNext:!0,
next:e});function DT(...t){return Et(IU,t)}function IU(t,e){for(let[n,r]of Object.entries(t))e(r,n,t);return t}function OU(...t){return Et(Object.fromEntries,t)}function Yc(...t){return Et(Object.entries,t)}function Qe(...t){return Et(LU,t,FU)}var LU=(t,e)=>t.filter(e),FU=t=>(e,n,r)=>t(e,n,r)?{done:!1,hasNext:!0,next:e}:Vc,TT=t=>Object.assign(t,{single:!0});function ST(...t){return Et(MU,t,TT(jU))}var MU=(t,e)=>t.find(e),jU=t=>(e,n,r)=>t(e,n,r)?{done:!0,hasNext:!0,next:e}:Vc;function CT(...t){return Et(
BU,t)}var BU=(t,e)=>{for(let n=t.length-1;n>=0;n--){let r=t[n];if(e(r,n,t))return r}};function Go(...t){return Et(qU,t,TT(GU))}var qU=([t])=>t,GU=()=>UU,UU=t=>({hasNext:!0,next:t,done:!0});function _T(...t){return Et(zU,t)}var zU=(t,e)=>[...t,...e];function WU(...t){return bT(HU,t)}function HU(t){if(t.length===0)return XG;let e=new Map;for(let n of t)e.set(n,(e.get(n)??0)+1);return n=>{let r=e.get(n);return r===void 0||r===0?{done:!1,hasNext:!0,next:n}:(e.set(n,r-1),Vc)}}function VU(...t){return Et(
KU,t)}var KU=(t,e)=>e.some(n=>n(t));function ZU(...t){return Et(XU,t)}function XU(t,e){if(e<1)throw new RangeError(`chunk: A chunk size of '${e.toString()}' would result in an infinite array`);if(t.length===0)return[];if(e>=t.length)return[[...t]];let n=Math.ceil(t.length/e),r=new Array(n);if(e===1)for(let[i,s]of t.entries())r[i]=[s];else for(let i=0;i<n;i+=1){let s=i*e;r[i]=t.slice(s,s+e)}return r}function AT(...t){return Et(YU,t)}var YU=(t,{min:e,max:n})=>e!==void 0&&t<e?e:n!==void 0&&t>n?n:t,
JU={reset:[0,0],bold:[1,22,"\x1B[22m\x1B[1m"],dim:[2,22,"\x1B[22m\x1B[2m"],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,
39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]},QU=Object.entries(JU);function Xv(t){return String(t)}Xv.open="",Xv.close="";function e8(t=!1){let e=typeof process<"u"?process:void 0,n=e?.env||{},r=e?.argv||[];return!("NO_COLOR"in n||r.includes("--no-color"))&&("FORCE_COLOR"in n||r.includes("--colo\
r")||e?.platform==="win32"||t&&n.TERM!=="dumb"||"CI"in n)||typeof window<"u"&&!!window.chrome}function t8(t=!1){let e=e8(t),n=(a,o,u,c)=>{let l="",f=0;do l+=a.substring(f,c)+u,f=c+o.length,c=a.indexOf(o,f);while(~c);return l+a.substring(f)},r=(a,o,u=a)=>{let c=l=>{let f=String(l),d=f.indexOf(o,a.length);return~d?a+n(f,o,u,d)+o:a+f+o};return c.open=a,c.close=o,c},i={isColorSupported:e},s=a=>`\x1B[${a}m`;for(let[a,o]of QU)i[a]=e?r(s(o[0]),s(o[1]),o[2]):Xv;return i}var n8=process.env.FORCE_TTY!==void 0||
r1(1),nn=t8(n8),Sa={},Kt={},xT;function Yv(){if(xT)return Kt;xT=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.thenable=Kt.typedArray=Kt.stringArray=Kt.array=Kt.func=Kt.error=Kt.number=Kt.string=Kt.boolean=void 0;function t(c){return c===!0||c===!1}Kt.boolean=t;function e(c){return typeof c=="string"||c instanceof String}Kt.string=e;function n(c){return typeof c=="number"||c instanceof Number}Kt.number=n;function r(c){return c instanceof Error}Kt.error=r;function i(c){return typeof c=="f\
unction"}Kt.func=i;function s(c){return Array.isArray(c)}Kt.array=s;function a(c){return s(c)&&c.every(l=>e(l))}Kt.stringArray=a;function o(c,l){return Array.isArray(c)&&c.every(l)}Kt.typedArray=o;function u(c){return c&&i(c.then)}return Kt.thenable=u,Kt}var ct={},Ca={},_a={},Dp={},Jv={},Se={},PT;function NT(){if(PT)return Se;PT=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.Message=Se.NotificationType9=Se.NotificationType8=Se.NotificationType7=Se.NotificationType6=Se.NotificationType5=Se.
NotificationType4=Se.NotificationType3=Se.NotificationType2=Se.NotificationType1=Se.NotificationType0=Se.NotificationType=Se.RequestType9=Se.RequestType8=Se.RequestType7=Se.RequestType6=Se.RequestType5=Se.RequestType4=Se.RequestType3=Se.RequestType2=Se.RequestType1=Se.RequestType=Se.RequestType0=Se.AbstractMessageSignature=Se.ParameterStructures=Se.ResponseError=Se.ErrorCodes=void 0;const t=zc();var e;(function(T){T.ParseError=-32700,T.InvalidRequest=-32600,T.MethodNotFound=-32601,T.InvalidParams=
-32602,T.InternalError=-32603,T.jsonrpcReservedErrorRangeStart=-32099,T.serverErrorStart=-32099,T.MessageWriteError=-32099,T.MessageReadError=-32098,T.PendingResponseRejected=-32097,T.ConnectionInactive=-32096,T.ServerNotInitialized=-32002,T.UnknownErrorCode=-32001,T.jsonrpcReservedErrorRangeEnd=-32e3,T.serverErrorEnd=-32e3})(e||(Se.ErrorCodes=e={}));class n extends Error{constructor($,j,A){super(j),this.code=t.number($)?$:e.UnknownErrorCode,this.data=A,Object.setPrototypeOf(this,n.prototype)}toJson(){
const $={code:this.code,message:this.message};return this.data!==void 0&&($.data=this.data),$}}Se.ResponseError=n;class r{constructor($){this.kind=$}static is($){return $===r.auto||$===r.byName||$===r.byPosition}toString(){return this.kind}}Se.ParameterStructures=r,r.auto=new r("auto"),r.byPosition=new r("byPosition"),r.byName=new r("byName");class i{constructor($,j){this.method=$,this.numberOfParams=j}get parameterStructures(){return r.auto}}Se.AbstractMessageSignature=i;class s extends i{constructor($){
super($,0)}}Se.RequestType0=s;class a extends i{constructor($,j=r.auto){super($,1),this._parameterStructures=j}get parameterStructures(){return this._parameterStructures}}Se.RequestType=a;class o extends i{constructor($,j=r.auto){super($,1),this._parameterStructures=j}get parameterStructures(){return this._parameterStructures}}Se.RequestType1=o;class u extends i{constructor($){super($,2)}}Se.RequestType2=u;class c extends i{constructor($){super($,3)}}Se.RequestType3=c;class l extends i{constructor($){
super($,4)}}Se.RequestType4=l;class f extends i{constructor($){super($,5)}}Se.RequestType5=f;class d extends i{constructor($){super($,6)}}Se.RequestType6=d;class h extends i{constructor($){super($,7)}}Se.RequestType7=h;class p extends i{constructor($){super($,8)}}Se.RequestType8=p;class w extends i{constructor($){super($,9)}}Se.RequestType9=w;class v extends i{constructor($,j=r.auto){super($,1),this._parameterStructures=j}get parameterStructures(){return this._parameterStructures}}Se.NotificationType=
v;class g extends i{constructor($){super($,0)}}Se.NotificationType0=g;class b extends i{constructor($,j=r.auto){super($,1),this._parameterStructures=j}get parameterStructures(){return this._parameterStructures}}Se.NotificationType1=b;class k extends i{constructor($){super($,2)}}Se.NotificationType2=k;class _ extends i{constructor($){super($,3)}}Se.NotificationType3=_;class I extends i{constructor($){super($,4)}}Se.NotificationType4=I;class Z extends i{constructor($){super($,5)}}Se.NotificationType5=
Z;class J extends i{constructor($){super($,6)}}Se.NotificationType6=J;class ue extends i{constructor($){super($,7)}}Se.NotificationType7=ue;class ae extends i{constructor($){super($,8)}}Se.NotificationType8=ae;class $e extends i{constructor($){super($,9)}}Se.NotificationType9=$e;var B;return function(T){function $(P){const L=P;return L&&t.string(L.method)&&(t.string(L.id)||t.number(L.id))}T.isRequest=$;function j(P){const L=P;return L&&t.string(L.method)&&P.id===void 0}T.isNotification=j;function A(P){
const L=P;return L&&(L.result!==void 0||!!L.error)&&(t.string(L.id)||t.number(L.id)||L.id===null)}T.isResponse=A}(B||(Se.Message=B={})),Se}var zi={},IT;function OT(){if(IT)return zi;IT=1;var t;Object.defineProperty(zi,"__esModule",{value:!0}),zi.LRUCache=zi.LinkedMap=zi.Touch=void 0;var e;(function(i){i.None=0,i.First=1,i.AsOld=i.First,i.Last=2,i.AsNew=i.Last})(e||(zi.Touch=e={}));class n{constructor(){this[t]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=
0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(s){return this._map.has(s)}get(s,a=e.None){const o=this._map.get(s);if(o)return a!==e.None&&this.touch(o,a),o.value}set(s,a,o=e.None){let u=this._map.get(s);if(u)u.value=a,o!==e.None&&this.touch(u,o);else{switch(u={key:s,value:a,next:void 0,previous:void 0},o){case e.
None:this.addItemLast(u);break;case e.First:this.addItemFirst(u);break;case e.Last:this.addItemLast(u);break;default:this.addItemLast(u);break}this._map.set(s,u),this._size++}return this}delete(s){return!!this.remove(s)}remove(s){const a=this._map.get(s);if(a)return this._map.delete(s),this.removeItem(a),this._size--,a.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const s=this._head;return this._map.delete(s.key),this.removeItem(s),this.
_size--,s.value}forEach(s,a){const o=this._state;let u=this._head;for(;u;){if(a?s.bind(a)(u.value,u.key,this):s(u.value,u.key,this),this._state!==o)throw new Error("LinkedMap got modified during iteration.");u=u.next}}keys(){const s=this._state;let a=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const u={value:a.key,done:!1};return a=a.next,u}else return{value:void 0,done:!0}}};return o}values(){const s=this.
_state;let a=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const u={value:a.value,done:!1};return a=a.next,u}else return{value:void 0,done:!0}}};return o}entries(){const s=this._state;let a=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const u={value:[a.key,a.value],done:!1};return a=a.next,u}else return{value:void 0,
done:!0}}};return o}[(t=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(s){if(s>=this.size)return;if(s===0){this.clear();return}let a=this._head,o=this.size;for(;a&&o>s;)this._map.delete(a.key),a=a.next,o--;this._head=a,this._size=o,a&&(a.previous=void 0),this._state++}addItemFirst(s){if(!this._head&&!this._tail)this._tail=s;else if(this._head)s.next=this._head,this._head.previous=s;else throw new Error("Invalid list");this._head=s,this._state++}addItemLast(s){if(!this._head&&
!this._tail)this._head=s;else if(this._tail)s.previous=this._tail,this._tail.next=s;else throw new Error("Invalid list");this._tail=s,this._state++}removeItem(s){if(s===this._head&&s===this._tail)this._head=void 0,this._tail=void 0;else if(s===this._head){if(!s.next)throw new Error("Invalid list");s.next.previous=void 0,this._head=s.next}else if(s===this._tail){if(!s.previous)throw new Error("Invalid list");s.previous.next=void 0,this._tail=s.previous}else{const a=s.next,o=s.previous;if(!a||!o)throw new Error(
"Invalid list");a.previous=o,o.next=a}s.next=void 0,s.previous=void 0,this._state++}touch(s,a){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(a!==e.First&&a!==e.Last)){if(a===e.First){if(s===this._head)return;const o=s.next,u=s.previous;s===this._tail?(u.next=void 0,this._tail=u):(o.previous=u,u.next=o),s.previous=void 0,s.next=this._head,this._head.previous=s,this._head=s,this._state++}else if(a===e.Last){if(s===this._tail)return;const o=s.next,u=s.previous;s===this._head?(o.previous=
void 0,this._head=o):(o.previous=u,u.next=o),s.next=void 0,s.previous=this._tail,this._tail.next=s,this._tail=s,this._state++}}}toJSON(){const s=[];return this.forEach((a,o)=>{s.push([o,a])}),s}fromJSON(s){this.clear();for(const[a,o]of s)this.set(a,o)}}zi.LinkedMap=n;class r extends n{constructor(s,a=1){super(),this._limit=s,this._ratio=Math.min(Math.max(0,a),1)}get limit(){return this._limit}set limit(s){this._limit=s,this.checkTrim()}get ratio(){return this._ratio}set ratio(s){this._ratio=Math.
min(Math.max(0,s),1),this.checkTrim()}get(s,a=e.AsNew){return super.get(s,a)}peek(s){return super.get(s,e.None)}set(s,a){return super.set(s,a,e.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}return zi.LRUCache=r,zi}var Jc={},LT;function r8(){if(LT)return Jc;LT=1,Object.defineProperty(Jc,"__esModule",{value:!0}),Jc.Disposable=void 0;var t;return function(e){function n(r){return{dispose:r}}e.create=n}(t||(Jc.Disposable=t={})),Jc}var Aa={},
FT;function i8(){if(FT)return Aa;FT=1,Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.SharedArrayReceiverStrategy=Aa.SharedArraySenderStrategy=void 0;const t=fp();var e;(function(a){a.Continue=0,a.Cancelled=1})(e||(e={}));class n{constructor(){this.buffers=new Map}enableCancellation(o){if(o.id===null)return;const u=new SharedArrayBuffer(4),c=new Int32Array(u,0,1);c[0]=e.Continue,this.buffers.set(o.id,u),o.$cancellationData=u}async sendCancellation(o,u){const c=this.buffers.get(u);if(c===void 0)
return;const l=new Int32Array(c,0,1);Atomics.store(l,0,e.Cancelled)}cleanup(o){this.buffers.delete(o)}dispose(){this.buffers.clear()}}Aa.SharedArraySenderStrategy=n;class r{constructor(o){this.data=new Int32Array(o,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===e.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class i{constructor(o){this.token=new r(o)}cancel(){}dispose(){}}class s{constructor(){
this.kind="request"}createCancellationTokenSource(o){const u=o.$cancellationData;return u===void 0?new t.CancellationTokenSource:new i(u)}}return Aa.SharedArrayReceiverStrategy=s,Aa}var Wi={},Qc={},MT;function jT(){if(MT)return Qc;MT=1,Object.defineProperty(Qc,"__esModule",{value:!0}),Qc.Semaphore=void 0;const t=ka();class e{constructor(r=1){if(r<=0)throw new Error("Capacity must be greater than 0");this._capacity=r,this._active=0,this._waiting=[]}lock(r){return new Promise((i,s)=>{this._waiting.
push({thunk:r,resolve:i,reject:s}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,t.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const r=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const i=r.thunk();i instanceof Promise?i.then(s=>{this._active--,r.resolve(s),this.runNext()},
s=>{this._active--,r.reject(s),this.runNext()}):(this._active--,r.resolve(i),this.runNext())}catch(i){this._active--,r.reject(i),this.runNext()}}}return Qc.Semaphore=e,Qc}var BT;function s8(){if(BT)return Wi;BT=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.ReadableStreamMessageReader=Wi.AbstractMessageReader=Wi.MessageReader=void 0;const t=ka(),e=zc(),n=Mo(),r=jT();var i;(function(u){function c(l){let f=l;return f&&e.func(f.listen)&&e.func(f.dispose)&&e.func(f.onError)&&e.func(f.onClose)&&
e.func(f.onPartialMessage)}u.is=c})(i||(Wi.MessageReader=i={}));class s{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter,this.partialMessageEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(c){this.errorEmitter.fire(this.asError(c))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.
event}firePartialMessage(c){this.partialMessageEmitter.fire(c)}asError(c){return c instanceof Error?c:new Error(`Reader received error. Reason: ${e.string(c.message)?c.message:"unknown"}`)}}Wi.AbstractMessageReader=s;var a;(function(u){function c(l){let f,d;const h=new Map;let p;const w=new Map;if(l===void 0||typeof l=="string")f=l??"utf-8";else{if(f=l.charset??"utf-8",l.contentDecoder!==void 0&&(d=l.contentDecoder,h.set(d.name,d)),l.contentDecoders!==void 0)for(const v of l.contentDecoders)h.set(
v.name,v);if(l.contentTypeDecoder!==void 0&&(p=l.contentTypeDecoder,w.set(p.name,p)),l.contentTypeDecoders!==void 0)for(const v of l.contentTypeDecoders)w.set(v.name,v)}return p===void 0&&(p=(0,t.default)().applicationJson.decoder,w.set(p.name,p)),{charset:f,contentDecoder:d,contentDecoders:h,contentTypeDecoder:p,contentTypeDecoders:w}}u.fromOptions=c})(a||(a={}));class o extends s{constructor(c,l){super(),this.readable=c,this.options=a.fromOptions(l),this.buffer=(0,t.default)().messageBuffer.create(
this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new r.Semaphore(1)}set partialMessageTimeout(c){this._partialMessageTimeout=c}get partialMessageTimeout(){return this._partialMessageTimeout}listen(c){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=c;const l=this.readable.onData(f=>{this.onData(f)});return this.readable.onError(f=>this.fireError(f)),this.readable.onClose(()=>this.fireClose()),
l}onData(c){try{for(this.buffer.append(c);;){if(this.nextMessageLength===-1){const f=this.buffer.tryReadHeaders(!0);if(!f)return;const d=f.get("content-length");if(!d){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(f))}`));return}const h=parseInt(d);if(isNaN(h)){this.fireError(new Error(`Content-Length value must be a number. Got ${d}`));return}this.nextMessageLength=h}const l=this.buffer.tryReadBody(this.nextMessageLength);if(l===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const f=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(l):l,d=await this.options.
contentTypeDecoder.decode(f,this.options);this.callback(d)}).catch(f=>{this.fireError(f)})}}catch(l){this.fireError(l)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,t.default)().timer.setTimeout((c,l)=>{this.partialMessageTimer=void 0,c===this.messageToken&&(this.firePartialMessage({messageToken:c,waitingTime:l}),
this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}return Wi.ReadableStreamMessageReader=o,Wi}var Hi={},qT;function a8(){if(qT)return Hi;qT=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.WriteableStreamMessageWriter=Hi.AbstractMessageWriter=Hi.MessageWriter=void 0;const t=ka(),e=zc(),n=jT(),r=Mo(),i="Content-Length: ",s=`\r
`;var a;(function(l){function f(d){let h=d;return h&&e.func(h.dispose)&&e.func(h.onClose)&&e.func(h.onError)&&e.func(h.write)}l.is=f})(a||(Hi.MessageWriter=a={}));class o{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(f,d,h){this.errorEmitter.fire([this.asError(f),d,h])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(
void 0)}asError(f){return f instanceof Error?f:new Error(`Writer received error. Reason: ${e.string(f.message)?f.message:"unknown"}`)}}Hi.AbstractMessageWriter=o;var u;(function(l){function f(d){return d===void 0||typeof d=="string"?{charset:d??"utf-8",contentTypeEncoder:(0,t.default)().applicationJson.encoder}:{charset:d.charset??"utf-8",contentEncoder:d.contentEncoder,contentTypeEncoder:d.contentTypeEncoder??(0,t.default)().applicationJson.encoder}}l.fromOptions=f})(u||(u={}));class c extends o{constructor(f,d){
super(),this.writable=f,this.options=u.fromOptions(d),this.errorCount=0,this.writeSemaphore=new n.Semaphore(1),this.writable.onError(h=>this.fireError(h)),this.writable.onClose(()=>this.fireClose())}async write(f){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(f,this.options).then(h=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(h):h).then(h=>{const p=[];return p.push(i,h.byteLength.toString(),s),p.push(s),this.doWrite(f,p,h)},h=>{throw this.
fireError(h),h}))}async doWrite(f,d,h){try{return await this.writable.write(d.join(""),"ascii"),this.writable.write(h)}catch(p){return this.handleError(p,f),Promise.reject(p)}}handleError(f,d){this.errorCount++,this.fireError(f,d,this.errorCount)}end(){this.writable.end()}}return Hi.WriteableStreamMessageWriter=c,Hi}var el={},GT;function o8(){if(GT)return el;GT=1,Object.defineProperty(el,"__esModule",{value:!0}),el.AbstractMessageBuffer=void 0;const t=13,e=10,n=`\r
`;class r{constructor(s="utf-8"){this._encoding=s,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(s){const a=typeof s=="string"?this.fromString(s,this._encoding):s;this._chunks.push(a),this._totalLength+=a.byteLength}tryReadHeaders(s=!1){if(this._chunks.length===0)return;let a=0,o=0,u=0,c=0;e:for(;o<this._chunks.length;){const h=this._chunks[o];for(u=0;u<h.length;){switch(h[u]){case t:switch(a){case 0:a=1;break;case 2:a=3;break;default:a=0}break;case e:switch(a){case 1:
a=2;break;case 3:a=4,u++;break e;default:a=0}break;default:a=0}u++}c+=h.byteLength,o++}if(a!==4)return;const l=this._read(c+u),f=new Map,d=this.toString(l,"ascii").split(n);if(d.length<2)return f;for(let h=0;h<d.length-2;h++){const p=d[h],w=p.indexOf(":");if(w===-1)throw new Error(`Message header must separate key and value using ':'
${p}`);const v=p.substr(0,w),g=p.substr(w+1).trim();f.set(s?v.toLowerCase():v,g)}return f}tryReadBody(s){if(!(this._totalLength<s))return this._read(s)}get numberOfBytes(){return this._totalLength}_read(s){if(s===0)return this.emptyBuffer();if(s>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===s){const c=this._chunks[0];return this._chunks.shift(),this._totalLength-=s,this.asNative(c)}if(this._chunks[0].byteLength>s){const c=this._chunks[0],l=this.asNative(
c,s);return this._chunks[0]=c.slice(s),this._totalLength-=s,l}const a=this.allocNative(s);let o=0,u=0;for(;s>0;){const c=this._chunks[u];if(c.byteLength>s){const l=c.slice(0,s);a.set(l,o),o+=s,this._chunks[u]=c.slice(s),this._totalLength-=s,s-=s}else a.set(c,o),o+=c.byteLength,this._chunks.shift(),this._totalLength-=c.byteLength,s-=c.byteLength}return a}}return el.AbstractMessageBuffer=r,el}var Qv={},UT;function u8(){return UT||(UT=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.
createMessageConnection=t.ConnectionOptions=t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.RequestCancellationReceiverStrategy=t.IdCancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=t.NullLogger=t.ProgressType=t.ProgressToken=void 0;const e=ka(),n=zc(),r=NT(),i=OT(),s=Mo(),a=fp();var o;(function($){$.type=new r.NotificationType(
"$/cancelRequest")})(o||(o={}));var u;(function($){function j(A){return typeof A=="string"||typeof A=="number"}$.is=j})(u||(t.ProgressToken=u={}));var c;(function($){$.type=new r.NotificationType("$/progress")})(c||(c={}));class l{constructor(){}}t.ProgressType=l;var f;(function($){function j(A){return n.func(A)}$.is=j})(f||(f={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var d;(function($){$[$.Off=0]="Off",$[$.Messages=1]="Messages",$[$.Compact=2]="Compact",
$[$.Verbose=3]="Verbose"})(d||(t.Trace=d={}));var h;(function($){$.Off="off",$.Messages="messages",$.Compact="compact",$.Verbose="verbose"})(h||(t.TraceValues=h={})),function($){function j(P){if(!n.string(P))return $.Off;switch(P=P.toLowerCase(),P){case"off":return $.Off;case"messages":return $.Messages;case"compact":return $.Compact;case"verbose":return $.Verbose;default:return $.Off}}$.fromString=j;function A(P){switch(P){case $.Off:return"off";case $.Messages:return"messages";case $.Compact:return"\
compact";case $.Verbose:return"verbose";default:return"off"}}$.toString=A}(d||(t.Trace=d={}));var p;(function($){$.Text="text",$.JSON="json"})(p||(t.TraceFormat=p={})),function($){function j(A){return n.string(A)?(A=A.toLowerCase(),A==="json"?$.JSON:$.Text):$.Text}$.fromString=j}(p||(t.TraceFormat=p={}));var w;(function($){$.type=new r.NotificationType("$/setTrace")})(w||(t.SetTraceNotification=w={}));var v;(function($){$.type=new r.NotificationType("$/logTrace")})(v||(t.LogTraceNotification=v={}));
var g;(function($){$[$.Closed=1]="Closed",$[$.Disposed=2]="Disposed",$[$.AlreadyListening=3]="AlreadyListening"})(g||(t.ConnectionErrors=g={}));class b extends Error{constructor(j,A){super(A),this.code=j,Object.setPrototypeOf(this,b.prototype)}}t.ConnectionError=b;var k;(function($){function j(A){const P=A;return P&&n.func(P.cancelUndispatched)}$.is=j})(k||(t.ConnectionStrategy=k={}));var _;(function($){function j(A){const P=A;return P&&(P.kind===void 0||P.kind==="id")&&n.func(P.createCancellationTokenSource)&&
(P.dispose===void 0||n.func(P.dispose))}$.is=j})(_||(t.IdCancellationReceiverStrategy=_={}));var I;(function($){function j(A){const P=A;return P&&P.kind==="request"&&n.func(P.createCancellationTokenSource)&&(P.dispose===void 0||n.func(P.dispose))}$.is=j})(I||(t.RequestCancellationReceiverStrategy=I={}));var Z;(function($){$.Message=Object.freeze({createCancellationTokenSource(A){return new a.CancellationTokenSource}});function j(A){return _.is(A)||I.is(A)}$.is=j})(Z||(t.CancellationReceiverStrategy=
Z={}));var J;(function($){$.Message=Object.freeze({sendCancellation(A,P){return A.sendNotification(o.type,{id:P})},cleanup(A){}});function j(A){const P=A;return P&&n.func(P.sendCancellation)&&n.func(P.cleanup)}$.is=j})(J||(t.CancellationSenderStrategy=J={}));var ue;(function($){$.Message=Object.freeze({receiver:Z.Message,sender:J.Message});function j(A){const P=A;return P&&Z.is(P.receiver)&&J.is(P.sender)}$.is=j})(ue||(t.CancellationStrategy=ue={}));var ae;(function($){function j(A){const P=A;return P&&
n.func(P.handleMessage)}$.is=j})(ae||(t.MessageStrategy=ae={}));var $e;(function($){function j(A){const P=A;return P&&(ue.is(P.cancellationStrategy)||k.is(P.connectionStrategy)||ae.is(P.messageStrategy))}$.is=j})($e||(t.ConnectionOptions=$e={}));var B;(function($){$[$.New=1]="New",$[$.Listening=2]="Listening",$[$.Closed=3]="Closed",$[$.Disposed=4]="Disposed"})(B||(B={}));function T($,j,A,P){const L=A!==void 0?A:t.NullLogger;let Q=0,H=0,S=0;const re="2.0";let ke;const je=new Map;let M;const V=new Map,
Le=new Map;let he,Ce=new i.LinkedMap,Be=new Map,pe=new Set,O=new Map,U=d.Off,ge=p.Text,z,me=B.New;const nt=new s.Emitter,mt=new s.Emitter,de=new s.Emitter,Ue=new s.Emitter,se=new s.Emitter,_e=P&&P.cancellationStrategy?P.cancellationStrategy:ue.Message;function Xe(R){if(R===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+R.toString()}function xt(R){return R===null?"res-unknown-"+(++S).toString():"res-"+R.toString()}function dt(){return"\
not-"+(++H).toString()}function ln(R,W){r.Message.isRequest(W)?R.set(Xe(W.id),W):r.Message.isResponse(W)?R.set(xt(W.id),W):R.set(dt(),W)}function gn(R){}function In(){return me===B.Listening}function X(){return me===B.Closed}function Y(){return me===B.Disposed}function ve(){(me===B.New||me===B.Listening)&&(me=B.Closed,mt.fire(void 0))}function yn(R){nt.fire([R,void 0,void 0])}function dn(R){nt.fire(R)}$.onClose(ve),$.onError(yn),j.onClose(ve),j.onError(dn);function ci(){he||Ce.size===0||(he=(0,e.
default)().timer.setImmediate(()=>{he=void 0,Zs()}))}function gs(R){r.Message.isRequest(R)?Ys(R):r.Message.isNotification(R)?ys(R):r.Message.isResponse(R)?Js(R):vs(R)}function Zs(){if(Ce.size===0)return;const R=Ce.shift();try{const W=P?.messageStrategy;ae.is(W)?W.handleMessage(R,gs):gs(R)}finally{ci()}}const Xs=R=>{try{if(r.Message.isNotification(R)&&R.method===o.type.method){const W=R.params.id,ne=Xe(W),ce=Ce.get(ne);if(r.Message.isRequest(ce)){const Ve=P?.connectionStrategy,ft=Ve&&Ve.cancelUndispatched?
Ve.cancelUndispatched(ce,gn):void 0;if(ft&&(ft.error!==void 0||ft.result!==void 0)){Ce.delete(ne),O.delete(W),ft.id=ce.id,li(ft,R.method,Date.now()),j.write(ft).catch(()=>L.error("Sending response for canceled message failed."));return}}const Ye=O.get(W);if(Ye!==void 0){Ye.cancel(),Ci(R);return}else pe.add(W)}ln(Ce,R)}finally{ci()}};function Ys(R){if(Y())return;function W(ze,bt,ht){const sn={jsonrpc:re,id:R.id};ze instanceof r.ResponseError?sn.error=ze.toJson():sn.result=ze===void 0?null:ze,li(sn,
bt,ht),j.write(sn).catch(()=>L.error("Sending response failed."))}function ne(ze,bt,ht){const sn={jsonrpc:re,id:R.id,error:ze.toJson()};li(sn,bt,ht),j.write(sn).catch(()=>L.error("Sending response failed."))}function ce(ze,bt,ht){ze===void 0&&(ze=null);const sn={jsonrpc:re,id:R.id,result:ze};li(sn,bt,ht),j.write(sn).catch(()=>L.error("Sending response failed."))}ta(R);const Ye=je.get(R.method);let Ve,ft;Ye&&(Ve=Ye.type,ft=Ye.handler);const Te=Date.now();if(ft||ke){const ze=R.id??String(Date.now()),
bt=_.is(_e.receiver)?_e.receiver.createCancellationTokenSource(ze):_e.receiver.createCancellationTokenSource(R);R.id!==null&&pe.has(R.id)&&bt.cancel(),R.id!==null&&O.set(ze,bt);try{let ht;if(ft)if(R.params===void 0){if(Ve!==void 0&&Ve.numberOfParams!==0){ne(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${R.method} defines ${Ve.numberOfParams} params but received none.`),R.method,Te);return}ht=ft(bt.token)}else if(Array.isArray(R.params)){if(Ve!==void 0&&Ve.parameterStructures===r.ParameterStructures.
byName){ne(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${R.method} defines parameters by name but received parameters by position`),R.method,Te);return}ht=ft(...R.params,bt.token)}else{if(Ve!==void 0&&Ve.parameterStructures===r.ParameterStructures.byPosition){ne(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${R.method} defines parameters by position but received parameters by name`),R.method,Te);return}ht=ft(R.params,bt.token)}else ke&&(ht=ke(R.method,R.params,bt.token));const sn=ht;
ht?sn.then?sn.then(On=>{O.delete(ze),W(On,R.method,Te)},On=>{O.delete(ze),On instanceof r.ResponseError?ne(On,R.method,Te):On&&n.string(On.message)?ne(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${R.method} failed with message: ${On.message}`),R.method,Te):ne(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${R.method} failed unexpectedly without providing any details.`),R.method,Te)}):(O.delete(ze),W(ht,R.method,Te)):(O.delete(ze),ce(ht,R.method,Te))}catch(ht){O.delete(ze),ht instanceof
r.ResponseError?W(ht,R.method,Te):ht&&n.string(ht.message)?ne(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${R.method} failed with message: ${ht.message}`),R.method,Te):ne(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${R.method} failed unexpectedly without providing any details.`),R.method,Te)}}else ne(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${R.method}`),R.method,Te)}function Js(R){if(!Y())if(R.id===null)R.error?L.error(`Received response message \
without id: Error is: 
${JSON.stringify(R.error,void 0,4)}`):L.error("Received response message without id. No further error information provided.");else{const W=R.id,ne=Be.get(W);if(na(R,ne),ne!==void 0){Be.delete(W);try{if(R.error){const ce=R.error;ne.reject(new r.ResponseError(ce.code,ce.message,ce.data))}else if(R.result!==void 0)ne.resolve(R.result);else throw new Error("Should never happen.")}catch(ce){ce.message?L.error(`Response handler '${ne.method}' failed with message: ${ce.message}`):L.error(`Response hand\
ler '${ne.method}' failed unexpectedly.`)}}}}function ys(R){if(Y())return;let W,ne;if(R.method===o.type.method){const ce=R.params.id;pe.delete(ce),Ci(R);return}else{const ce=V.get(R.method);ce&&(ne=ce.handler,W=ce.type)}if(ne||M)try{if(Ci(R),ne)if(R.params===void 0)W!==void 0&&W.numberOfParams!==0&&W.parameterStructures!==r.ParameterStructures.byName&&L.error(`Notification ${R.method} defines ${W.numberOfParams} params but received none.`),ne();else if(Array.isArray(R.params)){const ce=R.params;
R.method===c.type.method&&ce.length===2&&u.is(ce[0])?ne({token:ce[0],value:ce[1]}):(W!==void 0&&(W.parameterStructures===r.ParameterStructures.byName&&L.error(`Notification ${R.method} defines parameters by name but received parameters by position`),W.numberOfParams!==R.params.length&&L.error(`Notification ${R.method} defines ${W.numberOfParams} params but received ${ce.length} arguments`)),ne(...ce))}else W!==void 0&&W.parameterStructures===r.ParameterStructures.byPosition&&L.error(`Notificatio\
n ${R.method} defines parameters by position but received parameters by name`),ne(R.params);else M&&M(R.method,R.params)}catch(ce){ce.message?L.error(`Notification handler '${R.method}' failed with message: ${ce.message}`):L.error(`Notification handler '${R.method}' failed unexpectedly.`)}else de.fire(R)}function vs(R){if(!R){L.error("Received empty message.");return}L.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(R,null,4)}`);const W=R;if(n.string(W.id)||n.number(W.id)){const ne=W.id,ce=Be.get(ne);ce&&ce.reject(new Error("The received response has neither a result nor an error property."))}}function Xn(R){if(R!=null)switch(U){case d.Verbose:return JSON.stringify(R,null,4);case d.Compact:return JSON.stringify(R);default:return}}function Qs(R){if(!(U===d.Off||!z))if(ge===p.Text){let W;(U===d.Verbose||U===d.Compact)&&R.params&&(W=`Params: ${Xn(R.params)}

`),z.log(`Sending request '${R.method} - (${R.id})'.`,W)}else Rr("send-request",R)}function ea(R){if(!(U===d.Off||!z))if(ge===p.Text){let W;(U===d.Verbose||U===d.Compact)&&(R.params?W=`Params: ${Xn(R.params)}

`:W=`No parameters provided.

`),z.log(`Sending notification '${R.method}'.`,W)}else Rr("send-notification",R)}function li(R,W,ne){if(!(U===d.Off||!z))if(ge===p.Text){let ce;(U===d.Verbose||U===d.Compact)&&(R.error&&R.error.data?ce=`Error data: ${Xn(R.error.data)}

`:R.result?ce=`Result: ${Xn(R.result)}

`:R.error===void 0&&(ce=`No result returned.

`)),z.log(`Sending response '${W} - (${R.id})'. Processing request took ${Date.now()-ne}ms`,ce)}else Rr("send-response",R)}function ta(R){if(!(U===d.Off||!z))if(ge===p.Text){let W;(U===d.Verbose||U===d.Compact)&&R.params&&(W=`Params: ${Xn(R.params)}

`),z.log(`Received request '${R.method} - (${R.id})'.`,W)}else Rr("receive-request",R)}function Ci(R){if(!(U===d.Off||!z||R.method===v.type.method))if(ge===p.Text){let W;(U===d.Verbose||U===d.Compact)&&(R.params?W=`Params: ${Xn(R.params)}

`:W=`No parameters provided.

`),z.log(`Received notification '${R.method}'.`,W)}else Rr("receive-notification",R)}function na(R,W){if(!(U===d.Off||!z))if(ge===p.Text){let ne;if((U===d.Verbose||U===d.Compact)&&(R.error&&R.error.data?ne=`Error data: ${Xn(R.error.data)}

`:R.result?ne=`Result: ${Xn(R.result)}

`:R.error===void 0&&(ne=`No result returned.

`)),W){const ce=R.error?` Request failed: ${R.error.message} (${R.error.code}).`:"";z.log(`Received response '${W.method} - (${R.id})' in ${Date.now()-W.timerStart}ms.${ce}`,ne)}else z.log(`Received response ${R.id} without active response promise.`,ne)}else Rr("receive-response",R)}function Rr(R,W){if(!z||U===d.Off)return;const ne={isLSPMessage:!0,type:R,message:W,timestamp:Date.now()};z.log(ne)}function Fr(){if(X())throw new b(g.Closed,"Connection is closed.");if(Y())throw new b(g.Disposed,"Co\
nnection is disposed.")}function go(){if(In())throw new b(g.AlreadyListening,"Connection is already listening")}function q(){if(!In())throw new Error("Call listen() first.")}function E(R){return R===void 0?null:R}function x(R){if(R!==null)return R}function m(R){return R!=null&&!Array.isArray(R)&&typeof R=="object"}function D(R,W){switch(R){case r.ParameterStructures.auto:return m(W)?x(W):[E(W)];case r.ParameterStructures.byName:if(!m(W))throw new Error("Received parameters by name but param is n\
ot an object literal.");return x(W);case r.ParameterStructures.byPosition:return[E(W)];default:throw new Error(`Unknown parameter structure ${R.toString()}`)}}function y(R,W){let ne;const ce=R.numberOfParams;switch(ce){case 0:ne=void 0;break;case 1:ne=D(R.parameterStructures,W[0]);break;default:ne=[];for(let Ye=0;Ye<W.length&&Ye<ce;Ye++)ne.push(E(W[Ye]));if(W.length<ce)for(let Ye=W.length;Ye<ce;Ye++)ne.push(null);break}return ne}const N={sendNotification:(R,...W)=>{Fr();let ne,ce;if(n.string(R)){
ne=R;const Ve=W[0];let ft=0,Te=r.ParameterStructures.auto;r.ParameterStructures.is(Ve)&&(ft=1,Te=Ve);let ze=W.length;const bt=ze-ft;switch(bt){case 0:ce=void 0;break;case 1:ce=D(Te,W[ft]);break;default:if(Te===r.ParameterStructures.byName)throw new Error(`Received ${bt} parameters for 'by Name' notification parameter structure.`);ce=W.slice(ft,ze).map(ht=>E(ht));break}}else{const Ve=W;ne=R.method,ce=y(R,Ve)}const Ye={jsonrpc:re,method:ne,params:ce};return ea(Ye),j.write(Ye).catch(Ve=>{throw L.error(
"Sending notification failed."),Ve})},onNotification:(R,W)=>{Fr();let ne;return n.func(R)?M=R:W&&(n.string(R)?(ne=R,V.set(R,{type:void 0,handler:W})):(ne=R.method,V.set(R.method,{type:R,handler:W}))),{dispose:()=>{ne!==void 0?V.delete(ne):M=void 0}}},onProgress:(R,W,ne)=>{if(Le.has(W))throw new Error(`Progress handler for token ${W} already registered`);return Le.set(W,ne),{dispose:()=>{Le.delete(W)}}},sendProgress:(R,W,ne)=>N.sendNotification(c.type,{token:W,value:ne}),onUnhandledProgress:Ue.event,
sendRequest:(R,...W)=>{Fr(),q();let ne,ce,Ye;if(n.string(R)){ne=R;const ze=W[0],bt=W[W.length-1];let ht=0,sn=r.ParameterStructures.auto;r.ParameterStructures.is(ze)&&(ht=1,sn=ze);let On=W.length;a.CancellationToken.is(bt)&&(On=On-1,Ye=bt);const di=On-ht;switch(di){case 0:ce=void 0;break;case 1:ce=D(sn,W[ht]);break;default:if(sn===r.ParameterStructures.byName)throw new Error(`Received ${di} parameters for 'by Name' request parameter structure.`);ce=W.slice(ht,On).map(YP=>E(YP));break}}else{const ze=W;
ne=R.method,ce=y(R,ze);const bt=R.numberOfParams;Ye=a.CancellationToken.is(ze[bt])?ze[bt]:void 0}const Ve=Q++;let ft;Ye&&(ft=Ye.onCancellationRequested(()=>{const ze=_e.sender.sendCancellation(N,Ve);return ze===void 0?(L.log(`Received no promise from cancellation strategy when cancelling id ${Ve}`),Promise.resolve()):ze.catch(()=>{L.log(`Sending cancellation messages for id ${Ve} failed`)})}));const Te={jsonrpc:re,id:Ve,method:ne,params:ce};return Qs(Te),typeof _e.sender.enableCancellation=="fun\
ction"&&_e.sender.enableCancellation(Te),new Promise(async(ze,bt)=>{const ht=di=>{ze(di),_e.sender.cleanup(Ve),ft?.dispose()},sn=di=>{bt(di),_e.sender.cleanup(Ve),ft?.dispose()},On={method:ne,timerStart:Date.now(),resolve:ht,reject:sn};try{await j.write(Te),Be.set(Ve,On)}catch(di){throw L.error("Sending request failed."),On.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,di.message?di.message:"Unknown reason")),di}})},onRequest:(R,W)=>{Fr();let ne=null;return f.is(R)?(ne=void 0,ke=R):n.
string(R)?(ne=null,W!==void 0&&(ne=R,je.set(R,{handler:W,type:void 0}))):W!==void 0&&(ne=R.method,je.set(R.method,{type:R,handler:W})),{dispose:()=>{ne!==null&&(ne!==void 0?je.delete(ne):ke=void 0)}}},hasPendingResponse:()=>Be.size>0,trace:async(R,W,ne)=>{let ce=!1,Ye=p.Text;ne!==void 0&&(n.boolean(ne)?ce=ne:(ce=ne.sendNotification||!1,Ye=ne.traceFormat||p.Text)),U=R,ge=Ye,U===d.Off?z=void 0:z=W,ce&&!X()&&!Y()&&await N.sendNotification(w.type,{value:d.toString(R)})},onError:nt.event,onClose:mt.event,
onUnhandledNotification:de.event,onDispose:se.event,end:()=>{j.end()},dispose:()=>{if(Y())return;me=B.Disposed,se.fire(void 0);const R=new r.ResponseError(r.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const W of Be.values())W.reject(R);Be=new Map,O=new Map,pe=new Set,Ce=new i.LinkedMap,n.func(j.dispose)&&j.dispose(),n.func($.dispose)&&$.dispose()},listen:()=>{Fr(),go(),me=B.Listening,$.listen(Xs)},inspect:()=>{(0,e.default)().console.log("ins\
pect")}};return N.onNotification(v.type,R=>{if(U===d.Off||!z)return;const W=U===d.Verbose||U===d.Compact;z.log(R.message,W?R.verbose:void 0)}),N.onNotification(c.type,R=>{const W=Le.get(R.token);W?W(R.value):Ue.fire(R)}),N}t.createMessageConnection=T}(Qv)),Qv}var zT;function ew(){return zT||(zT=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressType=t.ProgressToken=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.AbstractMessageBuffer=t.WriteableStreamMessageWriter=
t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.LRUCache=t.Touch=t.LinkedMap=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.
NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.Message=t.RAL=void 0,t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=void 0;const e=NT();Object.defineProperty(t,"Me\
ssage",{enumerable:!0,get:function(){return e.Message}}),Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return e.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return e.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return e.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return e.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){
return e.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return e.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return e.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return e.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return e.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return e.RequestType8}}),Object.
defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return e.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return e.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return e.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return e.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return e.NotificationType0}}),Object.defineProperty(
t,"NotificationType1",{enumerable:!0,get:function(){return e.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return e.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return e.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return e.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return e.NotificationType5}}),Object.
defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return e.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return e.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return e.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return e.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return e.ParameterStructures}});
const n=OT();Object.defineProperty(t,"LinkedMap",{enumerable:!0,get:function(){return n.LinkedMap}}),Object.defineProperty(t,"LRUCache",{enumerable:!0,get:function(){return n.LRUCache}}),Object.defineProperty(t,"Touch",{enumerable:!0,get:function(){return n.Touch}});const r=r8();Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return r.Disposable}});const i=Mo();Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return i.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,
get:function(){return i.Emitter}});const s=fp();Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return s.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return s.CancellationToken}});const a=i8();Object.defineProperty(t,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return a.SharedArraySenderStrategy}}),Object.defineProperty(t,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return a.SharedArrayReceiverStrategy}});
const o=s8();Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return o.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return o.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return o.ReadableStreamMessageReader}});const u=a8();Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return u.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",
{enumerable:!0,get:function(){return u.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return u.WriteableStreamMessageWriter}});const c=o8();Object.defineProperty(t,"AbstractMessageBuffer",{enumerable:!0,get:function(){return c.AbstractMessageBuffer}});const l=u8();Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return l.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){
return l.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return l.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return l.createMessageConnection}}),Object.defineProperty(t,"ProgressToken",{enumerable:!0,get:function(){return l.ProgressToken}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return l.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return l.Trace}}),
Object.defineProperty(t,"TraceValues",{enumerable:!0,get:function(){return l.TraceValues}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return l.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return l.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return l.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return l.ConnectionErrors}}),
Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return l.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return l.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return l.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return l.CancellationStrategy}}),Object.defineProperty(t,"MessageStrategy",
{enumerable:!0,get:function(){return l.MessageStrategy}});const f=ka();t.RAL=f.default}(Jv)),Jv}var WT;function c8(){if(WT)return Dp;WT=1,Object.defineProperty(Dp,"__esModule",{value:!0});const t=a1,e=ew();class n extends e.AbstractMessageBuffer{constructor(u="utf-8"){super(u)}emptyBuffer(){return n.emptyBuffer}fromString(u,c){return Buffer.from(u,c)}toString(u,c){return u instanceof Buffer?u.toString(c):new t.TextDecoder(c).decode(u)}asNative(u,c){return c===void 0?u instanceof Buffer?u:Buffer.
from(u):u instanceof Buffer?u.slice(0,c):Buffer.from(u,0,c)}allocNative(u){return Buffer.allocUnsafe(u)}}n.emptyBuffer=Buffer.allocUnsafe(0);class r{constructor(u){this.stream=u}onClose(u){return this.stream.on("close",u),e.Disposable.create(()=>this.stream.off("close",u))}onError(u){return this.stream.on("error",u),e.Disposable.create(()=>this.stream.off("error",u))}onEnd(u){return this.stream.on("end",u),e.Disposable.create(()=>this.stream.off("end",u))}onData(u){return this.stream.on("data",u),
e.Disposable.create(()=>this.stream.off("data",u))}}class i{constructor(u){this.stream=u}onClose(u){return this.stream.on("close",u),e.Disposable.create(()=>this.stream.off("close",u))}onError(u){return this.stream.on("error",u),e.Disposable.create(()=>this.stream.off("error",u))}onEnd(u){return this.stream.on("end",u),e.Disposable.create(()=>this.stream.off("end",u))}write(u,c){return new Promise((l,f)=>{const d=h=>{h==null?l():f(h)};typeof u=="string"?this.stream.write(u,c,d):this.stream.write(
u,d)})}end(){this.stream.end()}}const s=Object.freeze({messageBuffer:Object.freeze({create:o=>new n(o)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(o,u)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(o,void 0,0),u.charset))}catch(c){return Promise.reject(c)}}}),decoder:Object.freeze({name:"application/json",decode:(o,u)=>{try{return o instanceof Buffer?Promise.resolve(JSON.parse(o.toString(u.charset))):Promise.resolve(JSON.parse(new t.TextDecoder(
u.charset).decode(o)))}catch(c){return Promise.reject(c)}}})}),stream:Object.freeze({asReadableStream:o=>new r(o),asWritableStream:o=>new i(o)}),console,timer:Object.freeze({setTimeout(o,u,...c){const l=setTimeout(o,u,...c);return{dispose:()=>clearTimeout(l)}},setImmediate(o,...u){const c=setImmediate(o,...u);return{dispose:()=>clearImmediate(c)}},setInterval(o,u,...c){const l=setInterval(o,u,...c);return{dispose:()=>clearInterval(l)}}})});function a(){return s}return function(o){function u(){e.
RAL.install(s)}o.install=u}(a||(a={})),Dp.default=a,Dp}var HT;function xa(){return HT||(HT=1,function(t){var e=_a&&_a.__createBinding||(Object.create?function(B,T,$,j){j===void 0&&(j=$);var A=Object.getOwnPropertyDescriptor(T,$);(!A||("get"in A?!T.__esModule:A.writable||A.configurable))&&(A={enumerable:!0,get:function(){return T[$]}}),Object.defineProperty(B,j,A)}:function(B,T,$,j){j===void 0&&(j=$),B[j]=T[$]}),n=_a&&_a.__exportStar||function(B,T){for(var $ in B)$!=="default"&&!Object.prototype.
hasOwnProperty.call(T,$)&&e(T,B,$)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.createServerSocketTransport=t.createClientSocketTransport=t.createServerPipeTransport=t.createClientPipeTransport=t.generateRandomPipeName=t.StreamMessageWriter=t.StreamMessageReader=t.SocketMessageWriter=t.SocketMessageReader=t.PortMessageWriter=t.PortMessageReader=t.IPCMessageWriter=t.IPCMessageReader=void 0;const r=c8();r.default.install();const i=bs,s=o1,a=u1,o=c1,u=ew();n(ew(),t);
class c extends u.AbstractMessageReader{constructor(T){super(),this.process=T;let $=this.process;$.on("error",j=>this.fireError(j)),$.on("close",()=>this.fireClose())}listen(T){return this.process.on("message",T),u.Disposable.create(()=>this.process.off("message",T))}}t.IPCMessageReader=c;class l extends u.AbstractMessageWriter{constructor(T){super(),this.process=T,this.errorCount=0;const $=this.process;$.on("error",j=>this.fireError(j)),$.on("close",()=>this.fireClose)}write(T){try{return typeof this.
process.send=="function"&&this.process.send(T,void 0,void 0,$=>{$?(this.errorCount++,this.handleError($,T)):this.errorCount=0}),Promise.resolve()}catch($){return this.handleError($,T),Promise.reject($)}}handleError(T,$){this.errorCount++,this.fireError(T,$,this.errorCount)}end(){}}t.IPCMessageWriter=l;class f extends u.AbstractMessageReader{constructor(T){super(),this.onData=new u.Emitter,T.on("close",()=>this.fireClose),T.on("error",$=>this.fireError($)),T.on("message",$=>{this.onData.fire($)})}listen(T){
return this.onData.event(T)}}t.PortMessageReader=f;class d extends u.AbstractMessageWriter{constructor(T){super(),this.port=T,this.errorCount=0,T.on("close",()=>this.fireClose()),T.on("error",$=>this.fireError($))}write(T){try{return this.port.postMessage(T),Promise.resolve()}catch($){return this.handleError($,T),Promise.reject($)}}handleError(T,$){this.errorCount++,this.fireError(T,$,this.errorCount)}end(){}}t.PortMessageWriter=d;class h extends u.ReadableStreamMessageReader{constructor(T,$="ut\
f-8"){super((0,r.default)().stream.asReadableStream(T),$)}}t.SocketMessageReader=h;class p extends u.WriteableStreamMessageWriter{constructor(T,$){super((0,r.default)().stream.asWritableStream(T),$),this.socket=T}dispose(){super.dispose(),this.socket.destroy()}}t.SocketMessageWriter=p;class w extends u.ReadableStreamMessageReader{constructor(T,$){super((0,r.default)().stream.asReadableStream(T),$)}}t.StreamMessageReader=w;class v extends u.WriteableStreamMessageWriter{constructor(T,$){super((0,r.
default)().stream.asWritableStream(T),$)}}t.StreamMessageWriter=v;const g=process.env.XDG_RUNTIME_DIR,b=new Map([["linux",107],["darwin",103]]);function k(){const B=(0,a.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${B}-sock`;let T;g?T=i.join(g,`vscode-ipc-${B}.sock`):T=i.join(s.tmpdir(),`vscode-${B}.sock`);const $=b.get(process.platform);return $!==void 0&&T.length>$&&(0,r.default)().console.warn(`WARNING: IPC handle "${T}" is longer than ${$}\
 characters.`),T}t.generateRandomPipeName=k;function _(B,T="utf-8"){let $;const j=new Promise((A,P)=>{$=A});return new Promise((A,P)=>{let L=(0,o.createServer)(Q=>{L.close(),$([new h(Q,T),new p(Q,T)])});L.on("error",P),L.listen(B,()=>{L.removeListener("error",P),A({onConnected:()=>j})})})}t.createClientPipeTransport=_;function I(B,T="utf-8"){const $=(0,o.createConnection)(B);return[new h($,T),new p($,T)]}t.createServerPipeTransport=I;function Z(B,T="utf-8"){let $;const j=new Promise((A,P)=>{$=A});
return new Promise((A,P)=>{const L=(0,o.createServer)(Q=>{L.close(),$([new h(Q,T),new p(Q,T)])});L.on("error",P),L.listen(B,"127.0.0.1",()=>{L.removeListener("error",P),A({onConnected:()=>j})})})}t.createClientSocketTransport=Z;function J(B,T="utf-8"){const $=(0,o.createConnection)(B,"127.0.0.1");return[new h($,T),new p($,T)]}t.createServerSocketTransport=J;function ue(B){const T=B;return T.read!==void 0&&T.addListener!==void 0}function ae(B){const T=B;return T.write!==void 0&&T.addListener!==void 0}
function $e(B,T,$,j){$||($=u.NullLogger);const A=ue(B)?new w(B):B,P=ae(T)?new v(T):T;return u.ConnectionStrategy.is(j)&&(j={connectionStrategy:j}),(0,u.createMessageConnection)(A,P,$,j)}t.createMessageConnection=$e}(_a)),_a}var tw,VT;function KT(){return VT||(VT=1,tw=xa()),tw}var Pa={},Tp={exports:{}},ZT;function nw(){return ZT||(ZT=1,function(t,e){(function(n){{var r=n(X0,e);r!==void 0&&(t.exports=r)}})(function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TextDocument=r.EOL=r.WorkspaceFolder=
r.InlineCompletionContext=r.SelectedCompletionInfo=r.InlineCompletionTriggerKind=r.InlineCompletionList=r.InlineCompletionItem=r.StringValue=r.InlayHint=r.InlayHintLabelPart=r.InlayHintKind=r.InlineValueContext=r.InlineValueEvaluatableExpression=r.InlineValueVariableLookup=r.InlineValueText=r.SemanticTokens=r.SemanticTokenModifiers=r.SemanticTokenTypes=r.SelectionRange=r.DocumentLink=r.FormattingOptions=r.CodeLens=r.CodeAction=r.CodeActionContext=r.CodeActionTriggerKind=r.CodeActionKind=r.DocumentSymbol=
r.WorkspaceSymbol=r.SymbolInformation=r.SymbolTag=r.SymbolKind=r.DocumentHighlight=r.DocumentHighlightKind=r.SignatureInformation=r.ParameterInformation=r.Hover=r.MarkedString=r.CompletionList=r.CompletionItem=r.CompletionItemLabelDetails=r.InsertTextMode=r.InsertReplaceEdit=r.CompletionItemTag=r.InsertTextFormat=r.CompletionItemKind=r.MarkupContent=r.MarkupKind=r.TextDocumentItem=r.OptionalVersionedTextDocumentIdentifier=r.VersionedTextDocumentIdentifier=r.TextDocumentIdentifier=r.WorkspaceChange=
r.WorkspaceEdit=r.DeleteFile=r.RenameFile=r.CreateFile=r.TextDocumentEdit=r.AnnotatedTextEdit=r.ChangeAnnotationIdentifier=r.ChangeAnnotation=r.TextEdit=r.Command=r.Diagnostic=r.CodeDescription=r.DiagnosticTag=r.DiagnosticSeverity=r.DiagnosticRelatedInformation=r.FoldingRange=r.FoldingRangeKind=r.ColorPresentation=r.ColorInformation=r.Color=r.LocationLink=r.Location=r.Range=r.Position=r.uinteger=r.integer=r.URI=r.DocumentUri=void 0;var i;(function(E){function x(m){return typeof m=="string"}E.is=
x})(i||(r.DocumentUri=i={}));var s;(function(E){function x(m){return typeof m=="string"}E.is=x})(s||(r.URI=s={}));var a;(function(E){E.MIN_VALUE=-2147483648,E.MAX_VALUE=2147483647;function x(m){return typeof m=="number"&&E.MIN_VALUE<=m&&m<=E.MAX_VALUE}E.is=x})(a||(r.integer=a={}));var o;(function(E){E.MIN_VALUE=0,E.MAX_VALUE=2147483647;function x(m){return typeof m=="number"&&E.MIN_VALUE<=m&&m<=E.MAX_VALUE}E.is=x})(o||(r.uinteger=o={}));var u;(function(E){function x(D,y){return D===Number.MAX_VALUE&&
(D=o.MAX_VALUE),y===Number.MAX_VALUE&&(y=o.MAX_VALUE),{line:D,character:y}}E.create=x;function m(D){var y=D;return q.objectLiteral(y)&&q.uinteger(y.line)&&q.uinteger(y.character)}E.is=m})(u||(r.Position=u={}));var c;(function(E){function x(D,y,N,R){if(q.uinteger(D)&&q.uinteger(y)&&q.uinteger(N)&&q.uinteger(R))return{start:u.create(D,y),end:u.create(N,R)};if(u.is(D)&&u.is(y))return{start:D,end:y};throw new Error("Range#create called with invalid arguments[".concat(D,", ").concat(y,", ").concat(N,
", ").concat(R,"]"))}E.create=x;function m(D){var y=D;return q.objectLiteral(y)&&u.is(y.start)&&u.is(y.end)}E.is=m})(c||(r.Range=c={}));var l;(function(E){function x(D,y){return{uri:D,range:y}}E.create=x;function m(D){var y=D;return q.objectLiteral(y)&&c.is(y.range)&&(q.string(y.uri)||q.undefined(y.uri))}E.is=m})(l||(r.Location=l={}));var f;(function(E){function x(D,y,N,R){return{targetUri:D,targetRange:y,targetSelectionRange:N,originSelectionRange:R}}E.create=x;function m(D){var y=D;return q.objectLiteral(
y)&&c.is(y.targetRange)&&q.string(y.targetUri)&&c.is(y.targetSelectionRange)&&(c.is(y.originSelectionRange)||q.undefined(y.originSelectionRange))}E.is=m})(f||(r.LocationLink=f={}));var d;(function(E){function x(D,y,N,R){return{red:D,green:y,blue:N,alpha:R}}E.create=x;function m(D){var y=D;return q.objectLiteral(y)&&q.numberRange(y.red,0,1)&&q.numberRange(y.green,0,1)&&q.numberRange(y.blue,0,1)&&q.numberRange(y.alpha,0,1)}E.is=m})(d||(r.Color=d={}));var h;(function(E){function x(D,y){return{range:D,
color:y}}E.create=x;function m(D){var y=D;return q.objectLiteral(y)&&c.is(y.range)&&d.is(y.color)}E.is=m})(h||(r.ColorInformation=h={}));var p;(function(E){function x(D,y,N){return{label:D,textEdit:y,additionalTextEdits:N}}E.create=x;function m(D){var y=D;return q.objectLiteral(y)&&q.string(y.label)&&(q.undefined(y.textEdit)||J.is(y))&&(q.undefined(y.additionalTextEdits)||q.typedArray(y.additionalTextEdits,J.is))}E.is=m})(p||(r.ColorPresentation=p={}));var w;(function(E){E.Comment="comment",E.Imports=
"imports",E.Region="region"})(w||(r.FoldingRangeKind=w={}));var v;(function(E){function x(D,y,N,R,W,ne){var ce={startLine:D,endLine:y};return q.defined(N)&&(ce.startCharacter=N),q.defined(R)&&(ce.endCharacter=R),q.defined(W)&&(ce.kind=W),q.defined(ne)&&(ce.collapsedText=ne),ce}E.create=x;function m(D){var y=D;return q.objectLiteral(y)&&q.uinteger(y.startLine)&&q.uinteger(y.startLine)&&(q.undefined(y.startCharacter)||q.uinteger(y.startCharacter))&&(q.undefined(y.endCharacter)||q.uinteger(y.endCharacter))&&
(q.undefined(y.kind)||q.string(y.kind))}E.is=m})(v||(r.FoldingRange=v={}));var g;(function(E){function x(D,y){return{location:D,message:y}}E.create=x;function m(D){var y=D;return q.defined(y)&&l.is(y.location)&&q.string(y.message)}E.is=m})(g||(r.DiagnosticRelatedInformation=g={}));var b;(function(E){E.Error=1,E.Warning=2,E.Information=3,E.Hint=4})(b||(r.DiagnosticSeverity=b={}));var k;(function(E){E.Unnecessary=1,E.Deprecated=2})(k||(r.DiagnosticTag=k={}));var _;(function(E){function x(m){var D=m;
return q.objectLiteral(D)&&q.string(D.href)}E.is=x})(_||(r.CodeDescription=_={}));var I;(function(E){function x(D,y,N,R,W,ne){var ce={range:D,message:y};return q.defined(N)&&(ce.severity=N),q.defined(R)&&(ce.code=R),q.defined(W)&&(ce.source=W),q.defined(ne)&&(ce.relatedInformation=ne),ce}E.create=x;function m(D){var y,N=D;return q.defined(N)&&c.is(N.range)&&q.string(N.message)&&(q.number(N.severity)||q.undefined(N.severity))&&(q.integer(N.code)||q.string(N.code)||q.undefined(N.code))&&(q.undefined(
N.codeDescription)||q.string((y=N.codeDescription)===null||y===void 0?void 0:y.href))&&(q.string(N.source)||q.undefined(N.source))&&(q.undefined(N.relatedInformation)||q.typedArray(N.relatedInformation,g.is))}E.is=m})(I||(r.Diagnostic=I={}));var Z;(function(E){function x(D,y){for(var N=[],R=2;R<arguments.length;R++)N[R-2]=arguments[R];var W={title:D,command:y};return q.defined(N)&&N.length>0&&(W.arguments=N),W}E.create=x;function m(D){var y=D;return q.defined(y)&&q.string(y.title)&&q.string(y.command)}
E.is=m})(Z||(r.Command=Z={}));var J;(function(E){function x(N,R){return{range:N,newText:R}}E.replace=x;function m(N,R){return{range:{start:N,end:N},newText:R}}E.insert=m;function D(N){return{range:N,newText:""}}E.del=D;function y(N){var R=N;return q.objectLiteral(R)&&q.string(R.newText)&&c.is(R.range)}E.is=y})(J||(r.TextEdit=J={}));var ue;(function(E){function x(D,y,N){var R={label:D};return y!==void 0&&(R.needsConfirmation=y),N!==void 0&&(R.description=N),R}E.create=x;function m(D){var y=D;return q.
objectLiteral(y)&&q.string(y.label)&&(q.boolean(y.needsConfirmation)||y.needsConfirmation===void 0)&&(q.string(y.description)||y.description===void 0)}E.is=m})(ue||(r.ChangeAnnotation=ue={}));var ae;(function(E){function x(m){var D=m;return q.string(D)}E.is=x})(ae||(r.ChangeAnnotationIdentifier=ae={}));var $e;(function(E){function x(N,R,W){return{range:N,newText:R,annotationId:W}}E.replace=x;function m(N,R,W){return{range:{start:N,end:N},newText:R,annotationId:W}}E.insert=m;function D(N,R){return{
range:N,newText:"",annotationId:R}}E.del=D;function y(N){var R=N;return J.is(R)&&(ue.is(R.annotationId)||ae.is(R.annotationId))}E.is=y})($e||(r.AnnotatedTextEdit=$e={}));var B;(function(E){function x(D,y){return{textDocument:D,edits:y}}E.create=x;function m(D){var y=D;return q.defined(y)&&re.is(y.textDocument)&&Array.isArray(y.edits)}E.is=m})(B||(r.TextDocumentEdit=B={}));var T;(function(E){function x(D,y,N){var R={kind:"create",uri:D};return y!==void 0&&(y.overwrite!==void 0||y.ignoreIfExists!==
void 0)&&(R.options=y),N!==void 0&&(R.annotationId=N),R}E.create=x;function m(D){var y=D;return y&&y.kind==="create"&&q.string(y.uri)&&(y.options===void 0||(y.options.overwrite===void 0||q.boolean(y.options.overwrite))&&(y.options.ignoreIfExists===void 0||q.boolean(y.options.ignoreIfExists)))&&(y.annotationId===void 0||ae.is(y.annotationId))}E.is=m})(T||(r.CreateFile=T={}));var $;(function(E){function x(D,y,N,R){var W={kind:"rename",oldUri:D,newUri:y};return N!==void 0&&(N.overwrite!==void 0||N.
ignoreIfExists!==void 0)&&(W.options=N),R!==void 0&&(W.annotationId=R),W}E.create=x;function m(D){var y=D;return y&&y.kind==="rename"&&q.string(y.oldUri)&&q.string(y.newUri)&&(y.options===void 0||(y.options.overwrite===void 0||q.boolean(y.options.overwrite))&&(y.options.ignoreIfExists===void 0||q.boolean(y.options.ignoreIfExists)))&&(y.annotationId===void 0||ae.is(y.annotationId))}E.is=m})($||(r.RenameFile=$={}));var j;(function(E){function x(D,y,N){var R={kind:"delete",uri:D};return y!==void 0&&
(y.recursive!==void 0||y.ignoreIfNotExists!==void 0)&&(R.options=y),N!==void 0&&(R.annotationId=N),R}E.create=x;function m(D){var y=D;return y&&y.kind==="delete"&&q.string(y.uri)&&(y.options===void 0||(y.options.recursive===void 0||q.boolean(y.options.recursive))&&(y.options.ignoreIfNotExists===void 0||q.boolean(y.options.ignoreIfNotExists)))&&(y.annotationId===void 0||ae.is(y.annotationId))}E.is=m})(j||(r.DeleteFile=j={}));var A;(function(E){function x(m){var D=m;return D&&(D.changes!==void 0||
D.documentChanges!==void 0)&&(D.documentChanges===void 0||D.documentChanges.every(function(y){return q.string(y.kind)?T.is(y)||$.is(y)||j.is(y):B.is(y)}))}E.is=x})(A||(r.WorkspaceEdit=A={}));var P=function(){function E(x,m){this.edits=x,this.changeAnnotations=m}return E.prototype.insert=function(x,m,D){var y,N;if(D===void 0?y=J.insert(x,m):ae.is(D)?(N=D,y=$e.insert(x,m,D)):(this.assertChangeAnnotations(this.changeAnnotations),N=this.changeAnnotations.manage(D),y=$e.insert(x,m,N)),this.edits.push(
y),N!==void 0)return N},E.prototype.replace=function(x,m,D){var y,N;if(D===void 0?y=J.replace(x,m):ae.is(D)?(N=D,y=$e.replace(x,m,D)):(this.assertChangeAnnotations(this.changeAnnotations),N=this.changeAnnotations.manage(D),y=$e.replace(x,m,N)),this.edits.push(y),N!==void 0)return N},E.prototype.delete=function(x,m){var D,y;if(m===void 0?D=J.del(x):ae.is(m)?(y=m,D=$e.del(x,m)):(this.assertChangeAnnotations(this.changeAnnotations),y=this.changeAnnotations.manage(m),D=$e.del(x,y)),this.edits.push(D),
y!==void 0)return y},E.prototype.add=function(x){this.edits.push(x)},E.prototype.all=function(){return this.edits},E.prototype.clear=function(){this.edits.splice(0,this.edits.length)},E.prototype.assertChangeAnnotations=function(x){if(x===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},E}(),L=function(){function E(x){this._annotations=x===void 0?Object.create(null):x,this._counter=0,this._size=0}return E.prototype.all=function(){return this._annotations},
Object.defineProperty(E.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),E.prototype.manage=function(x,m){var D;if(ae.is(x)?D=x:(D=this.nextId(),m=x),this._annotations[D]!==void 0)throw new Error("Id ".concat(D," is already in use."));if(m===void 0)throw new Error("No annotation provided for id ".concat(D));return this._annotations[D]=m,this._size++,D},E.prototype.nextId=function(){return this._counter++,this._counter.toString()},E}(),Q=function(){function E(x){
var m=this;this._textEditChanges=Object.create(null),x!==void 0?(this._workspaceEdit=x,x.documentChanges?(this._changeAnnotations=new L(x.changeAnnotations),x.changeAnnotations=this._changeAnnotations.all(),x.documentChanges.forEach(function(D){if(B.is(D)){var y=new P(D.edits,m._changeAnnotations);m._textEditChanges[D.textDocument.uri]=y}})):x.changes&&Object.keys(x.changes).forEach(function(D){var y=new P(x.changes[D]);m._textEditChanges[D]=y})):this._workspaceEdit={}}return Object.defineProperty(
E.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),E.prototype.getTextEditChange=function(x){if(re.is(x)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document cha\
nges.");var m={uri:x.uri,version:x.version},D=this._textEditChanges[m.uri];if(!D){var y=[],N={textDocument:m,edits:y};this._workspaceEdit.documentChanges.push(N),D=new P(y,this._changeAnnotations),this._textEditChanges[m.uri]=D}return D}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var D=this._textEditChanges[x];if(!D){var y=[];this._workspaceEdit.changes[x]=y,D=new P(y),this._textEditChanges[x]=D}
return D}},E.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new L,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},E.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},E.prototype.createFile=function(x,m,D){if(this.initDocumentChanges(),
this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var y;ue.is(m)||ae.is(m)?y=m:D=m;var N,R;if(y===void 0?N=T.create(x,D):(R=ae.is(y)?y:this._changeAnnotations.manage(y),N=T.create(x,D,R)),this._workspaceEdit.documentChanges.push(N),R!==void 0)return R},E.prototype.renameFile=function(x,m,D,y){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document\
 changes.");var N;ue.is(D)||ae.is(D)?N=D:y=D;var R,W;if(N===void 0?R=$.create(x,m,y):(W=ae.is(N)?N:this._changeAnnotations.manage(N),R=$.create(x,m,y,W)),this._workspaceEdit.documentChanges.push(R),W!==void 0)return W},E.prototype.deleteFile=function(x,m,D){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var y;ue.is(m)||ae.is(m)?y=m:D=m;var N,R;if(y===void 0?N=j.create(x,D):(R=ae.is(y)?y:this._changeAnnotations.
manage(y),N=j.create(x,D,R)),this._workspaceEdit.documentChanges.push(N),R!==void 0)return R},E}();r.WorkspaceChange=Q;var H;(function(E){function x(D){return{uri:D}}E.create=x;function m(D){var y=D;return q.defined(y)&&q.string(y.uri)}E.is=m})(H||(r.TextDocumentIdentifier=H={}));var S;(function(E){function x(D,y){return{uri:D,version:y}}E.create=x;function m(D){var y=D;return q.defined(y)&&q.string(y.uri)&&q.integer(y.version)}E.is=m})(S||(r.VersionedTextDocumentIdentifier=S={}));var re;(function(E){
function x(D,y){return{uri:D,version:y}}E.create=x;function m(D){var y=D;return q.defined(y)&&q.string(y.uri)&&(y.version===null||q.integer(y.version))}E.is=m})(re||(r.OptionalVersionedTextDocumentIdentifier=re={}));var ke;(function(E){function x(D,y,N,R){return{uri:D,languageId:y,version:N,text:R}}E.create=x;function m(D){var y=D;return q.defined(y)&&q.string(y.uri)&&q.string(y.languageId)&&q.integer(y.version)&&q.string(y.text)}E.is=m})(ke||(r.TextDocumentItem=ke={}));var je;(function(E){E.PlainText=
"plaintext",E.Markdown="markdown";function x(m){var D=m;return D===E.PlainText||D===E.Markdown}E.is=x})(je||(r.MarkupKind=je={}));var M;(function(E){function x(m){var D=m;return q.objectLiteral(m)&&je.is(D.kind)&&q.string(D.value)}E.is=x})(M||(r.MarkupContent=M={}));var V;(function(E){E.Text=1,E.Method=2,E.Function=3,E.Constructor=4,E.Field=5,E.Variable=6,E.Class=7,E.Interface=8,E.Module=9,E.Property=10,E.Unit=11,E.Value=12,E.Enum=13,E.Keyword=14,E.Snippet=15,E.Color=16,E.File=17,E.Reference=18,
E.Folder=19,E.EnumMember=20,E.Constant=21,E.Struct=22,E.Event=23,E.Operator=24,E.TypeParameter=25})(V||(r.CompletionItemKind=V={}));var Le;(function(E){E.PlainText=1,E.Snippet=2})(Le||(r.InsertTextFormat=Le={}));var he;(function(E){E.Deprecated=1})(he||(r.CompletionItemTag=he={}));var Ce;(function(E){function x(D,y,N){return{newText:D,insert:y,replace:N}}E.create=x;function m(D){var y=D;return y&&q.string(y.newText)&&c.is(y.insert)&&c.is(y.replace)}E.is=m})(Ce||(r.InsertReplaceEdit=Ce={}));var Be;
(function(E){E.asIs=1,E.adjustIndentation=2})(Be||(r.InsertTextMode=Be={}));var pe;(function(E){function x(m){var D=m;return D&&(q.string(D.detail)||D.detail===void 0)&&(q.string(D.description)||D.description===void 0)}E.is=x})(pe||(r.CompletionItemLabelDetails=pe={}));var O;(function(E){function x(m){return{label:m}}E.create=x})(O||(r.CompletionItem=O={}));var U;(function(E){function x(m,D){return{items:m||[],isIncomplete:!!D}}E.create=x})(U||(r.CompletionList=U={}));var ge;(function(E){function x(D){
return D.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}E.fromPlainText=x;function m(D){var y=D;return q.string(y)||q.objectLiteral(y)&&q.string(y.language)&&q.string(y.value)}E.is=m})(ge||(r.MarkedString=ge={}));var z;(function(E){function x(m){var D=m;return!!D&&q.objectLiteral(D)&&(M.is(D.contents)||ge.is(D.contents)||q.typedArray(D.contents,ge.is))&&(m.range===void 0||c.is(m.range))}E.is=x})(z||(r.Hover=z={}));var me;(function(E){function x(m,D){return D?{label:m,documentation:D}:{label:m}}E.create=
x})(me||(r.ParameterInformation=me={}));var nt;(function(E){function x(m,D){for(var y=[],N=2;N<arguments.length;N++)y[N-2]=arguments[N];var R={label:m};return q.defined(D)&&(R.documentation=D),q.defined(y)?R.parameters=y:R.parameters=[],R}E.create=x})(nt||(r.SignatureInformation=nt={}));var mt;(function(E){E.Text=1,E.Read=2,E.Write=3})(mt||(r.DocumentHighlightKind=mt={}));var de;(function(E){function x(m,D){var y={range:m};return q.number(D)&&(y.kind=D),y}E.create=x})(de||(r.DocumentHighlight=de=
{}));var Ue;(function(E){E.File=1,E.Module=2,E.Namespace=3,E.Package=4,E.Class=5,E.Method=6,E.Property=7,E.Field=8,E.Constructor=9,E.Enum=10,E.Interface=11,E.Function=12,E.Variable=13,E.Constant=14,E.String=15,E.Number=16,E.Boolean=17,E.Array=18,E.Object=19,E.Key=20,E.Null=21,E.EnumMember=22,E.Struct=23,E.Event=24,E.Operator=25,E.TypeParameter=26})(Ue||(r.SymbolKind=Ue={}));var se;(function(E){E.Deprecated=1})(se||(r.SymbolTag=se={}));var _e;(function(E){function x(m,D,y,N,R){var W={name:m,kind:D,
location:{uri:N,range:y}};return R&&(W.containerName=R),W}E.create=x})(_e||(r.SymbolInformation=_e={}));var Xe;(function(E){function x(m,D,y,N){return N!==void 0?{name:m,kind:D,location:{uri:y,range:N}}:{name:m,kind:D,location:{uri:y}}}E.create=x})(Xe||(r.WorkspaceSymbol=Xe={}));var xt;(function(E){function x(D,y,N,R,W,ne){var ce={name:D,detail:y,kind:N,range:R,selectionRange:W};return ne!==void 0&&(ce.children=ne),ce}E.create=x;function m(D){var y=D;return y&&q.string(y.name)&&q.number(y.kind)&&
c.is(y.range)&&c.is(y.selectionRange)&&(y.detail===void 0||q.string(y.detail))&&(y.deprecated===void 0||q.boolean(y.deprecated))&&(y.children===void 0||Array.isArray(y.children))&&(y.tags===void 0||Array.isArray(y.tags))}E.is=m})(xt||(r.DocumentSymbol=xt={}));var dt;(function(E){E.Empty="",E.QuickFix="quickfix",E.Refactor="refactor",E.RefactorExtract="refactor.extract",E.RefactorInline="refactor.inline",E.RefactorRewrite="refactor.rewrite",E.Source="source",E.SourceOrganizeImports="source.organi\
zeImports",E.SourceFixAll="source.fixAll"})(dt||(r.CodeActionKind=dt={}));var ln;(function(E){E.Invoked=1,E.Automatic=2})(ln||(r.CodeActionTriggerKind=ln={}));var gn;(function(E){function x(D,y,N){var R={diagnostics:D};return y!=null&&(R.only=y),N!=null&&(R.triggerKind=N),R}E.create=x;function m(D){var y=D;return q.defined(y)&&q.typedArray(y.diagnostics,I.is)&&(y.only===void 0||q.typedArray(y.only,q.string))&&(y.triggerKind===void 0||y.triggerKind===ln.Invoked||y.triggerKind===ln.Automatic)}E.is=
m})(gn||(r.CodeActionContext=gn={}));var In;(function(E){function x(D,y,N){var R={title:D},W=!0;return typeof y=="string"?(W=!1,R.kind=y):Z.is(y)?R.command=y:R.edit=y,W&&N!==void 0&&(R.kind=N),R}E.create=x;function m(D){var y=D;return y&&q.string(y.title)&&(y.diagnostics===void 0||q.typedArray(y.diagnostics,I.is))&&(y.kind===void 0||q.string(y.kind))&&(y.edit!==void 0||y.command!==void 0)&&(y.command===void 0||Z.is(y.command))&&(y.isPreferred===void 0||q.boolean(y.isPreferred))&&(y.edit===void 0||
A.is(y.edit))}E.is=m})(In||(r.CodeAction=In={}));var X;(function(E){function x(D,y){var N={range:D};return q.defined(y)&&(N.data=y),N}E.create=x;function m(D){var y=D;return q.defined(y)&&c.is(y.range)&&(q.undefined(y.command)||Z.is(y.command))}E.is=m})(X||(r.CodeLens=X={}));var Y;(function(E){function x(D,y){return{tabSize:D,insertSpaces:y}}E.create=x;function m(D){var y=D;return q.defined(y)&&q.uinteger(y.tabSize)&&q.boolean(y.insertSpaces)}E.is=m})(Y||(r.FormattingOptions=Y={}));var ve;(function(E){
function x(D,y,N){return{range:D,target:y,data:N}}E.create=x;function m(D){var y=D;return q.defined(y)&&c.is(y.range)&&(q.undefined(y.target)||q.string(y.target))}E.is=m})(ve||(r.DocumentLink=ve={}));var yn;(function(E){function x(D,y){return{range:D,parent:y}}E.create=x;function m(D){var y=D;return q.objectLiteral(y)&&c.is(y.range)&&(y.parent===void 0||E.is(y.parent))}E.is=m})(yn||(r.SelectionRange=yn={}));var dn;(function(E){E.namespace="namespace",E.type="type",E.class="class",E.enum="enum",E.
interface="interface",E.struct="struct",E.typeParameter="typeParameter",E.parameter="parameter",E.variable="variable",E.property="property",E.enumMember="enumMember",E.event="event",E.function="function",E.method="method",E.macro="macro",E.keyword="keyword",E.modifier="modifier",E.comment="comment",E.string="string",E.number="number",E.regexp="regexp",E.operator="operator",E.decorator="decorator"})(dn||(r.SemanticTokenTypes=dn={}));var ci;(function(E){E.declaration="declaration",E.definition="de\
finition",E.readonly="readonly",E.static="static",E.deprecated="deprecated",E.abstract="abstract",E.async="async",E.modification="modification",E.documentation="documentation",E.defaultLibrary="defaultLibrary"})(ci||(r.SemanticTokenModifiers=ci={}));var gs;(function(E){function x(m){var D=m;return q.objectLiteral(D)&&(D.resultId===void 0||typeof D.resultId=="string")&&Array.isArray(D.data)&&(D.data.length===0||typeof D.data[0]=="number")}E.is=x})(gs||(r.SemanticTokens=gs={}));var Zs;(function(E){
function x(D,y){return{range:D,text:y}}E.create=x;function m(D){var y=D;return y!=null&&c.is(y.range)&&q.string(y.text)}E.is=m})(Zs||(r.InlineValueText=Zs={}));var Xs;(function(E){function x(D,y,N){return{range:D,variableName:y,caseSensitiveLookup:N}}E.create=x;function m(D){var y=D;return y!=null&&c.is(y.range)&&q.boolean(y.caseSensitiveLookup)&&(q.string(y.variableName)||y.variableName===void 0)}E.is=m})(Xs||(r.InlineValueVariableLookup=Xs={}));var Ys;(function(E){function x(D,y){return{range:D,
expression:y}}E.create=x;function m(D){var y=D;return y!=null&&c.is(y.range)&&(q.string(y.expression)||y.expression===void 0)}E.is=m})(Ys||(r.InlineValueEvaluatableExpression=Ys={}));var Js;(function(E){function x(D,y){return{frameId:D,stoppedLocation:y}}E.create=x;function m(D){var y=D;return q.defined(y)&&c.is(D.stoppedLocation)}E.is=m})(Js||(r.InlineValueContext=Js={}));var ys;(function(E){E.Type=1,E.Parameter=2;function x(m){return m===1||m===2}E.is=x})(ys||(r.InlayHintKind=ys={}));var vs;(function(E){
function x(D){return{value:D}}E.create=x;function m(D){var y=D;return q.objectLiteral(y)&&(y.tooltip===void 0||q.string(y.tooltip)||M.is(y.tooltip))&&(y.location===void 0||l.is(y.location))&&(y.command===void 0||Z.is(y.command))}E.is=m})(vs||(r.InlayHintLabelPart=vs={}));var Xn;(function(E){function x(D,y,N){var R={position:D,label:y};return N!==void 0&&(R.kind=N),R}E.create=x;function m(D){var y=D;return q.objectLiteral(y)&&u.is(y.position)&&(q.string(y.label)||q.typedArray(y.label,vs.is))&&(y.
kind===void 0||ys.is(y.kind))&&y.textEdits===void 0||q.typedArray(y.textEdits,J.is)&&(y.tooltip===void 0||q.string(y.tooltip)||M.is(y.tooltip))&&(y.paddingLeft===void 0||q.boolean(y.paddingLeft))&&(y.paddingRight===void 0||q.boolean(y.paddingRight))}E.is=m})(Xn||(r.InlayHint=Xn={}));var Qs;(function(E){function x(m){return{kind:"snippet",value:m}}E.createSnippet=x})(Qs||(r.StringValue=Qs={}));var ea;(function(E){function x(m,D,y,N){return{insertText:m,filterText:D,range:y,command:N}}E.create=x})(
ea||(r.InlineCompletionItem=ea={}));var li;(function(E){function x(m){return{items:m}}E.create=x})(li||(r.InlineCompletionList=li={}));var ta;(function(E){E.Invoked=0,E.Automatic=1})(ta||(r.InlineCompletionTriggerKind=ta={}));var Ci;(function(E){function x(m,D){return{range:m,text:D}}E.create=x})(Ci||(r.SelectedCompletionInfo=Ci={}));var na;(function(E){function x(m,D){return{triggerKind:m,selectedCompletionInfo:D}}E.create=x})(na||(r.InlineCompletionContext=na={}));var Rr;(function(E){function x(m){
var D=m;return q.objectLiteral(D)&&s.is(D.uri)&&q.string(D.name)}E.is=x})(Rr||(r.WorkspaceFolder=Rr={})),r.EOL=[`
`,`\r
`,"\r"];var Fr;(function(E){function x(N,R,W,ne){return new go(N,R,W,ne)}E.create=x;function m(N){var R=N;return!!(q.defined(R)&&q.string(R.uri)&&(q.undefined(R.languageId)||q.string(R.languageId))&&q.uinteger(R.lineCount)&&q.func(R.getText)&&q.func(R.positionAt)&&q.func(R.offsetAt))}E.is=m;function D(N,R){for(var W=N.getText(),ne=y(R,function(ze,bt){var ht=ze.range.start.line-bt.range.start.line;return ht===0?ze.range.start.character-bt.range.start.character:ht}),ce=W.length,Ye=ne.length-1;Ye>=
0;Ye--){var Ve=ne[Ye],ft=N.offsetAt(Ve.range.start),Te=N.offsetAt(Ve.range.end);if(Te<=ce)W=W.substring(0,ft)+Ve.newText+W.substring(Te,W.length);else throw new Error("Overlapping edit");ce=ft}return W}E.applyEdits=D;function y(N,R){if(N.length<=1)return N;var W=N.length/2|0,ne=N.slice(0,W),ce=N.slice(W);y(ne,R),y(ce,R);for(var Ye=0,Ve=0,ft=0;Ye<ne.length&&Ve<ce.length;){var Te=R(ne[Ye],ce[Ve]);Te<=0?N[ft++]=ne[Ye++]:N[ft++]=ce[Ve++]}for(;Ye<ne.length;)N[ft++]=ne[Ye++];for(;Ve<ce.length;)N[ft++]=
ce[Ve++];return N}})(Fr||(r.TextDocument=Fr={}));var go=function(){function E(x,m,D,y){this._uri=x,this._languageId=m,this._version=D,this._content=y,this._lineOffsets=void 0}return Object.defineProperty(E.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"version",{get:function(){return this._version},enumerable:!1,
configurable:!0}),E.prototype.getText=function(x){if(x){var m=this.offsetAt(x.start),D=this.offsetAt(x.end);return this._content.substring(m,D)}return this._content},E.prototype.update=function(x,m){this._content=x.text,this._version=m,this._lineOffsets=void 0},E.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var x=[],m=this._content,D=!0,y=0;y<m.length;y++){D&&(x.push(y),D=!1);var N=m.charAt(y);D=N==="\r"||N===`
`,N==="\r"&&y+1<m.length&&m.charAt(y+1)===`
`&&y++}D&&m.length>0&&x.push(m.length),this._lineOffsets=x}return this._lineOffsets},E.prototype.positionAt=function(x){x=Math.max(Math.min(x,this._content.length),0);var m=this.getLineOffsets(),D=0,y=m.length;if(y===0)return u.create(0,x);for(;D<y;){var N=Math.floor((D+y)/2);m[N]>x?y=N:D=N+1}var R=D-1;return u.create(R,x-m[R])},E.prototype.offsetAt=function(x){var m=this.getLineOffsets();if(x.line>=m.length)return this._content.length;if(x.line<0)return 0;var D=m[x.line],y=x.line+1<m.length?m[x.
line+1]:this._content.length;return Math.max(Math.min(D+x.character,y),D)},Object.defineProperty(E.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),E}(),q;(function(E){var x=Object.prototype.toString;function m(Te){return typeof Te<"u"}E.defined=m;function D(Te){return typeof Te>"u"}E.undefined=D;function y(Te){return Te===!0||Te===!1}E.boolean=y;function N(Te){return x.call(Te)==="[object String]"}E.string=N;function R(Te){return x.call(
Te)==="[object Number]"}E.number=R;function W(Te,ze,bt){return x.call(Te)==="[object Number]"&&ze<=Te&&Te<=bt}E.numberRange=W;function ne(Te){return x.call(Te)==="[object Number]"&&-2147483648<=Te&&Te<=2147483647}E.integer=ne;function ce(Te){return x.call(Te)==="[object Number]"&&0<=Te&&Te<=2147483647}E.uinteger=ce;function Ye(Te){return x.call(Te)==="[object Function]"}E.func=Ye;function Ve(Te){return Te!==null&&typeof Te=="object"}E.objectLiteral=Ve;function ft(Te,ze){return Array.isArray(Te)&&
Te.every(ze)}E.typedArray=ft})(q||(q={}))})}(Tp,Tp.exports)),Tp.exports}var zn={},XT;function qt(){if(XT)return zn;XT=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.ProtocolNotificationType=zn.ProtocolNotificationType0=zn.ProtocolRequestType=zn.ProtocolRequestType0=zn.RegistrationType=zn.MessageDirection=void 0;const t=xa();var e;(function(o){o.clientToServer="clientToServer",o.serverToClient="serverToClient",o.both="both"})(e||(zn.MessageDirection=e={}));class n{constructor(u){this.method=
u}}zn.RegistrationType=n;class r extends t.RequestType0{constructor(u){super(u)}}zn.ProtocolRequestType0=r;class i extends t.RequestType{constructor(u){super(u,t.ParameterStructures.byName)}}zn.ProtocolRequestType=i;class s extends t.NotificationType0{constructor(u){super(u)}}zn.ProtocolNotificationType0=s;class a extends t.NotificationType{constructor(u){super(u,t.ParameterStructures.byName)}}return zn.ProtocolNotificationType=a,zn}var rw={},Zt={},YT;function iw(){if(YT)return Zt;YT=1,Object.defineProperty(
Zt,"__esModule",{value:!0}),Zt.objectLiteral=Zt.typedArray=Zt.stringArray=Zt.array=Zt.func=Zt.error=Zt.number=Zt.string=Zt.boolean=void 0;function t(c){return c===!0||c===!1}Zt.boolean=t;function e(c){return typeof c=="string"||c instanceof String}Zt.string=e;function n(c){return typeof c=="number"||c instanceof Number}Zt.number=n;function r(c){return c instanceof Error}Zt.error=r;function i(c){return typeof c=="function"}Zt.func=i;function s(c){return Array.isArray(c)}Zt.array=s;function a(c){return s(
c)&&c.every(l=>e(l))}Zt.stringArray=a;function o(c,l){return Array.isArray(c)&&c.every(l)}Zt.typedArray=o;function u(c){return c!==null&&typeof c=="object"}return Zt.objectLiteral=u,Zt}var tl={},JT;function l8(){if(JT)return tl;JT=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.ImplementationRequest=void 0;const t=qt();var e;return function(n){n.method="textDocument/implementation",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e||(tl.ImplementationRequest=
e={})),tl}var nl={},QT;function d8(){if(QT)return nl;QT=1,Object.defineProperty(nl,"__esModule",{value:!0}),nl.TypeDefinitionRequest=void 0;const t=qt();var e;return function(n){n.method="textDocument/typeDefinition",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e||(nl.TypeDefinitionRequest=e={})),nl}var Na={},eS;function f8(){if(eS)return Na;eS=1,Object.defineProperty(Na,"__esModule",{value:!0}),Na.DidChangeWorkspaceFoldersNotification=Na.WorkspaceFoldersRequest=
void 0;const t=qt();var e;(function(r){r.method="workspace/workspaceFolders",r.messageDirection=t.MessageDirection.serverToClient,r.type=new t.ProtocolRequestType0(r.method)})(e||(Na.WorkspaceFoldersRequest=e={}));var n;return function(r){r.method="workspace/didChangeWorkspaceFolders",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolNotificationType(r.method)}(n||(Na.DidChangeWorkspaceFoldersNotification=n={})),Na}var rl={},tS;function h8(){if(tS)return rl;tS=1,Object.defineProperty(
rl,"__esModule",{value:!0}),rl.ConfigurationRequest=void 0;const t=qt();var e;return function(n){n.method="workspace/configuration",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType(n.method)}(e||(rl.ConfigurationRequest=e={})),rl}var Ia={},nS;function p8(){if(nS)return Ia;nS=1,Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.ColorPresentationRequest=Ia.DocumentColorRequest=void 0;const t=qt();var e;(function(r){r.method="textDocument/documentColor",r.messageDirection=
t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)})(e||(Ia.DocumentColorRequest=e={}));var n;return function(r){r.method="textDocument/colorPresentation",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)}(n||(Ia.ColorPresentationRequest=n={})),Ia}var Oa={},rS;function m8(){if(rS)return Oa;rS=1,Object.defineProperty(Oa,"__esModule",{value:!0}),Oa.FoldingRangeRefreshRequest=Oa.FoldingRangeRequest=void 0;const t=qt();var e;(function(r){
r.method="textDocument/foldingRange",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)})(e||(Oa.FoldingRangeRequest=e={}));var n;return function(r){r.method="workspace/foldingRange/refresh",r.messageDirection=t.MessageDirection.serverToClient,r.type=new t.ProtocolRequestType0(r.method)}(n||(Oa.FoldingRangeRefreshRequest=n={})),Oa}var il={},iS;function g8(){if(iS)return il;iS=1,Object.defineProperty(il,"__esModule",{value:!0}),il.DeclarationRequest=void 0;
const t=qt();var e;return function(n){n.method="textDocument/declaration",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e||(il.DeclarationRequest=e={})),il}var sl={},sS;function y8(){if(sS)return sl;sS=1,Object.defineProperty(sl,"__esModule",{value:!0}),sl.SelectionRangeRequest=void 0;const t=qt();var e;return function(n){n.method="textDocument/selectionRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(
n.method)}(e||(sl.SelectionRangeRequest=e={})),sl}var Vi={},aS;function v8(){if(aS)return Vi;aS=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.WorkDoneProgressCancelNotification=Vi.WorkDoneProgressCreateRequest=Vi.WorkDoneProgress=void 0;const t=xa(),e=qt();var n;(function(s){s.type=new t.ProgressType;function a(o){return o===s.type}s.is=a})(n||(Vi.WorkDoneProgress=n={}));var r;(function(s){s.method="window/workDoneProgress/create",s.messageDirection=e.MessageDirection.serverToClient,s.type=
new e.ProtocolRequestType(s.method)})(r||(Vi.WorkDoneProgressCreateRequest=r={}));var i;return function(s){s.method="window/workDoneProgress/cancel",s.messageDirection=e.MessageDirection.clientToServer,s.type=new e.ProtocolNotificationType(s.method)}(i||(Vi.WorkDoneProgressCancelNotification=i={})),Vi}var Ki={},oS;function w8(){if(oS)return Ki;oS=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.CallHierarchyOutgoingCallsRequest=Ki.CallHierarchyIncomingCallsRequest=Ki.CallHierarchyPrepareRequest=
void 0;const t=qt();var e;(function(i){i.method="textDocument/prepareCallHierarchy",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(e||(Ki.CallHierarchyPrepareRequest=e={}));var n;(function(i){i.method="callHierarchy/incomingCalls",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(n||(Ki.CallHierarchyIncomingCallsRequest=n={}));var r;return function(i){i.method="callHierarchy/outgoingCalls",i.messageDirection=
t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)}(r||(Ki.CallHierarchyOutgoingCallsRequest=r={})),Ki}var Wn={},uS;function b8(){if(uS)return Wn;uS=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.SemanticTokensRefreshRequest=Wn.SemanticTokensRangeRequest=Wn.SemanticTokensDeltaRequest=Wn.SemanticTokensRequest=Wn.SemanticTokensRegistrationType=Wn.TokenFormat=void 0;const t=qt();var e;(function(o){o.Relative="relative"})(e||(Wn.TokenFormat=e={}));var n;(function(o){
o.method="textDocument/semanticTokens",o.type=new t.RegistrationType(o.method)})(n||(Wn.SemanticTokensRegistrationType=n={}));var r;(function(o){o.method="textDocument/semanticTokens/full",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(o.method),o.registrationMethod=n.method})(r||(Wn.SemanticTokensRequest=r={}));var i;(function(o){o.method="textDocument/semanticTokens/full/delta",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(
o.method),o.registrationMethod=n.method})(i||(Wn.SemanticTokensDeltaRequest=i={}));var s;(function(o){o.method="textDocument/semanticTokens/range",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(o.method),o.registrationMethod=n.method})(s||(Wn.SemanticTokensRangeRequest=s={}));var a;return function(o){o.method="workspace/semanticTokens/refresh",o.messageDirection=t.MessageDirection.serverToClient,o.type=new t.ProtocolRequestType0(o.method)}(a||(Wn.SemanticTokensRefreshRequest=
a={})),Wn}var al={},cS;function E8(){if(cS)return al;cS=1,Object.defineProperty(al,"__esModule",{value:!0}),al.ShowDocumentRequest=void 0;const t=qt();var e;return function(n){n.method="window/showDocument",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType(n.method)}(e||(al.ShowDocumentRequest=e={})),al}var ol={},lS;function k8(){if(lS)return ol;lS=1,Object.defineProperty(ol,"__esModule",{value:!0}),ol.LinkedEditingRangeRequest=void 0;const t=qt();var e;return function(n){
n.method="textDocument/linkedEditingRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e||(ol.LinkedEditingRangeRequest=e={})),ol}var $n={},dS;function R8(){if(dS)return $n;dS=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.WillDeleteFilesRequest=$n.DidDeleteFilesNotification=$n.DidRenameFilesNotification=$n.WillRenameFilesRequest=$n.DidCreateFilesNotification=$n.WillCreateFilesRequest=$n.FileOperationPatternKind=void 0;const t=qt();var e;
(function(u){u.file="file",u.folder="folder"})(e||($n.FileOperationPatternKind=e={}));var n;(function(u){u.method="workspace/willCreateFiles",u.messageDirection=t.MessageDirection.clientToServer,u.type=new t.ProtocolRequestType(u.method)})(n||($n.WillCreateFilesRequest=n={}));var r;(function(u){u.method="workspace/didCreateFiles",u.messageDirection=t.MessageDirection.clientToServer,u.type=new t.ProtocolNotificationType(u.method)})(r||($n.DidCreateFilesNotification=r={}));var i;(function(u){u.method=
"workspace/willRenameFiles",u.messageDirection=t.MessageDirection.clientToServer,u.type=new t.ProtocolRequestType(u.method)})(i||($n.WillRenameFilesRequest=i={}));var s;(function(u){u.method="workspace/didRenameFiles",u.messageDirection=t.MessageDirection.clientToServer,u.type=new t.ProtocolNotificationType(u.method)})(s||($n.DidRenameFilesNotification=s={}));var a;(function(u){u.method="workspace/didDeleteFiles",u.messageDirection=t.MessageDirection.clientToServer,u.type=new t.ProtocolNotificationType(
u.method)})(a||($n.DidDeleteFilesNotification=a={}));var o;return function(u){u.method="workspace/willDeleteFiles",u.messageDirection=t.MessageDirection.clientToServer,u.type=new t.ProtocolRequestType(u.method)}(o||($n.WillDeleteFilesRequest=o={})),$n}var Zi={},fS;function $8(){if(fS)return Zi;fS=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.MonikerRequest=Zi.MonikerKind=Zi.UniquenessLevel=void 0;const t=qt();var e;(function(i){i.document="document",i.project="project",i.group="group",i.
scheme="scheme",i.global="global"})(e||(Zi.UniquenessLevel=e={}));var n;(function(i){i.$import="import",i.$export="export",i.local="local"})(n||(Zi.MonikerKind=n={}));var r;return function(i){i.method="textDocument/moniker",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)}(r||(Zi.MonikerRequest=r={})),Zi}var Xi={},hS;function D8(){if(hS)return Xi;hS=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.TypeHierarchySubtypesRequest=Xi.TypeHierarchySupertypesRequest=
Xi.TypeHierarchyPrepareRequest=void 0;const t=qt();var e;(function(i){i.method="textDocument/prepareTypeHierarchy",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(e||(Xi.TypeHierarchyPrepareRequest=e={}));var n;(function(i){i.method="typeHierarchy/supertypes",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(n||(Xi.TypeHierarchySupertypesRequest=n={}));var r;return function(i){i.method="typeHierarch\
y/subtypes",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)}(r||(Xi.TypeHierarchySubtypesRequest=r={})),Xi}var La={},pS;function T8(){if(pS)return La;pS=1,Object.defineProperty(La,"__esModule",{value:!0}),La.InlineValueRefreshRequest=La.InlineValueRequest=void 0;const t=qt();var e;(function(r){r.method="textDocument/inlineValue",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)})(e||(La.InlineValueRequest=
e={}));var n;return function(r){r.method="workspace/inlineValue/refresh",r.messageDirection=t.MessageDirection.serverToClient,r.type=new t.ProtocolRequestType0(r.method)}(n||(La.InlineValueRefreshRequest=n={})),La}var Yi={},mS;function S8(){if(mS)return Yi;mS=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.InlayHintRefreshRequest=Yi.InlayHintResolveRequest=Yi.InlayHintRequest=void 0;const t=qt();var e;(function(i){i.method="textDocument/inlayHint",i.messageDirection=t.MessageDirection.clientToServer,
i.type=new t.ProtocolRequestType(i.method)})(e||(Yi.InlayHintRequest=e={}));var n;(function(i){i.method="inlayHint/resolve",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(n||(Yi.InlayHintResolveRequest=n={}));var r;return function(i){i.method="workspace/inlayHint/refresh",i.messageDirection=t.MessageDirection.serverToClient,i.type=new t.ProtocolRequestType0(i.method)}(r||(Yi.InlayHintRefreshRequest=r={})),Yi}var mr={},gS;function C8(){if(gS)return mr;
gS=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.DiagnosticRefreshRequest=mr.WorkspaceDiagnosticRequest=mr.DocumentDiagnosticRequest=mr.DocumentDiagnosticReportKind=mr.DiagnosticServerCancellationData=void 0;const t=xa(),e=iw(),n=qt();var r;(function(u){function c(l){const f=l;return f&&e.boolean(f.retriggerRequest)}u.is=c})(r||(mr.DiagnosticServerCancellationData=r={}));var i;(function(u){u.Full="full",u.Unchanged="unchanged"})(i||(mr.DocumentDiagnosticReportKind=i={}));var s;(function(u){
u.method="textDocument/diagnostic",u.messageDirection=n.MessageDirection.clientToServer,u.type=new n.ProtocolRequestType(u.method),u.partialResult=new t.ProgressType})(s||(mr.DocumentDiagnosticRequest=s={}));var a;(function(u){u.method="workspace/diagnostic",u.messageDirection=n.MessageDirection.clientToServer,u.type=new n.ProtocolRequestType(u.method),u.partialResult=new t.ProgressType})(a||(mr.WorkspaceDiagnosticRequest=a={}));var o;return function(u){u.method="workspace/diagnostic/refresh",u.
messageDirection=n.MessageDirection.serverToClient,u.type=new n.ProtocolRequestType0(u.method)}(o||(mr.DiagnosticRefreshRequest=o={})),mr}var Gt={},yS;function _8(){if(yS)return Gt;yS=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.DidCloseNotebookDocumentNotification=Gt.DidSaveNotebookDocumentNotification=Gt.DidChangeNotebookDocumentNotification=Gt.NotebookCellArrayChange=Gt.DidOpenNotebookDocumentNotification=Gt.NotebookDocumentSyncRegistrationType=Gt.NotebookDocument=Gt.NotebookCell=Gt.
ExecutionSummary=Gt.NotebookCellKind=void 0;const t=nw(),e=iw(),n=qt();var r;(function(h){h.Markup=1,h.Code=2;function p(w){return w===1||w===2}h.is=p})(r||(Gt.NotebookCellKind=r={}));var i;(function(h){function p(g,b){const k={executionOrder:g};return(b===!0||b===!1)&&(k.success=b),k}h.create=p;function w(g){const b=g;return e.objectLiteral(b)&&t.uinteger.is(b.executionOrder)&&(b.success===void 0||e.boolean(b.success))}h.is=w;function v(g,b){return g===b?!0:g==null||b===null||b===void 0?!1:g.executionOrder===
b.executionOrder&&g.success===b.success}h.equals=v})(i||(Gt.ExecutionSummary=i={}));var s;(function(h){function p(b,k){return{kind:b,document:k}}h.create=p;function w(b){const k=b;return e.objectLiteral(k)&&r.is(k.kind)&&t.DocumentUri.is(k.document)&&(k.metadata===void 0||e.objectLiteral(k.metadata))}h.is=w;function v(b,k){const _=new Set;return b.document!==k.document&&_.add("document"),b.kind!==k.kind&&_.add("kind"),b.executionSummary!==k.executionSummary&&_.add("executionSummary"),(b.metadata!==
void 0||k.metadata!==void 0)&&!g(b.metadata,k.metadata)&&_.add("metadata"),(b.executionSummary!==void 0||k.executionSummary!==void 0)&&!i.equals(b.executionSummary,k.executionSummary)&&_.add("executionSummary"),_}h.diff=v;function g(b,k){if(b===k)return!0;if(b==null||k===null||k===void 0||typeof b!=typeof k||typeof b!="object")return!1;const _=Array.isArray(b),I=Array.isArray(k);if(_!==I)return!1;if(_&&I){if(b.length!==k.length)return!1;for(let Z=0;Z<b.length;Z++)if(!g(b[Z],k[Z]))return!1}if(e.objectLiteral(
b)&&e.objectLiteral(k)){const Z=Object.keys(b),J=Object.keys(k);if(Z.length!==J.length||(Z.sort(),J.sort(),!g(Z,J)))return!1;for(let ue=0;ue<Z.length;ue++){const ae=Z[ue];if(!g(b[ae],k[ae]))return!1}}return!0}})(s||(Gt.NotebookCell=s={}));var a;(function(h){function p(v,g,b,k){return{uri:v,notebookType:g,version:b,cells:k}}h.create=p;function w(v){const g=v;return e.objectLiteral(g)&&e.string(g.uri)&&t.integer.is(g.version)&&e.typedArray(g.cells,s.is)}h.is=w})(a||(Gt.NotebookDocument=a={}));var o;
(function(h){h.method="notebookDocument/sync",h.messageDirection=n.MessageDirection.clientToServer,h.type=new n.RegistrationType(h.method)})(o||(Gt.NotebookDocumentSyncRegistrationType=o={}));var u;(function(h){h.method="notebookDocument/didOpen",h.messageDirection=n.MessageDirection.clientToServer,h.type=new n.ProtocolNotificationType(h.method),h.registrationMethod=o.method})(u||(Gt.DidOpenNotebookDocumentNotification=u={}));var c;(function(h){function p(v){const g=v;return e.objectLiteral(g)&&
t.uinteger.is(g.start)&&t.uinteger.is(g.deleteCount)&&(g.cells===void 0||e.typedArray(g.cells,s.is))}h.is=p;function w(v,g,b){const k={start:v,deleteCount:g};return b!==void 0&&(k.cells=b),k}h.create=w})(c||(Gt.NotebookCellArrayChange=c={}));var l;(function(h){h.method="notebookDocument/didChange",h.messageDirection=n.MessageDirection.clientToServer,h.type=new n.ProtocolNotificationType(h.method),h.registrationMethod=o.method})(l||(Gt.DidChangeNotebookDocumentNotification=l={}));var f;(function(h){
h.method="notebookDocument/didSave",h.messageDirection=n.MessageDirection.clientToServer,h.type=new n.ProtocolNotificationType(h.method),h.registrationMethod=o.method})(f||(Gt.DidSaveNotebookDocumentNotification=f={}));var d;return function(h){h.method="notebookDocument/didClose",h.messageDirection=n.MessageDirection.clientToServer,h.type=new n.ProtocolNotificationType(h.method),h.registrationMethod=o.method}(d||(Gt.DidCloseNotebookDocumentNotification=d={})),Gt}var ul={},vS;function A8(){if(vS)
return ul;vS=1,Object.defineProperty(ul,"__esModule",{value:!0}),ul.InlineCompletionRequest=void 0;const t=qt();var e;return function(n){n.method="textDocument/inlineCompletion",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e||(ul.InlineCompletionRequest=e={})),ul}var wS;function x8(){return wS||(wS=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=
t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.RelativePattern=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=
t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeErrorCodes=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.PositionEncodingKind=t.FailureHandlingKind=t.ResourceOperationKind=
t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.NotebookCellTextDocumentFilter=t.NotebookDocumentFilter=t.TextDocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=
t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=
t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangesFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolResolveRequest=void 0,t.InlineCompletionRequest=t.DidCloseNotebookDocumentNotification=
t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=t.InlineValueRefreshRequest=
t.InlineValueRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchySubtypesRequest=t.TypeHierarchyPrepareRequest=void 0;const e=qt(),n=nw(),r=iw(),i=l8();Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return i.ImplementationRequest}});const s=d8();Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return s.TypeDefinitionRequest}});const a=f8();Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return a.WorkspaceFoldersRequest}}),
Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return a.DidChangeWorkspaceFoldersNotification}});const o=h8();Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return o.ConfigurationRequest}});const u=p8();Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return u.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return u.ColorPresentationRequest}});
const c=m8();Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return c.FoldingRangeRequest}}),Object.defineProperty(t,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return c.FoldingRangeRefreshRequest}});const l=g8();Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return l.DeclarationRequest}});const f=y8();Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return f.SelectionRangeRequest}});const d=v8();
Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return d.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return d.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return d.WorkDoneProgressCancelNotification}});const h=w8();Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyIncomingCallsRequest}}),
Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return h.CallHierarchyPrepareRequest}});const p=b8();Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return p.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return p.SemanticTokensRequest}}),Object.defineProperty(t,
"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return p.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return p.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return p.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return p.SemanticTokensRegistrationType}});const w=E8();Object.defineProperty(
t,"ShowDocumentRequest",{enumerable:!0,get:function(){return w.ShowDocumentRequest}});const v=k8();Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return v.LinkedEditingRangeRequest}});const g=R8();Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return g.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return g.DidCreateFilesNotification}}),Object.defineProperty(t,"Wil\
lCreateFilesRequest",{enumerable:!0,get:function(){return g.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return g.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return g.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return g.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,
get:function(){return g.WillDeleteFilesRequest}});const b=$8();Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return b.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return b.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return b.MonikerRequest}});const k=D8();Object.defineProperty(t,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return k.TypeHierarchyPrepareRequest}}),Object.defineProperty(
t,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return k.TypeHierarchySubtypesRequest}}),Object.defineProperty(t,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return k.TypeHierarchySupertypesRequest}});const _=T8();Object.defineProperty(t,"InlineValueRequest",{enumerable:!0,get:function(){return _.InlineValueRequest}}),Object.defineProperty(t,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return _.InlineValueRefreshRequest}});const I=S8();Object.defineProperty(
t,"InlayHintRequest",{enumerable:!0,get:function(){return I.InlayHintRequest}}),Object.defineProperty(t,"InlayHintResolveRequest",{enumerable:!0,get:function(){return I.InlayHintResolveRequest}}),Object.defineProperty(t,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return I.InlayHintRefreshRequest}});const Z=C8();Object.defineProperty(t,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Z.DiagnosticServerCancellationData}}),Object.defineProperty(t,"DocumentDiagnost\
icReportKind",{enumerable:!0,get:function(){return Z.DocumentDiagnosticReportKind}}),Object.defineProperty(t,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Z.DocumentDiagnosticRequest}}),Object.defineProperty(t,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Z.WorkspaceDiagnosticRequest}}),Object.defineProperty(t,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Z.DiagnosticRefreshRequest}});const J=_8();Object.defineProperty(t,"NotebookCellKind",
{enumerable:!0,get:function(){return J.NotebookCellKind}}),Object.defineProperty(t,"ExecutionSummary",{enumerable:!0,get:function(){return J.ExecutionSummary}}),Object.defineProperty(t,"NotebookCell",{enumerable:!0,get:function(){return J.NotebookCell}}),Object.defineProperty(t,"NotebookDocument",{enumerable:!0,get:function(){return J.NotebookDocument}}),Object.defineProperty(t,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return J.NotebookDocumentSyncRegistrationType}}),Object.
defineProperty(t,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return J.DidOpenNotebookDocumentNotification}}),Object.defineProperty(t,"NotebookCellArrayChange",{enumerable:!0,get:function(){return J.NotebookCellArrayChange}}),Object.defineProperty(t,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return J.DidChangeNotebookDocumentNotification}}),Object.defineProperty(t,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return J.DidSaveNotebookDocumentNotification}}),
Object.defineProperty(t,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return J.DidCloseNotebookDocumentNotification}});const ue=A8();Object.defineProperty(t,"InlineCompletionRequest",{enumerable:!0,get:function(){return ue.InlineCompletionRequest}});var ae;(function(m){function D(y){const N=y;return r.string(N)||r.string(N.language)||r.string(N.scheme)||r.string(N.pattern)}m.is=D})(ae||(t.TextDocumentFilter=ae={}));var $e;(function(m){function D(y){const N=y;return r.objectLiteral(
N)&&(r.string(N.notebookType)||r.string(N.scheme)||r.string(N.pattern))}m.is=D})($e||(t.NotebookDocumentFilter=$e={}));var B;(function(m){function D(y){const N=y;return r.objectLiteral(N)&&(r.string(N.notebook)||$e.is(N.notebook))&&(N.language===void 0||r.string(N.language))}m.is=D})(B||(t.NotebookCellTextDocumentFilter=B={}));var T;(function(m){function D(y){if(!Array.isArray(y))return!1;for(let N of y)if(!r.string(N)&&!ae.is(N)&&!B.is(N))return!1;return!0}m.is=D})(T||(t.DocumentSelector=T={}));
var $;(function(m){m.method="client/registerCapability",m.messageDirection=e.MessageDirection.serverToClient,m.type=new e.ProtocolRequestType(m.method)})($||(t.RegistrationRequest=$={}));var j;(function(m){m.method="client/unregisterCapability",m.messageDirection=e.MessageDirection.serverToClient,m.type=new e.ProtocolRequestType(m.method)})(j||(t.UnregistrationRequest=j={}));var A;(function(m){m.Create="create",m.Rename="rename",m.Delete="delete"})(A||(t.ResourceOperationKind=A={}));var P;(function(m){
m.Abort="abort",m.Transactional="transactional",m.TextOnlyTransactional="textOnlyTransactional",m.Undo="undo"})(P||(t.FailureHandlingKind=P={}));var L;(function(m){m.UTF8="utf-8",m.UTF16="utf-16",m.UTF32="utf-32"})(L||(t.PositionEncodingKind=L={}));var Q;(function(m){function D(y){const N=y;return N&&r.string(N.id)&&N.id.length>0}m.hasId=D})(Q||(t.StaticRegistrationOptions=Q={}));var H;(function(m){function D(y){const N=y;return N&&(N.documentSelector===null||T.is(N.documentSelector))}m.is=D})(H||
(t.TextDocumentRegistrationOptions=H={}));var S;(function(m){function D(N){const R=N;return r.objectLiteral(R)&&(R.workDoneProgress===void 0||r.boolean(R.workDoneProgress))}m.is=D;function y(N){const R=N;return R&&r.boolean(R.workDoneProgress)}m.hasWorkDoneProgress=y})(S||(t.WorkDoneProgressOptions=S={}));var re;(function(m){m.method="initialize",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(re||(t.InitializeRequest=re={}));var ke;(function(m){
m.unknownProtocolVersion=1})(ke||(t.InitializeErrorCodes=ke={}));var je;(function(m){m.method="initialized",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolNotificationType(m.method)})(je||(t.InitializedNotification=je={}));var M;(function(m){m.method="shutdown",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType0(m.method)})(M||(t.ShutdownRequest=M={}));var V;(function(m){m.method="exit",m.messageDirection=e.MessageDirection.clientToServer,
m.type=new e.ProtocolNotificationType0(m.method)})(V||(t.ExitNotification=V={}));var Le;(function(m){m.method="workspace/didChangeConfiguration",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolNotificationType(m.method)})(Le||(t.DidChangeConfigurationNotification=Le={}));var he;(function(m){m.Error=1,m.Warning=2,m.Info=3,m.Log=4,m.Debug=5})(he||(t.MessageType=he={}));var Ce;(function(m){m.method="window/showMessage",m.messageDirection=e.MessageDirection.serverToClient,m.
type=new e.ProtocolNotificationType(m.method)})(Ce||(t.ShowMessageNotification=Ce={}));var Be;(function(m){m.method="window/showMessageRequest",m.messageDirection=e.MessageDirection.serverToClient,m.type=new e.ProtocolRequestType(m.method)})(Be||(t.ShowMessageRequest=Be={}));var pe;(function(m){m.method="window/logMessage",m.messageDirection=e.MessageDirection.serverToClient,m.type=new e.ProtocolNotificationType(m.method)})(pe||(t.LogMessageNotification=pe={}));var O;(function(m){m.method="telem\
etry/event",m.messageDirection=e.MessageDirection.serverToClient,m.type=new e.ProtocolNotificationType(m.method)})(O||(t.TelemetryEventNotification=O={}));var U;(function(m){m.None=0,m.Full=1,m.Incremental=2})(U||(t.TextDocumentSyncKind=U={}));var ge;(function(m){m.method="textDocument/didOpen",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolNotificationType(m.method)})(ge||(t.DidOpenTextDocumentNotification=ge={}));var z;(function(m){function D(N){let R=N;return R!=null&&
typeof R.text=="string"&&R.range!==void 0&&(R.rangeLength===void 0||typeof R.rangeLength=="number")}m.isIncremental=D;function y(N){let R=N;return R!=null&&typeof R.text=="string"&&R.range===void 0&&R.rangeLength===void 0}m.isFull=y})(z||(t.TextDocumentContentChangeEvent=z={}));var me;(function(m){m.method="textDocument/didChange",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolNotificationType(m.method)})(me||(t.DidChangeTextDocumentNotification=me={}));var nt;(function(m){
m.method="textDocument/didClose",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolNotificationType(m.method)})(nt||(t.DidCloseTextDocumentNotification=nt={}));var mt;(function(m){m.method="textDocument/didSave",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolNotificationType(m.method)})(mt||(t.DidSaveTextDocumentNotification=mt={}));var de;(function(m){m.Manual=1,m.AfterDelay=2,m.FocusOut=3})(de||(t.TextDocumentSaveReason=de={}));var Ue;(function(m){
m.method="textDocument/willSave",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolNotificationType(m.method)})(Ue||(t.WillSaveTextDocumentNotification=Ue={}));var se;(function(m){m.method="textDocument/willSaveWaitUntil",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(se||(t.WillSaveTextDocumentWaitUntilRequest=se={}));var _e;(function(m){m.method="workspace/didChangeWatchedFiles",m.messageDirection=e.MessageDirection.clientToServer,
m.type=new e.ProtocolNotificationType(m.method)})(_e||(t.DidChangeWatchedFilesNotification=_e={}));var Xe;(function(m){m.Created=1,m.Changed=2,m.Deleted=3})(Xe||(t.FileChangeType=Xe={}));var xt;(function(m){function D(y){const N=y;return r.objectLiteral(N)&&(n.URI.is(N.baseUri)||n.WorkspaceFolder.is(N.baseUri))&&r.string(N.pattern)}m.is=D})(xt||(t.RelativePattern=xt={}));var dt;(function(m){m.Create=1,m.Change=2,m.Delete=4})(dt||(t.WatchKind=dt={}));var ln;(function(m){m.method="textDocument/pub\
lishDiagnostics",m.messageDirection=e.MessageDirection.serverToClient,m.type=new e.ProtocolNotificationType(m.method)})(ln||(t.PublishDiagnosticsNotification=ln={}));var gn;(function(m){m.Invoked=1,m.TriggerCharacter=2,m.TriggerForIncompleteCompletions=3})(gn||(t.CompletionTriggerKind=gn={}));var In;(function(m){m.method="textDocument/completion",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(In||(t.CompletionRequest=In={}));var X;(function(m){m.
method="completionItem/resolve",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(X||(t.CompletionResolveRequest=X={}));var Y;(function(m){m.method="textDocument/hover",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(Y||(t.HoverRequest=Y={}));var ve;(function(m){m.Invoked=1,m.TriggerCharacter=2,m.ContentChange=3})(ve||(t.SignatureHelpTriggerKind=ve={}));var yn;(function(m){m.method="textDocument/sig\
natureHelp",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(yn||(t.SignatureHelpRequest=yn={}));var dn;(function(m){m.method="textDocument/definition",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(dn||(t.DefinitionRequest=dn={}));var ci;(function(m){m.method="textDocument/references",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(ci||(t.ReferencesRequest=
ci={}));var gs;(function(m){m.method="textDocument/documentHighlight",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(gs||(t.DocumentHighlightRequest=gs={}));var Zs;(function(m){m.method="textDocument/documentSymbol",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(Zs||(t.DocumentSymbolRequest=Zs={}));var Xs;(function(m){m.method="textDocument/codeAction",m.messageDirection=e.MessageDirection.clientToServer,
m.type=new e.ProtocolRequestType(m.method)})(Xs||(t.CodeActionRequest=Xs={}));var Ys;(function(m){m.method="codeAction/resolve",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(Ys||(t.CodeActionResolveRequest=Ys={}));var Js;(function(m){m.method="workspace/symbol",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(Js||(t.WorkspaceSymbolRequest=Js={}));var ys;(function(m){m.method="workspaceSymbol/reso\
lve",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(ys||(t.WorkspaceSymbolResolveRequest=ys={}));var vs;(function(m){m.method="textDocument/codeLens",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(vs||(t.CodeLensRequest=vs={}));var Xn;(function(m){m.method="codeLens/resolve",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(Xn||(t.CodeLensResolveRequest=
Xn={}));var Qs;(function(m){m.method="workspace/codeLens/refresh",m.messageDirection=e.MessageDirection.serverToClient,m.type=new e.ProtocolRequestType0(m.method)})(Qs||(t.CodeLensRefreshRequest=Qs={}));var ea;(function(m){m.method="textDocument/documentLink",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(ea||(t.DocumentLinkRequest=ea={}));var li;(function(m){m.method="documentLink/resolve",m.messageDirection=e.MessageDirection.clientToServer,m.
type=new e.ProtocolRequestType(m.method)})(li||(t.DocumentLinkResolveRequest=li={}));var ta;(function(m){m.method="textDocument/formatting",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(ta||(t.DocumentFormattingRequest=ta={}));var Ci;(function(m){m.method="textDocument/rangeFormatting",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(Ci||(t.DocumentRangeFormattingRequest=Ci={}));var na;(function(m){
m.method="textDocument/rangesFormatting",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(na||(t.DocumentRangesFormattingRequest=na={}));var Rr;(function(m){m.method="textDocument/onTypeFormatting",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(Rr||(t.DocumentOnTypeFormattingRequest=Rr={}));var Fr;(function(m){m.Identifier=1})(Fr||(t.PrepareSupportDefaultBehavior=Fr={}));var go;(function(m){m.method=
"textDocument/rename",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(go||(t.RenameRequest=go={}));var q;(function(m){m.method="textDocument/prepareRename",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(q||(t.PrepareRenameRequest=q={}));var E;(function(m){m.method="workspace/executeCommand",m.messageDirection=e.MessageDirection.clientToServer,m.type=new e.ProtocolRequestType(m.method)})(E||(t.ExecuteCommandRequest=
E={}));var x;(function(m){m.method="workspace/applyEdit",m.messageDirection=e.MessageDirection.serverToClient,m.type=new e.ProtocolRequestType("workspace/applyEdit")})(x||(t.ApplyWorkspaceEditRequest=x={}))}(rw)),rw}var cl={},bS;function P8(){if(bS)return cl;bS=1,Object.defineProperty(cl,"__esModule",{value:!0}),cl.createProtocolConnection=void 0;const t=xa();function e(n,r,i,s){return t.ConnectionStrategy.is(s)&&(s={connectionStrategy:s}),(0,t.createMessageConnection)(n,r,i,s)}return cl.createProtocolConnection=
e,cl}var ES;function N8(){return ES||(ES=1,function(t){var e=Pa&&Pa.__createBinding||(Object.create?function(s,a,o,u){u===void 0&&(u=o);var c=Object.getOwnPropertyDescriptor(a,o);(!c||("get"in c?!a.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(s,u,c)}:function(s,a,o,u){u===void 0&&(u=o),s[u]=a[o]}),n=Pa&&Pa.__exportStar||function(s,a){for(var o in s)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&e(a,s,o)};Object.defineProperty(
t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,n(xa(),t),n(nw(),t),n(qt(),t),n(x8(),t);var r=P8();Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return r.createProtocolConnection}});var i;(function(s){s.lspReservedErrorRangeStart=-32899,s.RequestFailed=-32803,s.ServerCancelled=-32802,s.ContentModified=-32801,s.RequestCancelled=-32800,s.lspReservedErrorRangeEnd=-32800})(i||(t.LSPErrorCodes=i={}))}(Pa)),Pa}var kS;function Xt(){return kS||
(kS=1,function(t){var e=Ca&&Ca.__createBinding||(Object.create?function(s,a,o,u){u===void 0&&(u=o);var c=Object.getOwnPropertyDescriptor(a,o);(!c||("get"in c?!a.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(s,u,c)}:function(s,a,o,u){u===void 0&&(u=o),s[u]=a[o]}),n=Ca&&Ca.__exportStar||function(s,a){for(var o in s)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&e(a,s,o)};Object.defineProperty(t,"__esModule",{value:!0}),t.
createProtocolConnection=void 0;const r=KT();n(KT(),t),n(N8(),t);function i(s,a,o,u){return(0,r.createMessageConnection)(s,a,o,u)}t.createProtocolConnection=i}(Ca)),Ca}var gr={},RS;function $S(){if(RS)return gr;RS=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.generateUuid=gr.parse=gr.isUUID=gr.v4=gr.empty=void 0;class t{constructor(u){this._value=u}asHex(){return this._value}equals(u){return this.asHex()===u.asHex()}}class e extends t{static _oneOf(u){return u[Math.floor(u.length*Math.random())]}static _randomHex(){
return e._oneOf(e._chars)}constructor(){super([e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-","4",e._randomHex(),e._randomHex(),e._randomHex(),"-",e._oneOf(e._timeHighBits),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e.
_randomHex(),e._randomHex(),e._randomHex()].join(""))}}e._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],e._timeHighBits=["8","9","a","b"],gr.empty=new t("00000000-0000-0000-0000-000000000000");function n(){return new e}gr.v4=n;const r=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function i(o){return r.test(o)}gr.isUUID=i;function s(o){if(!i(o))throw new Error("invalid uuid");return new t(o)}gr.parse=s;function a(){return n().asHex()}return gr.generateUuid=
a,gr}var Ji={},DS;function I8(){if(DS)return Ji;DS=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.attachPartialResult=Ji.ProgressFeature=Ji.attachWorkDone=void 0;const t=Xt(),e=$S();class n{constructor(d,h){this._connection=d,this._token=h,n.Instances.set(this._token,this)}begin(d,h,p,w){let v={kind:"begin",title:d,percentage:h,message:p,cancellable:w};this._connection.sendProgress(t.WorkDoneProgress.type,this._token,v)}report(d,h){let p={kind:"report"};typeof d=="number"?(p.percentage=d,
h!==void 0&&(p.message=h)):p.message=d,this._connection.sendProgress(t.WorkDoneProgress.type,this._token,p)}done(){n.Instances.delete(this._token),this._connection.sendProgress(t.WorkDoneProgress.type,this._token,{kind:"end"})}}n.Instances=new Map;class r extends n{constructor(d,h){super(d,h),this._source=new t.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class i{constructor(){}begin(){}report(){}done(){}}
class s extends i{constructor(){super(),this._source=new t.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}function a(f,d){if(d===void 0||d.workDoneToken===void 0)return new i;const h=d.workDoneToken;return delete d.workDoneToken,new n(f,h)}Ji.attachWorkDone=a;const o=f=>class extends f{constructor(){super(),this._progressSupported=!1}initialize(d){super.initialize(d),d?.window?.workDoneProgress===!0&&(this._progressSupported=
!0,this.connection.onNotification(t.WorkDoneProgressCancelNotification.type,h=>{let p=n.Instances.get(h.token);(p instanceof r||p instanceof s)&&p.cancel()}))}attachWorkDoneProgress(d){return d===void 0?new i:new n(this.connection,d)}createWorkDoneProgress(){if(this._progressSupported){const d=(0,e.generateUuid)();return this.connection.sendRequest(t.WorkDoneProgressCreateRequest.type,{token:d}).then(()=>new r(this.connection,d))}else return Promise.resolve(new s)}};Ji.ProgressFeature=o;var u;(function(f){
f.type=new t.ProgressType})(u||(u={}));class c{constructor(d,h){this._connection=d,this._token=h}report(d){this._connection.sendProgress(u.type,this._token,d)}}function l(f,d){if(d===void 0||d.partialResultToken===void 0)return;const h=d.partialResultToken;return delete d.partialResultToken,new c(f,h)}return Ji.attachPartialResult=l,Ji}var ll={},TS;function O8(){if(TS)return ll;TS=1,Object.defineProperty(ll,"__esModule",{value:!0}),ll.ConfigurationFeature=void 0;const t=Xt(),e=Yv(),n=r=>class extends r{getConfiguration(i){
return i?e.string(i)?this._getConfiguration({section:i}):this._getConfiguration(i):this._getConfiguration({})}_getConfiguration(i){let s={items:Array.isArray(i)?i:[i]};return this.connection.sendRequest(t.ConfigurationRequest.type,s).then(a=>Array.isArray(a)?Array.isArray(i)?a:a[0]:Array.isArray(i)?[]:null)}};return ll.ConfigurationFeature=n,ll}var dl={},SS;function L8(){if(SS)return dl;SS=1,Object.defineProperty(dl,"__esModule",{value:!0}),dl.WorkspaceFoldersFeature=void 0;const t=Xt(),e=n=>class extends n{constructor(){
super(),this._notificationIsAutoRegistered=!1}initialize(r){super.initialize(r);let i=r.workspace;i&&i.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new t.Emitter,this.connection.onNotification(t.DidChangeWorkspaceFoldersNotification.type,s=>{this._onDidChangeWorkspaceFolders.fire(s.event)}))}fillServerCapabilities(r){super.fillServerCapabilities(r);const i=r.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=i===!0||typeof i=="string"}getWorkspaceFolders(){
return this.connection.sendRequest(t.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return!this._notificationIsAutoRegistered&&!this._unregistration&&(this._unregistration=this.connection.client.register(t.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}};return dl.WorkspaceFoldersFeature=e,dl}var fl={},CS;function F8(){if(CS)
return fl;CS=1,Object.defineProperty(fl,"__esModule",{value:!0}),fl.CallHierarchyFeature=void 0;const t=Xt(),e=n=>class extends n{get callHierarchy(){return{onPrepare:r=>this.connection.onRequest(t.CallHierarchyPrepareRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),void 0)),onIncomingCalls:r=>{const i=t.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))},onOutgoingCalls:r=>{const i=t.
CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return fl.CallHierarchyFeature=e,fl}var Qi={},_S;function AS(){if(_S)return Qi;_S=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.SemanticTokensBuilder=Qi.SemanticTokensDiff=Qi.SemanticTokensFeature=void 0;const t=Xt(),e=i=>class extends i{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(t.SemanticTokensRefreshRequest.
type),on:s=>{const a=t.SemanticTokensRequest.type;return this.connection.onRequest(a,(o,u)=>s(o,u,this.attachWorkDoneProgress(o),this.attachPartialResultProgress(a,o)))},onDelta:s=>{const a=t.SemanticTokensDeltaRequest.type;return this.connection.onRequest(a,(o,u)=>s(o,u,this.attachWorkDoneProgress(o),this.attachPartialResultProgress(a,o)))},onRange:s=>{const a=t.SemanticTokensRangeRequest.type;return this.connection.onRequest(a,(o,u)=>s(o,u,this.attachWorkDoneProgress(o),this.attachPartialResultProgress(
a,o)))}}}};Qi.SemanticTokensFeature=e;class n{constructor(s,a){this.originalSequence=s,this.modifiedSequence=a}computeDiff(){const s=this.originalSequence.length,a=this.modifiedSequence.length;let o=0;for(;o<a&&o<s&&this.originalSequence[o]===this.modifiedSequence[o];)o++;if(o<a&&o<s){let u=s-1,c=a-1;for(;u>=o&&c>=o&&this.originalSequence[u]===this.modifiedSequence[c];)u--,c--;(u<o||c<o)&&(u++,c++);const l=u-o+1,f=this.modifiedSequence.slice(o,c+1);return f.length===1&&f[0]===this.originalSequence[u]?
[{start:o,deleteCount:l-1}]:[{start:o,deleteCount:l,data:f}]}else return o<a?[{start:o,deleteCount:0,data:this.modifiedSequence.slice(o)}]:o<s?[{start:o,deleteCount:s-o}]:[]}}Qi.SemanticTokensDiff=n;class r{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(s,a,o,u,c){let l=s,f=a;this._dataLen>0&&(l-=this._prevLine,l===0&&(f-=this._prevChar)),this._data[this._dataLen++]=l,this._data[this._dataLen++]=
f,this._data[this._dataLen++]=o,this._data[this._dataLen++]=u,this._data[this._dataLen++]=c,this._prevLine=s,this._prevChar=a}get id(){return this._id.toString()}previousResult(s){this.id===s&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){return this._prevData!==void 0?{resultId:this.id,edits:new n(this._prevData,this._data).computeDiff()}:this.build()}}return Qi.SemanticTokensBuilder=
r,Qi}var hl={},xS;function M8(){if(xS)return hl;xS=1,Object.defineProperty(hl,"__esModule",{value:!0}),hl.ShowDocumentFeature=void 0;const t=Xt(),e=n=>class extends n{showDocument(r){return this.connection.sendRequest(t.ShowDocumentRequest.type,r)}};return hl.ShowDocumentFeature=e,hl}var pl={},PS;function j8(){if(PS)return pl;PS=1,Object.defineProperty(pl,"__esModule",{value:!0}),pl.FileOperationsFeature=void 0;const t=Xt(),e=n=>class extends n{onDidCreateFiles(r){return this.connection.onNotification(
t.DidCreateFilesNotification.type,i=>{r(i)})}onDidRenameFiles(r){return this.connection.onNotification(t.DidRenameFilesNotification.type,i=>{r(i)})}onDidDeleteFiles(r){return this.connection.onNotification(t.DidDeleteFilesNotification.type,i=>{r(i)})}onWillCreateFiles(r){return this.connection.onRequest(t.WillCreateFilesRequest.type,(i,s)=>r(i,s))}onWillRenameFiles(r){return this.connection.onRequest(t.WillRenameFilesRequest.type,(i,s)=>r(i,s))}onWillDeleteFiles(r){return this.connection.onRequest(
t.WillDeleteFilesRequest.type,(i,s)=>r(i,s))}};return pl.FileOperationsFeature=e,pl}var ml={},NS;function B8(){if(NS)return ml;NS=1,Object.defineProperty(ml,"__esModule",{value:!0}),ml.LinkedEditingRangeFeature=void 0;const t=Xt(),e=n=>class extends n{onLinkedEditingRange(r){return this.connection.onRequest(t.LinkedEditingRangeRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),void 0))}};return ml.LinkedEditingRangeFeature=e,ml}var gl={},IS;function q8(){if(IS)return gl;IS=1,Object.defineProperty(
gl,"__esModule",{value:!0}),gl.TypeHierarchyFeature=void 0;const t=Xt(),e=n=>class extends n{get typeHierarchy(){return{onPrepare:r=>this.connection.onRequest(t.TypeHierarchyPrepareRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),void 0)),onSupertypes:r=>{const i=t.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))},onSubtypes:r=>{const i=t.TypeHierarchySubtypesRequest.type;return this.
connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return gl.TypeHierarchyFeature=e,gl}var yl={},OS;function G8(){if(OS)return yl;OS=1,Object.defineProperty(yl,"__esModule",{value:!0}),yl.InlineValueFeature=void 0;const t=Xt(),e=n=>class extends n{get inlineValue(){return{refresh:()=>this.connection.sendRequest(t.InlineValueRefreshRequest.type),on:r=>this.connection.onRequest(t.InlineValueRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(
i)))}}};return yl.InlineValueFeature=e,yl}var vl={},LS;function U8(){if(LS)return vl;LS=1,Object.defineProperty(vl,"__esModule",{value:!0}),vl.FoldingRangeFeature=void 0;const t=Xt(),e=n=>class extends n{get foldingRange(){return{refresh:()=>this.connection.sendRequest(t.FoldingRangeRefreshRequest.type),on:r=>{const i=t.FoldingRangeRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return vl.FoldingRangeFeature=
e,vl}var wl={},FS;function z8(){if(FS)return wl;FS=1,Object.defineProperty(wl,"__esModule",{value:!0}),wl.InlayHintFeature=void 0;const t=Xt(),e=n=>class extends n{get inlayHint(){return{refresh:()=>this.connection.sendRequest(t.InlayHintRefreshRequest.type),on:r=>this.connection.onRequest(t.InlayHintRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i))),resolve:r=>this.connection.onRequest(t.InlayHintResolveRequest.type,(i,s)=>r(i,s))}}};return wl.InlayHintFeature=e,wl}var bl={},MS;function W8(){
if(MS)return bl;MS=1,Object.defineProperty(bl,"__esModule",{value:!0}),bl.DiagnosticFeature=void 0;const t=Xt(),e=n=>class extends n{get diagnostics(){return{refresh:()=>this.connection.sendRequest(t.DiagnosticRefreshRequest.type),on:r=>this.connection.onRequest(t.DocumentDiagnosticRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(t.DocumentDiagnosticRequest.partialResult,i))),onWorkspace:r=>this.connection.onRequest(t.WorkspaceDiagnosticRequest.type,(i,s)=>r(
i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(t.WorkspaceDiagnosticRequest.partialResult,i)))}}};return bl.DiagnosticFeature=e,bl}var Fa={},El={},jS;function BS(){if(jS)return El;jS=1,Object.defineProperty(El,"__esModule",{value:!0}),El.TextDocuments=void 0;const t=Xt();class e{constructor(r){this._configuration=r,this._syncedDocuments=new Map,this._onDidChangeContent=new t.Emitter,this._onDidOpen=new t.Emitter,this._onDidClose=new t.Emitter,this._onDidSave=new t.Emitter,this.
_onWillSave=new t.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(r){this._willSaveWaitUntil=r}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(r){return this._syncedDocuments.get(r)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(r){r.__textDocumentSync=
t.TextDocumentSyncKind.Incremental;const i=[];return i.push(r.onDidOpenTextDocument(s=>{const a=s.textDocument,o=this._configuration.create(a.uri,a.languageId,a.version,a.text);this._syncedDocuments.set(a.uri,o);const u=Object.freeze({document:o});this._onDidOpen.fire(u),this._onDidChangeContent.fire(u)})),i.push(r.onDidChangeTextDocument(s=>{const a=s.textDocument,o=s.contentChanges;if(o.length===0)return;const{version:u}=a;if(u==null)throw new Error(`Received document change event for ${a.uri}\
 without valid version identifier`);let c=this._syncedDocuments.get(a.uri);c!==void 0&&(c=this._configuration.update(c,o,u),this._syncedDocuments.set(a.uri,c),this._onDidChangeContent.fire(Object.freeze({document:c})))})),i.push(r.onDidCloseTextDocument(s=>{let a=this._syncedDocuments.get(s.textDocument.uri);a!==void 0&&(this._syncedDocuments.delete(s.textDocument.uri),this._onDidClose.fire(Object.freeze({document:a})))})),i.push(r.onWillSaveTextDocument(s=>{let a=this._syncedDocuments.get(s.textDocument.
uri);a!==void 0&&this._onWillSave.fire(Object.freeze({document:a,reason:s.reason}))})),i.push(r.onWillSaveTextDocumentWaitUntil((s,a)=>{let o=this._syncedDocuments.get(s.textDocument.uri);return o!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:o,reason:s.reason}),a):[]})),i.push(r.onDidSaveTextDocument(s=>{let a=this._syncedDocuments.get(s.textDocument.uri);a!==void 0&&this._onDidSave.fire(Object.freeze({document:a}))})),t.Disposable.create(()=>{i.forEach(s=>s.
dispose())})}}return El.TextDocuments=e,El}var qS;function GS(){if(qS)return Fa;qS=1,Object.defineProperty(Fa,"__esModule",{value:!0}),Fa.NotebookDocuments=Fa.NotebookSyncFeature=void 0;const t=Xt(),e=BS(),n=s=>class extends s{get synchronization(){return{onDidOpenNotebookDocument:a=>this.connection.onNotification(t.DidOpenNotebookDocumentNotification.type,o=>{a(o)}),onDidChangeNotebookDocument:a=>this.connection.onNotification(t.DidChangeNotebookDocumentNotification.type,o=>{a(o)}),onDidSaveNotebookDocument:a=>this.
connection.onNotification(t.DidSaveNotebookDocumentNotification.type,o=>{a(o)}),onDidCloseNotebookDocument:a=>this.connection.onNotification(t.DidCloseNotebookDocumentNotification.type,o=>{a(o)})}}};Fa.NotebookSyncFeature=n;class r{onDidOpenTextDocument(a){return this.openHandler=a,t.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(a){this.openHandler&&this.openHandler(a)}onDidChangeTextDocument(a){return this.changeHandler=a,t.Disposable.create(()=>{this.changeHandler=a})}changeTextDocument(a){
this.changeHandler&&this.changeHandler(a)}onDidCloseTextDocument(a){return this.closeHandler=a,t.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(a){this.closeHandler&&this.closeHandler(a)}onWillSaveTextDocument(){return r.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return r.NULL_DISPOSE}onDidSaveTextDocument(){return r.NULL_DISPOSE}}r.NULL_DISPOSE=Object.freeze({dispose:()=>{}});class i{constructor(a){a instanceof e.TextDocuments?this._cellTextDocuments=a:this._cellTextDocuments=
new e.TextDocuments(a),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new t.Emitter,this._onDidChange=new t.Emitter,this._onDidSave=new t.Emitter,this._onDidClose=new t.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(a){return this._cellTextDocuments.get(a.document)}getNotebookDocument(a){return this.notebookDocuments.get(a)}getNotebookCell(a){const o=this.notebookCellMap.get(a);return o&&o[0]}findNotebookDocumentForCell(a){const o=typeof a==
"string"?a:a.document,u=this.notebookCellMap.get(o);return u&&u[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(a){const o=new r,u=[];return u.push(this.cellTextDocuments.listen(o)),u.push(a.notebooks.synchronization.onDidOpenNotebookDocument(c=>{this.notebookDocuments.set(c.notebookDocument.uri,c.notebookDocument);for(const l of c.cellTextDocuments)
o.openTextDocument({textDocument:l});this.updateCellMap(c.notebookDocument),this._onDidOpen.fire(c.notebookDocument)})),u.push(a.notebooks.synchronization.onDidChangeNotebookDocument(c=>{const l=this.notebookDocuments.get(c.notebookDocument.uri);if(l===void 0)return;l.version=c.notebookDocument.version;const f=l.metadata;let d=!1;const h=c.change;h.metadata!==void 0&&(d=!0,l.metadata=h.metadata);const p=[],w=[],v=[],g=[];if(h.cells!==void 0){const Z=h.cells;if(Z.structure!==void 0){const J=Z.structure.
array;if(l.cells.splice(J.start,J.deleteCount,...J.cells!==void 0?J.cells:[]),Z.structure.didOpen!==void 0)for(const ue of Z.structure.didOpen)o.openTextDocument({textDocument:ue}),p.push(ue.uri);if(Z.structure.didClose)for(const ue of Z.structure.didClose)o.closeTextDocument({textDocument:ue}),w.push(ue.uri)}if(Z.data!==void 0){const J=new Map(Z.data.map(ue=>[ue.document,ue]));for(let ue=0;ue<=l.cells.length;ue++){const ae=J.get(l.cells[ue].document);if(ae!==void 0){const $e=l.cells.splice(ue,1,
ae);if(v.push({old:$e[0],new:ae}),J.delete(ae.document),J.size===0)break}}}if(Z.textContent!==void 0)for(const J of Z.textContent)o.changeTextDocument({textDocument:J.document,contentChanges:J.changes}),g.push(J.document.uri)}this.updateCellMap(l);const b={notebookDocument:l};d&&(b.metadata={old:f,new:l.metadata});const k=[];for(const Z of p)k.push(this.getNotebookCell(Z));const _=[];for(const Z of w)_.push(this.getNotebookCell(Z));const I=[];for(const Z of g)I.push(this.getNotebookCell(Z));(k.length>
0||_.length>0||v.length>0||I.length>0)&&(b.cells={added:k,removed:_,changed:{data:v,textContent:I}}),(b.metadata!==void 0||b.cells!==void 0)&&this._onDidChange.fire(b)})),u.push(a.notebooks.synchronization.onDidSaveNotebookDocument(c=>{const l=this.notebookDocuments.get(c.notebookDocument.uri);l!==void 0&&this._onDidSave.fire(l)})),u.push(a.notebooks.synchronization.onDidCloseNotebookDocument(c=>{const l=this.notebookDocuments.get(c.notebookDocument.uri);if(l!==void 0){this._onDidClose.fire(l);for(const f of c.
cellTextDocuments)o.closeTextDocument({textDocument:f});this.notebookDocuments.delete(c.notebookDocument.uri);for(const f of l.cells)this.notebookCellMap.delete(f.document)}})),t.Disposable.create(()=>{u.forEach(c=>c.dispose())})}updateCellMap(a){for(const o of a.cells)this.notebookCellMap.set(o.document,[o,a])}}return Fa.NotebookDocuments=i,Fa}var kl={},US;function H8(){if(US)return kl;US=1,Object.defineProperty(kl,"__esModule",{value:!0}),kl.MonikerFeature=void 0;const t=Xt(),e=n=>class extends n{get moniker(){
return{on:r=>{const i=t.MonikerRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return kl.MonikerFeature=e,kl}var zS;function WS(){if(zS)return ct;zS=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.createConnection=ct.combineFeatures=ct.combineNotebooksFeatures=ct.combineLanguagesFeatures=ct.combineWorkspaceFeatures=ct.combineWindowFeatures=ct.combineClientFeatures=ct.combineTracerFeatures=ct.combineTelemetryFeatures=
ct.combineConsoleFeatures=ct._NotebooksImpl=ct._LanguagesImpl=ct.BulkUnregistration=ct.BulkRegistration=ct.ErrorMessageTracker=void 0;const t=Xt(),e=Yv(),n=$S(),r=I8(),i=O8(),s=L8(),a=F8(),o=AS(),u=M8(),c=j8(),l=B8(),f=q8(),d=G8(),h=U8(),p=z8(),w=W8(),v=GS(),g=H8();function b(pe){if(pe!==null)return pe}class k{constructor(){this._messages=Object.create(null)}add(O){let U=this._messages[O];U||(U=0),U++,this._messages[O]=U}sendErrors(O){Object.keys(this._messages).forEach(U=>{O.window.showErrorMessage(
U)})}}ct.ErrorMessageTracker=k;class _{constructor(){}rawAttach(O){this._rawConnection=O}attach(O){this._connection=O}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(O){}initialize(O){}error(O){this.send(t.MessageType.Error,O)}warn(O){this.send(t.MessageType.Warning,O)}info(O){this.send(t.MessageType.Info,O)}log(O){this.send(t.MessageType.Log,O)}debug(O){this.send(t.MessageType.Debug,O)}send(O,U){
this._rawConnection&&this._rawConnection.sendNotification(t.LogMessageNotification.type,{type:O,message:U}).catch(()=>{(0,t.RAL)().console.error("Sending log message failed")})}}class I{constructor(){}attach(O){this._connection=O}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(O){}fillServerCapabilities(O){}showErrorMessage(O,...U){let ge={type:t.MessageType.Error,message:O,actions:U};return this.connection.sendRequest(
t.ShowMessageRequest.type,ge).then(b)}showWarningMessage(O,...U){let ge={type:t.MessageType.Warning,message:O,actions:U};return this.connection.sendRequest(t.ShowMessageRequest.type,ge).then(b)}showInformationMessage(O,...U){let ge={type:t.MessageType.Info,message:O,actions:U};return this.connection.sendRequest(t.ShowMessageRequest.type,ge).then(b)}}const Z=(0,u.ShowDocumentFeature)((0,r.ProgressFeature)(I));var J;(function(pe){function O(){return new ue}pe.create=O})(J||(ct.BulkRegistration=J={}));
class ue{constructor(){this._registrations=[],this._registered=new Set}add(O,U){const ge=e.string(O)?O:O.method;if(this._registered.has(ge))throw new Error(`${ge} is already added to this registration`);const z=n.generateUuid();this._registrations.push({id:z,method:ge,registerOptions:U||{}}),this._registered.add(ge)}asRegistrationParams(){return{registrations:this._registrations}}}var ae;(function(pe){function O(){return new $e(void 0,[])}pe.create=O})(ae||(ct.BulkUnregistration=ae={}));class $e{constructor(O,U){
this._connection=O,this._unregistrations=new Map,U.forEach(ge=>{this._unregistrations.set(ge.method,ge)})}get isAttached(){return!!this._connection}attach(O){this._connection=O}add(O){this._unregistrations.set(O.method,O)}dispose(){let O=[];for(let ge of this._unregistrations.values())O.push(ge);let U={unregisterations:O};this._connection.sendRequest(t.UnregistrationRequest.type,U).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(O){const U=e.string(O)?O:O.
method,ge=this._unregistrations.get(U);if(!ge)return!1;let z={unregisterations:[ge]};return this._connection.sendRequest(t.UnregistrationRequest.type,z).then(()=>{this._unregistrations.delete(U)},me=>{this._connection.console.info(`Un-registering request handler for ${ge.id} failed.`)}),!0}}class B{attach(O){this._connection=O}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(O){}fillServerCapabilities(O){}register(O,U,ge){
return O instanceof ue?this.registerMany(O):O instanceof $e?this.registerSingle1(O,U,ge):this.registerSingle2(O,U)}registerSingle1(O,U,ge){const z=e.string(U)?U:U.method,me=n.generateUuid();let nt={registrations:[{id:me,method:z,registerOptions:ge||{}}]};return O.isAttached||O.attach(this.connection),this.connection.sendRequest(t.RegistrationRequest.type,nt).then(mt=>(O.add({id:me,method:z}),O),mt=>(this.connection.console.info(`Registering request handler for ${z} failed.`),Promise.reject(mt)))}registerSingle2(O,U){
const ge=e.string(O)?O:O.method,z=n.generateUuid();let me={registrations:[{id:z,method:ge,registerOptions:U||{}}]};return this.connection.sendRequest(t.RegistrationRequest.type,me).then(nt=>t.Disposable.create(()=>{this.unregisterSingle(z,ge).catch(()=>{this.connection.console.info(`Un-registering capability with id ${z} failed.`)})}),nt=>(this.connection.console.info(`Registering request handler for ${ge} failed.`),Promise.reject(nt)))}unregisterSingle(O,U){let ge={unregisterations:[{id:O,method:U}]};
return this.connection.sendRequest(t.UnregistrationRequest.type,ge).catch(()=>{this.connection.console.info(`Un-registering request handler for ${O} failed.`)})}registerMany(O){let U=O.asRegistrationParams();return this.connection.sendRequest(t.RegistrationRequest.type,U).then(()=>new $e(this._connection,U.registrations.map(ge=>({id:ge.id,method:ge.method}))),ge=>(this.connection.console.info("Bulk registration failed."),Promise.reject(ge)))}}class T{constructor(){}attach(O){this._connection=O}get connection(){
if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(O){}fillServerCapabilities(O){}applyEdit(O){function U(z){return z&&!!z.edit}let ge=U(O)?O:{edit:O};return this.connection.sendRequest(t.ApplyWorkspaceEditRequest.type,ge)}}const $=(0,c.FileOperationsFeature)((0,s.WorkspaceFoldersFeature)((0,i.ConfigurationFeature)(T)));class j{constructor(){this._trace=t.Trace.Off}attach(O){this._connection=O}get connection(){if(!this._connection)
throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(O){}fillServerCapabilities(O){}set trace(O){this._trace=O}log(O,U){this._trace!==t.Trace.Off&&this.connection.sendNotification(t.LogTraceNotification.type,{message:O,verbose:this._trace===t.Trace.Verbose?U:void 0}).catch(()=>{})}}class A{constructor(){}attach(O){this._connection=O}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(O){}fillServerCapabilities(O){}logEvent(O){
this.connection.sendNotification(t.TelemetryEventNotification.type,O).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}}class P{constructor(){}attach(O){this._connection=O}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(O){}fillServerCapabilities(O){}attachWorkDoneProgress(O){return(0,r.attachWorkDone)(this.connection,O)}attachPartialResultProgress(O,U){return(0,r.attachPartialResult)(
this.connection,U)}}ct._LanguagesImpl=P;const L=(0,h.FoldingRangeFeature)((0,g.MonikerFeature)((0,w.DiagnosticFeature)((0,p.InlayHintFeature)((0,d.InlineValueFeature)((0,f.TypeHierarchyFeature)((0,l.LinkedEditingRangeFeature)((0,o.SemanticTokensFeature)((0,a.CallHierarchyFeature)(P)))))))));class Q{constructor(){}attach(O){this._connection=O}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(O){}fillServerCapabilities(O){}attachWorkDoneProgress(O){
return(0,r.attachWorkDone)(this.connection,O)}attachPartialResultProgress(O,U){return(0,r.attachPartialResult)(this.connection,U)}}ct._NotebooksImpl=Q;const H=(0,v.NotebookSyncFeature)(Q);function S(pe,O){return function(U){return O(pe(U))}}ct.combineConsoleFeatures=S;function re(pe,O){return function(U){return O(pe(U))}}ct.combineTelemetryFeatures=re;function ke(pe,O){return function(U){return O(pe(U))}}ct.combineTracerFeatures=ke;function je(pe,O){return function(U){return O(pe(U))}}ct.combineClientFeatures=
je;function M(pe,O){return function(U){return O(pe(U))}}ct.combineWindowFeatures=M;function V(pe,O){return function(U){return O(pe(U))}}ct.combineWorkspaceFeatures=V;function Le(pe,O){return function(U){return O(pe(U))}}ct.combineLanguagesFeatures=Le;function he(pe,O){return function(U){return O(pe(U))}}ct.combineNotebooksFeatures=he;function Ce(pe,O){function U(z,me,nt){return z&&me?nt(z,me):z||me}return{__brand:"features",console:U(pe.console,O.console,S),tracer:U(pe.tracer,O.tracer,ke),telemetry:U(
pe.telemetry,O.telemetry,re),client:U(pe.client,O.client,je),window:U(pe.window,O.window,M),workspace:U(pe.workspace,O.workspace,V),languages:U(pe.languages,O.languages,Le),notebooks:U(pe.notebooks,O.notebooks,he)}}ct.combineFeatures=Ce;function Be(pe,O,U){const ge=U&&U.console?new(U.console(_)):new _,z=pe(ge);ge.rawAttach(z);const me=U&&U.tracer?new(U.tracer(j)):new j,nt=U&&U.telemetry?new(U.telemetry(A)):new A,mt=U&&U.client?new(U.client(B)):new B,de=U&&U.window?new(U.window(Z)):new Z,Ue=U&&U.
workspace?new(U.workspace($)):new $,se=U&&U.languages?new(U.languages(L)):new L,_e=U&&U.notebooks?new(U.notebooks(H)):new H,Xe=[ge,me,nt,mt,de,Ue,se,_e];function xt(X){return X instanceof Promise?X:e.thenable(X)?new Promise((Y,ve)=>{X.then(yn=>Y(yn),yn=>ve(yn))}):Promise.resolve(X)}let dt,ln,gn,In={listen:()=>z.listen(),sendRequest:(X,...Y)=>z.sendRequest(e.string(X)?X:X.method,...Y),onRequest:(X,Y)=>z.onRequest(X,Y),sendNotification:(X,Y)=>{const ve=e.string(X)?X:X.method;return z.sendNotification(
ve,Y)},onNotification:(X,Y)=>z.onNotification(X,Y),onProgress:z.onProgress,sendProgress:z.sendProgress,onInitialize:X=>(ln=X,{dispose:()=>{ln=void 0}}),onInitialized:X=>z.onNotification(t.InitializedNotification.type,X),onShutdown:X=>(dt=X,{dispose:()=>{dt=void 0}}),onExit:X=>(gn=X,{dispose:()=>{gn=void 0}}),get console(){return ge},get telemetry(){return nt},get tracer(){return me},get client(){return mt},get window(){return de},get workspace(){return Ue},get languages(){return se},get notebooks(){
return _e},onDidChangeConfiguration:X=>z.onNotification(t.DidChangeConfigurationNotification.type,X),onDidChangeWatchedFiles:X=>z.onNotification(t.DidChangeWatchedFilesNotification.type,X),__textDocumentSync:void 0,onDidOpenTextDocument:X=>z.onNotification(t.DidOpenTextDocumentNotification.type,X),onDidChangeTextDocument:X=>z.onNotification(t.DidChangeTextDocumentNotification.type,X),onDidCloseTextDocument:X=>z.onNotification(t.DidCloseTextDocumentNotification.type,X),onWillSaveTextDocument:X=>z.
onNotification(t.WillSaveTextDocumentNotification.type,X),onWillSaveTextDocumentWaitUntil:X=>z.onRequest(t.WillSaveTextDocumentWaitUntilRequest.type,X),onDidSaveTextDocument:X=>z.onNotification(t.DidSaveTextDocumentNotification.type,X),sendDiagnostics:X=>z.sendNotification(t.PublishDiagnosticsNotification.type,X),onHover:X=>z.onRequest(t.HoverRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),void 0)),onCompletion:X=>z.onRequest(t.CompletionRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),
(0,r.attachPartialResult)(z,Y))),onCompletionResolve:X=>z.onRequest(t.CompletionResolveRequest.type,X),onSignatureHelp:X=>z.onRequest(t.SignatureHelpRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),void 0)),onDeclaration:X=>z.onRequest(t.DeclarationRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onDefinition:X=>z.onRequest(t.DefinitionRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onTypeDefinition:X=>z.onRequest(
t.TypeDefinitionRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onImplementation:X=>z.onRequest(t.ImplementationRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onReferences:X=>z.onRequest(t.ReferencesRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onDocumentHighlight:X=>z.onRequest(t.DocumentHighlightRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,
Y))),onDocumentSymbol:X=>z.onRequest(t.DocumentSymbolRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onWorkspaceSymbol:X=>z.onRequest(t.WorkspaceSymbolRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onWorkspaceSymbolResolve:X=>z.onRequest(t.WorkspaceSymbolResolveRequest.type,X),onCodeAction:X=>z.onRequest(t.CodeActionRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onCodeActionResolve:X=>z.
onRequest(t.CodeActionResolveRequest.type,(Y,ve)=>X(Y,ve)),onCodeLens:X=>z.onRequest(t.CodeLensRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onCodeLensResolve:X=>z.onRequest(t.CodeLensResolveRequest.type,(Y,ve)=>X(Y,ve)),onDocumentFormatting:X=>z.onRequest(t.DocumentFormattingRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),void 0)),onDocumentRangeFormatting:X=>z.onRequest(t.DocumentRangeFormattingRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),
void 0)),onDocumentOnTypeFormatting:X=>z.onRequest(t.DocumentOnTypeFormattingRequest.type,(Y,ve)=>X(Y,ve)),onRenameRequest:X=>z.onRequest(t.RenameRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),void 0)),onPrepareRename:X=>z.onRequest(t.PrepareRenameRequest.type,(Y,ve)=>X(Y,ve)),onDocumentLinks:X=>z.onRequest(t.DocumentLinkRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onDocumentLinkResolve:X=>z.onRequest(t.DocumentLinkResolveRequest.type,(Y,ve)=>X(Y,
ve)),onDocumentColor:X=>z.onRequest(t.DocumentColorRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onColorPresentation:X=>z.onRequest(t.ColorPresentationRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onFoldingRanges:X=>z.onRequest(t.FoldingRangeRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),(0,r.attachPartialResult)(z,Y))),onSelectionRanges:X=>z.onRequest(t.SelectionRangeRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(
z,Y),(0,r.attachPartialResult)(z,Y))),onExecuteCommand:X=>z.onRequest(t.ExecuteCommandRequest.type,(Y,ve)=>X(Y,ve,(0,r.attachWorkDone)(z,Y),void 0)),dispose:()=>z.dispose()};for(let X of Xe)X.attach(In);return z.onRequest(t.InitializeRequest.type,X=>{O.initialize(X),e.string(X.trace)&&(me.trace=t.Trace.fromString(X.trace));for(let Y of Xe)Y.initialize(X.capabilities);if(ln){let Y=ln(X,new t.CancellationTokenSource().token,(0,r.attachWorkDone)(z,X),void 0);return xt(Y).then(ve=>{if(ve instanceof t.
ResponseError)return ve;let yn=ve;yn||(yn={capabilities:{}});let dn=yn.capabilities;dn||(dn={},yn.capabilities=dn),dn.textDocumentSync===void 0||dn.textDocumentSync===null?dn.textDocumentSync=e.number(In.__textDocumentSync)?In.__textDocumentSync:t.TextDocumentSyncKind.None:!e.number(dn.textDocumentSync)&&!e.number(dn.textDocumentSync.change)&&(dn.textDocumentSync.change=e.number(In.__textDocumentSync)?In.__textDocumentSync:t.TextDocumentSyncKind.None);for(let ci of Xe)ci.fillServerCapabilities(dn);
return yn})}else{let Y={capabilities:{textDocumentSync:t.TextDocumentSyncKind.None}};for(let ve of Xe)ve.fillServerCapabilities(Y.capabilities);return Y}}),z.onRequest(t.ShutdownRequest.type,()=>{if(O.shutdownReceived=!0,dt)return dt(new t.CancellationTokenSource().token)}),z.onNotification(t.ExitNotification.type,()=>{try{gn&&gn()}finally{O.shutdownReceived?O.exit(0):O.exit(1)}}),z.onNotification(t.SetTraceNotification.type,X=>{me.trace=t.Trace.fromString(X.value)}),In}return ct.createConnection=
Be,ct}var Hn={},HS;function V8(){if(HS)return Hn;HS=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.resolveModulePath=Hn.FileSystem=Hn.resolveGlobalYarnPath=Hn.resolveGlobalNodePath=Hn.resolve=Hn.uriToFilePath=void 0;const t=l1,e=bs,n=Pu,r=d1;function i(f){let d=t.parse(f);if(d.protocol!=="file:"||!d.path)return;let h=d.path.split("/");for(var p=0,w=h.length;p<w;p++)h[p]=decodeURIComponent(h[p]);if(process.platform==="win32"&&h.length>1){let v=h[0],g=h[1];v.length===0&&g.length>1&&g[1]===
":"&&h.shift()}return e.normalize(h.join("/"))}Hn.uriToFilePath=i;function s(){return process.platform==="win32"}function a(f,d,h,p){const w="NODE_PATH",v=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise((g,b)=>{let k=process.env,_=Object.create(null);Object.keys(k).forEach(I=>_[I]=k[I]),
d&&n.existsSync(d)&&(_[w]?_[w]=d+e.delimiter+_[w]:_[w]=d,p&&p(`NODE_PATH value is: ${_[w]}`)),_.ELECTRON_RUN_AS_NODE="1";try{let I=(0,r.fork)("",[],{cwd:h,env:_,execArgv:["-e",v]});if(I.pid===void 0){b(new Error(`Starting process to resolve node module  ${f} failed`));return}I.on("error",J=>{b(J)}),I.on("message",J=>{J.c==="r"&&(I.send({c:"e"}),J.s?g(J.r):b(new Error(`Failed to resolve module: ${f}`)))});let Z={c:"rs",a:f};I.send(Z)}catch(I){b(I)}})}Hn.resolve=a;function o(f){let d="npm";const h=Object.
create(null);Object.keys(process.env).forEach(v=>h[v]=process.env[v]),h.NO_UPDATE_NOTIFIER="true";const p={encoding:"utf8",env:h};s()&&(d="npm.cmd",p.shell=!0);let w=()=>{};try{process.on("SIGPIPE",w);let v=(0,r.spawnSync)(d,["config","get","prefix"],p).stdout;if(!v){f&&f("'npm config get prefix' didn't return a value.");return}let g=v.trim();return f&&f(`'npm config get prefix' value is: ${g}`),g.length>0?s()?e.join(g,"node_modules"):e.join(g,"lib","node_modules"):void 0}catch{return}finally{process.
removeListener("SIGPIPE",w)}}Hn.resolveGlobalNodePath=o;function u(f){let d="yarn",h={encoding:"utf8"};s()&&(d="yarn.cmd",h.shell=!0);let p=()=>{};try{process.on("SIGPIPE",p);let w=(0,r.spawnSync)(d,["global","dir","--json"],h),v=w.stdout;if(!v){f&&(f("'yarn global dir' didn't return a value."),w.stderr&&f(w.stderr));return}let g=v.trim().split(/\r?\n/);for(let b of g)try{let k=JSON.parse(b);if(k.type==="log")return e.join(k.data,"node_modules")}catch{}return}catch{return}finally{process.removeListener(
"SIGPIPE",p)}}Hn.resolveGlobalYarnPath=u;var c;(function(f){let d;function h(){return d!==void 0||(process.platform==="win32"?d=!1:d=!n.existsSync(__filename.toUpperCase())||!n.existsSync(__filename.toLowerCase())),d}f.isCaseSensitive=h;function p(w,v){return h()?e.normalize(v).indexOf(e.normalize(w))===0:e.normalize(v).toLowerCase().indexOf(e.normalize(w).toLowerCase())===0}f.isParent=p})(c||(Hn.FileSystem=c={}));function l(f,d,h,p){return h?(e.isAbsolute(h)||(h=e.join(f,h)),a(d,h,h,p).then(w=>c.
isParent(h,w)?w:Promise.reject(new Error(`Failed to load ${d} from node path location.`))).then(void 0,w=>a(d,o(p),f,p))):a(d,o(p),f,p)}return Hn.resolveModulePath=l,Hn}var sw,VS;function KS(){return VS||(VS=1,sw=Xt()),sw}var Ma={},Rl={},ZS;function K8(){if(ZS)return Rl;ZS=1,Object.defineProperty(Rl,"__esModule",{value:!0}),Rl.InlineCompletionFeature=void 0;const t=Xt(),e=n=>class extends n{get inlineCompletion(){return{on:r=>this.connection.onRequest(t.InlineCompletionRequest.type,(i,s)=>r(i,s,
this.attachWorkDoneProgress(i)))}}};return Rl.InlineCompletionFeature=e,Rl}var XS;function Z8(){return XS||(XS=1,function(t){var e=Ma&&Ma.__createBinding||(Object.create?function(u,c,l,f){f===void 0&&(f=l);var d=Object.getOwnPropertyDescriptor(c,l);(!d||("get"in d?!c.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return c[l]}}),Object.defineProperty(u,f,d)}:function(u,c,l,f){f===void 0&&(f=l),u[f]=c[l]}),n=Ma&&Ma.__exportStar||function(u,c){for(var l in u)l!=="default"&&
!Object.prototype.hasOwnProperty.call(c,l)&&e(c,u,l)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProposedFeatures=t.NotebookDocuments=t.TextDocuments=t.SemanticTokensBuilder=void 0;const r=AS();Object.defineProperty(t,"SemanticTokensBuilder",{enumerable:!0,get:function(){return r.SemanticTokensBuilder}});const i=K8();n(Xt(),t);const s=BS();Object.defineProperty(t,"TextDocuments",{enumerable:!0,get:function(){return s.TextDocuments}});const a=GS();Object.defineProperty(t,"NotebookDocument\
s",{enumerable:!0,get:function(){return a.NotebookDocuments}}),n(WS(),t);var o;(function(u){u.all={__brand:"features",languages:i.InlineCompletionFeature}})(o||(t.ProposedFeatures=o={}))}(Ma)),Ma}var YS;function JS(){return YS||(YS=1,function(t){var e=Sa&&Sa.__createBinding||(Object.create?function(g,b,k,_){_===void 0&&(_=k);var I=Object.getOwnPropertyDescriptor(b,k);(!I||("get"in I?!b.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return b[k]}}),Object.defineProperty(
g,_,I)}:function(g,b,k,_){_===void 0&&(_=k),g[_]=b[k]}),n=Sa&&Sa.__exportStar||function(g,b){for(var k in g)k!=="default"&&!Object.prototype.hasOwnProperty.call(b,k)&&e(b,g,k)};Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.Files=void 0;const r=i1,i=Yv(),s=WS(),a=V8(),o=KS();n(KS(),t),n(Z8(),t);var u;(function(g){g.uriToFilePath=a.uriToFilePath,g.resolveGlobalNodePath=a.resolveGlobalNodePath,g.resolveGlobalYarnPath=a.resolveGlobalYarnPath,g.resolve=a.resolve,g.resolveModulePath=
a.resolveModulePath})(u||(t.Files=u={}));function c(){}let l=!1,f;function d(){const g="--clientProcessId";function b(k){try{let _=parseInt(k);isNaN(_)||(f=setInterval(()=>{try{process.kill(_,0)}catch{process.exit(l?0:1)}},3e3))}catch{}}for(let k=2;k<process.argv.length;k++){let _=process.argv[k];if(_===g&&k+1<process.argv.length){b(process.argv[k+1]);return}else{let I=_.split("=");I[0]===g&&b(I[1])}}}d();const h={initialize:g=>{const b=g.processId;i.number(b)&&f===void 0&&setInterval(()=>{try{process.
kill(b,0)}catch{process.exit(l?0:1)}},3e3)},get shutdownReceived(){return l},set shutdownReceived(g){l=g},exit:g=>{process.exit(g)}};function p(g,b,k,_){let I,Z,J,ue;return g!==void 0&&g.__brand==="features"&&(I=g,g=b,b=k,k=_),o.ConnectionStrategy.is(g)||o.ConnectionOptions.is(g)?ue=g:(Z=g,J=b,ue=k),w(Z,J,ue,I)}t.createConnection=p;function w(g,b,k,_){let I=!1;if(!g&&!b&&process.argv.length>2){let ae,$e,B=process.argv.slice(2);for(let T=0;T<B.length;T++){let $=B[T];if($==="--node-ipc"){g=new o.IPCMessageReader(
process),b=new o.IPCMessageWriter(process);break}else if($==="--stdio"){I=!0,g=process.stdin,b=process.stdout;break}else if($==="--socket"){ae=parseInt(B[T+1]);break}else if($==="--pipe"){$e=B[T+1];break}else{var Z=$.split("=");if(Z[0]==="--socket"){ae=parseInt(Z[1]);break}else if(Z[0]==="--pipe"){$e=Z[1];break}}}if(ae){let T=(0,o.createServerSocketTransport)(ae);g=T[0],b=T[1]}else if($e){let T=(0,o.createServerPipeTransport)($e);g=T[0],b=T[1]}}var J="Use arguments of createConnection or set com\
mand line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!g)throw new Error("Connection input stream is not set. "+J);if(!b)throw new Error("Connection output stream is not set. "+J);if(i.func(g.read)&&i.func(g.on)){let ae=g;ae.on("end",()=>{process.exit(l?0:1)}),ae.on("close",()=>{process.exit(l?0:1)})}const ue=ae=>{const $e=(0,o.createProtocolConnection)(g,b,ae,k);return I&&v(ae),$e};return(0,s.createConnection)(ue,h,_)}function v(g){function b(_){return _.map(I=>typeof I=="str\
ing"?I:(0,r.inspect)(I)).join(" ")}const k=new Map;console.assert=function(I,...Z){if(!I)if(Z.length===0)g.error("Assertion failed");else{const[J,...ue]=Z;g.error(`Assertion failed: ${J} ${b(ue)}`)}},console.count=function(I="default"){const Z=String(I);let J=k.get(Z)??0;J+=1,k.set(Z,J),g.log(`${Z}: ${Z}`)},console.countReset=function(I){I===void 0?k.clear():k.delete(String(I))},console.debug=function(...I){g.log(b(I))},console.dir=function(I,Z){g.log((0,r.inspect)(I,Z))},console.log=function(...I){
g.log(b(I))},console.error=function(...I){g.error(b(I))},console.trace=function(...I){const Z=new Error().stack.replace(/(.+\n){2}/,"");let J="Trace";I.length!==0&&(J+=`: ${b(I)}`),g.log(`${J}
${Z}`)},console.warn=function(...I){g.warn(b(I))}}}(Sa)),Sa}var Ee=JS();function QS(t,e){const n={stacks:t,tokens:e};return X8(n),n.stacks.flat().forEach(i=>{i.property=void 0}),tC(n.stacks).map(i=>i[i.length-1])}function aw(t){const{next:e,cardinalities:n,visited:r,plus:i}=t,s=[],a=e.feature;if(r.has(a))return[];Rs(a)||r.add(a);let o,u=a;for(;u.$container;)if(Rs(u.$container)){o=u.$container;break}else if(Yg(u.$container))u=u.$container;else break;if(nk(u.cardinality)){const c=Uo({next:{feature:u,
type:e.type},cardinalities:n,visited:r,plus:i});for(const l of c)i.add(l.feature);s.push(...c)}if(o){const c=o.elements.indexOf(u);c!==void 0&&c<o.elements.length-1&&s.push(...eC({feature:o,type:e.type},c+1,n,r,i)),s.every(l=>$o(l.feature.cardinality,l.feature)||$o(n.get(l.feature))||i.has(l.feature))&&s.push(...aw({next:{feature:o,type:e.type},cardinalities:n,visited:r,plus:i}))}return s}function ow(t){return Mt(t)&&(t={feature:t}),Uo({next:t,cardinalities:new Map,visited:new Set,plus:new Set})}
function Uo(t){var e,n,r;const{next:i,cardinalities:s,visited:a,plus:o}=t;if(i===void 0)return[];const{feature:u,type:c}=i;if(Rs(u))return a.has(u)?[]:(a.add(u),eC(i,0,s,a,o).map(l=>Sp(l,u.cardinality,s)));if(ny(u)||ry(u))return u.elements.flatMap(l=>Uo({next:{feature:l,type:c,property:i.property},cardinalities:s,visited:a,plus:o})).map(l=>Sp(l,u.cardinality,s));if(hi(u)){const l={feature:u.terminal,type:c,property:(e=i.property)!==null&&e!==void 0?e:u.feature};return Uo({next:l,cardinalities:s,
visited:a,plus:o}).map(f=>Sp(f,u.cardinality,s))}else{if(ca(u))return aw({next:{feature:u,type:Ec(u),property:(n=i.property)!==null&&n!==void 0?n:u.feature},cardinalities:s,visited:a,plus:o});if(Pi(u)&&Sn(u.rule.ref)){const l=u.rule.ref,f={feature:l.definition,type:l.fragment||l.dataType?void 0:(r=la(l))!==null&&r!==void 0?r:l.name,property:i.property};return Uo({next:f,cardinalities:s,visited:a,plus:o}).map(d=>Sp(d,u.cardinality,s))}else return[i]}}function Sp(t,e,n){return n.set(t.feature,e),t}
function eC(t,e,n,r,i){var s;const a=[];let o;for(;e<t.feature.elements.length&&(o={feature:t.feature.elements[e++],type:t.type},a.push(...Uo({next:o,cardinalities:n,visited:r,plus:i})),!!$o((s=o.feature.cardinality)!==null&&s!==void 0?s:n.get(o.feature),o.feature)););return a}function X8(t){for(const e of t.tokens){const n=tC(t.stacks,e);t.stacks=n}}function tC(t,e){const n=[];for(const r of t)n.push(...Y8(r,e));return n}function Y8(t,e){const n=new Map,r=new Set(t.map(s=>s.feature).filter(J8)),
i=[];for(;t.length>0;){const s=t.pop(),a=aw({next:s,cardinalities:n,plus:r,visited:new Set}).filter(o=>e?uw(o.feature,e):!0);for(const o of a)i.push([...t,o]);if(!a.every(o=>$o(o.feature.cardinality,o.feature)||$o(n.get(o.feature))))break}return i}function J8(t){if(t.cardinality==="+")return!0;const e=cr(t,hi);return!!(e&&e.cardinality==="+")}function uw(t,e){if(pi(t))return t.value===e.image;if(Pi(t))return Q8(t.rule.ref,e);if(sc(t)){const n=fy(t);if(n)return uw(n,e)}return!1}function Q8(t,e){return Sn(
t)?ow(t.definition).some(r=>uw(r.feature,e)):xi(t)?kc(t).test(e.image):!1}function ez(t){const e=Array.from(new Set(t.flatMap(r=>{var i;return(i=r?.triggerCharacters)!==null&&i!==void 0?i:[]}))),n=Array.from(new Set(t.flatMap(r=>{var i;return(i=r?.allCommitCharacters)!==null&&i!==void 0?i:[]})));return{triggerCharacters:e.length>0?e:void 0,allCommitCharacters:n.length>0?n:void 0}}class nC{constructor(e){this.scopeProvider=e.references.ScopeProvider,this.grammar=e.Grammar,this.completionParser=e.
parser.CompletionParser,this.nameProvider=e.references.NameProvider,this.lexer=e.parser.Lexer,this.nodeKindProvider=e.shared.lsp.NodeKindProvider,this.fuzzyMatcher=e.shared.lsp.FuzzyMatcher,this.grammarConfig=e.parser.GrammarConfig,this.astReflection=e.shared.AstReflection,this.documentationProvider=e.documentation.DocumentationProvider}async getCompletion(e,n,r){const i=[],s=this.buildContexts(e,n.position),a=(c,l)=>{const f=this.fillCompletionItem(c,l);f&&i.push(f)},o=c=>pi(c.feature)?c.feature.
value:c.feature,u=[];for(const c of s)if(await Promise.all(rt(c.features).distinct(o).exclude(u).map(l=>this.completionFor(c,l,a))),u.push(...c.features),!this.continueCompletion(i))break;return Ee.CompletionList.create(this.deduplicateItems(i),!0)}deduplicateItems(e){return rt(e).distinct(n=>`${n.kind}_${n.label}_${n.detail}`).toArray()}findFeaturesAt(e,n){const r=e.getText({start:Ee.Position.create(0,0),end:e.positionAt(n)}),i=this.completionParser.parse(r),s=i.tokens;if(i.tokenIndex===0){const u=vh(
this.grammar),c=ow({feature:u.definition,type:la(u)});return s.length>0?(s.shift(),QS(c.map(l=>[l]),s)):c}const a=[...s].splice(i.tokenIndex);return QS([i.elementStack.map(u=>({feature:u}))],a)}*buildContexts(e,n){var r,i;const s=e.parseResult.value.$cstNode;if(!s)return;const a=e.textDocument,o=a.getText(),u=a.offsetAt(n),c={document:e,textDocument:a,offset:u,position:n},l=this.findDataTypeRuleStart(s,u);if(l){const[b,k]=l,_=(r=Kg(s,b))===null||r===void 0?void 0:r.astNode;yield Object.assign(Object.
assign({},c),{node:_,tokenOffset:b,tokenEndOffset:k,features:this.findFeaturesAt(a,b)})}const{nextTokenStart:f,nextTokenEnd:d,previousTokenStart:h,previousTokenEnd:p}=this.backtrackToAnyToken(o,u);let w=f;u<=f&&h!==void 0&&(w=h);const v=(i=Kg(s,w))===null||i===void 0?void 0:i.astNode;let g=!0;if(h!==void 0&&p!==void 0&&p===u&&(yield Object.assign(Object.assign({},c),{node:v,tokenOffset:h,tokenEndOffset:p,features:this.findFeaturesAt(a,h)}),g=this.performNextTokenCompletion(e,o.substring(h,p),h,p),
g&&(yield Object.assign(Object.assign({},c),{node:v,tokenOffset:p,tokenEndOffset:p,features:this.findFeaturesAt(a,p)}))),v)g&&(yield Object.assign(Object.assign({},c),{node:v,tokenOffset:f,tokenEndOffset:d,features:this.findFeaturesAt(a,f)}));else{const b=vh(this.grammar);if(!b)throw new Error("Missing entry parser rule");yield Object.assign(Object.assign({},c),{tokenOffset:f,tokenEndOffset:d,features:ow(b.definition)})}}performNextTokenCompletion(e,n,r,i){return new RegExp("\\P{L}$","u").test(n)}findDataTypeRuleStart(e,n){
var r,i;let s=ua(e,n,this.grammarConfig.nameRegexp),a=!!(!((r=cr(s?.grammarSource,Sn))===null||r===void 0)&&r.dataType);if(a){for(;a;)s=s?.container,a=!!(!((i=cr(s?.grammarSource,Sn))===null||i===void 0)&&i.dataType);if(s)return[s.offset,s.end]}}continueCompletion(e){return e.length===0}backtrackToAnyToken(e,n){const r=this.lexer.tokenize(e).tokens;if(r.length===0)return{nextTokenStart:n,nextTokenEnd:n};let i;for(const s of r){if(s.startOffset>=n)return{nextTokenStart:n,nextTokenEnd:n,previousTokenStart:i?
i.startOffset:void 0,previousTokenEnd:i?i.endOffset+1:void 0};if(s.endOffset>=n)return{nextTokenStart:s.startOffset,nextTokenEnd:s.endOffset+1,previousTokenStart:i?i.startOffset:void 0,previousTokenEnd:i?i.endOffset+1:void 0};i=s}return{nextTokenStart:n,nextTokenEnd:n,previousTokenStart:i?i.startOffset:void 0,previousTokenEnd:i?i.endOffset+1:void 0}}completionFor(e,n,r){if(pi(n.feature))return this.completionForKeyword(e,n.feature,r);if(sc(n.feature)&&e.node)return this.completionForCrossReference(
e,n,r)}completionForCrossReference(e,n,r){const i=cr(n.feature,hi);let s=e.node;if(i&&s){n.type&&(s={$type:n.type,$container:s,$containerProperty:n.property},ay(this.astReflection,s));const a={reference:{$refText:""},container:s,property:i.feature};try{for(const o of this.getReferenceCandidates(a,e))r(e,this.createReferenceCompletionItem(o))}catch(o){console.error(o)}}}getReferenceCandidates(e,n){return this.scopeProvider.getScope(e).getAllElements()}createReferenceCompletionItem(e){const n=this.
nodeKindProvider.getCompletionItemKind(e),r=this.getReferenceDocumentation(e);return{nodeDescription:e,kind:n,documentation:r,detail:e.type,sortText:"0"}}getReferenceDocumentation(e){if(!e.node)return;const n=this.documentationProvider.getDocumentation(e.node);if(n)return{kind:"markdown",value:n}}completionForKeyword(e,n,r){this.filterKeyword(e,n)&&r(e,{label:n.value,kind:this.getKeywordCompletionItemKind(n),detail:"Keyword",sortText:"1"})}getKeywordCompletionItemKind(e){return Ee.CompletionItemKind.
Keyword}filterKeyword(e,n){return new RegExp("\\p{L}","u").test(n.value)}fillCompletionItem(e,n){var r,i;let s;if(typeof n.label=="string")s=n.label;else if("node"in n){const c=this.nameProvider.getName(n.node);if(!c)return;s=c}else if("nodeDescription"in n)s=n.nodeDescription.name;else return;let a;typeof((r=n.textEdit)===null||r===void 0?void 0:r.newText)=="string"?a=n.textEdit.newText:typeof n.insertText=="string"?a=n.insertText:a=s;const o=(i=n.textEdit)!==null&&i!==void 0?i:this.buildCompletionTextEdit(
e,s,a);return o?{additionalTextEdits:n.additionalTextEdits,command:n.command,commitCharacters:n.commitCharacters,data:n.data,detail:n.detail,documentation:n.documentation,filterText:n.filterText,insertText:n.insertText,insertTextFormat:n.insertTextFormat,insertTextMode:n.insertTextMode,kind:n.kind,labelDetails:n.labelDetails,preselect:n.preselect,sortText:n.sortText,tags:n.tags,textEditText:n.textEditText,textEdit:o,label:s}:void 0}buildCompletionTextEdit(e,n,r){const s=e.textDocument.getText().
substring(e.tokenOffset,e.offset);if(this.fuzzyMatcher.match(s,n)){const a=e.textDocument.positionAt(e.tokenOffset),o=e.position;return{newText:r,range:{start:a,end:o}}}else return}}class tz{constructor(e){this.nameProvider=e.references.NameProvider,this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}getDefinition(e,n,r){const i=e.parseResult.value;if(i.$cstNode){const s=i.$cstNode,a=ua(s,e.textDocument.offsetAt(n.position),this.grammarConfig.nameRegexp);if(a)return this.
collectLocationLinks(a,n)}}collectLocationLinks(e,n){var r;const i=this.findLink(e);if(i)return[Ee.LocationLink.create(i.targetDocument.textDocument.uri,((r=i.target.astNode.$cstNode)!==null&&r!==void 0?r:i.target).range,i.target.range,i.source.range)]}findLink(e){const n=this.references.findDeclarationNode(e);if(n?.astNode){const r=vt(n.astNode);if(n&&r)return{source:e,target:n,targetDocument:r}}}}class rC{constructor(e){this.references=e.references.References,this.nameProvider=e.references.NameProvider,
this.grammarConfig=e.parser.GrammarConfig}getDocumentHighlight(e,n,r){const i=e.parseResult.value.$cstNode;if(!i)return;const s=ua(i,e.textDocument.offsetAt(n.position),this.grammarConfig.nameRegexp);if(!s)return;const a=this.references.findDeclaration(s);if(a){const o=Tt.equals(vt(a).uri,e.uri),u={documentUri:e.uri,includeDeclaration:o};return this.references.findReferences(a,u).map(l=>this.createDocumentHighlight(l)).toArray()}}createDocumentHighlight(e){return Ee.DocumentHighlight.create(e.segment.
range)}}class nz{constructor(e){this.nameProvider=e.references.NameProvider,this.nodeKindProvider=e.shared.lsp.NodeKindProvider}getSymbols(e,n,r){return this.getSymbol(e,e.parseResult.value)}getSymbol(e,n){const r=n.$cstNode,i=this.nameProvider.getNameNode(n);if(i&&r){const s=this.nameProvider.getName(n);return[{kind:this.nodeKindProvider.getSymbolKind(n),name:s||i.text,range:r.range,selectionRange:i.range,children:this.getChildSymbols(e,n)}]}else return this.getChildSymbols(e,n)||[]}getChildSymbols(e,n){
const r=[];for(const i of vc(n)){const s=this.getSymbol(e,i);r.push(...s)}if(r.length>0)return r}}class rz{constructor(e){this.workspaceManager=e.workspace.WorkspaceManager,this.documentBuilder=e.workspace.DocumentBuilder,this.workspaceLock=e.workspace.WorkspaceLock,this.serviceRegistry=e.ServiceRegistry;let n=!1;e.lsp.LanguageServer.onInitialize(r=>{var i,s;n=!!(!((s=(i=r.capabilities.workspace)===null||i===void 0?void 0:i.didChangeWatchedFiles)===null||s===void 0)&&s.dynamicRegistration)}),e.lsp.
LanguageServer.onInitialized(r=>{n&&this.registerFileWatcher(e)})}registerFileWatcher(e){const n=rt(e.ServiceRegistry.all).flatMap(r=>r.LanguageMetaData.fileExtensions).map(r=>r.startsWith(".")?r.substring(1):r).distinct().toArray();if(n.length>0){const r=e.lsp.Connection,i={watchers:[{globPattern:n.length===1?`**/*.${n[0]}`:`**/*.{${n.join(",")}}`}]};r?.client.register(Ee.DidChangeWatchedFilesNotification.type,i)}}fireDocumentUpdate(e,n){e=e.filter(r=>this.serviceRegistry.hasServices(r)),this.workspaceManager.
ready.then(()=>{this.workspaceLock.write(r=>this.documentBuilder.update(e,n,r))}).catch(r=>{console.error("Workspace initialization failed. Could not perform document update.",r)})}didChangeContent(e){this.fireDocumentUpdate([_t.parse(e.document.uri)],[])}didChangeWatchedFiles(e){const n=rt(e.changes).filter(i=>i.type!==Ee.FileChangeType.Deleted).distinct(i=>i.uri).map(i=>_t.parse(i.uri)).toArray(),r=rt(e.changes).filter(i=>i.type===Ee.FileChangeType.Deleted).distinct(i=>i.uri).map(i=>_t.parse(i.
uri)).toArray();this.fireDocumentUpdate(n,r)}}class iz{constructor(e){this.commentNames=e.parser.GrammarConfig.multilineCommentRules}getFoldingRanges(e,n,r){const i=[],s=a=>i.push(a);return this.collectFolding(e,s),i}collectFolding(e,n){var r;const i=(r=e.parseResult)===null||r===void 0?void 0:r.value;if(i){if(this.shouldProcessContent(i)){const s=gi(i).iterator();let a;do if(a=s.next(),!a.done){const o=a.value;this.shouldProcess(o)&&this.collectObjectFolding(e,o,n),this.shouldProcessContent(o)||
s.prune()}while(!a.done)}this.collectCommentFolding(e,i,n)}}shouldProcess(e){return!0}shouldProcessContent(e){return!0}collectObjectFolding(e,n,r){const i=n.$cstNode;if(i){const s=this.toFoldingRange(e,i);s&&r(s)}}collectCommentFolding(e,n,r){const i=n.$cstNode;if(i){for(const s of gO(i))if(this.commentNames.includes(s.tokenType.name)){const a=this.toFoldingRange(e,s,Ee.FoldingRangeKind.Comment);a&&r(a)}}}toFoldingRange(e,n,r){const i=n.range,s=i.start;let a=i.end;if(!(a.line-s.line<2))return this.
includeLastFoldingLine(n,r)||(a=e.textDocument.positionAt(e.textDocument.offsetAt({line:a.line,character:0})-1)),Ee.FoldingRange.create(s.line,a.line,s.character,a.character,r)}includeLastFoldingLine(e,n){if(n===Ee.FoldingRangeKind.Comment)return!1;const r=e.text,i=r.charAt(r.length-1);return!(i==="}"||i===")"||i==="]")}}class sz{match(e,n){if(e.length===0)return!0;let r=!1,i,s=0;const a=n.length;for(let o=0;o<a;o++){const u=n.charCodeAt(o),c=e.charCodeAt(s);if((u===c||this.toUpperCharCode(u)===
this.toUpperCharCode(c))&&(r||(r=i===void 0||this.isWordTransition(i,u)),r&&s++,s===e.length))return!0;i=u}return!1}isWordTransition(e,n){return iC<=e&&e<=sC&&az<=n&&n<=oz||e===aC&&n!==aC}toUpperCharCode(e){return iC<=e&&e<=sC?e-32:e}}const iC=97,sC=122,az=65,oz=90,aC=95;class oC{constructor(e){this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}getHoverContent(e,n){var r,i;const s=(i=(r=e.parseResult)===null||r===void 0?void 0:r.value)===null||i===void 0?void 0:i.$cstNode;
if(s){const a=e.textDocument.offsetAt(n.position),o=ua(s,a,this.grammarConfig.nameRegexp);if(o&&o.offset+o.length>a){const u=this.references.findDeclaration(o);if(u)return this.getAstNodeHoverContent(u)}}}}class uz extends oC{constructor(e){super(e),this.documentationProvider=e.documentation.DocumentationProvider}getAstNodeHoverContent(e){const n=this.documentationProvider.getDocumentation(e);if(n)return{contents:{kind:"markdown",value:n}}}}var Cp=Xt();const cz={[Ee.SemanticTokenTypes.class]:0,[Ee.
SemanticTokenTypes.comment]:1,[Ee.SemanticTokenTypes.enum]:2,[Ee.SemanticTokenTypes.enumMember]:3,[Ee.SemanticTokenTypes.event]:4,[Ee.SemanticTokenTypes.function]:5,[Ee.SemanticTokenTypes.interface]:6,[Ee.SemanticTokenTypes.keyword]:7,[Ee.SemanticTokenTypes.macro]:8,[Ee.SemanticTokenTypes.method]:9,[Ee.SemanticTokenTypes.modifier]:10,[Ee.SemanticTokenTypes.namespace]:11,[Ee.SemanticTokenTypes.number]:12,[Ee.SemanticTokenTypes.operator]:13,[Ee.SemanticTokenTypes.parameter]:14,[Ee.SemanticTokenTypes.
property]:15,[Ee.SemanticTokenTypes.regexp]:16,[Ee.SemanticTokenTypes.string]:17,[Ee.SemanticTokenTypes.struct]:18,[Ee.SemanticTokenTypes.type]:19,[Ee.SemanticTokenTypes.typeParameter]:20,[Ee.SemanticTokenTypes.variable]:21,[Ee.SemanticTokenTypes.decorator]:22},lz={[Ee.SemanticTokenModifiers.abstract]:1,[Ee.SemanticTokenModifiers.async]:2,[Ee.SemanticTokenModifiers.declaration]:4,[Ee.SemanticTokenModifiers.defaultLibrary]:8,[Ee.SemanticTokenModifiers.definition]:16,[Ee.SemanticTokenModifiers.deprecated]:32,
[Ee.SemanticTokenModifiers.documentation]:64,[Ee.SemanticTokenModifiers.modification]:128,[Ee.SemanticTokenModifiers.readonly]:256,[Ee.SemanticTokenModifiers.static]:512};function dz(t){const e=[],n=[];let r=!0,i=!0,s=!0;for(const a of t)a&&(a.legend.tokenTypes.forEach((o,u)=>{const c=e[u];if(c&&c!==o)throw new Error(`Cannot merge '${c}' and '${o}' token types. They use the same index ${u}.`);e[u]=o}),a.legend.tokenModifiers.forEach((o,u)=>{const c=n[u];if(c&&c!==o)throw new Error(`Cannot merge \
'${c}' and '${o}' token modifier. They use the same index ${u}.`);n[u]=o}),a.full?typeof a.full=="object"&&!a.full.delta&&(i=!1):r=!1,a.range||(s=!1));return{legend:{tokenTypes:e,tokenModifiers:n},full:r&&{delta:i},range:s}}class fz extends Ee.SemanticTokensBuilder{constructor(){super(...arguments),this._tokens=[]}push(e,n,r,i,s){this._tokens.push({line:e,char:n,length:r,tokenType:i,tokenModifiers:s})}build(){return this.applyTokens(),super.build()}buildEdits(){return this.applyTokens(),super.buildEdits()}flush(){
this.previousResult(this.id)}applyTokens(){for(const e of this._tokens.sort(this.compareTokens))super.push(e.line,e.char,e.length,e.tokenType,e.tokenModifiers);this._tokens=[]}compareTokens(e,n){return e.line===n.line?e.char-n.char:e.line-n.line}}class hz{constructor(e){this.tokensBuilders=new Map,e.shared.workspace.TextDocuments.onDidClose(n=>{this.tokensBuilders.delete(n.document.uri)}),e.shared.lsp.LanguageServer.onInitialize(n=>{var r;this.initialize((r=n.capabilities.textDocument)===null||r===
void 0?void 0:r.semanticTokens)})}initialize(e){this.clientCapabilities=e}get tokenTypes(){return cz}get tokenModifiers(){return lz}get semanticTokensOptions(){return{legend:{tokenTypes:Object.keys(this.tokenTypes),tokenModifiers:Object.keys(this.tokenModifiers)},full:{delta:!0},range:!0}}async semanticHighlight(e,n,r=Dt.CancellationToken.None){return this.currentRange=void 0,this.currentDocument=e,this.currentTokensBuilder=this.getDocumentTokensBuilder(e),this.currentTokensBuilder.flush(),await this.
computeHighlighting(e,this.createAcceptor(),r),this.currentTokensBuilder.build()}async semanticHighlightRange(e,n,r=Dt.CancellationToken.None){return this.currentRange=n.range,this.currentDocument=e,this.currentTokensBuilder=this.getDocumentTokensBuilder(e),this.currentTokensBuilder.flush(),await this.computeHighlighting(e,this.createAcceptor(),r),this.currentTokensBuilder.build()}async semanticHighlightDelta(e,n,r=Dt.CancellationToken.None){return this.currentRange=void 0,this.currentDocument=e,
this.currentTokensBuilder=this.getDocumentTokensBuilder(e),this.currentTokensBuilder.previousResult(n.previousResultId),await this.computeHighlighting(e,this.createAcceptor(),r),this.currentTokensBuilder.buildEdits()}createAcceptor(){return n=>{"line"in n?this.highlightToken({range:{start:{line:n.line,character:n.char},end:{line:n.line,character:n.char+n.length}},type:n.type,modifier:n.modifier}):"range"in n?this.highlightToken(n):"keyword"in n?this.highlightKeyword(n):"property"in n?this.highlightProperty(
n):this.highlightNode({node:n.cst,type:n.type,modifier:n.modifier})}}getDocumentTokensBuilder(e){const n=this.tokensBuilders.get(e.uri.toString());if(n)return n;const r=new fz;return this.tokensBuilders.set(e.uri.toString(),r),r}async computeHighlighting(e,n,r){const i=e.parseResult.value,s=Ni(i,{range:this.currentRange}).iterator();let a;do if(a=s.next(),!a.done){await en(r);const o=a.value;this.highlightElement(o,n)==="prune"&&s.prune()}while(!a.done)}highlightToken(e){var n;const{range:r,type:i}=e;
let s=e.modifier;if(this.currentRange&&!PE(r,this.currentRange)||!this.currentDocument||!this.currentTokensBuilder)return;const a=this.tokenTypes[i];let o=0;if(s!==void 0){typeof s=="string"&&(s=[s]);for(const l of s){const f=this.tokenModifiers[l];o|=f}}const u=r.start.line,c=r.end.line;if(u===c){const l=r.start.character,f=r.end.character-l;this.currentTokensBuilder.push(u,l,f,a,o)}else if(!((n=this.clientCapabilities)===null||n===void 0)&&n.multilineTokenSupport){const l=r.start.character,f=this.
currentDocument.textDocument.offsetAt(r.start),d=this.currentDocument.textDocument.offsetAt(r.end);this.currentTokensBuilder.push(u,l,d-f,a,o)}else{const l=r.start;let f=this.currentDocument.textDocument.offsetAt({line:u+1,character:0});this.currentTokensBuilder.push(l.line,l.character,f-l.character-1,a,o);for(let d=u+1;d<c;d++){const h=f;f=this.currentDocument.textDocument.offsetAt({line:d+1,character:0}),this.currentTokensBuilder.push(d,0,f-h-1,a,o)}this.currentTokensBuilder.push(c,0,r.end.character,
a,o)}}highlightProperty(e){const n=[];if(typeof e.index=="number"){const s=Cn(e.node.$cstNode,e.property,e.index);s&&n.push(s)}else n.push(...Ro(e.node.$cstNode,e.property));const{type:r,modifier:i}=e;for(const s of n)this.highlightNode({node:s,type:r,modifier:i})}highlightKeyword(e){const{node:n,keyword:r,type:i,index:s,modifier:a}=e,o=[];if(typeof s=="number"){const u=bc(n.$cstNode,r,s);u&&o.push(u)}else o.push(...py(n.$cstNode,r));for(const u of o)this.highlightNode({node:u,type:i,modifier:a})}highlightNode(e){
const{node:n,type:r,modifier:i}=e,s=n.range;this.highlightToken({range:s,type:r,modifier:i})}}var uC;(function(t){function e(r,i,s){const a=new Map;Object.entries(i).forEach(([c,l])=>a.set(l,c));let o=0,u=0;return n(r.data,5).map(c=>{o+=c[0],c[0]!==0&&(u=0),u+=c[1];const l=c[2];return{offset:s.textDocument.offsetAt({line:o,character:u}),tokenType:a.get(c[3]),tokenModifiers:c[4],text:s.textDocument.getText({start:{line:o,character:u},end:{line:o,character:u+l}})}})}t.decode=e;function n(r,i){const s=[];
for(let a=0;a<r.length;a+=i){const o=r.slice(a,a+i);s.push(o)}return s}})(uC||(uC={}));function pz(t){const e=[],n=[];t.forEach(i=>{i?.triggerCharacters&&e.push(...i.triggerCharacters),i?.retriggerCharacters&&n.push(...i.retriggerCharacters)});const r={triggerCharacters:e.length>0?Array.from(new Set(e)).sort():void 0,retriggerCharacters:n.length>0?Array.from(new Set(n)).sort():void 0};return r.triggerCharacters?r:void 0}class mz{constructor(e){this.onInitializeEmitter=new Cp.Emitter,this.onInitializedEmitter=
new Cp.Emitter,this.services=e}get onInitialize(){return this.onInitializeEmitter.event}get onInitialized(){return this.onInitializedEmitter.event}async initialize(e){return this.eagerLoadServices(),this.fireInitializeOnDefaultServices(e),this.onInitializeEmitter.fire(e),this.onInitializeEmitter.dispose(),this.buildInitializeResult(e)}eagerLoadServices(){Wv(this.services),this.services.ServiceRegistry.all.forEach(e=>Wv(e))}hasService(e){return this.services.ServiceRegistry.all.some(r=>e(r)!==void 0)}buildInitializeResult(e){
var n,r,i,s;const a=this.services.lsp.DocumentUpdateHandler,o=(n=this.services.lsp.FileOperationHandler)===null||n===void 0?void 0:n.fileOperationOptions,u=this.services.ServiceRegistry.all,c=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.Formatter}),l=u.map(H=>{var S,re;return(re=(S=H.lsp)===null||S===void 0?void 0:S.Formatter)===null||re===void 0?void 0:re.formatOnTypeOptions}).find(H=>!!H),f=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.CodeActionProvider}),
d=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.SemanticTokenProvider}),h=dz(u.map(H=>{var S,re;return(re=(S=H.lsp)===null||S===void 0?void 0:S.SemanticTokenProvider)===null||re===void 0?void 0:re.semanticTokensOptions})),p=(i=(r=this.services.lsp)===null||r===void 0?void 0:r.ExecuteCommandHandler)===null||i===void 0?void 0:i.commands,w=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.DocumentLinkProvider}),v=pz(u.map(H=>{var S,re;return(re=(S=H.lsp)===
null||S===void 0?void 0:S.SignatureHelp)===null||re===void 0?void 0:re.signatureHelpOptions})),g=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.TypeProvider}),b=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.ImplementationProvider}),k=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.CompletionProvider}),_=ez(u.map(H=>{var S,re;return(re=(S=H.lsp)===null||S===void 0?void 0:S.CompletionProvider)===null||re===void 0?void 0:re.completionOptions})),
I=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.ReferencesProvider}),Z=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.DocumentSymbolProvider}),J=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.DefinitionProvider}),ue=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.DocumentHighlightProvider}),ae=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.FoldingRangeProvider}),$e=this.hasService(H=>{
var S;return(S=H.lsp)===null||S===void 0?void 0:S.HoverProvider}),B=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.RenameProvider}),T=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.CallHierarchyProvider}),$=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.TypeHierarchyProvider}),j=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.CodeLensProvider}),A=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?
void 0:S.DeclarationProvider}),P=this.hasService(H=>{var S;return(S=H.lsp)===null||S===void 0?void 0:S.InlayHintProvider}),L=(s=this.services.lsp)===null||s===void 0?void 0:s.WorkspaceSymbolProvider;return{capabilities:{workspace:{workspaceFolders:{supported:!0},fileOperations:o},executeCommandProvider:p&&{commands:p},textDocumentSync:{change:Cp.TextDocumentSyncKind.Incremental,openClose:!0,save:!!a.didSaveDocument,willSave:!!a.willSaveDocument,willSaveWaitUntil:!!a.willSaveDocumentWaitUntil},completionProvider:k?
_:void 0,referencesProvider:I,documentSymbolProvider:Z,definitionProvider:J,typeDefinitionProvider:g,documentHighlightProvider:ue,codeActionProvider:f,documentFormattingProvider:c,documentRangeFormattingProvider:c,documentOnTypeFormattingProvider:l,foldingRangeProvider:ae,hoverProvider:$e,renameProvider:B?{prepareProvider:!0}:void 0,semanticTokensProvider:d?h:void 0,signatureHelpProvider:v,implementationProvider:b,callHierarchyProvider:T?{}:void 0,typeHierarchyProvider:$?{}:void 0,documentLinkProvider:w?
{resolveProvider:!1}:void 0,codeLensProvider:j?{resolveProvider:!1}:void 0,declarationProvider:A,inlayHintProvider:P?{resolveProvider:!1}:void 0,workspaceSymbolProvider:L?{resolveProvider:!!L.resolveSymbol}:void 0}}}initialized(e){this.fireInitializedOnDefaultServices(e),this.onInitializedEmitter.fire(e),this.onInitializedEmitter.dispose()}fireInitializeOnDefaultServices(e){this.services.workspace.ConfigurationProvider.initialize(e),this.services.workspace.WorkspaceManager.initialize(e)}fireInitializedOnDefaultServices(e){
const n=this.services.lsp.Connection,r=n?Object.assign(Object.assign({},e),{register:i=>n.client.register(Cp.DidChangeConfigurationNotification.type,i),fetchConfiguration:i=>n.workspace.getConfiguration(i)}):e;this.services.workspace.ConfigurationProvider.initialized(r).catch(i=>console.error("Error in ConfigurationProvider initialization:",i)),this.services.workspace.WorkspaceManager.initialized(e).catch(i=>console.error("Error in WorkspaceManager initialization:",i))}}class gz{getSymbolKind(e){
return Ee.SymbolKind.Field}getCompletionItemKind(e){return Ee.CompletionItemKind.Reference}}class yz{constructor(e){this.nameProvider=e.references.NameProvider,this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}findReferences(e,n,r){const i=e.parseResult.value.$cstNode;if(!i)return[];const s=ua(i,e.textDocument.offsetAt(n.position),this.grammarConfig.nameRegexp);return s?this.getReferences(s,n,e):[]}getReferences(e,n,r){const i=[],s=this.references.findDeclaration(
e);if(s){const a={includeDeclaration:n.context.includeDeclaration};this.references.findReferences(s,a).forEach(o=>{i.push(Ee.Location.create(o.sourceUri.toString(),o.segment.range))})}return i}}class vz{constructor(e){this.references=e.references.References,this.nameProvider=e.references.NameProvider,this.grammarConfig=e.parser.GrammarConfig}async rename(e,n,r){const i={},s=e.parseResult.value.$cstNode;if(!s)return;const a=e.textDocument.offsetAt(n.position),o=ua(s,a,this.grammarConfig.nameRegexp);
if(!o)return;const u=this.references.findDeclaration(o);if(!u)return;const c={onlyLocal:!1,includeDeclaration:!0};return this.references.findReferences(u,c).forEach(f=>{const d=sr.replace(f.segment.range,n.newName),h=f.sourceUri.toString();i[h]?i[h].push(d):i[h]=[d]}),{changes:i}}prepareRename(e,n,r){return this.renameNodeRange(e,n.position)}renameNodeRange(e,n){const r=e.parseResult.value.$cstNode,i=e.textDocument.offsetAt(n);if(r&&i){const s=ua(r,i,this.grammarConfig.nameRegexp);if(!s)return;if(this.
references.findDeclaration(s)||this.isNameNode(s))return s.range}}isNameNode(e){return e?.astNode&&yp(e.astNode)&&e===this.nameProvider.getNameNode(e.astNode)}}class cC{constructor(e){this.indexManager=e.workspace.IndexManager,this.nodeKindProvider=e.lsp.NodeKindProvider,this.fuzzyMatcher=e.lsp.FuzzyMatcher}async getSymbols(e,n=Dt.CancellationToken.None){const r=[],i=e.query.toLowerCase();for(const s of this.indexManager.allElements())if(await en(n),this.fuzzyMatcher.match(i,s.name)){const a=this.
getWorkspaceSymbol(s);a&&r.push(a)}return r}getWorkspaceSymbol(e){const n=e.nameSegment;if(n)return{kind:this.nodeKindProvider.getSymbolKind(e),name:e.name,location:{range:n.range,uri:e.documentUri.toString()}}}}class lC{constructor(e){this._configuration=e,this._syncedDocuments=new Map,this._onDidChangeContent=new Ee.Emitter,this._onDidOpen=new Ee.Emitter,this._onDidClose=new Ee.Emitter,this._onDidSave=new Ee.Emitter,this._onWillSave=new Ee.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){
return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._syncedDocuments.get(Tt.normalize(e))}set(e){const n=Tt.normalize(e.uri);let r=!0;this._syncedDocuments.has(n)&&(r=!1),this._syncedDocuments.set(n,e);const i=Object.freeze({document:e});return this._onDidOpen.fire(i),this._onDidChangeContent.fire(i),r}delete(e){
const n=Tt.normalize(typeof e=="object"&&"uri"in e?e.uri:e),r=this._syncedDocuments.get(n);r!==void 0&&(this._syncedDocuments.delete(n),this._onDidClose.fire(Object.freeze({document:r})))}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(e){e.__textDocumentSync=Ee.TextDocumentSyncKind.Incremental;const n=[];return n.push(e.onDidOpenTextDocument(r=>{const i=r.textDocument,s=Tt.normalize(i.uri),a=this._configuration.create(s,i.languageId,
i.version,i.text);this._syncedDocuments.set(s,a);const o=Object.freeze({document:a});this._onDidOpen.fire(o),this._onDidChangeContent.fire(o)})),n.push(e.onDidChangeTextDocument(r=>{const i=r.textDocument,s=r.contentChanges;if(s.length===0)return;const{version:a}=i;if(a==null)throw new Error(`Received document change event for ${i.uri} without valid version identifier`);const o=Tt.normalize(i.uri);let u=this._syncedDocuments.get(o);u!==void 0&&(u=this._configuration.update(u,s,a),this._syncedDocuments.
set(o,u),this._onDidChangeContent.fire(Object.freeze({document:u})))})),n.push(e.onDidCloseTextDocument(r=>{const i=Tt.normalize(r.textDocument.uri),s=this._syncedDocuments.get(i);s!==void 0&&(this._syncedDocuments.delete(i),this._onDidClose.fire(Object.freeze({document:s})))})),n.push(e.onWillSaveTextDocument(r=>{const i=this._syncedDocuments.get(Tt.normalize(r.textDocument.uri));i!==void 0&&this._onWillSave.fire(Object.freeze({document:i,reason:r.reason}))})),n.push(e.onWillSaveTextDocumentWaitUntil(
(r,i)=>{const s=this._syncedDocuments.get(Tt.normalize(r.textDocument.uri));return s!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:s,reason:r.reason}),i):[]})),n.push(e.onDidSaveTextDocument(r=>{const i=this._syncedDocuments.get(Tt.normalize(r.textDocument.uri));i!==void 0&&this._onDidSave.fire(Object.freeze({document:i}))})),Ee.Disposable.create(()=>{n.forEach(r=>r.dispose())})}}class wz{constructor(e){this.notebookDocuments=new Map,this.notebookCellMap=new Map,
this._onDidOpen=new Ee.Emitter,this._onDidSave=new Ee.Emitter,this._onDidChange=new Ee.Emitter,this._onDidClose=new Ee.Emitter,"listen"in e?this._cellTextDocuments=e:this._cellTextDocuments=new lC(e)}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(e){return this._cellTextDocuments.get(e.document)}getNotebookDocument(e){return this.notebookDocuments.get(Tt.normalize(e))}getNotebookCell(e){const n=this.notebookCellMap.get(Tt.normalize(e));return n&&n[0]}findNotebookDocumentForCell(e){
const n=typeof e=="string"||"scheme"in e?e:e.document,r=this.notebookCellMap.get(Tt.normalize(n));return r&&r[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(e){const n=new _u,r=[];return r.push(this.cellTextDocuments.listen(n)),r.push(e.notebooks.synchronization.onDidOpenNotebookDocument(i=>{const s=Tt.normalize(i.notebookDocument.uri);this.notebookDocuments.
set(s,i.notebookDocument);for(const a of i.cellTextDocuments)n.openTextDocument({textDocument:a});this.updateCellMap(i.notebookDocument),this._onDidOpen.fire(i.notebookDocument)})),r.push(e.notebooks.synchronization.onDidChangeNotebookDocument(i=>{const s=Tt.normalize(i.notebookDocument.uri),a=this.notebookDocuments.get(s);if(a===void 0)return;a.version=i.notebookDocument.version;const o=a.metadata;let u=!1;const c=i.change;c.metadata!==void 0&&(u=!0,a.metadata=c.metadata);const l=[],f=[],d=[],h=[];
if(c.cells!==void 0){const b=c.cells;if(b.structure!==void 0){const k=b.structure.array;if(a.cells.splice(k.start,k.deleteCount,...k.cells!==void 0?k.cells:[]),b.structure.didOpen!==void 0)for(const _ of b.structure.didOpen)n.openTextDocument({textDocument:_}),l.push(_.uri);if(b.structure.didClose)for(const _ of b.structure.didClose)n.closeTextDocument({textDocument:_}),f.push(_.uri)}if(b.data!==void 0){const k=new Map(b.data.map(_=>[_.document,_]));for(let _=0;_<=a.cells.length;_++){const I=k.get(
a.cells[_].document);if(I!==void 0){const Z=a.cells.splice(_,1,I);if(d.push({old:Z[0],new:I}),k.delete(I.document),k.size===0)break}}}if(b.textContent!==void 0)for(const k of b.textContent)n.changeTextDocument({textDocument:k.document,contentChanges:k.changes}),h.push(k.document.uri)}this.updateCellMap(a);const p={notebookDocument:a};u&&(p.metadata={old:o,new:a.metadata});const w=[];for(const b of l)w.push(this.getNotebookCell(b));const v=[];for(const b of f)v.push(this.getNotebookCell(b));const g=[];
for(const b of h)g.push(this.getNotebookCell(b));(w.length>0||v.length>0||d.length>0||g.length>0)&&(p.cells={added:w,removed:v,changed:{data:d,textContent:g}}),(p.metadata!==void 0||p.cells!==void 0)&&this._onDidChange.fire(p)})),r.push(e.notebooks.synchronization.onDidSaveNotebookDocument(i=>{const s=this.getNotebookDocument(i.notebookDocument.uri);s!==void 0&&this._onDidSave.fire(s)})),r.push(e.notebooks.synchronization.onDidCloseNotebookDocument(i=>{const s=Tt.normalize(i.notebookDocument.uri),
a=this.notebookDocuments.get(s);if(a!==void 0){this._onDidClose.fire(a);for(const o of i.cellTextDocuments)n.closeTextDocument({textDocument:o});this.notebookDocuments.delete(s);for(const o of a.cells)this.notebookCellMap.delete(o.document)}})),Ee.Disposable.create(()=>{r.forEach(i=>i.dispose())})}updateCellMap(e){for(const n of e.cells)this.notebookCellMap.set(n.document,[n,e])}}class _u{onDidOpenTextDocument(e){return this.openHandler=e,Ee.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(e){
this.openHandler&&this.openHandler(e)}onDidChangeTextDocument(e){return this.changeHandler=e,Ee.Disposable.create(()=>{this.changeHandler=e})}changeTextDocument(e){this.changeHandler&&this.changeHandler(e)}onDidCloseTextDocument(e){return this.closeHandler=e,Ee.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(e){this.closeHandler&&this.closeHandler(e)}onWillSaveTextDocument(){return _u.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return _u.NULL_DISPOSE}onDidSaveTextDocument(){
return _u.NULL_DISPOSE}}_u.NULL_DISPOSE=Object.freeze({dispose:()=>{}});function bz(t){return bp.merge(fT(t),Ez(t))}function Ez(t){return{lsp:{CompletionProvider:e=>new nC(e),DocumentSymbolProvider:e=>new nz(e),HoverProvider:e=>new uz(e),FoldingRangeProvider:e=>new iz(e),ReferencesProvider:e=>new yz(e),DefinitionProvider:e=>new tz(e),DocumentHighlightProvider:e=>new rC(e),RenameProvider:e=>new vz(e)},shared:()=>t.shared}}function kz(t){return bp.merge(hT(t),Rz(t))}function Rz(t){return{lsp:{Connection:()=>t.
connection,LanguageServer:e=>new mz(e),DocumentUpdateHandler:e=>new rz(e),WorkspaceSymbolProvider:e=>new cC(e),NodeKindProvider:()=>new gz,FuzzyMatcher:()=>new sz},workspace:{TextDocuments:()=>new lC(gp),NotebookDocuments:e=>new wz(e.workspace.TextDocuments)}}}class $z{constructor(){this.collector=()=>{}}getNodeFormatter(e){return new Dz(e,this.collector)}formatDocument(e,n){const r=e.parseResult;return r.lexerErrors.length===0&&r.parserErrors.length===0?this.doDocumentFormat(e,n.options):[]}isFormatRangeErrorFree(e,n){
const r=e.parseResult;return r.lexerErrors.length||r.parserErrors.length?Math.min(...r.lexerErrors.map(s=>{var a;return(a=s.line)!==null&&a!==void 0?a:Number.MAX_VALUE}),...r.parserErrors.map(s=>{var a;return(a=s.token.startLine)!==null&&a!==void 0?a:Number.MAX_VALUE}))>n.end.line:!0}formatDocumentRange(e,n){return this.isFormatRangeErrorFree(e,n.range)?this.doDocumentFormat(e,n.options,n.range):[]}formatDocumentOnType(e,n){const r={start:{character:0,line:n.position.line},end:n.position};return this.
isFormatRangeErrorFree(e,r)?this.doDocumentFormat(e,n.options,r):[]}get formatOnTypeOptions(){}doDocumentFormat(e,n,r){const i=new Map,s=(o,u,c)=>{var l,f;const d=this.nodeModeToKey(o,u),h=i.get(d),p=(l=c.options.priority)!==null&&l!==void 0?l:0,w=(f=h?.options.priority)!==null&&f!==void 0?f:0;(!h||w<=p)&&i.set(d,c)};this.collector=s,this.iterateAstFormatting(e,r);const a=this.iterateCstFormatting(e,i,n,r);return this.avoidOverlappingEdits(e.textDocument,a)}avoidOverlappingEdits(e,n){const r=[];
for(const i of n){let s=r[r.length-1];for(;s;){const a=e.offsetAt(i.range.start),o=e.offsetAt(s.range.end);if(a<o)r.pop(),s=r[r.length-1];else break}r.push(i)}return r.filter(i=>this.isNecessary(i,e))}iterateAstFormatting(e,n){const r=e.parseResult.value;this.format(r);const i=gi(r).iterator();let s;do if(s=i.next(),!s.done){const a=s.value;this.insideRange(a.$cstNode.range,n)?this.format(a):i.prune()}while(!s.done)}nodeModeToKey(e,n){return`${e.offset}:${e.end}:${n}`}insideRange(e,n){return!n||
e.start.line<=n.start.line&&e.end.line>=n.end.line||e.start.line>=n.start.line&&e.end.line<=n.end.line||e.start.line<=n.end.line&&e.end.line>=n.end.line}isNecessary(e,n){return e.newText!==n.getText(e.range).replace(/\r/g,"")}iterateCstFormatting(e,n,r,i){const s={indentation:0,options:r,document:e.textDocument},a=[],u=this.iterateCstTree(e,s).iterator();let c,l;do if(l=u.next(),!l.done){const f=l.value,d=oa(f),h=this.nodeModeToKey(f,"prepend"),p=n.get(h);if(n.delete(h),p){const g=this.createTextEdit(
c,f,p,s);for(const b of g)b&&this.insideRange(b.range,i)&&a.push(b)}const w=this.nodeModeToKey(f,"append"),v=n.get(w);if(n.delete(w),v){const g=bO(f);if(g){const b=this.createTextEdit(f,g,v,s);for(const k of b)k&&this.insideRange(k.range,i)&&a.push(k)}}if(!p&&f.hidden){const g=this.createHiddenTextEdits(c,f,void 0,s);for(const b of g)b&&this.insideRange(b.range,i)&&a.push(b)}d&&(c=f)}while(!l.done);return a}createHiddenTextEdits(e,n,r,i){var s;const a=n.range.start.line;if(e&&e.range.end.line===
a)return[];const o=[],u={start:{character:0,line:a},end:n.range.start},c=i.document.getText(u),l=this.findFittingMove(u,(s=r?.moves)!==null&&s!==void 0?s:[],i),f=this.getExistingIndentationCharacterCount(c,i),h=this.getIndentationCharacterCount(i,l)-f;if(h===0)return[];let p="";h>0&&(p=(i.options.insertSpaces?" ":"	").repeat(h));const w=n.text.split(`
`);w[0]=c+w[0];for(let v=0;v<w.length;v++){const g=a+v,b={character:0,line:g};if(h>0)o.push({newText:p,range:{start:b,end:b}});else{const k=w[v];let _=0;for(;_<k.length;_++){const I=k.charAt(_);if(I!==" "&&I!=="	")break}o.push({newText:"",range:{start:b,end:{line:g,character:Math.min(_,Math.abs(h))}}})}}return o}getExistingIndentationCharacterCount(e,n){const r=" ".repeat(n.options.tabSize);return(n.options.insertSpaces?e.replaceAll("	",r):e.replaceAll(r,"	")).length}getIndentationCharacterCount(e,n){
let r=e.indentation;return n&&n.tabs&&(r+=n.tabs),(e.options.insertSpaces?e.options.tabSize:1)*r}createTextEdit(e,n,r,i){var s;if(n.hidden)return this.createHiddenTextEdits(e,n,r,i);if(e&&(e.range.end.line>n.range.start.line||e.range.end.line===n.range.start.line&&e.range.end.character>n.range.start.character))return[];const a={start:(s=e?.range.end)!==null&&s!==void 0?s:{character:0,line:0},end:n.range.start},o=this.findFittingMove(a,r.moves,i);if(!o)return[];const u=o.characters,c=o.lines,l=o.
tabs,f=i.indentation;i.indentation+=l??0;const d=[];return u!==void 0?e?.hidden||d.push(this.createSpaceTextEdit(a,u,r.options)):c!==void 0?d.push(this.createLineTextEdit(a,c,i,r.options)):l!==void 0&&d.push(this.createTabTextEdit(a,!!e,i)),oa(n)&&(i.indentation=f),d}createSpaceTextEdit(e,n,r){if(e.start.line===e.end.line){const s=e.end.character-e.start.character;n=this.fitIntoOptions(n,s,r)}return{newText:" ".repeat(n),range:e}}createLineTextEdit(e,n,r,i){const s=e.end.line-e.start.line;n=this.
fitIntoOptions(n,s,i);const o=(r.options.insertSpaces?" ".repeat(r.options.tabSize):"	").repeat(r.indentation);return{newText:`${`
`.repeat(n)}${o}`,range:e}}createTabTextEdit(e,n,r){const s=(r.options.insertSpaces?" ".repeat(r.options.tabSize):"	").repeat(r.indentation),a=n?1:0,o=Math.max(e.end.line-e.start.line,a);return{newText:`${`
`.repeat(o)}${s}`,range:e}}fitIntoOptions(e,n,r){return r.allowMore?e=Math.max(n,e):r.allowLess&&(e=Math.min(n,e)),e}findFittingMove(e,n,r){if(n.length===0)return;if(n.length===1)return n[0];const i=e.end.line-e.start.line;for(const s of n){if(s.lines!==void 0&&i<=s.lines)return s;if(s.lines===void 0&&i===0)return s}return n[n.length-1]}iterateCstTree(e,n){const i=e.parseResult.value.$cstNode;return i?new wo(i,s=>this.iterateCst(s,n)):Mu}iterateCst(e,n){if(!ks(e))return Mu;const r=n.indentation;
return new mn(()=>({index:0}),i=>i.index<e.content.length?{done:!1,value:e.content[i.index++]}:(n.indentation=r,Qn))}}class Dz{constructor(e,n){this.astNode=e,this.collector=n}node(e){return new ai(e.$cstNode?[e.$cstNode]:[],this.collector)}nodes(...e){const n=[];for(const r of e)r.$cstNode&&n.push(r.$cstNode);return new ai(n,this.collector)}property(e,n){const r=Cn(this.astNode.$cstNode,e,n);return new ai(r?[r]:[],this.collector)}properties(...e){const n=[];for(const r of e){const i=Ro(this.astNode.
$cstNode,r);n.push(...i)}return new ai(n,this.collector)}keyword(e,n){const r=bc(this.astNode.$cstNode,e,n);return new ai(r?[r]:[],this.collector)}keywords(...e){const n=[];for(const r of e){const i=py(this.astNode.$cstNode,r);n.push(...i)}return new ai(n,this.collector)}cst(e){return new ai([...e],this.collector)}interior(e,n){const r=e.nodes,i=n.nodes;if(r.length!==1||i.length!==1)return new ai([],this.collector);let s=r[0],a=i[0];if(s.offset>a.offset){const o=s;s=a,a=o}return new ai(EO(s,a),this.
collector)}}class ai{constructor(e,n){this.nodes=e,this.collector=n}prepend(e){for(const n of this.nodes)this.collector(n,"prepend",e);return this}append(e){for(const n of this.nodes)this.collector(n,"append",e);return this}surround(e){for(const n of this.nodes)this.collector(n,"prepend",e),this.collector(n,"append",e);return this}slice(e,n){return new ai(this.nodes.slice(e,n),this.collector)}}var xs;(function(t){function e(...l){return{options:{},moves:l.flatMap(f=>f.moves).sort(c)}}t.fit=e;function n(l){
return i(0,l)}t.noSpace=n;function r(l){return i(1,l)}t.oneSpace=r;function i(l,f){return{options:f??{},moves:[{characters:l}]}}t.spaces=i;function s(l){return a(1,l)}t.newLine=s;function a(l,f){return{options:f??{},moves:[{lines:l}]}}t.newLines=a;function o(l){return{options:l??{},moves:[{tabs:1,lines:1}]}}t.indent=o;function u(l){return{options:l??{},moves:[{tabs:0}]}}t.noIndent=u;function c(l,f){var d,h,p,w,v,g;const b=(d=l.lines)!==null&&d!==void 0?d:0,k=(h=f.lines)!==null&&h!==void 0?h:0,_=(p=
l.tabs)!==null&&p!==void 0?p:0,I=(w=f.tabs)!==null&&w!==void 0?w:0,Z=(v=l.characters)!==null&&v!==void 0?v:0,J=(g=f.characters)!==null&&g!==void 0?g:0;return b<k?-1:b>k?1:_<I?-1:_>I?1:Z<J?-1:Z>J?1:0}})(xs||(xs={}));var cw,dC;function Tz(){return dC||(dC=1,cw=JS()),cw}Tz();var ja={},$l={},Dl={},Ba={},Hr={},es={},fC;function hC(){if(fC)return es;fC=1,Object.defineProperty(es,"__esModule",{value:!0}),es.normalizePath=es.convertSlashes=es.cleanPath=void 0;const t=bs;function e(s){let a=(0,t.normalize)(
s);return a.length>1&&a[a.length-1]===t.sep&&(a=a.substring(0,a.length-1)),a}es.cleanPath=e;const n=/[\\/]/g;function r(s,a){return s.replace(n,a)}es.convertSlashes=r;function i(s,a){const{resolvePaths:o,normalizePath:u,pathSeparator:c}=a,l=process.platform==="win32"&&s.includes("/")||s.startsWith(".");if(o&&(s=(0,t.resolve)(s)),(u||l)&&(s=e(s)),s===".")return"";const f=s[s.length-1]!==c;return r(f?s+c:s,c)}return es.normalizePath=i,es}var ts={},pC;function Sz(){if(pC)return ts;pC=1,Object.defineProperty(
ts,"__esModule",{value:!0}),ts.build=ts.joinDirectoryPath=ts.joinPathWithBasePath=void 0;const t=bs,e=hC();function n(o,u){return u+o}ts.joinPathWithBasePath=n;function r(o,u){return function(c,l){return l.startsWith(o)?l.replace(o,"")+c:(0,e.convertSlashes)((0,t.relative)(o,l),u.pathSeparator)+u.pathSeparator+c}}function i(o){return o}function s(o,u,c){return u+o+c}ts.joinDirectoryPath=s;function a(o,u){const{relativePaths:c,includeBasePath:l}=u;return c&&o?r(o,u):l?n:i}return ts.build=a,ts}var Tl={},
mC;function Cz(){if(mC)return Tl;mC=1,Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.build=void 0;function t(a){return function(o,u){u.push(o.substring(a.length)||".")}}function e(a){return function(o,u,c){const l=o.substring(a.length)||".";c.every(f=>f(l,!0))&&u.push(l)}}const n=(a,o)=>{o.push(a||".")},r=(a,o,u)=>{const c=a||".";u.every(l=>l(c,!0))&&o.push(c)},i=()=>{};function s(a,o){const{includeDirs:u,filters:c,relativePaths:l}=o;return u?l?c&&c.length?e(a):t(a):c&&c.length?r:n:i}return Tl.
build=s,Tl}var Sl={},gC;function _z(){if(gC)return Sl;gC=1,Object.defineProperty(Sl,"__esModule",{value:!0}),Sl.build=void 0;const t=(a,o,u,c)=>{c.every(l=>l(a,!1))&&u.files++},e=(a,o,u,c)=>{c.every(l=>l(a,!1))&&o.push(a)},n=(a,o,u,c)=>{u.files++},r=(a,o)=>{o.push(a)},i=()=>{};function s(a){const{excludeFiles:o,filters:u,onlyCounts:c}=a;return o?i:u&&u.length?c?t:e:c?n:r}return Sl.build=s,Sl}var Cl={},yC;function Az(){if(yC)return Cl;yC=1,Object.defineProperty(Cl,"__esModule",{value:!0}),Cl.build=
void 0;const t=r=>r,e=()=>[""].slice(0,0);function n(r){return r.group?e:t}return Cl.build=n,Cl}var _l={},vC;function xz(){if(vC)return _l;vC=1,Object.defineProperty(_l,"__esModule",{value:!0}),_l.build=void 0;const t=(r,i,s)=>{r.push({directory:i,files:s,dir:i})},e=()=>{};function n(r){return r.group?t:e}return _l.build=n,_l}var qa={},wC;function Pz(){if(wC)return qa;wC=1;var t=qa&&qa.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(qa,"__esModule",{value:!0}),
qa.build=void 0;const e=t(Pu),n=bs,r=function(u,c,l){const{queue:f,options:{suppressErrors:d}}=c;f.enqueue(),e.default.realpath(u,(h,p)=>{if(h)return f.dequeue(d?null:h,c);e.default.stat(p,(w,v)=>{if(w)return f.dequeue(d?null:w,c);if(v.isDirectory()&&a(u,p,c))return f.dequeue(null,c);l(v,p),f.dequeue(null,c)})})},i=function(u,c,l){const{queue:f,options:{suppressErrors:d}}=c;f.enqueue();try{const h=e.default.realpathSync(u),p=e.default.statSync(h);if(p.isDirectory()&&a(u,h,c))return;l(p,h)}catch(h){
if(!d)throw h}};function s(u,c){return!u.resolveSymlinks||u.excludeSymlinks?null:c?i:r}qa.build=s;function a(u,c,l){if(l.options.useRealPaths)return o(c,l);let f=(0,n.dirname)(u),d=1;for(;f!==l.root&&d<2;){const h=l.symlinks.get(f);!!h&&(h===c||h.startsWith(c)||c.startsWith(h))?d++:f=(0,n.dirname)(f)}return l.symlinks.set(u,c),d>1}function o(u,c){return c.visited.includes(u+c.options.pathSeparator)}return qa}var Al={},bC;function Nz(){if(bC)return Al;bC=1,Object.defineProperty(Al,"__esModule",{value:!0}),
Al.build=void 0;const t=l=>l.counts,e=l=>l.groups,n=l=>l.paths,r=l=>l.paths.slice(0,l.options.maxFiles),i=(l,f,d)=>(u(f,d,l.counts,l.options.suppressErrors),null),s=(l,f,d)=>(u(f,d,l.paths,l.options.suppressErrors),null),a=(l,f,d)=>(u(f,d,l.paths.slice(0,l.options.maxFiles),l.options.suppressErrors),null),o=(l,f,d)=>(u(f,d,l.groups,l.options.suppressErrors),null);function u(l,f,d,h){f(l&&!h?l:null,d)}function c(l,f){const{onlyCounts:d,group:h,maxFiles:p}=l;return d?f?t:i:h?f?e:o:p?f?r:a:f?n:s}return Al.
build=c,Al}var Ga={},EC;function Iz(){if(EC)return Ga;EC=1;var t=Ga&&Ga.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.build=void 0;const e=t(Pu),n={withFileTypes:!0},r=(a,o,u,c,l)=>{if(c<0)return a.queue.dequeue(null,a);a.visited.push(o),a.counts.directories++,a.queue.enqueue(),e.default.readdir(o||".",n,(f,d=[])=>{l(d,u,c),a.queue.dequeue(a.options.suppressErrors?null:f,a)})},i=(a,o,u,c,l)=>{if(c<0)return;a.visited.push(o),
a.counts.directories++;let f=[];try{f=e.default.readdirSync(o||".",n)}catch(d){if(!a.options.suppressErrors)throw d}l(f,u,c)};function s(a){return a?i:r}return Ga.build=s,Ga}var xl={},kC;function Oz(){if(kC)return xl;kC=1,Object.defineProperty(xl,"__esModule",{value:!0}),xl.Queue=void 0;class t{onQueueEmpty;count=0;constructor(n){this.onQueueEmpty=n}enqueue(){this.count++}dequeue(n,r){(--this.count<=0||n)&&this.onQueueEmpty(n,r)}}return xl.Queue=t,xl}var Pl={},RC;function Lz(){if(RC)return Pl;RC=
1,Object.defineProperty(Pl,"__esModule",{value:!0}),Pl.Counter=void 0;class t{_files=0;_directories=0;set files(n){this._files=n}get files(){return this._files}set directories(n){this._directories=n}get directories(){return this._directories}get dirs(){return this._directories}}return Pl.Counter=t,Pl}var $C;function DC(){if($C)return Hr;$C=1;var t=Hr&&Hr.__createBinding||(Object.create?function(v,g,b,k){k===void 0&&(k=b);var _=Object.getOwnPropertyDescriptor(g,b);(!_||("get"in _?!g.__esModule:_.
writable||_.configurable))&&(_={enumerable:!0,get:function(){return g[b]}}),Object.defineProperty(v,k,_)}:function(v,g,b,k){k===void 0&&(k=b),v[k]=g[b]}),e=Hr&&Hr.__setModuleDefault||(Object.create?function(v,g){Object.defineProperty(v,"default",{enumerable:!0,value:g})}:function(v,g){v.default=g}),n=Hr&&Hr.__importStar||function(v){if(v&&v.__esModule)return v;var g={};if(v!=null)for(var b in v)b!=="default"&&Object.prototype.hasOwnProperty.call(v,b)&&t(g,v,b);return e(g,v),g};Object.defineProperty(
Hr,"__esModule",{value:!0}),Hr.Walker=void 0;const r=bs,i=hC(),s=n(Sz()),a=n(Cz()),o=n(_z()),u=n(Az()),c=n(xz()),l=n(Pz()),f=n(Nz()),d=n(Iz()),h=Oz(),p=Lz();class w{root;isSynchronous;state;joinPath;pushDirectory;pushFile;getArray;groupFiles;resolveSymlink;walkDirectory;callbackInvoker;constructor(g,b,k){this.isSynchronous=!k,this.callbackInvoker=f.build(b,this.isSynchronous),this.root=(0,i.normalizePath)(g,b),this.state={root:this.root.slice(0,-1),paths:[""].slice(0,0),groups:[],counts:new p.Counter,
options:b,queue:new h.Queue((_,I)=>this.callbackInvoker(I,_,k)),symlinks:new Map,visited:[""].slice(0,0)},this.joinPath=s.build(this.root,b),this.pushDirectory=a.build(this.root,b),this.pushFile=o.build(b),this.getArray=u.build(b),this.groupFiles=c.build(b),this.resolveSymlink=l.build(b,this.isSynchronous),this.walkDirectory=d.build(this.isSynchronous)}start(){return this.walkDirectory(this.state,this.root,this.root,this.state.options.maxDepth,this.walk),this.isSynchronous?this.callbackInvoker(this.
state,null):null}walk=(g,b,k)=>{const{paths:_,options:{filters:I,resolveSymlinks:Z,excludeSymlinks:J,exclude:ue,maxFiles:ae,signal:$e,useRealPaths:B,pathSeparator:T}}=this.state;if($e&&$e.aborted||ae&&_.length>ae)return;this.pushDirectory(b,_,I);const $=this.getArray(this.state.paths);for(let j=0;j<g.length;++j){const A=g[j];if(A.isFile()||A.isSymbolicLink()&&!Z&&!J){const P=this.joinPath(A.name,b);this.pushFile(P,$,this.state.counts,I)}else if(A.isDirectory()){let P=s.joinDirectoryPath(A.name,b,
this.state.options.pathSeparator);if(ue&&ue(A.name,P))continue;this.walkDirectory(this.state,P,P,k-1,this.walk)}else if(A.isSymbolicLink()&&this.resolveSymlink){let P=s.joinPathWithBasePath(A.name,b);this.resolveSymlink(P,this.state,(L,Q)=>{if(L.isDirectory()){if(Q=(0,i.normalizePath)(Q,this.state.options),ue&&ue(A.name,B?Q:P+T))return;this.walkDirectory(this.state,Q,B?Q:P+T,k-1,this.walk)}else{Q=B?Q:P;const H=(0,r.basename)(Q),S=(0,i.normalizePath)((0,r.dirname)(Q),this.state.options);Q=this.joinPath(
H,S),this.pushFile(Q,$,this.state.counts,I)}})}}this.groupFiles(this.state.groups,b,$)}}return Hr.Walker=w,Hr}var TC;function Fz(){if(TC)return Ba;TC=1,Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.callback=Ba.promise=void 0;const t=DC();function e(r,i){return new Promise((s,a)=>{n(r,i,(o,u)=>{if(o)return a(o);s(u)})})}Ba.promise=e;function n(r,i,s){new t.Walker(r,i,s).start()}return Ba.callback=n,Ba}var Nl={},SC;function Mz(){if(SC)return Nl;SC=1,Object.defineProperty(Nl,"__esModule",{value:!0}),
Nl.sync=void 0;const t=DC();function e(n,r){return new t.Walker(n,r).start()}return Nl.sync=e,Nl}var CC;function jz(){if(CC)return Dl;CC=1,Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.APIBuilder=void 0;const t=Fz(),e=Mz();class n{root;options;constructor(i,s){this.root=i,this.options=s}withPromise(){return(0,t.promise)(this.root,this.options)}withCallback(i){(0,t.callback)(this.root,this.options,i)}sync(){return(0,e.sync)(this.root,this.options)}}return Dl.APIBuilder=n,Dl}var lw={},dw,_C;
function _p(){if(_C)return dw;_C=1;const t="\\\\/",e=`[^${t}]`,n="\\.",r="\\+",i="\\?",s="\\/",a="(?=.)",o="[^/]",u=`(?:${s}|$)`,c=`(?:^|${s})`,l=`${n}{1,2}${u}`,f=`(?!${n})`,d=`(?!${c}${l})`,h=`(?!${n}{0,1}${u})`,p=`(?!${l})`,w=`[^.${s}]`,v=`${o}*?`,b={DOT_LITERAL:n,PLUS_LITERAL:r,QMARK_LITERAL:i,SLASH_LITERAL:s,ONE_CHAR:a,QMARK:o,END_ANCHOR:u,DOTS_SLASH:l,NO_DOT:f,NO_DOTS:d,NO_DOT_SLASH:h,NO_DOTS_SLASH:p,QMARK_NO_DOT:w,STAR:v,START_ANCHOR:c,SEP:"/"},k={...b,SLASH_LITERAL:`[${t}]`,QMARK:e,STAR:`${e}\
*?`,DOTS_SLASH:`${n}{1,2}(?:[${t}]|$)`,NO_DOT:`(?!${n})`,NO_DOTS:`(?!(?:^|[${t}])${n}{1,2}(?:[${t}]|$))`,NO_DOT_SLASH:`(?!${n}{0,1}(?:[${t}]|$))`,NO_DOTS_SLASH:`(?!${n}{1,2}(?:[${t}]|$))`,QMARK_NO_DOT:`[^.${t}]`,START_ANCHOR:`(?:^|[${t}])`,END_ANCHOR:`(?:[${t}]|$)`,SEP:"\\"},_={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",
upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};return dw={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:_,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,
CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,
CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(I){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${I.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"\
(?:",close:")"}}},globChars(I){return I===!0?k:b}},dw}var AC;function Ap(){return AC||(AC=1,function(t){const{REGEX_BACKSLASH:e,REGEX_REMOVE_BACKSLASH:n,REGEX_SPECIAL_CHARS:r,REGEX_SPECIAL_CHARS_GLOBAL:i}=_p();t.isObject=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t.hasRegexChars=s=>r.test(s),t.isRegexChar=s=>s.length===1&&t.hasRegexChars(s),t.escapeRegex=s=>s.replace(i,"\\$1"),t.toPosixSlashes=s=>s.replace(e,"/"),t.isWindows=()=>{if(typeof navigator<"u"&&navigator.platform){const s=navigator.
platform.toLowerCase();return s==="win32"||s==="windows"}return typeof process<"u"&&process.platform?process.platform==="win32":!1},t.removeBackslashes=s=>s.replace(n,a=>a==="\\"?"":a),t.escapeLast=(s,a,o)=>{const u=s.lastIndexOf(a,o);return u===-1?s:s[u-1]==="\\"?t.escapeLast(s,a,u-1):`${s.slice(0,u)}\\${s.slice(u)}`},t.removePrefix=(s,a={})=>{let o=s;return o.startsWith("./")&&(o=o.slice(2),a.prefix="./"),o},t.wrapOutput=(s,a={},o={})=>{const u=o.contains?"":"^",c=o.contains?"":"$";let l=`${u}\
(?:${s})${c}`;return a.negated===!0&&(l=`(?:^(?!${l}).*$)`),l},t.basename=(s,{windows:a}={})=>{const o=s.split(a?/[\\/]/:"/"),u=o[o.length-1];return u===""?o[o.length-2]:u}}(lw)),lw}var fw,xC;function Bz(){if(xC)return fw;xC=1;const t=Ap(),{CHAR_ASTERISK:e,CHAR_AT:n,CHAR_BACKWARD_SLASH:r,CHAR_COMMA:i,CHAR_DOT:s,CHAR_EXCLAMATION_MARK:a,CHAR_FORWARD_SLASH:o,CHAR_LEFT_CURLY_BRACE:u,CHAR_LEFT_PARENTHESES:c,CHAR_LEFT_SQUARE_BRACKET:l,CHAR_PLUS:f,CHAR_QUESTION_MARK:d,CHAR_RIGHT_CURLY_BRACE:h,CHAR_RIGHT_PARENTHESES:p,
CHAR_RIGHT_SQUARE_BRACKET:w}=_p(),v=k=>k===o||k===r,g=k=>{k.isPrefix!==!0&&(k.depth=k.isGlobstar?1/0:1)};return fw=(k,_)=>{const I=_||{},Z=k.length-1,J=I.parts===!0||I.scanToEnd===!0,ue=[],ae=[],$e=[];let B=k,T=-1,$=0,j=0,A=!1,P=!1,L=!1,Q=!1,H=!1,S=!1,re=!1,ke=!1,je=!1,M=!1,V=0,Le,he,Ce={value:"",depth:0,isGlob:!1};const Be=()=>T>=Z,pe=()=>B.charCodeAt(T+1),O=()=>(Le=he,B.charCodeAt(++T));for(;T<Z;){he=O();let nt;if(he===r){re=Ce.backslashes=!0,he=O(),he===u&&(S=!0);continue}if(S===!0||he===u){for(V++;Be()!==
!0&&(he=O());){if(he===r){re=Ce.backslashes=!0,O();continue}if(he===u){V++;continue}if(S!==!0&&he===s&&(he=O())===s){if(A=Ce.isBrace=!0,L=Ce.isGlob=!0,M=!0,J===!0)continue;break}if(S!==!0&&he===i){if(A=Ce.isBrace=!0,L=Ce.isGlob=!0,M=!0,J===!0)continue;break}if(he===h&&(V--,V===0)){S=!1,A=Ce.isBrace=!0,M=!0;break}}if(J===!0)continue;break}if(he===o){if(ue.push(T),ae.push(Ce),Ce={value:"",depth:0,isGlob:!1},M===!0)continue;if(Le===s&&T===$+1){$+=2;continue}j=T+1;continue}if(I.noext!==!0&&(he===f||
he===n||he===e||he===d||he===a)===!0&&pe()===c){if(L=Ce.isGlob=!0,Q=Ce.isExtglob=!0,M=!0,he===a&&T===$&&(je=!0),J===!0){for(;Be()!==!0&&(he=O());){if(he===r){re=Ce.backslashes=!0,he=O();continue}if(he===p){L=Ce.isGlob=!0,M=!0;break}}continue}break}if(he===e){if(Le===e&&(H=Ce.isGlobstar=!0),L=Ce.isGlob=!0,M=!0,J===!0)continue;break}if(he===d){if(L=Ce.isGlob=!0,M=!0,J===!0)continue;break}if(he===l){for(;Be()!==!0&&(nt=O());){if(nt===r){re=Ce.backslashes=!0,O();continue}if(nt===w){P=Ce.isBracket=!0,
L=Ce.isGlob=!0,M=!0;break}}if(J===!0)continue;break}if(I.nonegate!==!0&&he===a&&T===$){ke=Ce.negated=!0,$++;continue}if(I.noparen!==!0&&he===c){if(L=Ce.isGlob=!0,J===!0){for(;Be()!==!0&&(he=O());){if(he===c){re=Ce.backslashes=!0,he=O();continue}if(he===p){M=!0;break}}continue}break}if(L===!0){if(M=!0,J===!0)continue;break}}I.noext===!0&&(Q=!1,L=!1);let U=B,ge="",z="";$>0&&(ge=B.slice(0,$),B=B.slice($),j-=$),U&&L===!0&&j>0?(U=B.slice(0,j),z=B.slice(j)):L===!0?(U="",z=B):U=B,U&&U!==""&&U!=="/"&&U!==
B&&v(U.charCodeAt(U.length-1))&&(U=U.slice(0,-1)),I.unescape===!0&&(z&&(z=t.removeBackslashes(z)),U&&re===!0&&(U=t.removeBackslashes(U)));const me={prefix:ge,input:k,start:$,base:U,glob:z,isBrace:A,isBracket:P,isGlob:L,isExtglob:Q,isGlobstar:H,negated:ke,negatedExtglob:je};if(I.tokens===!0&&(me.maxDepth=0,v(he)||ae.push(Ce),me.tokens=ae),I.parts===!0||I.tokens===!0){let nt;for(let mt=0;mt<ue.length;mt++){const de=nt?nt+1:$,Ue=ue[mt],se=k.slice(de,Ue);I.tokens&&(mt===0&&$!==0?(ae[mt].isPrefix=!0,
ae[mt].value=ge):ae[mt].value=se,g(ae[mt]),me.maxDepth+=ae[mt].depth),(mt!==0||se!=="")&&$e.push(se),nt=Ue}if(nt&&nt+1<k.length){const mt=k.slice(nt+1);$e.push(mt),I.tokens&&(ae[ae.length-1].value=mt,g(ae[ae.length-1]),me.maxDepth+=ae[ae.length-1].depth)}me.slashes=ue,me.parts=$e}return me},fw}var hw,PC;function qz(){if(PC)return hw;PC=1;const t=_p(),e=Ap(),{MAX_LENGTH:n,POSIX_REGEX_SOURCE:r,REGEX_NON_SPECIAL_CHARS:i,REGEX_SPECIAL_CHARS_BACKREF:s,REPLACEMENTS:a}=t,o=(l,f)=>{if(typeof f.expandRange==
"function")return f.expandRange(...l,f);l.sort();const d=`[${l.join("-")}]`;try{new RegExp(d)}catch{return l.map(p=>e.escapeRegex(p)).join("..")}return d},u=(l,f)=>`Missing ${l}: "${f}" - use "\\\\${f}" to match literal characters`,c=(l,f)=>{if(typeof l!="string")throw new TypeError("Expected a string");l=a[l]||l;const d={...f},h=typeof d.maxLength=="number"?Math.min(n,d.maxLength):n;let p=l.length;if(p>h)throw new SyntaxError(`Input length: ${p}, exceeds maximum allowed length: ${h}`);const w={
type:"bos",value:"",output:d.prepend||""},v=[w],g=d.capture?"":"?:",b=t.globChars(d.windows),k=t.extglobChars(b),{DOT_LITERAL:_,PLUS_LITERAL:I,SLASH_LITERAL:Z,ONE_CHAR:J,DOTS_SLASH:ue,NO_DOT:ae,NO_DOT_SLASH:$e,NO_DOTS_SLASH:B,QMARK:T,QMARK_NO_DOT:$,STAR:j,START_ANCHOR:A}=b,P=de=>`(${g}(?:(?!${A}${de.dot?ue:_}).)*?)`,L=d.dot?"":ae,Q=d.dot?T:$;let H=d.bash===!0?P(d):j;d.capture&&(H=`(${H})`),typeof d.noext=="boolean"&&(d.noextglob=d.noext);const S={input:l,index:-1,start:0,dot:d.dot===!0,consumed:"",
output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:v};l=e.removePrefix(l,S),p=l.length;const re=[],ke=[],je=[];let M=w,V;const Le=()=>S.index===p-1,he=S.peek=(de=1)=>l[S.index+de],Ce=S.advance=()=>l[++S.index]||"",Be=()=>l.slice(S.index+1),pe=(de="",Ue=0)=>{S.consumed+=de,S.index+=Ue},O=de=>{S.output+=de.output!=null?de.output:de.value,pe(de.value)},U=()=>{let de=1;for(;he()==="!"&&(he(2)!=="("||he(3)==="?");)Ce(),S.start++,de++;return de%2===0?!1:
(S.negated=!0,S.start++,!0)},ge=de=>{S[de]++,je.push(de)},z=de=>{S[de]--,je.pop()},me=de=>{if(M.type==="globstar"){const Ue=S.braces>0&&(de.type==="comma"||de.type==="brace"),se=de.extglob===!0||re.length&&(de.type==="pipe"||de.type==="paren");de.type!=="slash"&&de.type!=="paren"&&!Ue&&!se&&(S.output=S.output.slice(0,-M.output.length),M.type="star",M.value="*",M.output=H,S.output+=M.output)}if(re.length&&de.type!=="paren"&&(re[re.length-1].inner+=de.value),(de.value||de.output)&&O(de),M&&M.type===
"text"&&de.type==="text"){M.output=(M.output||M.value)+de.value,M.value+=de.value;return}de.prev=M,v.push(de),M=de},nt=(de,Ue)=>{const se={...k[Ue],conditions:1,inner:""};se.prev=M,se.parens=S.parens,se.output=S.output;const _e=(d.capture?"(":"")+se.open;ge("parens"),me({type:de,value:Ue,output:S.output?"":J}),me({type:"paren",extglob:!0,value:Ce(),output:_e}),re.push(se)},mt=de=>{let Ue=de.close+(d.capture?")":""),se;if(de.type==="negate"){let _e=H;if(de.inner&&de.inner.length>1&&de.inner.includes(
"/")&&(_e=P(d)),(_e!==H||Le()||/^\)+$/.test(Be()))&&(Ue=de.close=`)$))${_e}`),de.inner.includes("*")&&(se=Be())&&/^\.[^\\/.]+$/.test(se)){const Xe=c(se,{...f,fastpaths:!1}).output;Ue=de.close=`)${Xe})${_e})`}de.prev.type==="bos"&&(S.negatedExtglob=!0)}me({type:"paren",extglob:!0,value:V,output:Ue}),z("parens")};if(d.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(l)){let de=!1,Ue=l.replace(s,(se,_e,Xe,xt,dt,ln)=>xt==="\\"?(de=!0,se):xt==="?"?_e?_e+xt+(dt?T.repeat(dt.length):""):ln===0?Q+(dt?T.repeat(
dt.length):""):T.repeat(Xe.length):xt==="."?_.repeat(Xe.length):xt==="*"?_e?_e+xt+(dt?H:""):H:_e?se:`\\${se}`);return de===!0&&(d.unescape===!0?Ue=Ue.replace(/\\/g,""):Ue=Ue.replace(/\\+/g,se=>se.length%2===0?"\\\\":se?"\\":"")),Ue===l&&d.contains===!0?(S.output=l,S):(S.output=e.wrapOutput(Ue,S,f),S)}for(;!Le();){if(V=Ce(),V==="\0")continue;if(V==="\\"){const se=he();if(se==="/"&&d.bash!==!0||se==="."||se===";")continue;if(!se){V+="\\",me({type:"text",value:V});continue}const _e=/^\\+/.exec(Be());
let Xe=0;if(_e&&_e[0].length>2&&(Xe=_e[0].length,S.index+=Xe,Xe%2!==0&&(V+="\\")),d.unescape===!0?V=Ce():V+=Ce(),S.brackets===0){me({type:"text",value:V});continue}}if(S.brackets>0&&(V!=="]"||M.value==="["||M.value==="[^")){if(d.posix!==!1&&V===":"){const se=M.value.slice(1);if(se.includes("[")&&(M.posix=!0,se.includes(":"))){const _e=M.value.lastIndexOf("["),Xe=M.value.slice(0,_e),xt=M.value.slice(_e+2),dt=r[xt];if(dt){M.value=Xe+dt,S.backtrack=!0,Ce(),!w.output&&v.indexOf(M)===1&&(w.output=J);
continue}}}(V==="["&&he()!==":"||V==="-"&&he()==="]")&&(V=`\\${V}`),V==="]"&&(M.value==="["||M.value==="[^")&&(V=`\\${V}`),d.posix===!0&&V==="!"&&M.value==="["&&(V="^"),M.value+=V,O({value:V});continue}if(S.quotes===1&&V!=='"'){V=e.escapeRegex(V),M.value+=V,O({value:V});continue}if(V==='"'){S.quotes=S.quotes===1?0:1,d.keepQuotes===!0&&me({type:"text",value:V});continue}if(V==="("){ge("parens"),me({type:"paren",value:V});continue}if(V===")"){if(S.parens===0&&d.strictBrackets===!0)throw new SyntaxError(
u("opening","("));const se=re[re.length-1];if(se&&S.parens===se.parens+1){mt(re.pop());continue}me({type:"paren",value:V,output:S.parens?")":"\\)"}),z("parens");continue}if(V==="["){if(d.nobracket===!0||!Be().includes("]")){if(d.nobracket!==!0&&d.strictBrackets===!0)throw new SyntaxError(u("closing","]"));V=`\\${V}`}else ge("brackets");me({type:"bracket",value:V});continue}if(V==="]"){if(d.nobracket===!0||M&&M.type==="bracket"&&M.value.length===1){me({type:"text",value:V,output:`\\${V}`});continue}
if(S.brackets===0){if(d.strictBrackets===!0)throw new SyntaxError(u("opening","["));me({type:"text",value:V,output:`\\${V}`});continue}z("brackets");const se=M.value.slice(1);if(M.posix!==!0&&se[0]==="^"&&!se.includes("/")&&(V=`/${V}`),M.value+=V,O({value:V}),d.literalBrackets===!1||e.hasRegexChars(se))continue;const _e=e.escapeRegex(M.value);if(S.output=S.output.slice(0,-M.value.length),d.literalBrackets===!0){S.output+=_e,M.value=_e;continue}M.value=`(${g}${_e}|${M.value})`,S.output+=M.value;continue}
if(V==="{"&&d.nobrace!==!0){ge("braces");const se={type:"brace",value:V,output:"(",outputIndex:S.output.length,tokensIndex:S.tokens.length};ke.push(se),me(se);continue}if(V==="}"){const se=ke[ke.length-1];if(d.nobrace===!0||!se){me({type:"text",value:V,output:V});continue}let _e=")";if(se.dots===!0){const Xe=v.slice(),xt=[];for(let dt=Xe.length-1;dt>=0&&(v.pop(),Xe[dt].type!=="brace");dt--)Xe[dt].type!=="dots"&&xt.unshift(Xe[dt].value);_e=o(xt,d),S.backtrack=!0}if(se.comma!==!0&&se.dots!==!0){const Xe=S.
output.slice(0,se.outputIndex),xt=S.tokens.slice(se.tokensIndex);se.value=se.output="\\{",V=_e="\\}",S.output=Xe;for(const dt of xt)S.output+=dt.output||dt.value}me({type:"brace",value:V,output:_e}),z("braces"),ke.pop();continue}if(V==="|"){re.length>0&&re[re.length-1].conditions++,me({type:"text",value:V});continue}if(V===","){let se=V;const _e=ke[ke.length-1];_e&&je[je.length-1]==="braces"&&(_e.comma=!0,se="|"),me({type:"comma",value:V,output:se});continue}if(V==="/"){if(M.type==="dot"&&S.index===
S.start+1){S.start=S.index+1,S.consumed="",S.output="",v.pop(),M=w;continue}me({type:"slash",value:V,output:Z});continue}if(V==="."){if(S.braces>0&&M.type==="dot"){M.value==="."&&(M.output=_);const se=ke[ke.length-1];M.type="dots",M.output+=V,M.value+=V,se.dots=!0;continue}if(S.braces+S.parens===0&&M.type!=="bos"&&M.type!=="slash"){me({type:"text",value:V,output:_});continue}me({type:"dot",value:V,output:_});continue}if(V==="?"){if(!(M&&M.value==="(")&&d.noextglob!==!0&&he()==="("&&he(2)!=="?"){
nt("qmark",V);continue}if(M&&M.type==="paren"){const _e=he();let Xe=V;(M.value==="("&&!/[!=<:]/.test(_e)||_e==="<"&&!/<([!=]|\w+>)/.test(Be()))&&(Xe=`\\${V}`),me({type:"text",value:V,output:Xe});continue}if(d.dot!==!0&&(M.type==="slash"||M.type==="bos")){me({type:"qmark",value:V,output:$});continue}me({type:"qmark",value:V,output:T});continue}if(V==="!"){if(d.noextglob!==!0&&he()==="("&&(he(2)!=="?"||!/[!=<:]/.test(he(3)))){nt("negate",V);continue}if(d.nonegate!==!0&&S.index===0){U();continue}}if(V===
"+"){if(d.noextglob!==!0&&he()==="("&&he(2)!=="?"){nt("plus",V);continue}if(M&&M.value==="("||d.regex===!1){me({type:"plus",value:V,output:I});continue}if(M&&(M.type==="bracket"||M.type==="paren"||M.type==="brace")||S.parens>0){me({type:"plus",value:V});continue}me({type:"plus",value:I});continue}if(V==="@"){if(d.noextglob!==!0&&he()==="("&&he(2)!=="?"){me({type:"at",extglob:!0,value:V,output:""});continue}me({type:"text",value:V});continue}if(V!=="*"){(V==="$"||V==="^")&&(V=`\\${V}`);const se=i.
exec(Be());se&&(V+=se[0],S.index+=se[0].length),me({type:"text",value:V});continue}if(M&&(M.type==="globstar"||M.star===!0)){M.type="star",M.star=!0,M.value+=V,M.output=H,S.backtrack=!0,S.globstar=!0,pe(V);continue}let de=Be();if(d.noextglob!==!0&&/^\([^?]/.test(de)){nt("star",V);continue}if(M.type==="star"){if(d.noglobstar===!0){pe(V);continue}const se=M.prev,_e=se.prev,Xe=se.type==="slash"||se.type==="bos",xt=_e&&(_e.type==="star"||_e.type==="globstar");if(d.bash===!0&&(!Xe||de[0]&&de[0]!=="/")){
me({type:"star",value:V,output:""});continue}const dt=S.braces>0&&(se.type==="comma"||se.type==="brace"),ln=re.length&&(se.type==="pipe"||se.type==="paren");if(!Xe&&se.type!=="paren"&&!dt&&!ln){me({type:"star",value:V,output:""});continue}for(;de.slice(0,3)==="/**";){const gn=l[S.index+4];if(gn&&gn!=="/")break;de=de.slice(3),pe("/**",3)}if(se.type==="bos"&&Le()){M.type="globstar",M.value+=V,M.output=P(d),S.output=M.output,S.globstar=!0,pe(V);continue}if(se.type==="slash"&&se.prev.type!=="bos"&&!xt&&
Le()){S.output=S.output.slice(0,-(se.output+M.output).length),se.output=`(?:${se.output}`,M.type="globstar",M.output=P(d)+(d.strictSlashes?")":"|$)"),M.value+=V,S.globstar=!0,S.output+=se.output+M.output,pe(V);continue}if(se.type==="slash"&&se.prev.type!=="bos"&&de[0]==="/"){const gn=de[1]!==void 0?"|$":"";S.output=S.output.slice(0,-(se.output+M.output).length),se.output=`(?:${se.output}`,M.type="globstar",M.output=`${P(d)}${Z}|${Z}${gn})`,M.value+=V,S.output+=se.output+M.output,S.globstar=!0,pe(
V+Ce()),me({type:"slash",value:"/",output:""});continue}if(se.type==="bos"&&de[0]==="/"){M.type="globstar",M.value+=V,M.output=`(?:^|${Z}|${P(d)}${Z})`,S.output=M.output,S.globstar=!0,pe(V+Ce()),me({type:"slash",value:"/",output:""});continue}S.output=S.output.slice(0,-M.output.length),M.type="globstar",M.output=P(d),M.value+=V,S.output+=M.output,S.globstar=!0,pe(V);continue}const Ue={type:"star",value:V,output:H};if(d.bash===!0){Ue.output=".*?",(M.type==="bos"||M.type==="slash")&&(Ue.output=L+Ue.
output),me(Ue);continue}if(M&&(M.type==="bracket"||M.type==="paren")&&d.regex===!0){Ue.output=V,me(Ue);continue}(S.index===S.start||M.type==="slash"||M.type==="dot")&&(M.type==="dot"?(S.output+=$e,M.output+=$e):d.dot===!0?(S.output+=B,M.output+=B):(S.output+=L,M.output+=L),he()!=="*"&&(S.output+=J,M.output+=J)),me(Ue)}for(;S.brackets>0;){if(d.strictBrackets===!0)throw new SyntaxError(u("closing","]"));S.output=e.escapeLast(S.output,"["),z("brackets")}for(;S.parens>0;){if(d.strictBrackets===!0)throw new SyntaxError(
u("closing",")"));S.output=e.escapeLast(S.output,"("),z("parens")}for(;S.braces>0;){if(d.strictBrackets===!0)throw new SyntaxError(u("closing","}"));S.output=e.escapeLast(S.output,"{"),z("braces")}if(d.strictSlashes!==!0&&(M.type==="star"||M.type==="bracket")&&me({type:"maybe_slash",value:"",output:`${Z}?`}),S.backtrack===!0){S.output="";for(const de of S.tokens)S.output+=de.output!=null?de.output:de.value,de.suffix&&(S.output+=de.suffix)}return S};return c.fastpaths=(l,f)=>{const d={...f},h=typeof d.
maxLength=="number"?Math.min(n,d.maxLength):n,p=l.length;if(p>h)throw new SyntaxError(`Input length: ${p}, exceeds maximum allowed length: ${h}`);l=a[l]||l;const{DOT_LITERAL:w,SLASH_LITERAL:v,ONE_CHAR:g,DOTS_SLASH:b,NO_DOT:k,NO_DOTS:_,NO_DOTS_SLASH:I,STAR:Z,START_ANCHOR:J}=t.globChars(d.windows),ue=d.dot?_:k,ae=d.dot?I:k,$e=d.capture?"":"?:",B={negated:!1,prefix:""};let T=d.bash===!0?".*?":Z;d.capture&&(T=`(${T})`);const $=L=>L.noglobstar===!0?T:`(${$e}(?:(?!${J}${L.dot?b:w}).)*?)`,j=L=>{switch(L){case"\
*":return`${ue}${g}${T}`;case".*":return`${w}${g}${T}`;case"*.*":return`${ue}${T}${w}${g}${T}`;case"*/*":return`${ue}${T}${v}${g}${ae}${T}`;case"**":return ue+$(d);case"**/*":return`(?:${ue}${$(d)}${v})?${ae}${g}${T}`;case"**/*.*":return`(?:${ue}${$(d)}${v})?${ae}${T}${w}${g}${T}`;case"**/.*":return`(?:${ue}${$(d)}${v})?${w}${g}${T}`;default:{const Q=/^(.*?)\.(\w+)$/.exec(L);if(!Q)return;const H=j(Q[1]);return H?H+w+Q[2]:void 0}}},A=e.removePrefix(l,B);let P=j(A);return P&&d.strictSlashes!==!0&&
(P+=`${v}?`),P},hw=c,hw}var pw,NC;function IC(){if(NC)return pw;NC=1;const t=Bz(),e=qz(),n=Ap(),r=_p(),i=a=>a&&typeof a=="object"&&!Array.isArray(a),s=(a,o,u=!1)=>{if(Array.isArray(a)){const v=a.map(b=>s(b,o,u));return b=>{for(const k of v){const _=k(b);if(_)return _}return!1}}const c=i(a)&&a.tokens&&a.input;if(a===""||typeof a!="string"&&!c)throw new TypeError("Expected pattern to be a non-empty string");const l=o||{},f=l.windows,d=c?s.compileRe(a,o):s.makeRe(a,o,!1,!0),h=d.state;delete d.state;
let p=()=>!1;if(l.ignore){const v={...o,ignore:null,onMatch:null,onResult:null};p=s(l.ignore,v,u)}const w=(v,g=!1)=>{const{isMatch:b,match:k,output:_}=s.test(v,d,o,{glob:a,posix:f}),I={glob:a,state:h,regex:d,posix:f,input:v,output:_,match:k,isMatch:b};return typeof l.onResult=="function"&&l.onResult(I),b===!1?(I.isMatch=!1,g?I:!1):p(v)?(typeof l.onIgnore=="function"&&l.onIgnore(I),I.isMatch=!1,g?I:!1):(typeof l.onMatch=="function"&&l.onMatch(I),g?I:!0)};return u&&(w.state=h),w};return s.test=(a,o,u,{
glob:c,posix:l}={})=>{if(typeof a!="string")throw new TypeError("Expected input to be a string");if(a==="")return{isMatch:!1,output:""};const f=u||{},d=f.format||(l?n.toPosixSlashes:null);let h=a===c,p=h&&d?d(a):a;return h===!1&&(p=d?d(a):a,h=p===c),(h===!1||f.capture===!0)&&(f.matchBase===!0||f.basename===!0?h=s.matchBase(a,o,u,l):h=o.exec(p)),{isMatch:!!h,match:h,output:p}},s.matchBase=(a,o,u)=>(o instanceof RegExp?o:s.makeRe(o,u)).test(n.basename(a)),s.isMatch=(a,o,u)=>s(o,u)(a),s.parse=(a,o)=>Array.
isArray(a)?a.map(u=>s.parse(u,o)):e(a,{...o,fastpaths:!1}),s.scan=(a,o)=>t(a,o),s.compileRe=(a,o,u=!1,c=!1)=>{if(u===!0)return a.output;const l=o||{},f=l.contains?"":"^",d=l.contains?"":"$";let h=`${f}(?:${a.output})${d}`;a&&a.negated===!0&&(h=`^(?!${h}).*$`);const p=s.toRegex(h,o);return c===!0&&(p.state=a),p},s.makeRe=(a,o={},u=!1,c=!1)=>{if(!a||typeof a!="string")throw new TypeError("Expected a non-empty string");let l={negated:!1,fastpaths:!0};return o.fastpaths!==!1&&(a[0]==="."||a[0]==="*")&&
(l.output=e.fastpaths(a,o)),l.output||(l=e(a,o)),s.compileRe(l,o,u,c)},s.toRegex=(a,o)=>{try{const u=o||{};return new RegExp(a,u.flags||(u.nocase?"i":""))}catch(u){if(o&&o.debug===!0)throw u;return/$^/}},s.constants=r,pw=s,pw}var mw,OC;function LC(){if(OC)return mw;OC=1;const t=IC(),e=Ap();function n(r,i,s=!1){return i&&(i.windows===null||i.windows===void 0)&&(i={...i,windows:e.isWindows()}),t(r,i,s)}return Object.assign(n,t),mw=n,mw}var FC;function Gz(){if(FC)return $l;FC=1,Object.defineProperty(
$l,"__esModule",{value:!0}),$l.Builder=void 0;const t=bs,e=jz();var n=null;try{require.resolve("picomatch"),n=LC()}catch{}class r{globCache={};options={maxDepth:1/0,suppressErrors:!0,pathSeparator:t.sep,filters:[]};globFunction;constructor(s){this.options={...this.options,...s},this.globFunction=this.options.globFunction}group(){return this.options.group=!0,this}withPathSeparator(s){return this.options.pathSeparator=s,this}withBasePath(){return this.options.includeBasePath=!0,this}withRelativePaths(){
return this.options.relativePaths=!0,this}withDirs(){return this.options.includeDirs=!0,this}withMaxDepth(s){return this.options.maxDepth=s,this}withMaxFiles(s){return this.options.maxFiles=s,this}withFullPaths(){return this.options.resolvePaths=!0,this.options.includeBasePath=!0,this}withErrors(){return this.options.suppressErrors=!1,this}withSymlinks({resolvePaths:s=!0}={}){return this.options.resolveSymlinks=!0,this.options.useRealPaths=s,this.withFullPaths()}withAbortSignal(s){return this.options.
signal=s,this}normalize(){return this.options.normalizePath=!0,this}filter(s){return this.options.filters.push(s),this}onlyDirs(){return this.options.excludeFiles=!0,this.options.includeDirs=!0,this}exclude(s){return this.options.exclude=s,this}onlyCounts(){return this.options.onlyCounts=!0,this}crawl(s){return new e.APIBuilder(s||".",this.options)}withGlobFunction(s){return this.globFunction=s,this}crawlWithOptions(s,a){return this.options={...this.options,...a},new e.APIBuilder(s||".",this.options)}glob(...s){
return this.globFunction?this.globWithOptions(s):this.globWithOptions(s,{dot:!0})}globWithOptions(s,...a){const o=this.globFunction||n;if(!o)throw new Error("Please specify a glob function to use glob matching.");var u=this.globCache[s.join("\0")];return u||(u=o(s,...a),this.globCache[s.join("\0")]=u),this.options.filters.push(c=>u(c)),this}}return $l.Builder=r,$l}var gw={},MC;function Uz(){return MC||(MC=1,Object.defineProperty(gw,"__esModule",{value:!0})),gw}var jC;function zz(){return jC||(jC=
1,function(t){var e=ja&&ja.__createBinding||(Object.create?function(i,s,a,o){o===void 0&&(o=a);var u=Object.getOwnPropertyDescriptor(s,a);(!u||("get"in u?!s.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(i,o,u)}:function(i,s,a,o){o===void 0&&(o=a),i[o]=s[a]}),n=ja&&ja.__exportStar||function(i,s){for(var a in i)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,i,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.fdir=
void 0;const r=Gz();Object.defineProperty(t,"fdir",{enumerable:!0,get:function(){return r.Builder}}),n(Uz(),t)}(ja)),ja}var Wz=zz();class Hz{constructor(){this.encoding="utf-8"}readFile(e){return _0.promises.readFile(e.fsPath,this.encoding)}async readDirectory(e){return(await _0.promises.readdir(e.fsPath,{withFileTypes:!0})).map(r=>({dirent:r,isFile:r.isFile(),isDirectory:r.isDirectory(),uri:Tt.joinPath(e,r.name)}))}}const xp="DeploymentElement";function Pp(t){return K.isInstance(t,xp)}const yw="\
DeploymentNodeOrElementKind",Np="DeploymentViewRule";function Vz(t){return K.isInstance(t,Np)}const Il="DynamicViewRule";function vw(t){return K.isInstance(t,Il)}const Ua="ElementProperty";function Kz(t){return K.isInstance(t,Ua)}const ww="ExpressionV2";function Zz(t){return K.isInstance(t,ww)}const bw="ExtendElementProperty",Ip="FqnExpr";function BC(t){return K.isInstance(t,Ip)}const Op="FqnExprOrWhere";function qC(t){return K.isInstance(t,Op)}const Lp="FqnExprOrWith";function GC(t){return K.isInstance(
t,Lp)}const Ew="FqnReferenceable",za="LikeC4View";function kw(t){return K.isInstance(t,za)}const Fp="MetadataProperty";function Ps(t){return K.isInstance(t,Fp)}const Rw="ModelReferenceable",zo="Referenceable",Mp="RelationExpr";function jp(t){return K.isInstance(t,Mp)}const Bp="RelationExprOrWhere";function Xz(t){return K.isInstance(t,Bp)}const qp="RelationExprOrWith";function Yz(t){return K.isInstance(t,qp)}const Ol="RelationProperty",Gp="RelationshipStyleProperty";function UC(t){return K.isInstance(
t,Gp)}const $w="SizeProperty";function Jz(t){return K.isInstance(t,$w)}const Wo="StringProperty";function zC(t){return K.isInstance(t,Wo)}const Ho="StyleProperty";function Dw(t){return K.isInstance(t,Ho)}const Up="ViewProperty";function Qz(t){return K.isInstance(t,Up)}const Ll="ViewRule";function eW(t){return K.isInstance(t,Ll)}const zp="ViewRuleStyleOrGlobalRef";function Tw(t){return K.isInstance(t,zp)}const Fl="WhereElement";function WC(t){return K.isInstance(t,Fl)}const Ml="WhereElementExpres\
sion";function tW(t){return K.isInstance(t,Ml)}const HC="WhereExpression",Wp="WhereKindEqual";function nW(t){return K.isInstance(t,Wp)}const jl="WhereRelation";function VC(t){return K.isInstance(t,jl)}const Bl="WhereRelationExpression";function rW(t){return K.isInstance(t,Bl)}const Hp="WhereTagEqual";function iW(t){return K.isInstance(t,Hp)}const ql="ArrowProperty";function Gl(t){return K.isInstance(t,ql)}const Ul="BorderProperty";function Vp(t){return K.isInstance(t,Ul)}const zl="ColorProperty";
function Wa(t){return K.isInstance(t,zl)}const Ha="CustomColor",Kp="CustomElementProperties";function sW(t){return K.isInstance(t,Kp)}const Zp="CustomRelationProperties";function aW(t){return K.isInstance(t,Zp)}const ns="DeployedInstance";function yr(t){return K.isInstance(t,ns)}const Xp="DeployedInstanceBody";function KC(t){return K.isInstance(t,Xp)}const Vr="DeploymentNode";function ar(t){return K.isInstance(t,Vr)}const Yp="DeploymentNodeBody";function ZC(t){return K.isInstance(t,Yp)}const rs="\
DeploymentNodeKind";function oW(t){return K.isInstance(t,rs)}const Jp="DeploymentRelation";function Ri(t){return K.isInstance(t,Jp)}const Qp="DeploymentRelationBody";function uW(t){return K.isInstance(t,Qp)}const Wl="DeploymentView";function XC(t){return K.isInstance(t,Wl)}const em="DeploymentViewBody";function Sw(t){return K.isInstance(t,em)}const Hl="DeploymentViewRulePredicate";function Vo(t){return K.isInstance(t,Hl)}const Vl="DeploymentViewRuleStyle";function Kl(t){return K.isInstance(t,Vl)}
const Zl="DirectedRelationExpr";function cW(t){return K.isInstance(t,Zl)}const Ko="DynamicView";function YC(t){return K.isInstance(t,Ko)}const tm="DynamicViewBody";function JC(t){return K.isInstance(t,tm)}const Xl="DynamicViewGlobalPredicateRef";function QC(t){return K.isInstance(t,Xl)}const Yl="DynamicViewIncludePredicate";function e_(t){return K.isInstance(t,Yl)}const nm="DynamicViewParallelSteps";function Cw(t){return K.isInstance(t,nm)}const _w="DynamicViewRef",rm="DynamicViewStep";function Aw(t){
return K.isInstance(t,rm)}const vr="Element";function _n(t){return K.isInstance(t,vr)}const im="ElementBody";function sm(t){return K.isInstance(t,im)}const is="ElementKind";function t_(t){return K.isInstance(t,is)}const Jl="ElementKindExpression";function n_(t){return K.isInstance(t,Jl)}const am="ElementRef";function xw(t){return K.isInstance(t,am)}const Ql="ElementStringProperty";function ed(t){return K.isInstance(t,Ql)}const td="ElementStyleProperty";function Zo(t){return K.isInstance(t,td)}const nd="\
ElementTagExpression";function r_(t){return K.isInstance(t,nd)}const Xo="ElementView";function om(t){return K.isInstance(t,Xo)}const um="ElementViewBody";function Pw(t){return K.isInstance(t,um)}const Nw="ElementViewRef",cm="Expressions";function i_(t){return K.isInstance(t,cm)}const rd="ExtendDeployment";function Va(t){return K.isInstance(t,rd)}const lm="ExtendDeploymentBody";function s_(t){return K.isInstance(t,lm)}const Ka="ExtendElement";function Yo(t){return K.isInstance(t,Ka)}const dm="Ext\
endElementBody";function Iw(t){return K.isInstance(t,dm)}const fm="FqnExpressions";function lW(t){return K.isInstance(t,fm)}const id="FqnExprWhere";function Ow(t){return K.isInstance(t,id)}const sd="FqnExprWith";function hm(t){return K.isInstance(t,sd)}const pm="FqnRef";function a_(t){return K.isInstance(t,pm)}const ad="FqnRefExpr";function Lw(t){return K.isInstance(t,ad)}const Jo="GlobalDynamicPredicateGroup";function od(t){return K.isInstance(t,Jo)}const Qo="GlobalPredicateGroup";function ud(t){
return K.isInstance(t,Qo)}const eu="Globals";function Fw(t){return K.isInstance(t,eu)}const mm="GlobalStyle";function tu(t){return K.isInstance(t,mm)}const gm="GlobalStyleGroup";function Za(t){return K.isInstance(t,gm)}const cd="GlobalStyleId",ld="IconProperty";function Ns(t){return K.isInstance(t,ld)}const Is="Imported";function ss(t){return K.isInstance(t,Is)}const ym="ImportsFromPoject";function Mw(t){return K.isInstance(t,ym)}const dd="IncomingRelationExpr";function dW(t){return K.isInstance(
t,dd)}const fd="InOutRelationExpr";function o_(t){return K.isInstance(t,fd)}const as="LibIcon";function fW(t){return K.isInstance(t,as)}const vm="LikeC4Grammar";function u_(t){return K.isInstance(t,vm)}const wm="LikeC4Lib";function hW(t){return K.isInstance(t,wm)}const hd="LineProperty";function pd(t){return K.isInstance(t,hd)}const md="LinkProperty";function bm(t){return K.isInstance(t,md)}const gd="MetadataAttribute";function pW(t){return K.isInstance(t,gd)}const yd="MetadataBody";function mW(t){
return K.isInstance(t,yd)}const nu="Model";function c_(t){return K.isInstance(t,nu)}const ru="ModelDeployments";function l_(t){return K.isInstance(t,ru)}const iu="ModelViews";function vd(t){return K.isInstance(t,iu)}const wd="MultipleProperty";function jw(t){return K.isInstance(t,wd)}const Em="NavigateToProperty";function km(t){return K.isInstance(t,Em)}const bd="NotationProperty";function su(t){return K.isInstance(t,bd)}const Ed="NotesProperty";function d_(t){return K.isInstance(t,Ed)}const kd="\
OpacityProperty";function Rm(t){return K.isInstance(t,kd)}const Rd="OutgoingRelationExpr";function f_(t){return K.isInstance(t,Rd)}const $d="PaddingSizeProperty";function Bw(t){return K.isInstance(t,$d)}const $m="Relation";function os(t){return K.isInstance(t,$m)}const Dm="RelationBody";function gW(t){return K.isInstance(t,Dm)}const Dd="RelationExprWhere";function qw(t){return K.isInstance(t,Dd)}const Td="RelationExprWith";function Gw(t){return K.isInstance(t,Td)}const Sd="RelationNavigateToProp\
erty";function Cd(t){return K.isInstance(t,Sd)}const Os="RelationshipKind";function yW(t){return K.isInstance(t,Os)}const _d="RelationStringProperty";function Ad(t){return K.isInstance(t,_d)}const xd="RelationStyleProperty";function Tm(t){return K.isInstance(t,xd)}const Pd="ShapeProperty";function Sm(t){return K.isInstance(t,Pd)}const Nd="ShapeSizeProperty";function Uw(t){return K.isInstance(t,Nd)}const Cm="SpecificationColor";function _m(t){return K.isInstance(t,Cm)}const au="SpecificationDeplo\
ymentNodeKind";function ou(t){return K.isInstance(t,au)}const uu="SpecificationElementKind";function cu(t){return K.isInstance(t,uu)}const Id="SpecificationElementStringProperty";function zw(t){return K.isInstance(t,Id)}const lu="SpecificationRelationshipKind";function du(t){return K.isInstance(t,lu)}const Od="SpecificationRelationshipStringProperty";function h_(t){return K.isInstance(t,Od)}const fu="SpecificationRule";function p_(t){return K.isInstance(t,fu)}const hu="SpecificationTag";function Am(t){
return K.isInstance(t,hu)}const xm="StrictFqnElementRef";function Ww(t){return K.isInstance(t,xm)}const Pm="StrictFqnRef";function m_(t){return K.isInstance(t,Pm)}const Ls="Tag";function g_(t){return K.isInstance(t,Ls)}const Nm="Tags";function Hw(t){return K.isInstance(t,Nm)}const Ld="TextSizeProperty";function Vw(t){return K.isInstance(t,Ld)}const Kw="ViewRef",Fd="ViewRuleAutoLayout";function Md(t){return K.isInstance(t,Fd)}const jd="ViewRuleGlobalPredicateRef";function Zw(t){return K.isInstance(
t,jd)}const Bd="ViewRuleGlobalStyle";function Xw(t){return K.isInstance(t,Bd)}const qd="ViewRuleGroup";function Im(t){return K.isInstance(t,qd)}const Gd="ViewRulePredicate";function Ud(t){return K.isInstance(t,Gd)}const zd="ViewRuleStyle";function pu(t){return K.isInstance(t,zd)}const Wd="ViewStringProperty";function vW(t){return K.isInstance(t,Wd)}const Hd="WhereBinaryExpression";function wW(t){return K.isInstance(t,Hd)}const Vd="WhereElementKind";function bW(t){return K.isInstance(t,Vd)}const Kd="\
WhereElementNegation";function y_(t){return K.isInstance(t,Kd)}const Zd="WhereElementTag";function EW(t){return K.isInstance(t,Zd)}const Xd="WhereRelationKind";function v_(t){return K.isInstance(t,Xd)}const Yd="WhereRelationNegation";function w_(t){return K.isInstance(t,Yd)}const Jd="WhereRelationParticipantKind";function b_(t){return K.isInstance(t,Jd)}const Qd="WhereRelationParticipantTag";function E_(t){return K.isInstance(t,Qd)}const ef="WhereRelationTag";function kW(t){return K.isInstance(t,
ef)}const tf="WildcardExpression";function k_(t){return K.isInstance(t,tf)}class R_ extends AE{getAllTypes(){return[ql,Ul,zl,Ha,Kp,Zp,ns,Xp,xp,Vr,Yp,rs,yw,Jp,Qp,Wl,em,Np,Hl,Vl,Zl,Ko,tm,Xl,Yl,nm,_w,Il,rm,vr,im,is,Jl,Ua,am,Ql,td,nd,Xo,um,Nw,ww,cm,rd,lm,Ka,dm,bw,Ip,Op,Lp,id,sd,fm,pm,ad,Ew,Jo,Qo,mm,gm,cd,eu,ld,Is,ym,fd,dd,as,vm,wm,za,hd,md,gd,yd,Fp,nu,ru,Rw,iu,wd,Em,bd,Ed,kd,Rd,$d,zo,$m,Dm,Mp,Bp,qp,Dd,Td,Sd,Ol,_d,xd,Os,Gp,Pd,Nd,$w,Cm,au,uu,Id,lu,Od,fu,hu,xm,Pm,Wo,Ho,Ls,Nm,Ld,Up,Kw,Ll,Fd,jd,Bd,qd,Gd,
zd,zp,Wd,Hd,Fl,Ml,Vd,Kd,Zd,HC,Wp,jl,Bl,Xd,Yd,Jd,Qd,ef,Hp,tf]}computeIsSubtype(e,n){switch(e){case ql:case hd:return this.isSubtype(Gp,n);case Ul:case wd:case kd:case Pd:return this.isSubtype(Ho,n);case zl:return this.isSubtype(Gp,n)||this.isSubtype(Ho,n);case ns:case Vr:return this.isSubtype(xp,n)||this.isSubtype(zo,n);case rs:case is:return this.isSubtype(yw,n);case Wl:case Ko:case Xo:return this.isSubtype(za,n);case Hl:case Vl:return this.isSubtype(Np,n);case Zl:case dd:case fd:case Rd:return this.
isSubtype(Mp,n);case Xl:case Yl:return this.isSubtype(Il,n);case vr:return this.isSubtype(Ew,n)||this.isSubtype(Rw,n)||this.isSubtype(zo,n);case Jl:case nd:case ad:case tf:return this.isSubtype(Ip,n);case Ql:return this.isSubtype(Ua,n)||this.isSubtype(Wo,n);case td:return this.isSubtype(Ua,n);case rd:case Ka:case zo:return this.isSubtype(Ew,n);case Ip:case id:return this.isSubtype(Op,n);case Op:case sd:return this.isSubtype(Lp,n);case Lp:case qp:return this.isSubtype(ww,n);case ld:return this.isSubtype(
Ua,n)||this.isSubtype(Ho,n);case Is:return this.isSubtype(Rw,n)||this.isSubtype(zo,n);case md:return this.isSubtype(Ua,n)||this.isSubtype(bw,n)||this.isSubtype(Ol,n)||this.isSubtype(Up,n);case gd:case bd:case Ed:case Id:case Od:return this.isSubtype(Wo,n);case yd:return this.isSubtype(Fp,n);case Fp:return this.isSubtype(Ua,n)||this.isSubtype(bw,n)||this.isSubtype(Ol,n);case $d:case Nd:case Ld:return this.isSubtype($w,n)||this.isSubtype(Ho,n);case Mp:case Dd:return this.isSubtype(Bp,n);case Bp:case Td:
return this.isSubtype(qp,n);case Sd:case xd:return this.isSubtype(Ol,n);case _d:return this.isSubtype(Ol,n)||this.isSubtype(Wo,n);case Fd:return this.isSubtype(Np,n)||this.isSubtype(Il,n)||this.isSubtype(Ll,n);case jd:case qd:case Gd:return this.isSubtype(Ll,n);case Bd:case zd:return this.isSubtype(zp,n);case zp:return this.isSubtype(Il,n)||this.isSubtype(Ll,n);case Wd:return this.isSubtype(Wo,n)||this.isSubtype(Up,n);case Hd:return this.isSubtype(Ml,n)||this.isSubtype(Bl,n);case Fl:case Kd:return this.
isSubtype(Ml,n);case Ml:case Bl:return this.isSubtype(HC,n);case Vd:return this.isSubtype(Fl,n)||this.isSubtype(Wp,n);case Zd:return this.isSubtype(Fl,n)||this.isSubtype(Hp,n);case jl:case Yd:return this.isSubtype(Bl,n);case Xd:case Jd:return this.isSubtype(Wp,n)||this.isSubtype(jl,n);case Qd:case ef:return this.isSubtype(jl,n)||this.isSubtype(Hp,n);default:return!1}}getReferenceType(e){const n=`${e.container.$type}:${e.property}`;switch(n){case"ColorProperty:customColor":return Ha;case"Deployme\
ntNode:kind":return rs;case"DeploymentRelation:kind":case"DynamicViewStep:kind":case"OutgoingRelationExpr:kind":case"Relation:kind":case"WhereRelationKind:value":return Os;case"DynamicViewGlobalPredicateRef:predicate":return Jo;case"DynamicViewRef:view":return Ko;case"Element:kind":case"ElementKindExpression:kind":return is;case"ElementTagExpression:tag":case"Tags:values":case"WhereElementTag:value":case"WhereRelationParticipantTag:value":case"WhereRelationTag:value":return Ls;case"ElementViewRe\
f:view":return Xo;case"FqnRef:value":case"StrictFqnRef:value":return zo;case"IconProperty:libicon":return as;case"Imported:imported":case"StrictFqnElementRef:el":return vr;case"ViewRef:view":return za;case"ViewRuleGlobalPredicateRef:predicate":return Qo;case"ViewRuleGlobalStyle:style":return cd;case"WhereElementKind:value":case"WhereRelationParticipantKind:value":return yw;default:throw new Error(`${n} is not a valid reference id.`)}}getTypeMetaData(e){switch(e){case ql:return{name:ql,properties:[
{name:"key"},{name:"value"}]};case Ul:return{name:Ul,properties:[{name:"key"},{name:"value"}]};case zl:return{name:zl,properties:[{name:"customColor"},{name:"key"},{name:"themeColor"}]};case Ha:return{name:Ha,properties:[{name:"name"}]};case Kp:return{name:Kp,properties:[{name:"props",defaultValue:[]}]};case Zp:return{name:Zp,properties:[{name:"props",defaultValue:[]}]};case ns:return{name:ns,properties:[{name:"body"},{name:"name"},{name:"target"},{name:"title"}]};case Xp:return{name:Xp,properties:[
{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case Vr:return{name:Vr,properties:[{name:"body"},{name:"kind"},{name:"name"},{name:"title"}]};case Yp:return{name:Yp,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case rs:return{name:rs,properties:[{name:"name"}]};case Jp:return{name:Jp,properties:[{name:"body"},{name:"kind"},{name:"source"},{name:"tags"},{name:"target"},{name:"technology"},{name:"title"}]};case Qp:return{
name:Qp,properties:[{name:"props",defaultValue:[]},{name:"tags"}]};case Wl:return{name:Wl,properties:[{name:"body"},{name:"name"}]};case em:return{name:em,properties:[{name:"props",defaultValue:[]},{name:"rules",defaultValue:[]},{name:"tags"}]};case Hl:return{name:Hl,properties:[{name:"expr"},{name:"isInclude",defaultValue:!1}]};case Vl:return{name:Vl,properties:[{name:"props",defaultValue:[]},{name:"targets"}]};case Zl:return{name:Zl,properties:[{name:"source"},{name:"target"}]};case Ko:return{
name:Ko,properties:[{name:"body"},{name:"name"}]};case tm:return{name:tm,properties:[{name:"props",defaultValue:[]},{name:"rules",defaultValue:[]},{name:"steps",defaultValue:[]},{name:"tags"}]};case Xl:return{name:Xl,properties:[{name:"predicate"}]};case Yl:return{name:Yl,properties:[{name:"exprs"}]};case nm:return{name:nm,properties:[{name:"steps",defaultValue:[]}]};case _w:return{name:_w,properties:[{name:"view"}]};case rm:return{name:rm,properties:[{name:"custom"},{name:"isBackward",defaultValue:!1},
{name:"kind"},{name:"source"},{name:"target"},{name:"title"}]};case vr:return{name:vr,properties:[{name:"body"},{name:"kind"},{name:"name"},{name:"props",defaultValue:[]}]};case im:return{name:im,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case is:return{name:is,properties:[{name:"name"}]};case Jl:return{name:Jl,properties:[{name:"isEqual",defaultValue:!1},{name:"kind"}]};case am:return{name:am,properties:[{name:"modelElement"}]};case Ql:return{name:Ql,
properties:[{name:"key"},{name:"value"}]};case td:return{name:td,properties:[{name:"key"},{name:"props",defaultValue:[]}]};case nd:return{name:nd,properties:[{name:"isEqual",defaultValue:!1},{name:"tag"}]};case Xo:return{name:Xo,properties:[{name:"body"},{name:"extends"},{name:"name"},{name:"viewOf"}]};case um:return{name:um,properties:[{name:"props",defaultValue:[]},{name:"rules",defaultValue:[]},{name:"tags"}]};case Nw:return{name:Nw,properties:[{name:"view"}]};case cm:return{name:cm,properties:[
{name:"prev"},{name:"value"}]};case rd:return{name:rd,properties:[{name:"body"},{name:"deploymentNode"}]};case lm:return{name:lm,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case Ka:return{name:Ka,properties:[{name:"body"},{name:"element"}]};case dm:return{name:dm,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case fm:return{name:fm,properties:[{name:"prev"},{name:"value"}]};case id:return{name:id,properties:[
{name:"subject"},{name:"where"}]};case sd:return{name:sd,properties:[{name:"custom"},{name:"subject"}]};case pm:return{name:pm,properties:[{name:"parent"},{name:"value"}]};case ad:return{name:ad,properties:[{name:"ref"},{name:"selector"}]};case Jo:return{name:Jo,properties:[{name:"name"},{name:"predicates",defaultValue:[]}]};case Qo:return{name:Qo,properties:[{name:"name"},{name:"predicates",defaultValue:[]}]};case eu:return{name:eu,properties:[{name:"name"},{name:"predicates",defaultValue:[]},{
name:"styles",defaultValue:[]}]};case mm:return{name:mm,properties:[{name:"id"},{name:"props",defaultValue:[]},{name:"targets"}]};case gm:return{name:gm,properties:[{name:"id"},{name:"styles",defaultValue:[]}]};case cd:return{name:cd,properties:[{name:"name"}]};case ld:return{name:ld,properties:[{name:"key"},{name:"libicon"},{name:"value"}]};case Is:return{name:Is,properties:[{name:"imported"},{name:"prev"}]};case ym:return{name:ym,properties:[{name:"imports"},{name:"project"}]};case dd:return{name:dd,
properties:[{name:"to"}]};case fd:return{name:fd,properties:[{name:"inout"}]};case as:return{name:as,properties:[{name:"name"}]};case vm:return{name:vm,properties:[{name:"deployments",defaultValue:[]},{name:"globals",defaultValue:[]},{name:"imports",defaultValue:[]},{name:"likec4lib",defaultValue:[]},{name:"models",defaultValue:[]},{name:"specifications",defaultValue:[]},{name:"views",defaultValue:[]}]};case wm:return{name:wm,properties:[{name:"icons",defaultValue:[]}]};case hd:return{name:hd,properties:[
{name:"key"},{name:"value"}]};case md:return{name:md,properties:[{name:"key"},{name:"title"},{name:"value"}]};case gd:return{name:gd,properties:[{name:"key"},{name:"value"}]};case yd:return{name:yd,properties:[{name:"props",defaultValue:[]}]};case nu:return{name:nu,properties:[{name:"elements",defaultValue:[]},{name:"name"}]};case ru:return{name:ru,properties:[{name:"elements",defaultValue:[]},{name:"name"}]};case iu:return{name:iu,properties:[{name:"name"},{name:"styles",defaultValue:[]},{name:"\
views",defaultValue:[]}]};case wd:return{name:wd,properties:[{name:"key"},{name:"value"}]};case Em:return{name:Em,properties:[{name:"key"},{name:"value"}]};case bd:return{name:bd,properties:[{name:"key"},{name:"value"}]};case Ed:return{name:Ed,properties:[{name:"key"},{name:"value"}]};case kd:return{name:kd,properties:[{name:"key"},{name:"value"}]};case Rd:return{name:Rd,properties:[{name:"from"},{name:"isBidirectional",defaultValue:!1},{name:"kind"}]};case $d:return{name:$d,properties:[{name:"k\
ey"},{name:"value"}]};case $m:return{name:$m,properties:[{name:"body"},{name:"kind"},{name:"source"},{name:"tags"},{name:"target"},{name:"technology"},{name:"title"}]};case Dm:return{name:Dm,properties:[{name:"props",defaultValue:[]},{name:"tags"}]};case Dd:return{name:Dd,properties:[{name:"subject"},{name:"where"}]};case Td:return{name:Td,properties:[{name:"custom"},{name:"subject"}]};case Sd:return{name:Sd,properties:[{name:"key"},{name:"value"}]};case Os:return{name:Os,properties:[{name:"name"}]};case _d:
return{name:_d,properties:[{name:"key"},{name:"value"}]};case xd:return{name:xd,properties:[{name:"key"},{name:"props",defaultValue:[]}]};case Pd:return{name:Pd,properties:[{name:"key"},{name:"value"}]};case Nd:return{name:Nd,properties:[{name:"key"},{name:"value"}]};case Cm:return{name:Cm,properties:[{name:"color"},{name:"name"}]};case au:return{name:au,properties:[{name:"kind"},{name:"props",defaultValue:[]}]};case uu:return{name:uu,properties:[{name:"kind"},{name:"props",defaultValue:[]}]};case Id:
return{name:Id,properties:[{name:"key"},{name:"value"}]};case lu:return{name:lu,properties:[{name:"kind"},{name:"props",defaultValue:[]}]};case Od:return{name:Od,properties:[{name:"key"},{name:"value"}]};case fu:return{name:fu,properties:[{name:"colors",defaultValue:[]},{name:"deploymentNodes",defaultValue:[]},{name:"elements",defaultValue:[]},{name:"name"},{name:"relationships",defaultValue:[]},{name:"tags",defaultValue:[]}]};case hu:return{name:hu,properties:[{name:"tag"}]};case xm:return{name:xm,
properties:[{name:"el"},{name:"parent"}]};case Pm:return{name:Pm,properties:[{name:"parent"},{name:"value"}]};case Ls:return{name:Ls,properties:[{name:"name"}]};case Nm:return{name:Nm,properties:[{name:"prev"},{name:"values",defaultValue:[]}]};case Ld:return{name:Ld,properties:[{name:"key"},{name:"value"}]};case Kw:return{name:Kw,properties:[{name:"view"}]};case Fd:return{name:Fd,properties:[{name:"direction"},{name:"nodeSep"},{name:"rankSep"}]};case jd:return{name:jd,properties:[{name:"predicat\
e"}]};case Bd:return{name:Bd,properties:[{name:"style"}]};case qd:return{name:qd,properties:[{name:"groupRules",defaultValue:[]},{name:"props",defaultValue:[]},{name:"title"}]};case Gd:return{name:Gd,properties:[{name:"exprs"},{name:"isInclude",defaultValue:!1}]};case zd:return{name:zd,properties:[{name:"props",defaultValue:[]},{name:"targets"}]};case Wd:return{name:Wd,properties:[{name:"key"},{name:"value"}]};case Hd:return{name:Hd,properties:[{name:"left"},{name:"operator"},{name:"right"}]};case Vd:
return{name:Vd,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case Kd:return{name:Kd,properties:[{name:"value"}]};case Zd:return{name:Zd,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case Xd:return{name:Xd,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case Yd:return{name:Yd,properties:[{name:"value"}]};case Jd:return{name:Jd,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"participant"},{name:"\
value"}]};case Qd:return{name:Qd,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"participant"},{name:"value"}]};case ef:return{name:ef,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case tf:return{name:tf,properties:[{name:"isWildcard",defaultValue:!1}]};default:return{name:e,properties:[]}}}}const K=new R_;let $_;const RW=()=>$_??($_=VG(`{"$type":"Grammar","isDeclared":true,"name":"LikeC4","rules":[{"$type":"ParserRule","entry":true,"name":"LikeC4G\
rammar","definition":{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"imports","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@16"},"arguments":[]}},{"$type":"Assignment","feature":"specifications","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@8"},"arguments":[]}},{"$type":"Assignment","feature":"models","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@19"},"arguments":[]}},{"$type":"Assignment","feature":"\
views","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@39"},"arguments":[]}},{"$type":"Assignment","feature":"globals","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@110"},"arguments":[]}},{"$type":"Assignment","feature":"deployments","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@96"},"arguments":[]}},{"$type":"Assignment","feature":"likec4lib","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@1"},"argum\
ents":[]}}],"cardinality":"*"},"definesHiddenTokens":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LikeC4Lib","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"likec4lib"},{"$type":"Keyword","value":"{"},{"$type":"Keyword","value":"icons"},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"icons","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@2"},"arguments":[]},"cardinality":"+"}\
,{"$type":"Keyword","value":"}"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LibIcon","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@140"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name\
":"ElementKind","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Tag","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragm\
ent":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationshipKind","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CustomColor","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Ru\
leCall","rule":{"$ref":"#/rules@144"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentNodeKind","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name"\
:"SpecificationRule","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"specification"}},{"$type":"Keyword","value":"{"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@9"},"arguments":[]}},{"$type":"Assignment","feature":"tags","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@12"},"argument\
s":[]}},{"$type":"Assignment","feature":"relationships","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@14"},"arguments":[]}},{"$type":"Assignment","feature":"colors","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@13"},"arguments":[]}},{"$type":"Assignment","feature":"deploymentNodes","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@11"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens\
":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationElementKind","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"element"},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@3"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alter\
natives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@10"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@129"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationElementStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","\
terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"technology"},{"$type":"Keyword","value":"notation"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","na\
me":"SpecificationDeploymentNodeKind","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"deploymentNode"},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@7"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@10"},"arguments":[]},{"$type":"RuleCa\
ll","rule":{"$ref":"#/rules@129"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationTag","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"tag"},{"$type":"Assignment","feature":"tag","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@4"},"arguments":[]}}]},"definesH\
iddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationColor","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"color"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@6"},"arguments":[]}},{"$type":"Assignment","feature":"color","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@139"},"arguments":[]}}]},"defi\
nesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationRelationshipKind","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"relationship"},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@5"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","\
terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@132"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@15"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationRelationshipStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","f\
eature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"technology"},{"$type":"Keyword","value":"notation"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":fa\
lse},{"$type":"ParserRule","name":"ImportsFromPoject","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"import"},{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"imports","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@17"},"arguments":[]}},{"$type":"Keyword","value":"}"}]},{"$type":"Assignment","feature":"imports","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref"\
:"#/rules@17"},"arguments":[]}}]},{"$type":"Keyword","value":"from"},{"$type":"Assignment","feature":"project","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Imported","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"imported","operator":"=","terminal":{"$type":"CrossReference","type"\
:{"$ref":"#/rules@20"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Imported"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"imported","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@20"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"d\
eprecatedSyntax":false}}],"cardinality":"*"},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Tags","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"values","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@142"},"arguments":[]},"deprecatedSynt\
ax":false},"cardinality":"+"},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Tags"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"values","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@142"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"*"}],"cardinality":"*"},{"$type":"Keyword","value":";","cardinal\
ity":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Model","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"model"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@24"},"argument\
s":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@31"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":true},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@20"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Element","definition":{"$type":"Group","elements":[{"$type":"Alternatives"\
,"elements":[{"$type":"Group","elements":[{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@3"},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}},{"$type":"RuleCal\
l","rule":{"$ref":"#/rules@161"},"arguments":[]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@3"},"deprecatedSyntax":false}}]}]},{"$type":"Group","elements":[{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rule\
s@163"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]}},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}],"cardinality":"?"}],"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":\
"#/rules@21"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$ty\
pe":"RuleCall","rule":{"$ref":"#/rules@22"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@31"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":false},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@20"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":\
false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@23"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@129"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@116"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@120"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@36"},"arguments":[]}]}\
,"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"title"},{"$type":"Keyword","value":"technology"},{"$type":"Keyword","value":"description"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment"\
,"feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendElement","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"extend"},{"$type":"Assignment","feature":"element","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref\
":"#/rules@28"},"arguments":[]}},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@25"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendElementBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":\
"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@31"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":true},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"\
#/rules@20"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendElementProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@116"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@36"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenToke\
ns":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementRef","definition":{"$type":"Assignment","feature":"modelElement","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"StrictFqnElementRef","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"el","operator":"=","terminal\
":{"$type":"CrossReference","type":{"$ref":"#/rules@20"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"StrictFqnElementRef"},"feature":"parent","operator":"="},{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]},{"$type":"Assignment","feature":"el","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@20"},"ter\
minal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnRef","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@1"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"argum\
ents":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"FqnRef"},"feature":"parent","operator":"="},{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@1"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}]},"definesHidde\
nTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"StrictFqnRef","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@1"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name"\
:"StrictFqnRef"},"feature":"parent","operator":"="},{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@1"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","na\
me":"Relation","parameters":[{"$type":"Parameter","name":"isExplicit"}],"definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Group","guardCondition":{"$type":"ParameterReference","parameter":{"$ref":"#/rules@31/parameters@0"}},"elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]}}]},{"$type":"Group","guardCondition":{"$type":"Negation","value":{"$type":"ParameterReference"\
,"parameter":{"$ref":"#/rules@31/parameters@0"}}},"elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]},"cardinality":"?"}]}]},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@143"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elemen\
ts":[{"$type":"Keyword","value":"-["},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Keyword","value":"->"}]},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCal\
l","rule":{"$ref":"#/rules@163"},"arguments":[]}},{"$type":"Assignment","feature":"technology","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments"\
:[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"wildcard":false},{"$type":"ParserRule","name":"RelationBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@3\
3"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@34"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@69"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@35"},"arguments":[]},{"$type":"RuleCall","rul\
e":{"$ref":"#/rules@116"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@36"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"title"},{"$type":"Keyword","value":"technology"},{"$type\
":"Keyword","value":"description"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationStyleProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment"\
,"feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"style"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@132"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MetadataProperty","definition":{"$type":"Group","elements":[{\
"$type":"Keyword","value":"metadata"},{"$type":"RuleCall","rule":{"$ref":"#/rules@37"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MetadataBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@38"},"arguments":[]},"cardinality":"*"},{"$type":"Keywo\
rd","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MetadataAttribute","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@164"},"arguments":[]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$re\
f":"#/rules@163"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ModelViews","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"views"}},{"$type":"Keyword","value":"{"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"views","operato\
r":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@40"},"arguments":[]}},{"$type":"Assignment","feature":"styles","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@62"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LikeC4ViewRule","returnType":{"$ref":"#/types@2"},"definition":{"$type":"Alternatives"\
,"elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@41"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@42"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@105"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementView","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"view"},{"$type":"Assignment","feature":"name","operator":"=","ter\
minal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"cardinality":"?"},{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Keyword","value":"extends"},{"$type":"Assignment","feature":"extends","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@44"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Keyword","value":"of"},{"$type":"Assignment","feature":"viewOf","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/ru\
les@27"},"arguments":[]}}]}],"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@46"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicView","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"dynamic"},{"$type":"Keyword","value":"view"},{"$type":"Assignment","feature":\
"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@47"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRef","definition":{"$type":"Assignment","feature":"view","operator":"=","terminal":{"$type":"CrossRefere\
nce","type":{"$ref":"#/types@2"},"deprecatedSyntax":false}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementViewRef","definition":{"$type":"Assignment","feature":"view","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@41"},"deprecatedSyntax":false}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"Pa\
rserRule","name":"DynamicViewRef","definition":{"$type":"Assignment","feature":"view","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@42"},"deprecatedSyntax":false}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementViewBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":\
"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@48"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"rules","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@51"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters"\
:[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@48"},"arguments":[]},"cardinality":"*"},{"$type":"Alternatives","elements":[{"$type":"Assignment"\
,"feature":"steps","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@54"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@55"},"arguments":[]}]}},{"$type":"Assignment","feature":"rules","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@53"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wild\
card":false},{"$type":"ParserRule","name":"ViewProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@49"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@116"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","term\
inal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"title"},{"$type":"Keyword","value":"description"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"V\
iewLayoutDirection","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"TopBottom"},{"$type":"Keyword","value":"LeftRight"},{"$type":"Keyword","value":"BottomTop"},{"$type":"Keyword","value":"RightLeft"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRule","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@56"},\
"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@57"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@52"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@62"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@63"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","valu\
e":"group"},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]},"cardinality":"?"},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@117"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@123"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@118"},"arguments":[]}]},"c\
ardinality":"*"},{"$type":"Assignment","feature":"groupRules","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@56"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@52"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewRule","definition":{"$type":"Alternati\
ves","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@58"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@59"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@62"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@63"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewParallelSteps","definition":{"$type":"Group","elements":[{"$type":"Al\
ternatives","elements":[{"$type":"Keyword","value":"parallel"},{"$type":"Keyword","value":"par"}]},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"steps","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@55"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewStep","definition":{"$type":"Gro\
up","elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@27"},"arguments":[]}},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isBackward","operator":"?=","terminal":{"$type":"Keyword","value":"<-"}},{"$type":"Keyword","value":"->"},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules\
@5"},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@143"},"arguments":[]},"deprecatedSyntax":false}}]},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@27"},"arguments":[]}},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type"\
:"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"custom","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@67"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRulePredicate","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":\
"isInclude","operator":"?=","terminal":{"$type":"Keyword","value":"include"}},{"$type":"Keyword","value":"exclude"}]},{"$type":"Assignment","feature":"exprs","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@70"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleGlobalPredicateRef","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"global"},\
{"$type":"Keyword","value":"predicate"},{"$type":"Assignment","feature":"predicate","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@111"},"deprecatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewIncludePredicate","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"include"},{"$type":"Assignment","feature":"exprs","operator":"=",\
"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@70"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewGlobalPredicateRef","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"global"},{"$type":"Keyword","value":"predicate"},{"$type":"Assignment","feature":"predicate","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@112"},"dep\
recatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"style"},{"$type":"Assignment","feature":"targets","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@83"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type"\
:"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@128"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@64"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleGlobalStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"global"},{"$type":"Keyword","value":"style"},{"$type":\
"Assignment","feature":"style","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@113"},"deprecatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleStyleOrGlobalRef","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@61"},"arguments":[]}]},"definesHi\
ddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleAutoLayout","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"autoLayout"},{"$type":"Assignment","feature":"direction","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@50"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"rankSep","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref\
":"#/rules@165"},"arguments":[]}},{"$type":"Assignment","feature":"nodeSep","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@165"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"NotationProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value"\
:"notation"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"NotesProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=",\
"terminal":{"$type":"Keyword","value":"notes"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CustomElementProperties","definition":{"$type":"Group","elements":[{"$type":\
"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@68"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@23"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@64"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@128"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false\
,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CustomRelationProperties","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@69"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@34"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@64"},"arguments":[]},{"$type":"RuleCall"\
,"rule":{"$ref":"#/rules@65"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@132"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"NavigateToProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"navigateTo"}},{"$type":"Assignment","f\
eature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@43"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationNavigateToProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"navigateTo"}},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type\
":"RuleCall","rule":{"$ref":"#/rules@45"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Expressions","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@71"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Expressions"},"fe\
ature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@71"},"arguments":[]},"cardinality":"?"}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExpressionV2","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@74"},"arguments":[\
]},{"$type":"RuleCall","rule":{"$ref":"#/rules@72"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnExprOrWith","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@73"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"FqnExprWith"},"feature":"subject","operator":"="},{"$type":"Keyword","val\
ue":"with"},{"$type":"Assignment","feature":"custom","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@66"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnExprOrWhere","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inf\
erredType":{"$type":"InferredType","name":"FqnExprWhere"},"feature":"subject","operator":"="},{"$type":"Keyword","value":"where"},{"$type":"Assignment","feature":"where","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@84"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationExprOrWith","definition":{"$type":"Group","elemen\
ts":[{"$type":"RuleCall","rule":{"$ref":"#/rules@75"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"RelationExprWith"},"feature":"subject","operator":"="},{"$type":"Keyword","value":"with"},{"$type":"Assignment","feature":"custom","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@67"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens"\
:[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationExprOrWhere","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@78"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"RelationExprWhere"},"feature":"subject","operator":"="},{"$type":"Keyword","value":"where"},{"$type":"Assignment","feature":"where","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@90"},"ar\
guments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnExpr","definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WildcardExpression"}},{"$type":"Assignment","feature":"isWildcard","operator":"?=","terminal":{"$type":"Keyword","value":"*"}}]},{"$type":"Group","elemen\
ts":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ElementTagExpression"}},{"$type":"Keyword","value":"element.tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@147"},"arguments":[]},{"$type":"Assignment","feature":"tag","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@142"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"?"}]},{"$type":"Group","elements":[{"$type":"Action","inferred\
Type":{"$type":"InferredType","name":"ElementKindExpression"}},{"$type":"Keyword","value":"element.kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@147"},"arguments":[]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@3"},"deprecatedSyntax":false},"cardinality":"?"}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@77"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"w\
ildcard":false},{"$type":"ParserRule","name":"FqnRefExpr","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"ref","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]}},{"$type":"Assignment","feature":"selector","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@155"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@156"},"arguments":[]}]},"cardinality":"?"}]},"definesHi\
ddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationExpr","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@79"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@81"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"InOutRelationExpr","inferredType"\
:{"$type":"InferredType","name":"RelationExpr"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@80"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"InOutRelationExpr"},"feature":"inout","operator":"="},{"$type":"Keyword","value":"->"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"I\
ncomingRelationExpr","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"->"},{"$type":"Assignment","feature":"to","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DirectedRelationExpr","inferredType":{"$type":"InferredType","name":"RelationExpr"},"definition":{"$type":"Group","elements":[{"$typ\
e":"RuleCall","rule":{"$ref":"#/rules@82"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"DirectedRelationExpr"},"feature":"source","operator":"="},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]}}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","\
name":"OutgoingRelationExpr","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"from","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]}},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isBidirectional","operator":"?=","terminal":{"$type":"Keyword","value":"<->"}},{"$type":"Keyword","value":"->"},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{"$type":"Assignment","feature":"kind","operator":"=","\
terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@143"},"arguments":[]},"deprecatedSyntax":false}}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTok\
ens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnExpressions","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"FqnExpressions"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"value","operator":"=","termin\
al":{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]},"cardinality":"?"}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElementExpression","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@85"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereE\
lementOr","inferredType":{"$type":"InferredType","name":"WhereElementExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@86"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereBinaryExpression"},"feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"or"}},{"$type":"Assignment","feature":"right","operator":"=","t\
erminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@86"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElementAnd","inferredType":{"$type":"InferredType","name":"WhereElementExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@87"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$t\
ype":"InferredType","name":"WhereBinaryExpression"},"feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"and"}},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@87"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElementPrim\
ary","inferredType":{"$type":"InferredType","name":"WhereElementExpression"},"definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Keyword","value":"("},{"$type":"RuleCall","rule":{"$ref":"#/rules@84"},"arguments":[]},{"$type":"Keyword","value":")"}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@88"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@89"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"para\
meters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElementNegation","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"not"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@84"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElement","definition":{"$type":"Alternatives","elements":[{"$ty\
pe":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereElementTag"}},{"$type":"Keyword","value":"tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@142"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"?"}]},{"$type":"Group","elements":[{"$type":"Action","\
inferredType":{"$type":"InferredType","name":"WhereElementKind"}},{"$type":"Keyword","value":"kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@4"},"deprecatedSyntax":false},"cardinality":"?"}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationExpression\
","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@91"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationOr","inferredType":{"$type":"InferredType","name":"WhereRelationExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@92"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredTy\
pe","name":"WhereBinaryExpression"},"feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"or"}},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@92"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationAnd","inferredType":\
{"$type":"InferredType","name":"WhereRelationExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@93"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereBinaryExpression"},"feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"and"}},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"Rule\
Call","rule":{"$ref":"#/rules@93"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationPrimary","inferredType":{"$type":"InferredType","name":"WhereRelationExpression"},"definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Keyword","value":"("},{"$type":"RuleCall","rule":{"$ref":"#/rules@90"},"arguments":[]},{"$type":"Keywo\
rd","value":")"}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@94"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@95"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationNegation","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"not"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules\
@90"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelation","definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereRelationTag"}},{"$type":"Keyword","value":"tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","\
terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@142"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"?"}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereRelationKind"}},{"$type":"Keyword","value":"kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","typ\
e":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"?"}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereRelationParticipantTag"}},{"$type":"Assignment","feature":"participant","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@138"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]},{"$type":"Keyword","va\
lue":"tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@142"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"?"}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereRelationParticipantKind"}},{"$type":"Assignment","feature":"participant","opera\
tor":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@138"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]},{"$type":"Keyword","value":"kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"?"}]}]},\
"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ModelDeployments","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"deployment"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@97"},"argu\
ments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@103"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":true},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@101"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentNode","definition":{"$type":"Group","elements":[{"$type":"\
Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@7"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","term\
inal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"arguments":[]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@7"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false}}]}]},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]},"c\
ardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@98"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentNodeBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$re\
f":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@22"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@99"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@103"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","tru\
e":false},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@97"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeployedInstance","definition":{"$type":"Group","elements":[{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"\
arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"arguments":[]}],"cardinality":"?"},{"$type":"Keyword","value":"instanceOf"},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@27"},"arguments":[]}},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type"\
:"RuleCall","rule":{"$ref":"#/rules@100"},"arguments":[]},"cardinality":"?"},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeployedInstanceBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"car\
dinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@22"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@103"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":false},"calledByName":false}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment\
":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendDeployment","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"extend"},{"$type":"Assignment","feature":"deploymentNode","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@30"},"arguments":[]}},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@102"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":fa\
lse,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendDeploymentBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"*"},{\
"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@99"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@103"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":true},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@97"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment\
":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentRelation","parameters":[{"$type":"Parameter","name":"isExplicit"}],"definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Group","guardCondition":{"$type":"ParameterReference","parameter":{"$ref":"#/rules@103/parameters@0"}},"elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]\
}}]},{"$type":"Group","guardCondition":{"$type":"Negation","value":{"$type":"ParameterReference","parameter":{"$ref":"#/rules@103/parameters@0"}}},"elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]},"cardinality":"?"}]}]},{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"->"},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{"$type":"Assignment","feature":"kind","operator":"=","\
terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@143"},"arguments":[]},"deprecatedSyntax":false}}]},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$t\
ype":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]}},{"$type":"Assignment","feature":"technology","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":\
"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@104"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentRelationBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"R\
uleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@33"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentView","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"deployment"},{"\
$type":"Keyword","value":"view"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@106"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewBody","definition":{"$type":\
"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@48"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"rules","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@107"},"arguments":[]},"cardinality":"\
*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewRule","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@109"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@108"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@63"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":\
false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewRuleStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"style"},{"$type":"Assignment","feature":"targets","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@83"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/ru\
les@128"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@64"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewRulePredicate","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isInclude","operator":"?=","terminal":{"$type":"Keyword","value":"include\
"}},{"$type":"Keyword","value":"exclude"}]},{"$type":"Assignment","feature":"expr","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@70"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Globals","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"global"}},{"$type":"Keyword","value":"\
{"},{"$type":"Group","elements":[{"$type":"Assignment","feature":"predicates","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@111"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@112"},"arguments":[]}]},"cardinality":"*"},{"$type":"Assignment","feature":"styles","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@114"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"\
#/rules@115"},"arguments":[]}]},"cardinality":"*"}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalPredicateGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"predicateGroup"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@164"},"arguments":[]}},{"$type":"Key\
word","value":"{"},{"$type":"Assignment","feature":"predicates","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@56"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalDynamicPredicateGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"dynamicPredicateGroup"},{"$type":"Assignment","feat\
ure":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@164"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"predicates","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@58"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalStyleId","definition":{"$t\
ype":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@164"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"style"},{"$type":"Assignment","feature":"id","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@113"},"arguments":[]}},{"$type":"\
Assignment","feature":"targets","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@83"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@128"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@64"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":fa\
lse,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalStyleGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"styleGroup"},{"$type":"Assignment","feature":"id","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@113"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"styles","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"cardinality":"*"}\
,{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LinkProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"link"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@141"},"a\
rguments":[]}},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@163"},"arguments":[]},"cardinality":"?"},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ColorProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","\
value":"color"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"themeColor","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@136"},"arguments":[]}},{"$type":"Assignment","feature":"customColor","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@6"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@144"},"arguments":[]},"deprecatedSyntax":false}}]},{"$type":"Keyword","value":\
";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"OpacityProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"opacity"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@162"},"argum\
ents":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MultipleProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"multiple"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCa\
ll","rule":{"$ref":"#/rules@133"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"IconProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"icon"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Alternatives","elements":[{"$type":"Assi\
gnment","feature":"libicon","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@2"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@140"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"none"},{"$type":"RuleCall","rule":{"$ref":"#/rules@141"},"arguments":[]}]}}]},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,\
"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ShapeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"shape"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@137"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"\
?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"BorderStyleValue","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@134"},"arguments":[]},{"$type":"Keyword","value":"none"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"BorderProperty","defin\
ition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"border"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@122"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"Parser\
Rule","name":"SizeValue","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"xs"},{"$type":"Keyword","value":"sm"},{"$type":"Keyword","value":"md"},{"$type":"Keyword","value":"lg"},{"$type":"Keyword","value":"xl"},{"$type":"Keyword","value":"xsmall"},{"$type":"Keyword","value":"small"},{"$type":"Keyword","value":"medium"},{"$type":"Keyword","value":"large"},{"$type":"Keyword","value":"xlarge"}]},"definesHiddenTokens":false,"entry":false,"fragment":fal\
se,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ShapeSizeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"size"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@124"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenToken\
s":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"PaddingSizeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"padding"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@124"},"arguments":[]}},{"$type":"Keyword","value":";\
","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TextSizeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"textSize"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@124"},"argum\
ents":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"StyleProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@117"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@121"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@123"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref"\
:"#/rules@118"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@120"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@119"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@125"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@126"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@127"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","na\
me":"ElementStyleProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"style"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@128"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{\
"$type":"ParserRule","name":"LineProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"line"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@134"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"pa\
rameters":[],"wildcard":false},{"$type":"ParserRule","name":"ArrowProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"head"},{"$type":"Keyword","value":"tail"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@135"},"arguments":[]}},{"$type":"Keyword","value"\
:";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationshipStyleProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@117"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@130"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@131"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":fals\
e,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Boolean","dataType":"boolean","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"true"},{"$type":"Keyword","value":"false"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LineOptions","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"solid"},{"$ty\
pe":"Keyword","value":"dashed"},{"$type":"Keyword","value":"dotted"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ArrowType","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"none"},{"$type":"Keyword","value":"normal"},{"$type":"Keyword","value":"onormal"},{"$type":"Keyword","value":"dot"},{"$type":"Keyword","value":"odot"},{"$type":"Keyword","value":"d\
iamond"},{"$type":"Keyword","value":"odiamond"},{"$type":"Keyword","value":"crow"},{"$type":"Keyword","value":"open"},{"$type":"Keyword","value":"vee"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ThemeColor","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"primary"},{"$type":"Keyword","value":"secondary"},{"$type":"Keyword","value":"muted"},{"$type":"\
Keyword","value":"slate"},{"$type":"Keyword","value":"blue"},{"$type":"Keyword","value":"indigo"},{"$type":"Keyword","value":"sky"},{"$type":"Keyword","value":"red"},{"$type":"Keyword","value":"gray"},{"$type":"Keyword","value":"green"},{"$type":"Keyword","value":"amber"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementShape","dataType":"string","definition":{"$type":"Alternatives","elements":[{\
"$type":"Keyword","value":"rectangle"},{"$type":"Keyword","value":"person"},{"$type":"Keyword","value":"browser"},{"$type":"Keyword","value":"mobile"},{"$type":"Keyword","value":"cylinder"},{"$type":"Keyword","value":"storage"},{"$type":"Keyword","value":"queue"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Participant","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"K\
eyword","value":"source"},{"$type":"Keyword","value":"target"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CustomColorValue","dataType":"string","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@157"},"arguments":[]},{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@16\
6"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@165"},"arguments":[]}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"IconId","dataType":"string","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@152"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Uri","dataType":"stri\
ng","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@153"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@154"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TagId","dataType":"string","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@157"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#\
/rules@145"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DotId","dataType":"string","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"Pars\
erRule","name":"CustomColorId","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@164"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@137"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@135"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@134"},"arguments":[]},{"$type":"Keyword","value":"element"},{"$type":"Keyword","value":"model"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"\
hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Id","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@164"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@137"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@136"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@135"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@134"},"arguments":[]},{"$type":"RuleCa\
ll","rule":{"$ref":"#/rules@138"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@124"},"arguments":[]},{"$type":"Keyword","value":"element"},{"$type":"Keyword","value":"model"},{"$type":"Keyword","value":"group"},{"$type":"Keyword","value":"node"},{"$type":"Keyword","value":"deployment"},{"$type":"Keyword","value":"instance"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","fragment":true,"name":"\
EqOperator","definition":{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"is"}},{"$type":"Assignment","feature":"not","operator":"?=","terminal":{"\
$type":"Keyword","value":"not"},"cardinality":"?"}]}]},"definesHiddenTokens":false,"entry":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","fragment":true,"name":"IsEqual","definition":{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isEqual","operator":"?=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"\
hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"TerminalRule","hidden":true,"name":"BLOCK_COMMENT","definition":{"$type":"RegexToken","regex":"/\\\\/\\\\*[\\\\s\\\\S]*?\\\\*\\\\//"},"fragment":false},{"$type":"TerminalRule","hidden":true,"name":"LINE_COMMENT","definition":{"$type":"RegexToken","regex":"/\\\\/\\\\/[^\\\\n\\\\r]*/"},"fragment":false},{"$type":"TerminalRule","hidden":true,"name":"WS","definition":{"$type":"RegexToken","regex":"/[\\\\t ]+/"},"fragment":false},{"$type":"TerminalRule","hidden"\
:true,"name":"NL","definition":{"$type":"RegexToken","regex":"/[\\\\r\\\\n]+/"},"fragment":false},{"$type":"TerminalRule","name":"LIB_ICON","definition":{"$type":"RegexToken","regex":"/(aws|azure|gcp|tech):[-\\\\w]*/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"URI_WITH_SCHEMA","definition":{"$type":"RegexToken","regex":"/\\\\w+:\\\\/{2}\\\\S+/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"URI_RELATIVE","definition":{"$type":"RegexToken","regex":"/\\\\.{0,2}\\\\/[^\\\\/]\
\\\\S+/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"DotUnderscore","definition":{"$type":"RegexToken","regex":"/\\\\b\\\\._(?![_a-zA-Z])/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"DotWildcard","definition":{"$type":"RegexToken","regex":"/\\\\b\\\\.\\\\*{1,2}/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Hash","definition":{"$type":"CharacterRange","left":{"$type":"Keyword","value":"#"}},"fragment":false,"hidden":false},{"$type":"TerminalR\
ule","name":"StickyDot","definition":{"$type":"RegexToken","regex":"/\\\\b\\\\./"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Dot","definition":{"$type":"CharacterRange","left":{"$type":"Keyword","value":"."}},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"NotEqual","definition":{"$type":"RegexToken","regex":"/\\\\!\\\\={1,2}/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Eq","definition":{"$type":"RegexToken","regex":"/\\\\={1,2}/"},"fragment":\
false,"hidden":false},{"$type":"TerminalRule","name":"Percent","definition":{"$type":"RegexToken","regex":"/\\\\b\\\\d+%/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"String","definition":{"$type":"RegexToken","regex":"/\\"[^\\"]*\\"|'[^']*'/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"IdTerminal","definition":{"$type":"RegexToken","regex":"/[_]*[a-zA-Z][-\\\\w]*/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Number","type":{"$type":"Retur\
nType","name":"number"},"definition":{"$type":"RegexToken","regex":"/\\\\b\\\\d+\\\\b/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Hex","definition":{"$type":"RegexToken","regex":"/\\\\b[a-zA-Z0-9]+\\\\b/"},"fragment":false,"hidden":false}],"types":[{"$type":"Type","name":"ModelReferenceable","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@20"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@17"}}]}},{"$type":"Type","name":"Referenceable","typ\
e":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@97"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@99"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@20"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@17"}}]}},{"$type":"Type","name":"LikeC4View","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@41"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@42"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@105"}}]}},{"\
$type":"Type","name":"StringProperty","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@23"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@49"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@34"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@38"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@10"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@15"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@64"}},{"$type":"SimpleType","typeRef":{"$ref":\
"#/rules@65"}}]}},{"$type":"Type","name":"DeploymentNodeOrElementKind","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@3"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@7"}}]}},{"$type":"Type","name":"WhereTagEqual","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@89/definition/elements@0/elements@0/inferredType"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@95/definition/elements@0/elements@0/inferredType"}},{"$\
type":"SimpleType","typeRef":{"$ref":"#/rules@95/definition/elements@2/elements@0/inferredType"}}]}},{"$type":"Type","name":"WhereKindEqual","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@89/definition/elements@1/elements@0/inferredType"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@95/definition/elements@1/elements@0/inferredType"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@95/definition/elements@3/elements@0/inferredType"}}]}},{"$type":"Type",\
"name":"WhereExpression","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@84"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@90"}}]}},{"$type":"Type","name":"DeploymentElement","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@97"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@99"}}]}},{"$type":"Type","name":"FqnReferenceable","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/types@1"}}\
,{"$type":"SimpleType","typeRef":{"$ref":"#/rules@20"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@24"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@101"}}]}},{"$type":"Type","name":"SizeProperty","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@125"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@126"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@127"}}]}}],"definesHiddenTokens":false,"hiddenTokens":[],"imports":[],"interfaces":[],"usedGra\
mmars":[]}`)),Yw={languageId:"likec4",fileExtensions:[".c4",".likec4",".like-c4"],caseInsensitive:!1,mode:"production"},$W={skipValidations:!0,recoveryEnabled:!0,nodeLocationTracking:"full"},DW={AstReflection:()=>new R_},TW={Grammar:()=>RW(),LanguageMetaData:()=>Yw,parser:{ParserConfig:()=>$W}},SW=[...Object.entries({aws:["activate","alexa-for-business","amplify","apache-mxnet-on-aws","api-gateway","app-config","app-flow","app-mesh","app-runner","app-stream","app-sync","application-auto-scaling",
"application-composer","application-cost-profiler","application-discovery-service","application-migration-service","artifact","athena","audit-manager","augmented-ai-a2i","aurora","auto-scaling","backint-agent","backup","batch","billing-conductor","bottlerocket","braket","budgets","certificate-manager","chatbot","chime","chime-sdk","chime-voice-connector","clean-rooms","client-vpn","cloud-control-api","cloud-development-kit","cloud-directory","cloud-formation","cloud-front","cloud-hsm","cloud-map",
"cloud-search","cloud-shell","cloud-trail","cloud-wan","cloud-watch","cloud9","code-artifact","code-build","code-catalyst","code-commit","code-deploy","code-guru","code-pipeline","code-star","code-whisperer","cognito","command-line-interface","comprehend","comprehend-medical","compute-optimizer","config","connect","console-mobile-application","control-tower","corretto","cost-and-usage-report","cost-explorer","data-exchange","data-pipeline","data-sync","data-zone","database-migration-service","de\
ep-composer","deep-learning-amis","deep-learning-containers","deep-lens","deep-racer","detective","dev-ops-guru","device-farm","direct-connect","directory-service","distro-for-open-telemetry","document-db","dynamo-db","ec2","ec2-auto-scaling","ec2-image-builder","ecs-anywhere","efs","eks-anywhere","eks-cloud","eks-distro","elasti-cache","elastic-beanstalk","elastic-block-store","elastic-container-registry","elastic-container-service","elastic-disaster-recovery","elastic-fabric-adapter","elastic-\
inference","elastic-kubernetes-service","elastic-load-balancing","elastic-transcoder","elemental-appliances-software","elemental-conductor","elemental-delta","elemental-link","elemental-live","elemental-media-connect","elemental-media-convert","elemental-media-live","elemental-media-package","elemental-media-store","elemental-media-tailor","elemental-server","emr","event-bridge","express-workflows","fargate","fault-injection-simulator","file-cache","fin-space","firewall-manager","forecast","frau\
d-detector","free-rtos","fsx","fsx-for-lustre","fsx-for-net-app-ontap","fsx-for-open-zfs","fsx-for-wfs","game-kit","game-lift","game-sparks","genomics-cli","global-accelerator","glue","glue-data-brew","glue-elastic-views","ground-station","guard-duty","health-lake","honeycode","iam-identity-center","identity-and-access-management","inspector","interactive-video-service","io-t-1-click","io-t-analytics","io-t-button","io-t-core","io-t-device-defender","io-t-device-management","io-t-edu-kit","io-t-\
events","io-t-express-link","io-t-fleet-wise","io-t-greengrass","io-t-robo-runner","io-t-site-wise","io-t-things-graph","io-t-twin-maker","iq","kendra","key-management-service","keyspaces","kinesis","kinesis-data-analytics","kinesis-data-streams","kinesis-firehose","kinesis-video-streams","lake-formation","lambda","launch-wizard","lex","license-manager","lightsail","local-zones","location-service","lookout-for-equipment","lookout-for-metrics","lookout-for-vision","lumberyard","macie","mainframe-\
modernization","managed-blockchain","managed-grafana","managed-service-for-prometheus","managed-services","managed-streaming-for-apache-kafka","managed-workflows-for-apache-airflow","management-console","marketplace-dark","marketplace-light","memory-db-for-redis","migration-evaluator","migration-hub","monitron","mq","neptune","network-firewall","neuron","nice-dcv","nice-engin-frame","nimble-studio","nitro-enclaves","omics","open-3d-engine","open-search-service","ops-works","organizations","outpo\
sts-family","outposts-rack","outposts-servers","panorama","parallel-cluster","personal-health-dashboard","personalize","pinpoint","pinpoint-apis","polly","private-5g","private-certificate-authority","private-link","professional-services","proton","quantum-ledger-database","quick-sight","rds","rds-on-vmware","re-post","red-hat-open-shift-service-on-aws","redshift","rekognition","reserved-instance-reporting","resilience-hub","resource-access-manager","resource-explorer","robo-maker","route-53","s3\
-on-outposts","sage-maker","sage-maker-ground-truth","sage-maker-studio-lab","savings-plans","secrets-manager","security-hub","security-lake","server-migration-service","serverless-application-repository","service-catalog","service-management-connector","shield","signer","sim-space-weaver","simple-email-service","simple-notification-service","simple-queue-service","simple-storage-service","simple-storage-service-glacier","site-to-site-vpn","snowball","snowball-edge","snowcone","snowmobile","step\
-functions","storage-gateway","sumerian","supply-chain","support","systems-manager","tensor-flow-on-aws","textract","thinkbox-deadline","thinkbox-frost","thinkbox-krakatoa","thinkbox-sequoia","thinkbox-stoke","thinkbox-xmesh","timestream","tools-and-sdks","torch-serve","training-certification","transcribe","transfer-family","transit-gateway","translate","trusted-advisor","verified-access","verified-permissions","virtual-private-cloud","vmware-cloud-on-aws","vpc-lattice","waf","wavelength","well-\
architected-tool","wickr","work-docs","work-docs-sdk","work-link","work-mail","work-spaces-family","x-ray"],azure:["abs-member","active-directory-connect-health","activity-log","administrative-units","advisor","ai-studio","aks-automatic","aks-istio","alerts","all-resources","analysis-services","anomaly-detector","api-center","api-connections","api-management-services","api-proxy","app-compliance-automation","app-configuration","app-registrations","app-service-certificates","app-service-domains",
"app-service-environments","app-service-plans","app-services","app-space","app-space-component","applens","application-gateway-containers","application-gateways","application-group","application-insights","application-security-groups","aquila","arc-data-services","arc-kubernetes","arc-machines","arc-postgre-sql","arc-sql-managed-instance","arc-sql-server","atm-multistack","auto-scale","automanaged-vm","automation-accounts","availability-sets","avs-vm","azure-a","azure-ad-b2c","azure-api-for-fhir",
"azure-applied-ai-services","azure-arc","azure-attestation","azure-backup-center","azure-blockchain-service","azure-center-for-sap","azure-chaos-studio","azure-cloud-shell","azure-communication-services","azure-communications-gateway","azure-compute-galleries","azure-cosmos-db","azure-data-catalog","azure-data-explorer-clusters","azure-database-maria-db-server","azure-database-migration-services","azure-database-my-sql-server","azure-database-postgre-sql-server","azure-database-postgre-sql-serve\
r-group","azure-databox-gateway","azure-databricks","azure-deployment-environments","azure-dev-ops","azure-dev-tunnels","azure-edge-hardware-center","azure-experimentation-studio","azure-fileshares","azure-firewall-manager","azure-firewall-policy","azure-hcp-cache","azure-hpc-workbenches","azure-hybrid-center","azure-information-protection","azure-io-t-operations","azure-lighthouse","azure-load-testing","azure-managed-grafana","azure-maps-accounts","azure-media-service","azure-migrate","azure-mo\
nitor-dashboard","azure-monitor-pipeline","azure-monitors-for-sap-solutions","azure-net-app-files","azure-network-function-manager","azure-network-function-manager-functions","azure-object-understanding","azure-open-ai","azure-operator-5g-core","azure-operator-insights","azure-operator-nexus","azure-operator-service-manager","azure-orbital","azure-programmable-connectivity","azure-purview-accounts","azure-quotas","azure-red-hat-open-shift","azure-sentinel","azure-service-bus","azure-sphere","azu\
re-spring-apps","azure-sql","azure-sql-edge","azure-sql-server-stretch-databases","azure-sql-vm","azure-stack","azure-stack-edge","azure-stack-hci-sizer","azure-storage-mover","azure-support-center-blue","azure-sustainability","azure-synapse-analytics","azure-token-service","azure-video-indexer","azure-virtual-desktop","azure-vmware-solution","azure-workbooks","azurite","backlog","backup-vault","bare-metal-infrastructure","bastions","batch-accounts","batch-ai","biz-talk","blob-block","blob-page",
"blockchain-applications","blueprints","bonsai","bot-services","branch","browser","bug","builds","business-process-tracking","cache","cache-redis","capacity","capacity-reservation-groups","cdn-profiles","central-service-instance-for-sap","ceres","change-analysis","client-apps","cloud-services-classic","cloud-services-extended-support","cloud-test","code","code-optimization","cognitive-search","cognitive-services","cognitive-services-decisions","collaborative-service","commit","community-images",
"compliance","compliance-center","compute-fleet","computer-vision","conditional-access","confidential-ledgers","connected-cache","connected-vehicle-platform","connections","consortium","container-apps-environments","container-instances","container-registries","container-services-deprecated","content-moderators","content-safety","controls","controls-horizontal","cost-alerts","cost-analysis","cost-budgets","cost-export","cost-management","cost-management-and-billing","counter","cubes","custom-ip-p\
refix","custom-vision","customer-lockbox-for-microsoft-azure","dashboard","dashboard-hub","data-box","data-collection-rules","data-factories","data-lake-analytics","data-lake-storage-gen1","data-lake-store-gen1","data-share-invitations","data-shares","database-instance-for-sap","ddo-s-protection-plans","dedicated-hsm","defender-cm-local-manager","defender-dcs-controller","defender-distributer-control-system","defender-engineering-station","defender-external-management","defender-freezer-monitor",
"defender-historian","defender-hmi","defender-industrial-packaging-system","defender-industrial-printer","defender-industrial-robot","defender-industrial-scale-system","defender-marquee","defender-meter","defender-plc","defender-pneumatic-device","defender-programable-board","defender-relay","defender-robot-controller","defender-rtu","defender-sensor","defender-slot","defender-web-guiding-system","detonation","dev-console","dev-ops-starter","dev-test-labs","device-compliance","device-configurati\
on","device-enrollment","device-provisioning-services","device-security-apple","device-security-google","device-security-windows","device-update-io-t-hub","devices","diagnostics-settings","digital-twins","disk-encryption-sets","disk-pool","disks","disks-classic","disks-snapshots","dns-multistack","dns-private-resolver","dns-security-policy","dns-zones","download","e-books","edge-management","education","elastic-job-agents","elastic-san","endpoint-analytics","enterprise-applications","entra-conne\
ct","entra-connect-health","entra-connect-sync","entra-domain-services","entra-global-secure-access","entra-id-protection","entra-identity-custom-roles","entra-identity-licenses","entra-identity-risky-signins","entra-identity-risky-users","entra-identity-roles-and-administrators","entra-internet-access","entra-managed-identities","entra-private-access","entra-privleged-identity-management","entra-verified-id","error","event-grid-domains","event-grid-subscriptions","event-grid-topics","event-hub-\
clusters","event-hubs","exchange-access","exchange-on-premises-access","express-route-circuits","express-route-direct","express-route-traffic-collector","extended-security-updates","extensions","external-identities","face-apis","feature-previews","fhir-service","fiji","file","files","firewalls","folder-blank","folder-website","form-recognizers","free-services","front-door-and-cdn-profiles","ftp","function-apps","gear","genomics","genomics-accounts","globe-error","globe-success","globe-warning","\
groups","guide","hd-insight-clusters","hdi-aks-cluster","heart","help-and-support","host-groups","host-pools","hosts","ic-m-troubleshooting","identity-governance","identity-multi-factor-authentication","identity-secure-score","image","image-definitions","image-templates","image-versions","images","immersive-readers","import-export-jobs","industrial-io-t","information","infrastructure-backup","input-output","instance-pools","integration-accounts","integration-environments","integration-service-en\
vironments","internet-analyzer-profiles","intune","intune-app-protection","intune-for-education","intune-trends","io-t-central-applications","io-t-edge","io-t-hub","ip-address-manager","ip-groups","journey-hub","key-vaults","keys","kubernetes-fleet-manager","kubernetes-services","lab-accounts","lab-services","language","language-understanding","launch-portal","learn","load-balancer-hub","load-balancers","load-test","load-testing","local-network-gateways","location","log-analytics-query-pack","lo\
g-analytics-workspaces","log-streaming","logic-apps","logic-apps-custom-connector","machine-learning","machine-learning-studio-classic-web-services","machine-learning-studio-web-service-plans","machine-learning-studio-workspaces","machines-azure-arc","maintenance-configuration","managed-applications-center","managed-database","managed-desktop","managed-dev-ops-pools","managed-file-shares","managed-identities","managed-instance-apache-cassandra","managed-service-fabric","management-groups","manag\
ement-portal","marketplace","marketplace-management","med-tech-service","media","media-file","mesh-applications","metrics","metrics-advisor","microsoft-defender-easm","microsoft-defender-for-cloud","microsoft-defender-for-io-t","microsoft-dev-box","mindaro","mission-landing-zone","mobile","mobile-engagement","mobile-networks","modular-data-center","module","monitor","monitor-health-models","multi-tenancy","multifactor-authentication","my-customers","nat","network-interfaces","network-managers","\
network-security-groups","network-security-perimeters","network-watcher","notification-hub-namespaces","notification-hubs","offers","on-premises-data-gateways","open-supply-chain-platform","operation-log-classic","oracle-database","os-images-classic","osconfig","outbound-connection","partner-namespace","partner-registration","partner-topic","peering-service","peerings","personalizers","plans","policy","power","power-bi-embedded","power-platform","power-up","powershell","preview-features","privat\
e-endpoints","private-link","private-link-service","private-link-services","process-explorer","production-ready-database","proximity-placement-groups","public-ip-addresses","public-ip-addresses-classic","public-ip-prefixes","qn-a-makers","quickstart-center","recent","recovery-services-vaults","region-management","relays","remote-rendering","reservations","reserved-capacity","reserved-ip-addresses-classic","resource-explorer","resource-graph-explorer","resource-group-list","resource-groups","reso\
urce-guard","resource-linked","resource-management-private-link","resource-mover","resources-provider","restore-points","restore-points-collections","route-filters","route-tables","rtos","savings-plans","scheduler","scheduler-job-collections","scvmm-management-servers","search","search-grid","security","security-baselines","send-grid-accounts","server-farm","serverless-search","service-catalog-mad","service-endpoint-policies","service-fabric-clusters","service-health","service-providers","shared\
-image-galleries","signal-r","software-as-a-service","software-updates","solutions","sonic-dash","spatial-anchor-accounts","speech-services","spot-vm","spot-vmss","sql-data-warehouses","sql-database","sql-elastic-pools","sql-managed-instance","sql-server","sql-server-registries","ssd","ssh-keys","ssis-lift-and-shift-ir","stack-hci-premium","static-apps","stor-simple-data-managers","stor-simple-device-managers","storage-accounts","storage-accounts-classic","storage-actions","storage-azure-files",
"storage-container","storage-explorer","storage-functions","storage-queue","storage-sync-services","stream-analytics-jobs","subnet","subscriptions","system-topic","table","tag","tags","targets-management","template-specs","templates","tenant-properties","tenant-status","test-base","tfs-vc-repository","time-series-data-sets","time-series-insights-access-policies","time-series-insights-environments","time-series-insights-event-sources","toolbox","traffic-manager-profiles","translator-text","troubl\
eshoot","universal-print","update-management-center","updates","user-privacy","user-settings","user-subscriptions","users","verifiable-credentials","verification-as-a-service","versions","video-analyzers","virtual-clusters","virtual-enclaves","virtual-instance-for-sap","virtual-machine","virtual-machines-classic","virtual-network-gateways","virtual-networks","virtual-networks-classic","virtual-router","virtual-visits-builder","virtual-wan-hub","virtual-wans","vm-app-definitions","vm-app-versions",
"vm-image-version","vm-images-classic","vm-scale-sets","wac","wac-installer","web-app-database","web-application-firewall-policies-waf","web-jobs","web-slots","web-test","website-power","website-staging","windows-notification-services","windows10-core-services","workbooks","worker-container-app","workflow","workspace-gateway","workspaces"],gcp:["access-context-manager","administration","advanced-agent-modeling","advanced-solutions-lab","agent-assist","ai-hub","ai-platform","ai-platform-unified",
"analytics-hub","anthos","anthos-config-management","anthos-service-mesh","api","api-analytics","api-monetization","apigee-api-platform","apigee-sense","app-engine","artifact-registry","asset-inventory","assured-workloads","auto-ml","auto-ml-natural-language","auto-ml-tables","auto-ml-translation","auto-ml-video-intelligence","auto-ml-vision","bare-metal-solutions","batch","beyondcorp","big-query","bigtable","billing","binary-authorization","catalog","certificate-authority-service","certificate-\
manager","cloud-api-gateway","cloud-apis","cloud-armor","cloud-asset-inventory","cloud-audit-logs","cloud-build","cloud-cdn","cloud-code","cloud-composer","cloud-data-fusion","cloud-deploy","cloud-deployment-manager","cloud-dns","cloud-domains","cloud-ekm","cloud-endpoints","cloud-external-ip-addresses","cloud-firewall-rules","cloud-for-marketing","cloud-functions","cloud-generic","cloud-gpu","cloud-healthcare-api","cloud-healthcare-marketplace","cloud-hsm","cloud-ids","cloud-inference-api","clo\
ud-interconnect","cloud-jobs-api","cloud-load-balancing","cloud-logging","cloud-media-edge","cloud-monitoring","cloud-nat","cloud-natural-language-api","cloud-network","cloud-ops","cloud-optimization-ai","cloud-optimization-ai-fleet-routing-api","cloud-router","cloud-routes","cloud-run","cloud-run-for-anthos","cloud-scheduler","cloud-security-scanner","cloud-shell","cloud-spanner","cloud-sql","cloud-storage","cloud-tasks","cloud-test-lab","cloud-tpu","cloud-translation-api","cloud-vision-api","c\
loud-vpn","compute-engine","configuration-management","connectivity-test","connectors","contact-center-ai","container-optimized-os","container-registry","data-catalog","data-labeling","data-layers","data-loss-prevention-api","data-qn-a","data-studio","data-transfer","database-migration-service","dataflow","datalab","dataplex","datapol","dataprep","dataproc","dataproc-metastore","datashare","datastore","datastream","debugger","developer-portal","dialogflow","dialogflow-cx","dialogflow-insights","\
document-ai","early-access-center","error-reporting","eventarc","filestore","financial-services-marketplace","firestore","fleet-engine","free-trial","game-servers","gce-systems-management","genomics","gke-on-prem","google-cloud-marketplace","google-kubernetes-engine","google-maps-platform","healthcare-nlp-api","home","identity-and-access-management","identity-aware-proxy","identity-platform","iot-core","iot-edge","key-access-justifications","key-management-service","kuberun","launcher","local-ss\
d","looker","managed-service-for-microsoft-active-directory","media-translation-api","memorystore","migrate-for-anthos","migrate-for-compute-engine","my-cloud","network-connectivity-center","network-intelligence-center","network-security","network-tiers","network-topology","onboarding","os-configuration-management","os-inventory-management","os-patch-management","partner-interconnect","partner-portal","performance-dashboard","permissions","persistent-disk","phishing-protection","policy-analyzer",
"premium-network-tier","private-connectivity","private-service-connect","producer-portal","profiler","project","pub-sub","quantum-engine","quotas","real-world-insights","recommendations-ai","release-notes","retail-api","risk-manager","runtime-config","secret-manager","security","security-command-center","security-health-advisor","security-key-enforcement","service-discovery","speech-to-text","stackdriver","standard-network-tier","stream-suite","support","tensorflow-enterprise","text-to-speech","\
tools-for-powershell","trace","traffic-director","transfer","transfer-appliance","user-preferences","vertex-ai","video-intelligence-api","virtual-private-cloud","visual-inspection","vmware-engine","web-risk","web-security-scanner","workflows","workload-identity-pool"],tech:["aarch64","adobe-illustrator","adobe-photoshop","adobe-premiere-pro","adobe-xd","adonis-js","after-effects","airflow","akka","algolia","alpine-js","amazon-web-services","anaconda","android","android-studio","angular","angular\
-js","ansible","ant-design","apache","apl","appcelerator","apple","apple-safari","appwrite","arch-linux","arduino","argo-cd","astro","atom","autodesk-maya","autodesk-shot-grid","awk","azios","azure","azure-devops","azure-sql-database","babel","backbone-js","ballerina","bamboo","bash","behance","bitbucket","blender","bootstrap","bower","browserstack","bulma","bun","c","cairo-graphics","cake-php","canva","capacitor","cassandra","cent-os","chrome","circle-ci","clarity","clion","clojure","clojure-sc\
ript","cloudflare","cloudflare-workers","cmake","code-igniter","code-pen","codeac","codecov","coffee-script","composer","confluence","consul","contao","corejs","cosmosdb","couchdb","cplusplus","crystal","csharp","css3","cucumber","cypress","d3js","dart","data-grip","data-spell","dbeaver","debian","deno","devicon","digital-ocean","discord-js","django","django-rest","docker","doctrine","dropwizard","drupal","eclipse-ceylon","eclipse-ide","eclipse-vert-x","elasticbeats","elasticsearch","electron","\
eleventy-11ty","elixir","elm","embedded-c","ember-js","envoy","erlang","eslint","express","facebook","fast-api","fastify","fauna","feathers","fedora","figma","file-zilla","firebase","firefox","flask","flutter","fortran","foundation","fsharp","gatling","gatsby","gazebo","gcc","gentoo","ghost","gimp","git","gitbook","github","github-actions","github-codespaces","gitlab","gitpod","gitter","gnu-emacs","go","go-land","godot-engine","google","google-cloud","gradle","grafana","grails","graphql","groovy",
"grunt-js","gulp-js","hadoop","handlebars","hardhat","harvester","hashicorp-vault","haskell","haxe","helm","heroku","hibernate","homebrew","html5","hugo","ibm-spss-statistics","ie10","ifttt","influxdb","inkscape","insomnia","intellij-idea","ionic","jaeger","jamstack","jasmine","java","javascript","jeet","jekyll","jenkins","jest","jetbrains","jira","jira-align","jquery","json","jule","julia","junit","jupyter","k3os","k3s","kafka","kaggle","karate","karma","keras","kibana","knex-js","knockout","ko\
tlin","krakenjs","ktor","kubernetes","labview","laravel","latex","less-js","linkedin","linux","liquibase","livewire","llvm","logstash","lua","lumen","magento","markdown","material-ui","materialize","matlab","matplotlib","maven","meteor-js","microsoft-sql-server","minitab","mob-x","mocha","modx","moleculer","mongodb","mongoose-js","moodle","ms-dos","mysql","nano","nerog","nestjs","net","net-core","network-x","new4j","nextjs","nginx","nhibernate","nim","nimble","nix","nodejs","nodemon","nodewebkit",
"npm","nuget","num-py","nuxt-js","objective-c","ocaml","oh-my-zsh","okta","open-al","open-api","open-cl","open-cv","open-gl","open-stack","open-suse","open-telemetry","opera","oracle","p5js","packer","pandas","perl","pf-sense","phalcon","phoenix-framework","photon-engine","php","php-storm","playwrite","ploty","podman","polygon","portainer","postcss","postgresql","postman","powershell","processing","prometheus","protractor","purescript","putty","pycharm","pyscript","pytest","python","python-poetr\
y","pytorch","qodana","qt","quarkus","quasar","qwik","r","rabbitmq","rancher","raspberrypi","reach","react","react-bootstrap","realm","red-cube-s-epic-compiler-thingy-programming-re-ct","redhat","redis","redux","ren-py","rider","robot-operating-system-ros","rocksdb","rollup-js","rspec","rstudio","ruby","ruby-mine","ruby-on-rails","rust","salesforce","sanity","sass","scala","scalingo","sdl","selenium","sema-software","sequelize","shopware","sketch","slack","socket-io","solid-js","solidity","sonar\
qube","sourcetree","spark","splunk","spring","sql-developer","sqlalchemy","sqlite","ssh","stackoverflow","stata","storybook","streamlit","stylus","subversion","svelte","swagger","swift","symfony","tailwind-css","tauri","tensorflow","terraform","tex","the-algorithms","three-js","titanium-sdk","tomcat","tortoise-git","tower","traefik-mesh","traefik-proxy","travis-ci","trello","twitter","typescript","typo3","ubuntu","uml","unity","unix","unreal-engine","uwsgi","v8","vagrant","vala","vercel","veutif\
y","vim","visualstudio","vite","vitejs","vscode","vsphere","vue","vue-storefront","vyper","webassembly","webflow","weblate","webpack","webstorm","windows8","windows11","woo-commerce","wordpress","xamarin","xcode","xml","yaml","yarn","yii-framework","yuno-host","zend-framework","zig"]})].flatMap(([t,e])=>e.map(n=>t+":"+n)),D_=["likec4lib {","  icons {",...SW.map(t=>"    "+t),"  }","}"].join(`
`),T_="likec4builtin",CW=`${T_}:///likec4/lib/icons.c4`;function nf(t){return t.scheme===T_}const lt=Fn.getChild("server");function rf(t){lt.error(Jn(t))}function Ae(t){lt.warn(Jn(t))}var Jw,S_;function _W(){return S_||(S_=1,Jw=IC()),Jw}var AW=_W();const C_=fi(AW),xW=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,__=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,PW=/^([/\\]\s*){2,}[^/\\]/,NW=/^\.?\//;function Qw(t){return["./","../"].some(e=>t.startsWith(e))}function Fs(t,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),
e.strict?xW.test(t):__.test(t)||(e.acceptRelative?PW.test(t):!1)}function IW(t="",e){return t.endsWith("/")}function OW(t="",e){return(IW(t)?t.slice(0,-1):t)||"/"}function A_(t="",e){return t.endsWith("/")?t:t+"/"}function sf(t=""){return t.startsWith("/")}function x_(t=""){return(sf(t)?t.slice(1):t)||"/"}function LW(t=""){return sf(t)?t:"/"+t}function FW(t,e){if(MW(e))return t;const n=OW(e);if(!t.startsWith(n))return t;const r=t.slice(n.length);return r[0]==="/"?r:"/"+r}function MW(t){return!t||
t==="/"}function jW(t){return t&&t!=="/"}function P_(t,...e){let n=t||"";for(const r of e.filter(i=>jW(i)))if(n){const i=r.replace(NW,"");n=A_(n)+i}else n=r;return n}function Om(...t){const e=/\/(?!\/)/,n=t.filter(Boolean),r=[];let i=0;for(const a of n)if(!(!a||a==="/")){for(const[o,u]of a.split(e).entries())if(!(!u||u===".")){if(u===".."){if(r.length===1&&Fs(r[0]))continue;r.pop(),i--;continue}if(o===1&&r[r.length-1]?.endsWith(":/")){r[r.length-1]+="/"+u;continue}r.push(u),i++}}let s=r.join("/");
return i>=0?n[0]?.startsWith("/")&&!s.startsWith("/")?s="/"+s:n[0]?.startsWith("./")&&!s.startsWith("./")&&(s="./"+s):s="../".repeat(-1*i)+s,n[n.length-1]?.endsWith("/")&&!s.endsWith("/")&&(s+="/"),s}function N_(t){return eb(t,"")}function eb(t,e){let n=t.match(__);return n||(n=t.match(/^\/{2,}/)),n?e+t.slice(n[0].length):e+t}const BW=Symbol.for("ufo:protocolRelative");function qW(t="",e){const n=t.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(n){const[,f,d=""]=n;return{protocol:f.
toLowerCase(),pathname:d,href:f+d,auth:"",host:"",search:"",hash:""}}if(!Fs(t,{acceptRelative:!0}))return mu(t);const[,r="",i,s=""]=t.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,a="",o=""]=s.match(/([^#/?]*)(.*)?/)||[];r==="file:"&&(o=o.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:u,search:c,hash:l}=mu(o);return{protocol:r.toLowerCase(),auth:i?i.slice(0,Math.max(0,i.length-1)):"",host:a,pathname:u,search:c,hash:l,[BW]:!r}}function mu(t=""){const[e="",n="",r=""]=(t.
match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:n,hash:r}}const GW=/\/([^/]+)$/;function UW(t="",e){const{pathname:n}=qW(t),r=n.match(GW);return r?r[1]:void 0}var zW=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,WW=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,
HW=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,
tb={Space_Separator:zW,ID_Start:WW,ID_Continue:HW},Yt={isSpaceSeparator(t){return typeof t=="string"&&tb.Space_Separator.test(t)},isIdStartChar(t){return typeof t=="string"&&(t>="a"&&t<="z"||t>="A"&&t<="Z"||t==="$"||t==="_"||tb.ID_Start.test(t))},isIdContinueChar(t){return typeof t=="string"&&(t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9"||t==="$"||t==="_"||t==="\u200C"||t==="\u200D"||tb.ID_Continue.test(t))},isDigit(t){return typeof t=="string"&&/[0-9]/.test(t)},isHexDigit(t){return typeof t==
"string"&&/[0-9A-Fa-f]/.test(t)}};let nb,Vn,us,Lm,Ms,Kr,pn,rb,af;var VW=function(e,n){nb=String(e),Vn="start",us=[],Lm=0,Ms=1,Kr=0,pn=void 0,rb=void 0,af=void 0;do pn=KW(),YW[Vn]();while(pn.type!=="eof");return typeof n=="function"?ib({"":af},"",n):af};function ib(t,e,n){const r=t[e];if(r!=null&&typeof r=="object")if(Array.isArray(r))for(let i=0;i<r.length;i++){const s=String(i),a=ib(r,s,n);a===void 0?delete r[s]:Object.defineProperty(r,s,{value:a,writable:!0,enumerable:!0,configurable:!0})}else
for(const i in r){const s=ib(r,i,n);s===void 0?delete r[i]:Object.defineProperty(r,i,{value:s,writable:!0,enumerable:!0,configurable:!0})}return n.call(t,e,r)}let We,Me,of,cs,tt;function KW(){for(We="default",Me="",of=!1,cs=1;;){tt=ls();const t=I_[We]();if(t)return t}}function ls(){if(nb[Lm])return String.fromCodePoint(nb.codePointAt(Lm))}function ee(){const t=ls();return t===`
`?(Ms++,Kr=0):t?Kr+=t.length:Kr++,t&&(Lm+=t.length),t}const I_={default(){switch(tt){case"	":case"\v":case"\f":case" ":case"\xA0":case"\uFEFF":case`
`:case"\r":case"\u2028":case"\u2029":ee();return;case"/":ee(),We="comment";return;case void 0:return ee(),It("eof")}if(Yt.isSpaceSeparator(tt)){ee();return}return I_[Vn]()},comment(){switch(tt){case"*":ee(),We="multiLineComment";return;case"/":ee(),We="singleLineComment";return}throw Ot(ee())},multiLineComment(){switch(tt){case"*":ee(),We="multiLineCommentAsterisk";return;case void 0:throw Ot(ee())}ee()},multiLineCommentAsterisk(){switch(tt){case"*":ee();return;case"/":ee(),We="default";return;case void 0:
throw Ot(ee())}ee(),We="multiLineComment"},singleLineComment(){switch(tt){case`
`:case"\r":case"\u2028":case"\u2029":ee(),We="default";return;case void 0:return ee(),It("eof")}ee()},value(){switch(tt){case"{":case"[":return It("punctuator",ee());case"n":return ee(),Xa("ull"),It("null",null);case"t":return ee(),Xa("rue"),It("boolean",!0);case"f":return ee(),Xa("alse"),It("boolean",!1);case"-":case"+":ee()==="-"&&(cs=-1),We="sign";return;case".":Me=ee(),We="decimalPointLeading";return;case"0":Me=ee(),We="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"\
8":case"9":Me=ee(),We="decimalInteger";return;case"I":return ee(),Xa("nfinity"),It("numeric",1/0);case"N":return ee(),Xa("aN"),It("numeric",NaN);case'"':case"'":of=ee()==='"',Me="",We="string";return}throw Ot(ee())},identifierNameStartEscape(){if(tt!=="u")throw Ot(ee());ee();const t=sb();switch(t){case"$":case"_":break;default:if(!Yt.isIdStartChar(t))throw O_();break}Me+=t,We="identifierName"},identifierName(){switch(tt){case"$":case"_":case"\u200C":case"\u200D":Me+=ee();return;case"\\":ee(),We=
"identifierNameEscape";return}if(Yt.isIdContinueChar(tt)){Me+=ee();return}return It("identifier",Me)},identifierNameEscape(){if(tt!=="u")throw Ot(ee());ee();const t=sb();switch(t){case"$":case"_":case"\u200C":case"\u200D":break;default:if(!Yt.isIdContinueChar(t))throw O_();break}Me+=t,We="identifierName"},sign(){switch(tt){case".":Me=ee(),We="decimalPointLeading";return;case"0":Me=ee(),We="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":Me=ee(),We="decimalInt\
eger";return;case"I":return ee(),Xa("nfinity"),It("numeric",cs*(1/0));case"N":return ee(),Xa("aN"),It("numeric",NaN)}throw Ot(ee())},zero(){switch(tt){case".":Me+=ee(),We="decimalPoint";return;case"e":case"E":Me+=ee(),We="decimalExponent";return;case"x":case"X":Me+=ee(),We="hexadecimal";return}return It("numeric",cs*0)},decimalInteger(){switch(tt){case".":Me+=ee(),We="decimalPoint";return;case"e":case"E":Me+=ee(),We="decimalExponent";return}if(Yt.isDigit(tt)){Me+=ee();return}return It("numeric",
cs*Number(Me))},decimalPointLeading(){if(Yt.isDigit(tt)){Me+=ee(),We="decimalFraction";return}throw Ot(ee())},decimalPoint(){switch(tt){case"e":case"E":Me+=ee(),We="decimalExponent";return}if(Yt.isDigit(tt)){Me+=ee(),We="decimalFraction";return}return It("numeric",cs*Number(Me))},decimalFraction(){switch(tt){case"e":case"E":Me+=ee(),We="decimalExponent";return}if(Yt.isDigit(tt)){Me+=ee();return}return It("numeric",cs*Number(Me))},decimalExponent(){switch(tt){case"+":case"-":Me+=ee(),We="decimalE\
xponentSign";return}if(Yt.isDigit(tt)){Me+=ee(),We="decimalExponentInteger";return}throw Ot(ee())},decimalExponentSign(){if(Yt.isDigit(tt)){Me+=ee(),We="decimalExponentInteger";return}throw Ot(ee())},decimalExponentInteger(){if(Yt.isDigit(tt)){Me+=ee();return}return It("numeric",cs*Number(Me))},hexadecimal(){if(Yt.isHexDigit(tt)){Me+=ee(),We="hexadecimalInteger";return}throw Ot(ee())},hexadecimalInteger(){if(Yt.isHexDigit(tt)){Me+=ee();return}return It("numeric",cs*Number(Me))},string(){switch(tt){case"\
\\":ee(),Me+=ZW();return;case'"':if(of)return ee(),It("string",Me);Me+=ee();return;case"'":if(!of)return ee(),It("string",Me);Me+=ee();return;case`
`:case"\r":throw Ot(ee());case"\u2028":case"\u2029":JW(tt);break;case void 0:throw Ot(ee())}Me+=ee()},start(){switch(tt){case"{":case"[":return It("punctuator",ee())}We="value"},beforePropertyName(){switch(tt){case"$":case"_":Me=ee(),We="identifierName";return;case"\\":ee(),We="identifierNameStartEscape";return;case"}":return It("punctuator",ee());case'"':case"'":of=ee()==='"',We="string";return}if(Yt.isIdStartChar(tt)){Me+=ee(),We="identifierName";return}throw Ot(ee())},afterPropertyName(){if(tt===
":")return It("punctuator",ee());throw Ot(ee())},beforePropertyValue(){We="value"},afterPropertyValue(){switch(tt){case",":case"}":return It("punctuator",ee())}throw Ot(ee())},beforeArrayValue(){if(tt==="]")return It("punctuator",ee());We="value"},afterArrayValue(){switch(tt){case",":case"]":return It("punctuator",ee())}throw Ot(ee())},end(){throw Ot(ee())}};function It(t,e){return{type:t,value:e,line:Ms,column:Kr}}function Xa(t){for(const e of t){if(ls()!==e)throw Ot(ee());ee()}}function ZW(){switch(ls()){case"\
b":return ee(),"\b";case"f":return ee(),"\f";case"n":return ee(),`
`;case"r":return ee(),"\r";case"t":return ee(),"	";case"v":return ee(),"\v";case"0":if(ee(),Yt.isDigit(ls()))throw Ot(ee());return"\0";case"x":return ee(),XW();case"u":return ee(),sb();case`
`:case"\u2028":case"\u2029":return ee(),"";case"\r":return ee(),ls()===`
`&&ee(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":throw Ot(ee());case void 0:throw Ot(ee())}return ee()}function XW(){let t="",e=ls();if(!Yt.isHexDigit(e)||(t+=ee(),e=ls(),!Yt.isHexDigit(e)))throw Ot(ee());return t+=ee(),String.fromCodePoint(parseInt(t,16))}function sb(){let t="",e=4;for(;e-- >0;){const n=ls();if(!Yt.isHexDigit(n))throw Ot(ee());t+=ee()}return String.fromCodePoint(parseInt(t,16))}const YW={start(){if(pn.type==="eof")throw Ya();ab()},beforePropertyName(){
switch(pn.type){case"identifier":case"string":rb=pn.value,Vn="afterPropertyName";return;case"punctuator":Fm();return;case"eof":throw Ya()}},afterPropertyName(){if(pn.type==="eof")throw Ya();Vn="beforePropertyValue"},beforePropertyValue(){if(pn.type==="eof")throw Ya();ab()},beforeArrayValue(){if(pn.type==="eof")throw Ya();if(pn.type==="punctuator"&&pn.value==="]"){Fm();return}ab()},afterPropertyValue(){if(pn.type==="eof")throw Ya();switch(pn.value){case",":Vn="beforePropertyName";return;case"}":Fm()}},
afterArrayValue(){if(pn.type==="eof")throw Ya();switch(pn.value){case",":Vn="beforeArrayValue";return;case"]":Fm()}},end(){}};function ab(){let t;switch(pn.type){case"punctuator":switch(pn.value){case"{":t={};break;case"[":t=[];break}break;case"null":case"boolean":case"numeric":case"string":t=pn.value;break}if(af===void 0)af=t;else{const e=us[us.length-1];Array.isArray(e)?e.push(t):Object.defineProperty(e,rb,{value:t,writable:!0,enumerable:!0,configurable:!0})}if(t!==null&&typeof t=="object")us.
push(t),Array.isArray(t)?Vn="beforeArrayValue":Vn="beforePropertyName";else{const e=us[us.length-1];e==null?Vn="end":Array.isArray(e)?Vn="afterArrayValue":Vn="afterPropertyValue"}}function Fm(){us.pop();const t=us[us.length-1];t==null?Vn="end":Array.isArray(t)?Vn="afterArrayValue":Vn="afterPropertyValue"}function Ot(t){return Mm(t===void 0?`JSON5: invalid end of input at ${Ms}:${Kr}`:`JSON5: invalid character '${L_(t)}' at ${Ms}:${Kr}`)}function Ya(){return Mm(`JSON5: invalid end of input at ${Ms}\
:${Kr}`)}function O_(){return Kr-=5,Mm(`JSON5: invalid identifier character at ${Ms}:${Kr}`)}function JW(t){console.warn(`JSON5: '${L_(t)}' in strings is not valid ECMAScript; consider escaping`)}function L_(t){const e={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(e[t])return e[t];if(t<" "){const n=t.charCodeAt(0).toString(16);return"\\x"+("00"+n).substring(n.length)}return t}function Mm(t){const e=new SyntaxError(
t);return e.lineNumber=Ms,e.columnNumber=Kr,e}var QW=function(e,n,r){const i=[];let s="",a,o,u="",c;if(n!=null&&typeof n=="object"&&!Array.isArray(n)&&(r=n.space,c=n.quote,n=n.replacer),typeof n=="function")o=n;else if(Array.isArray(n)){a=[];for(const w of n){let v;typeof w=="string"?v=w:(typeof w=="number"||w instanceof String||w instanceof Number)&&(v=String(w)),v!==void 0&&a.indexOf(v)<0&&a.push(v)}}return r instanceof Number?r=Number(r):r instanceof String&&(r=String(r)),typeof r=="number"?r>
0&&(r=Math.min(10,Math.floor(r)),u="          ".substr(0,r)):typeof r=="string"&&(u=r.substr(0,10)),l("",{"":e});function l(w,v){let g=v[w];switch(g!=null&&(typeof g.toJSON5=="function"?g=g.toJSON5(w):typeof g.toJSON=="function"&&(g=g.toJSON(w))),o&&(g=o.call(v,w,g)),g instanceof Number?g=Number(g):g instanceof String?g=String(g):g instanceof Boolean&&(g=g.valueOf()),g){case null:return"null";case!0:return"true";case!1:return"false"}if(typeof g=="string")return f(g);if(typeof g=="number")return String(
g);if(typeof g=="object")return Array.isArray(g)?p(g):d(g)}function f(w){const v={"'":.1,'"':.2},g={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let b="";for(let _=0;_<w.length;_++){const I=w[_];switch(I){case"'":case'"':v[I]++,b+=I;continue;case"\0":if(Yt.isDigit(w[_+1])){b+="\\x00";continue}}if(g[I]){b+=g[I];continue}if(I<" "){let Z=I.charCodeAt(0).toString(16);b+="\\x"+("00"+Z).substring(Z.length);
continue}b+=I}const k=c||Object.keys(v).reduce((_,I)=>v[_]<v[I]?_:I);return b=b.replace(new RegExp(k,"g"),g[k]),k+b+k}function d(w){if(i.indexOf(w)>=0)throw TypeError("Converting circular structure to JSON5");i.push(w);let v=s;s=s+u;let g=a||Object.keys(w),b=[];for(const _ of g){const I=l(_,w);if(I!==void 0){let Z=h(_)+":";u!==""&&(Z+=" "),Z+=I,b.push(Z)}}let k;if(b.length===0)k="{}";else{let _;if(u==="")_=b.join(","),k="{"+_+"}";else{let I=`,
`+s;_=b.join(I),k=`{
`+s+_+`,
`+v+"}"}}return i.pop(),s=v,k}function h(w){if(w.length===0)return f(w);const v=String.fromCodePoint(w.codePointAt(0));if(!Yt.isIdStartChar(v))return f(w);for(let g=v.length;g<w.length;g++)if(!Yt.isIdContinueChar(String.fromCodePoint(w.codePointAt(g))))return f(w);return w}function p(w){if(i.indexOf(w)>=0)throw TypeError("Converting circular structure to JSON5");i.push(w);let v=s;s=s+u;let g=[];for(let k=0;k<w.length;k++){const _=l(String(k),w);g.push(_!==void 0?_:"null")}let b;if(g.length===0)b=
"[]";else if(u==="")b="["+g.join(",")+"]";else{let k=`,
`+s,_=g.join(k);b=`[
`+s+_+`,
`+v+"]"}return i.pop(),s=v,b}};const e9={parse:VW,stringify:QW};var F_=e9,ob;function M_(t){return{lang:t?.lang??ob?.lang,message:t?.message,abortEarly:t?.abortEarly??ob?.abortEarly,abortPipeEarly:t?.abortPipeEarly??ob?.abortPipeEarly}}var t9;function n9(t){return t9?.get(t)}var r9;function i9(t){return r9?.get(t)}var s9;function a9(t,e){return s9?.get(t)?.get(e)}function o9(t){const e=typeof t;return e==="string"?`"${t}"`:e==="number"||e==="bigint"||e==="boolean"?`${t}`:e==="object"||e==="funct\
ion"?(t&&Object.getPrototypeOf(t)?.constructor?.name)??"null":e}function uf(t,e,n,r,i){const s=i&&"input"in i?i.input:n.value,a=i?.expected??t.expects??null,o=i?.received??o9(s),u={kind:t.kind,type:t.type,input:s,expected:a,received:o,message:`Invalid ${e}: ${a?`Expected ${a} but r`:"R"}eceived ${o}`,requirement:t.requirement,path:i?.path,issues:i?.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},c=t.kind==="schema",l=i?.message??t.message??a9(t.reference,u.lang)??(c?i9(
u.lang):null)??r.message??n9(u.lang);l!==void 0&&(u.message=typeof l=="function"?l(u):l),c&&(n.typed=!1),n.issues?n.issues.push(u):n.issues=[u]}function cf(t){return{version:1,vendor:"valibot",validate(e){return t["~run"]({value:e},M_())}}}var u9=class extends Error{constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function jm(t){return{kind:"metadata",type:"description",reference:jm,description:t}}function j_(t){return{kind:"validation",type:"non_empty",reference:j_,async:!1,
expects:"!0",message:t,"~run"(e,n){return e.typed&&e.value.length===0&&uf(this,"length",e,n,{received:"0"}),e}}}function c9(t,e,n){return typeof t.fallback=="function"?t.fallback(e,n):t.fallback}function B_(t,e,n){return typeof t.default=="function"?t.default(e,n):t.default}function q_(t,e){return{kind:"schema",type:"array",reference:q_,expects:"Array",async:!1,item:t,message:e,get"~standard"(){return cf(this)},"~run"(n,r){const i=n.value;if(Array.isArray(i)){n.typed=!0,n.value=[];for(let s=0;s<
i.length;s++){const a=i[s],o=this.item["~run"]({value:a},r);if(o.issues){const u={type:"array",origin:"value",input:i,key:s,value:a};for(const c of o.issues)c.path?c.path.unshift(u):c.path=[u],n.issues?.push(c);if(n.issues||(n.issues=o.issues),r.abortEarly){n.typed=!1;break}}o.typed||(n.typed=!1),n.value.push(o.value)}}else uf(this,"type",n,r);return n}}}function G_(t,e){return{kind:"schema",type:"object",reference:G_,expects:"Object",async:!1,entries:t,message:e,get"~standard"(){return cf(this)},
"~run"(n,r){const i=n.value;if(i&&typeof i=="object"){n.typed=!0,n.value={};for(const s in this.entries){const a=this.entries[s];if(s in i||(a.type==="exact_optional"||a.type==="optional"||a.type==="nullish")&&a.default!==void 0){const o=s in i?i[s]:B_(a),u=a["~run"]({value:o},r);if(u.issues){const c={type:"object",origin:"value",input:i,key:s,value:o};for(const l of u.issues)l.path?l.path.unshift(c):l.path=[c],n.issues?.push(l);if(n.issues||(n.issues=u.issues),r.abortEarly){n.typed=!1;break}}u.
typed||(n.typed=!1),n.value[s]=u.value}else if(a.fallback!==void 0)n.value[s]=c9(a);else if(a.type!=="exact_optional"&&a.type!=="optional"&&a.type!=="nullish"&&(uf(this,"key",n,r,{input:void 0,expected:`"${s}"`,path:[{type:"object",origin:"key",input:i,key:s,value:i[s]}]}),r.abortEarly))break}}else uf(this,"type",n,r);return n}}}function ub(t,e){return{kind:"schema",type:"optional",reference:ub,expects:`(${t.expects} | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return cf(this)},"~\
run"(n,r){return n.value===void 0&&(this.default!==void 0&&(n.value=B_(this,n,r)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function cb(t){return{kind:"schema",type:"string",reference:cb,expects:"string",async:!1,message:t,get"~standard"(){return cf(this)},"~run"(e,n){return typeof e.value=="string"?e.typed=!0:uf(this,"type",e,n),e}}}function l9(t,e,n){const r=t["~run"]({value:e},M_(n));if(r.issues)throw new u9(r.issues);return r.value}function Bm(...t){return{...t[0],pipe:t,get"\
~standard"(){return cf(this)},"~run"(e,n){for(const r of t)if(r.kind!=="metadata"){if(e.issues&&(r.kind==="schema"||r.kind==="transformation")){e.typed=!1;break}(!e.issues||!n.abortEarly&&!n.abortPipeEarly)&&(e=r["~run"](e,n))}return e}}}const U_=Bm(cb(),j_()),d9=G_({name:Bm(U_,jm("Project name, must be unique in the workspace")),contactPerson:ub(Bm(U_,jm("A person who has been involved in creating or maintaining this project"))),exclude:ub(Bm(q_(cb()),jm('List of file patterns to exclude from t\
he project, default is ["**/node_modules/**/*"]')))});function f9(t){return h9(F_.parse(t))}function h9(t){return l9(d9,t)}const z_=lt.getChild("ProjectsManager");class Tn{constructor(e){this.services=e,z_.debug`created`}static DefaultProjectId="default";static ConfigFileNames=[".likec4rc",".likec4.config.json","likec4.config.json"];projectIdToFolder=new f1;_projects=[];defaultGlobalProject={id:Tn.DefaultProjectId,config:{name:Tn.DefaultProjectId,exclude:["**/node_modules/**/*"]},exclude:C_("**/\
node_modules/**/*")};get defaultProjectId(){if(!(this._projects.length>1))return this._projects[0]?.id??Tn.DefaultProjectId}get all(){return Ar(this._projects,1)?[...Ht(this._projects,Ui("id")),Tn.DefaultProjectId]:[Tn.DefaultProjectId]}getProject(e){const n=typeof e=="string"?e:e.likec4ProjectId||this.belongsTo(e);if(n===Tn.DefaultProjectId){const s=this.services.workspace.WorkspaceManager.workspaceUri;return{id:n,folder:s,config:this.defaultGlobalProject.config}}const{config:r,folder:i}=Vt(this.
_projects.find(s=>s.id===n),`Project "${n}" not found`);return{id:n,folder:_t.parse(i),config:r}}ensureProjectId(e){return e===Tn.DefaultProjectId?e:e?(Fe(this.projectIdToFolder.has(e),`Project ID ${e} is not registered`),e):Vt(this.defaultProjectId,()=>`Specify exact project, known: [${[...this.projectIdToFolder.keys()].join(", ")}]`)}hasMultipleProjects(){return this._projects.length>1}checkIfExcluded(e){let n=e.toString();const r=this.findProjectForDocument(n);return r.exclude?r.exclude(N_(n)):
!1}isConfigFile(e){const n=UW(e.uri.toString())?.toLowerCase();return!!n&&Tn.ConfigFileNames.includes(n)}async loadConfigFile(e){if(!e.isDirectory&&this.isConfigFile(e))return await this.registerProject(e.uri)}async registerProject(e){if(_t.isUri(e)){const u=e,c=await this.services.workspace.FileSystemProvider.readFile(u),l=f9(c),f=Om(u.path,".."),d=u.with({path:f});return this.registerProject({config:l,folderUri:d})}const{config:n,folderUri:r}=e;let i=n.name,s=1;for(;this.projectIdToFolder.has(
i);)i=`${n.name}-${s++}`;let a;_t.isUri(r)?a=r.toString():a=Fs(r)?r:eb(r,"file://");const o={id:i,config:n,folder:a};return Ft(n.exclude)?o.exclude=this.defaultGlobalProject.exclude:Ar(n.exclude,1)&&(o.exclude=C_(n.exclude)),this._projects=et([...this._projects,o],lU([({folder:u})=>N_(u).split("/").length,"desc"])),this.projectIdToFolder.set(i,a),z_.info`register project ${i} folder: ${a}`,o}belongsTo(e){let n;return typeof e=="string"?n=Fs(e)?e:eb(e,"file://"):_t.isUri(e)?n=e.toString():n=e.uri.
toString(),this.findProjectForDocument(n).id}findProjectForDocument(e){return this.mappingsToProject.get(e,()=>this._projects.find(({folder:n})=>e.startsWith(n))??this.defaultGlobalProject)}_mappingsToProject;get mappingsToProject(){return this._mappingsToProject??=new vp(this.services),this._mappingsToProject}}const p9={fileSystemProvider:()=>new y9},m9=[...Yw.fileExtensions,...Tn.ConfigFileNames],g9=t=>m9.some(e=>t.endsWith(e));let y9=class extends Hz{async readFile(e){return nf(e)?Promise.resolve(
D_):await super.readFile(e)}async readDirectory(e){const n=[];try{const r=await new Wz.fdir().withSymlinks({resolvePaths:!1}).withFullPaths().filter(g9).crawl(e.fsPath).withPromise();for(const i of r)n.push({isFile:!0,isDirectory:!1,uri:_t.file(i)})}catch(r){rf(r)}return n}};var st;(function(t){t.assertEqual=i=>i;function e(i){}t.assertIs=e;function n(i){throw new Error}t.assertNever=n,t.arrayToEnum=i=>{const s={};for(const a of i)s[a]=a;return s},t.getValidEnumValues=i=>{const s=t.objectKeys(i).
filter(o=>typeof i[i[o]]!="number"),a={};for(const o of s)a[o]=i[o];return t.objectValues(a)},t.objectValues=i=>t.objectKeys(i).map(function(s){return i[s]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&s.push(a);return s},t.find=(i,s)=>{for(const a of i)if(s(a))return a},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function r(i,s="\
 | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}t.joinValues=r,t.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(st||(st={}));var lb;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(lb||(lb={}));const be=st.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ds=t=>{switch(typeof t){case"undefined":return be.undefined;case"string":return be.
string;case"number":return isNaN(t)?be.nan:be.number;case"boolean":return be.boolean;case"function":return be.function;case"bigint":return be.bigint;case"symbol":return be.symbol;case"object":return Array.isArray(t)?be.array:t===null?be.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?be.promise:typeof Map<"u"&&t instanceof Map?be.map:typeof Set<"u"&&t instanceof Set?be.set:typeof Date<"u"&&t instanceof Date?be.date:be.object;default:return be.unknown}},ie=st.arrayToEnum(
["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),v9=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Er extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=
(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(s){return s.message},r={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,u=0;
for(;u<a.path.length;){const c=a.path[u];u===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return i(this),r}static assert(e){if(!(e instanceof Er))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,st.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const i of this.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||
[],n[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Er.create=t=>new Er(t);const gu=(t,e)=>{let n;switch(t.code){case ie.invalid_type:t.received===be.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ie.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,st.jsonStringifyReplacer)}`;break;case ie.unrecognized_keys:n=`Unrecognized key(s) in object: ${st.joinValues(t.keys,",\
 ")}`;break;case ie.invalid_union:n="Invalid input";break;case ie.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${st.joinValues(t.options)}`;break;case ie.invalid_enum_value:n=`Invalid enum value. Expected ${st.joinValues(t.options)}, received '${t.received}'`;break;case ie.invalid_arguments:n="Invalid function arguments";break;case ie.invalid_return_type:n="Invalid function return type";break;case ie.invalid_date:n="Invalid date";break;case ie.invalid_string:typeof t.validation==
"object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:st.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ie.
too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than\
 "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ie.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?
"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ie.custom:n="Invalid input";break;case ie.invalid_intersection_types:n="Intersection results could not be merged";break;case ie.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ie.not_finite:n="Number must be finite";break;default:n=e.defaultError,st.assertNever(
t)}return{message:n}};let W_=gu;function w9(t){W_=t}function qm(){return W_}const Gm=t=>{const{data:e,path:n,errorMaps:r,issueData:i}=t,s=[...n,...i.path||[]],a={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let o="";const u=r.filter(c=>!!c).slice().reverse();for(const c of u)o=c(a,{data:e,defaultError:o}).message;return{...i,path:s,message:o}},b9=[];function ye(t,e){const n=qm(),r=Gm({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,
n,n===gu?void 0:gu].filter(i=>!!i)});t.common.issues.push(r)}class Nn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const i of n){if(i.status==="aborted")return Oe;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const i of n){const s=await i.key,a=await i.value;r.push({key:s,value:a})}return Nn.
mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const i of n){const{key:s,value:a}=i;if(s.status==="aborted"||a.status==="aborted")return Oe;s.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(r[s.value]=a.value)}return{status:e.value,value:r}}}const Oe=Object.freeze({status:"aborted"}),yu=t=>({status:"dirty",value:t}),Kn=t=>({status:"valid",value:t}),db=t=>t.status==="aborted",fb=t=>t.status==="dirty",Ja=t=>t.status===
"valid",lf=t=>typeof Promise<"u"&&t instanceof Promise;function Um(t,e,n,r){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function H_(t,e,n,r,i){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}typeof SuppressedError=="function"&&SuppressedError;var De;(function(t){t.errToObj=e=>typeof e==
"string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(De||(De={}));var df,ff;class $i{constructor(e,n,r,i){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const V_=(t,e)=>{if(Ja(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation f\
ailed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Er(t.common.issues);return this._error=n,this._error}}};function qe(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:i}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,o)=>{var u,c;const{message:l}=t;return a.code==="invalid_enum_va\
lue"?{message:l??o.defaultError}:typeof o.data>"u"?{message:(u=l??r)!==null&&u!==void 0?u:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(c=l??n)!==null&&c!==void 0?c:o.defaultError}},description:i}}class Ge{get description(){return this._def.description}_getType(e){return ds(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:ds(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Nn,
ctx:{common:e.parent.common,data:e.data,parsedType:ds(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(lf(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const i={common:{issues:[],async:(r=n?.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n?.errorMap},
path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ds(e)},s=this._parseSync({data:e,path:i.path,parent:i});return V_(i,s)}"~validate"(e){var n,r;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ds(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:i});return Ja(s)?{value:s.value}:{issues:i.common.issues}}catch(s){!((r=(n=s?.message)===null||n===void 0?void 0:
n.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(s=>Ja(s)?{value:s.value}:{issues:i.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ds(
e)},i=this._parse({data:e,path:r.path,parent:r}),s=await(lf(i)?i:Promise.resolve(i));return V_(r,s)}refine(e,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,s)=>{const a=e(i),o=()=>s.addIssue({code:ie.custom,...r(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,n){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(e){return new Zr(
{schema:this,typeName:oe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.
optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=
this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Xr.create(this,this._def)}nullable(){return js.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return oi.create(this)}promise(){return bu.create(this,this._def)}or(e){return gf.create([this,e],this._def)}and(e){return yf.create(this,e,this._def)}transform(e){return new Zr({...qe(this._def),schema:this,typeName:oe.
ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Ef({...qe(this._def),innerType:this,defaultValue:n,typeName:oe.ZodDefault})}brand(){return new mb({typeName:oe.ZodBranded,type:this,...qe(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new kf({...qe(this._def),innerType:this,catchValue:n,typeName:oe.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Gf.create(this,
e)}readonly(){return Rf.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const E9=/^c[^\s-]{8,}$/i,k9=/^[0-9a-z]+$/,R9=/^[0-9A-HJKMNP-TV-Z]{26}$/i,$9=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,D9=/^[a-z0-9_-]{21}$/i,T9=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,S9=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,
C9=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_9="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let hb;const A9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,x9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,P9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,
N9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,
I9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,O9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,K_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",L9=new RegExp(`^${K_}$`);function Z_(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=
`${e}(\\.\\d+)?`),e}function F9(t){return new RegExp(`^${Z_(t)}$`)}function X_(t){let e=`${K_}T${Z_(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function M9(t,e){return!!((e==="v4"||!e)&&A9.test(t)||(e==="v6"||!e)&&P9.test(t))}function j9(t,e){if(!T9.test(t))return!1;try{const[n]=t.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!=
"object"||i===null||!i.typ||!i.alg||e&&i.alg!==e)}catch{return!1}}function B9(t,e){return!!((e==="v4"||!e)&&x9.test(t)||(e==="v6"||!e)&&N9.test(t))}class ui extends Ge{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==be.string){const s=this._getOrReturnCtx(e);return ye(s,{code:ie.invalid_type,expected:be.string,received:s.parsedType}),Oe}const r=new Nn;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),ye(i,{code:ie.
too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),ye(i,{code:ie.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const a=e.data.length>s.value,o=e.data.length<s.value;(a||o)&&(i=this._getOrReturnCtx(e,i),a?ye(i,{code:ie.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):o&&ye(i,{code:ie.
too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")C9.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"email",code:ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")hb||(hb=new RegExp(_9,"u")),hb.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"emoji",code:ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")$9.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"\
uuid",code:ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")D9.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"nanoid",code:ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")E9.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"cuid",code:ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")k9.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"cuid2",code:ie.invalid_string,message:s.message}),r.
dirty());else if(s.kind==="ulid")R9.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"ulid",code:ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),ye(i,{validation:"url",code:ie.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"regex",code:ie.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?
e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),ye(i,{code:ie.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),ye(i,{code:ie.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="\
endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),ye(i,{code:ie.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?X_(s).test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{code:ie.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?L9.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{code:ie.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?F9(s).test(e.data)||(i=this._getOrReturnCtx(
e,i),ye(i,{code:ie.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?S9.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"duration",code:ie.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?M9(e.data,s.version)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"ip",code:ie.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?j9(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"jwt",code:ie.invalid_string,message:s.message}),
r.dirty()):s.kind==="cidr"?B9(e.data,s.version)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"cidr",code:ie.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?I9.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"base64",code:ie.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?O9.test(e.data)||(i=this._getOrReturnCtx(e,i),ye(i,{validation:"base64url",code:ie.invalid_string,message:s.message}),r.dirty()):st.assertNever(s);return{status:r.value,value:e.data}}_regex(e,n,r){
return this.refinement(i=>e.test(i),{validation:n,code:ie.invalid_string,...De.errToObj(r)})}_addCheck(e){return new ui({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...De.errToObj(e)})}url(e){return this._addCheck({kind:"url",...De.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...De.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...De.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...De.errToObj(e)})}cuid(e){return this.
_addCheck({kind:"cuid",...De.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...De.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...De.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...De.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...De.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...De.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...De.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...De.errToObj(e)})}datetime(e){
var n,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(n=e?.offset)!==null&&n!==void 0?n:!1,local:(r=e?.local)!==null&&r!==void 0?r:!1,...De.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.
precision>"u"?null:e?.precision,...De.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...De.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...De.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n?.position,...De.errToObj(n?.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...De.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...De.errToObj(n)})}min(e,n){return this.
_addCheck({kind:"min",value:e,...De.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...De.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...De.errToObj(n)})}nonempty(e){return this.min(1,De.errToObj(e))}trim(){return new ui({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ui({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ui({...this._def,checks:[...this._def.checks,{kind:"toUpp\
erCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.
checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this.
_def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ui.create=t=>{var e;return new ui({checks:[],typeName:oe.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...qe(t)})};function q9(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||
"").length,i=n>r?n:r,s=parseInt(t.toFixed(i).replace(".","")),a=parseInt(e.toFixed(i).replace(".",""));return s%a/Math.pow(10,i)}class Hs extends Ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==be.number){const s=this._getOrReturnCtx(e);return ye(s,{code:ie.invalid_type,expected:be.number,received:s.parsedType}),Oe}let r;const i=new Nn;for(const s of this._def.checks)s.kind===
"int"?st.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),ye(r,{code:ie.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),ye(r,{code:ie.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),ye(r,{code:ie.too_big,maximum:s.value,type:"number",inclusive:s.
inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?q9(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),ye(r,{code:ie.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),ye(r,{code:ie.not_finite,message:s.message}),i.dirty()):st.assertNever(s);return{status:i.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,De.toString(n))}gt(e,n){return this.setLimit("min",e,!1,De.toString(n))}lte(e,n){
return this.setLimit("max",e,!0,De.toString(n))}lt(e,n){return this.setLimit("max",e,!1,De.toString(n))}setLimit(e,n,r,i){return new Hs({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:De.toString(i)}]})}_addCheck(e){return new Hs({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:De.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:De.toString(e)})}negative(e){return this._addCheck({
kind:"max",value:0,inclusive:!1,message:De.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:De.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:De.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:De.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:De.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:De.
toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:De.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&st.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this.
_def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Hs.create=t=>new Hs({checks:[],typeName:oe.ZodNumber,coerce:t?.coerce||!1,...qe(t)});class Vs extends Ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this.
_getType(e)!==be.bigint)return this._getInvalidInput(e);let r;const i=new Nn;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),ye(r,{code:ie.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),ye(r,{code:ie.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):
s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),ye(r,{code:ie.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):st.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return ye(n,{code:ie.invalid_type,expected:be.bigint,received:n.parsedType}),Oe}gte(e,n){return this.setLimit("min",e,!0,De.toString(n))}gt(e,n){return this.setLimit("min",e,!1,De.toString(n))}lte(e,n){return this.setLimit("max",e,!0,De.
toString(n))}lt(e,n){return this.setLimit("max",e,!1,De.toString(n))}setLimit(e,n,r,i){return new Vs({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:De.toString(i)}]})}_addCheck(e){return new Vs({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:De.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:De.toString(e)})}nonpositive(e){return this._addCheck(
{kind:"max",value:BigInt(0),inclusive:!0,message:De.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:De.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:De.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Vs.create=
t=>{var e;return new Vs({checks:[],typeName:oe.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...qe(t)})};class hf extends Ge{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==be.boolean){const r=this._getOrReturnCtx(e);return ye(r,{code:ie.invalid_type,expected:be.boolean,received:r.parsedType}),Oe}return Kn(e.data)}}hf.create=t=>new hf({typeName:oe.ZodBoolean,coerce:t?.coerce||!1,...qe(t)});class po extends Ge{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this.
_getType(e)!==be.date){const s=this._getOrReturnCtx(e);return ye(s,{code:ie.invalid_type,expected:be.date,received:s.parsedType}),Oe}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return ye(s,{code:ie.invalid_date}),Oe}const r=new Nn;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),ye(i,{code:ie.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&
(i=this._getOrReturnCtx(e,i),ye(i,{code:ie.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):st.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new po({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:De.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:De.toString(n)})}get minDate(){let e=null;for(const n of this._def.
checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}po.create=t=>new po({checks:[],coerce:t?.coerce||!1,typeName:oe.ZodDate,...qe(t)});class zm extends Ge{_parse(e){if(this._getType(e)!==be.symbol){const r=this._getOrReturnCtx(e);return ye(r,{code:ie.invalid_type,expected:be.symbol,received:r.parsedType}),Oe}return Kn(e.
data)}}zm.create=t=>new zm({typeName:oe.ZodSymbol,...qe(t)});class pf extends Ge{_parse(e){if(this._getType(e)!==be.undefined){const r=this._getOrReturnCtx(e);return ye(r,{code:ie.invalid_type,expected:be.undefined,received:r.parsedType}),Oe}return Kn(e.data)}}pf.create=t=>new pf({typeName:oe.ZodUndefined,...qe(t)});class mf extends Ge{_parse(e){if(this._getType(e)!==be.null){const r=this._getOrReturnCtx(e);return ye(r,{code:ie.invalid_type,expected:be.null,received:r.parsedType}),Oe}return Kn(e.
data)}}mf.create=t=>new mf({typeName:oe.ZodNull,...qe(t)});class vu extends Ge{constructor(){super(...arguments),this._any=!0}_parse(e){return Kn(e.data)}}vu.create=t=>new vu({typeName:oe.ZodAny,...qe(t)});class Qa extends Ge{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Kn(e.data)}}Qa.create=t=>new Qa({typeName:oe.ZodUnknown,...qe(t)});class fs extends Ge{_parse(e){const n=this._getOrReturnCtx(e);return ye(n,{code:ie.invalid_type,expected:be.never,received:n.parsedType}),Oe}}
fs.create=t=>new fs({typeName:oe.ZodNever,...qe(t)});class Wm extends Ge{_parse(e){if(this._getType(e)!==be.undefined){const r=this._getOrReturnCtx(e);return ye(r,{code:ie.invalid_type,expected:be.void,received:r.parsedType}),Oe}return Kn(e.data)}}Wm.create=t=>new Wm({typeName:oe.ZodVoid,...qe(t)});class oi extends Ge{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),i=this._def;if(n.parsedType!==be.array)return ye(n,{code:ie.invalid_type,expected:be.array,received:n.parsedType}),Oe;if(i.
exactLength!==null){const a=n.data.length>i.exactLength.value,o=n.data.length<i.exactLength.value;(a||o)&&(ye(n,{code:a?ie.too_big:ie.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(ye(n,{code:ie.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.
data.length>i.maxLength.value&&(ye(n,{code:ie.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>i.type._parseAsync(new $i(n,a,n.path,o)))).then(a=>Nn.mergeArray(r,a));const s=[...n.data].map((a,o)=>i.type._parseSync(new $i(n,a,n.path,o)));return Nn.mergeArray(r,s)}get element(){return this._def.type}min(e,n){return new oi({...this._def,minLength:{value:e,message:De.toString(n)}})}max(e,n){
return new oi({...this._def,maxLength:{value:e,message:De.toString(n)}})}length(e,n){return new oi({...this._def,exactLength:{value:e,message:De.toString(n)}})}nonempty(e){return this.min(1,e)}}oi.create=(t,e)=>new oi({type:t,minLength:null,maxLength:null,exactLength:null,typeName:oe.ZodArray,...qe(e)});function wu(t){if(t instanceof Ut){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Xr.create(wu(r))}return new Ut({...t._def,shape:()=>e})}else return t instanceof oi?new oi({...t._def,
type:wu(t.element)}):t instanceof Xr?Xr.create(wu(t.unwrap())):t instanceof js?js.create(wu(t.unwrap())):t instanceof Si?Si.create(t.items.map(e=>wu(e))):t}class Ut extends Ge{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=st.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==be.object){const c=this._getOrReturnCtx(e);return ye(
c,{code:ie.invalid_type,expected:be.object,received:c.parsedType}),Oe}const{status:r,ctx:i}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof fs&&this._def.unknownKeys==="strip"))for(const c in i.data)a.includes(c)||o.push(c);const u=[];for(const c of a){const l=s[c],f=i.data[c];u.push({key:{status:"valid",value:c},value:l._parse(new $i(i,f,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof fs){const c=this._def.unknownKeys;if(c===
"passthrough")for(const l of o)u.push({key:{status:"valid",value:l},value:{status:"valid",value:i.data[l]}});else if(c==="strict")o.length>0&&(ye(i,{code:ie.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const l of o){const f=i.data[l];u.push({key:{status:"valid",value:l},value:c._parse(new $i(i,f,i.path,l)),alwaysSet:l in i.data})}}return i.common.async?Promise.resolve().then(async()=>{
const c=[];for(const l of u){const f=await l.key,d=await l.value;c.push({key:f,value:d,alwaysSet:l.alwaysSet})}return c}).then(c=>Nn.mergeObjectSync(r,c)):Nn.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(e){return De.errToObj,new Ut({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var i,s,a,o;const u=(a=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,n,r).message)!==null&&a!==void 0?a:r.defaultError;return n.code==="unrecognized_keys"?{message:(o=
De.errToObj(e).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new Ut({...this._def,unknownKeys:"strip"})}passthrough(){return new Ut({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ut({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ut({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:oe.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Ut({
...this._def,catchall:e})}pick(e){const n={};return st.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Ut({...this._def,shape:()=>n})}omit(e){const n={};return st.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new Ut({...this._def,shape:()=>n})}deepPartial(){return wu(this)}partial(e){const n={};return st.objectKeys(this.shape).forEach(r=>{const i=this.shape[r];e&&!e[r]?n[r]=i:n[r]=i.optional()}),new Ut({...this._def,shape:()=>n})}required(e){const n={};
return st.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof Xr;)s=s._def.innerType;n[r]=s}}),new Ut({...this._def,shape:()=>n})}keyof(){return Y_(st.objectKeys(this.shape))}}Ut.create=(t,e)=>new Ut({shape:()=>t,unknownKeys:"strip",catchall:fs.create(),typeName:oe.ZodObject,...qe(e)}),Ut.strictCreate=(t,e)=>new Ut({shape:()=>t,unknownKeys:"strict",catchall:fs.create(),typeName:oe.ZodObject,...qe(e)}),Ut.lazycreate=(t,e)=>new Ut({shape:t,unknownKeys:"\
strip",catchall:fs.create(),typeName:oe.ZodObject,...qe(e)});class gf extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function i(s){for(const o of s)if(o.result.status==="valid")return o.result;for(const o of s)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=s.map(o=>new Er(o.ctx.common.issues));return ye(n,{code:ie.invalid_union,unionErrors:a}),Oe}if(n.common.async)return Promise.all(r.map(async s=>{const a={...n,
common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(i);{let s;const a=[];for(const u of r){const c={...n,common:{...n.common,issues:[]},parent:null},l=u._parseSync({data:n.data,path:n.path,parent:c});if(l.status==="valid")return l;l.status==="dirty"&&!s&&(s={result:l,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const o=a.map(u=>new Er(u));return ye(
n,{code:ie.invalid_union,unionErrors:o}),Oe}}get options(){return this._def.options}}gf.create=(t,e)=>new gf({options:t,typeName:oe.ZodUnion,...qe(e)});const hs=t=>t instanceof vf?hs(t.schema):t instanceof Zr?hs(t.innerType()):t instanceof wf?[t.value]:t instanceof Ks?t.options:t instanceof bf?st.objectValues(t.enum):t instanceof Ef?hs(t._def.innerType):t instanceof pf?[void 0]:t instanceof mf?[null]:t instanceof Xr?[void 0,...hs(t.unwrap())]:t instanceof js?[null,...hs(t.unwrap())]:t instanceof
mb||t instanceof Rf?hs(t.unwrap()):t instanceof kf?hs(t._def.innerType):[];class Rg extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==be.object)return ye(n,{code:ie.invalid_type,expected:be.object,received:n.parsedType}),Oe;const r=this.discriminator,i=n.data[r],s=this.optionsMap.get(i);return s?n.common.async?s._parseAsync({data:n.data,path:n.path,parent:n}):s._parseSync({data:n.data,path:n.path,parent:n}):(ye(n,{code:ie.invalid_union_discriminator,options:Array.from(
this.optionsMap.keys()),path:[r]}),Oe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const i=new Map;for(const s of n){const a=hs(s.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(i.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);i.set(o,s)}}
return new Rg({typeName:oe.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:i,...qe(r)})}}function pb(t,e){const n=ds(t),r=ds(e);if(t===e)return{valid:!0,data:t};if(n===be.object&&r===be.object){const i=st.objectKeys(e),s=st.objectKeys(t).filter(o=>i.indexOf(o)!==-1),a={...t,...e};for(const o of s){const u=pb(t[o],e[o]);if(!u.valid)return{valid:!1};a[o]=u.data}return{valid:!0,data:a}}else if(n===be.array&&r===be.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<t.
length;s++){const a=t[s],o=e[s],u=pb(a,o);if(!u.valid)return{valid:!1};i.push(u.data)}return{valid:!0,data:i}}else return n===be.date&&r===be.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class yf extends Ge{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=(s,a)=>{if(db(s)||db(a))return Oe;const o=pb(s.value,a.value);return o.valid?((fb(s)||fb(a))&&n.dirty(),{status:n.value,value:o.data}):(ye(r,{code:ie.invalid_intersection_types}),Oe)};return r.common.async?Promise.all([this._def.left.
_parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,a])=>i(s,a)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}yf.create=(t,e,n)=>new yf({left:t,right:e,typeName:oe.ZodIntersection,...qe(n)});class Si extends Ge{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==be.array)return ye(r,{code:ie.invalid_type,expected:be.array,
received:r.parsedType}),Oe;if(r.data.length<this._def.items.length)return ye(r,{code:ie.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Oe;!this._def.rest&&r.data.length>this._def.items.length&&(ye(r,{code:ie.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...r.data].map((a,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new $i(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(s).
then(a=>Nn.mergeArray(n,a)):Nn.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new Si({...this._def,rest:e})}}Si.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Si({items:t,typeName:oe.ZodTuple,rest:null,...qe(e)})};class zf extends Ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==be.object)
return ye(r,{code:ie.invalid_type,expected:be.object,received:r.parsedType}),Oe;const i=[],s=this._def.keyType,a=this._def.valueType;for(const o in r.data)i.push({key:s._parse(new $i(r,o,r.path,o)),value:a._parse(new $i(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?Nn.mergeObjectAsync(n,i):Nn.mergeObjectSync(n,i)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof Ge?new zf({keyType:e,valueType:n,typeName:oe.ZodRecord,...qe(r)}):new zf({keyType:ui.
create(),valueType:e,typeName:oe.ZodRecord,...qe(n)})}}class Hm extends Ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==be.map)return ye(r,{code:ie.invalid_type,expected:be.map,received:r.parsedType}),Oe;const i=this._def.keyType,s=this._def.valueType,a=[...r.data.entries()].map(([o,u],c)=>({key:i._parse(new $i(r,o,r.path,[c,"key"])),value:s._parse(new $i(r,u,r.path,[c,"value"]))}));
if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of a){const c=await u.key,l=await u.value;if(c.status==="aborted"||l.status==="aborted")return Oe;(c.status==="dirty"||l.status==="dirty")&&n.dirty(),o.set(c.value,l.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const u of a){const c=u.key,l=u.value;if(c.status==="aborted"||l.status==="aborted")return Oe;(c.status==="dirty"||l.status==="dirty")&&n.dirty(),o.set(c.value,l.value)}return{status:n.
value,value:o}}}}Hm.create=(t,e,n)=>new Hm({valueType:e,keyType:t,typeName:oe.ZodMap,...qe(n)});class mo extends Ge{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==be.set)return ye(r,{code:ie.invalid_type,expected:be.set,received:r.parsedType}),Oe;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(ye(r,{code:ie.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.
value&&(ye(r,{code:ie.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const s=this._def.valueType;function a(u){const c=new Set;for(const l of u){if(l.status==="aborted")return Oe;l.status==="dirty"&&n.dirty(),c.add(l.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((u,c)=>s._parse(new $i(r,u,r.path,c)));return r.common.async?Promise.all(o).then(u=>a(u)):a(o)}min(e,n){return new mo({...this._def,minSize:{value:e,message:De.
toString(n)}})}max(e,n){return new mo({...this._def,maxSize:{value:e,message:De.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}mo.create=(t,e)=>new mo({valueType:t,minSize:null,maxSize:null,typeName:oe.ZodSet,...qe(e)});class Au extends Ge{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==be.function)return ye(n,{code:ie.invalid_type,expected:be.function,received:n.parsedType}),
Oe;function r(o,u){return Gm({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,qm(),gu].filter(c=>!!c),issueData:{code:ie.invalid_arguments,argumentsError:u}})}function i(o,u){return Gm({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,qm(),gu].filter(c=>!!c),issueData:{code:ie.invalid_return_type,returnTypeError:u}})}const s={errorMap:n.common.contextualErrorMap},a=n.data;if(this._def.returns instanceof bu){const o=this;return Kn(async function(...u){
const c=new Er([]),l=await o._def.args.parseAsync(u,s).catch(h=>{throw c.addIssue(r(u,h)),c}),f=await Reflect.apply(a,this,l);return await o._def.returns._def.type.parseAsync(f,s).catch(h=>{throw c.addIssue(i(f,h)),c})})}else{const o=this;return Kn(function(...u){const c=o._def.args.safeParse(u,s);if(!c.success)throw new Er([r(u,c.error)]);const l=Reflect.apply(a,this,c.data),f=o._def.returns.safeParse(l,s);if(!f.success)throw new Er([i(l,f.error)]);return f.data})}}parameters(){return this._def.
args}returnType(){return this._def.returns}args(...e){return new Au({...this._def,args:Si.create(e).rest(Qa.create())})}returns(e){return new Au({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new Au({args:e||Si.create([]).rest(Qa.create()),returns:n||Qa.create(),typeName:oe.ZodFunction,...qe(r)})}}class vf extends Ge{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this.
_def.getter()._parse({data:n.data,path:n.path,parent:n})}}vf.create=(t,e)=>new vf({getter:t,typeName:oe.ZodLazy,...qe(e)});class wf extends Ge{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return ye(n,{received:n.data,code:ie.invalid_literal,expected:this._def.value}),Oe}return{status:"valid",value:e.data}}get value(){return this._def.value}}wf.create=(t,e)=>new wf({value:t,typeName:oe.ZodLiteral,...qe(e)});function Y_(t,e){return new Ks({values:t,typeName:oe.ZodEnum,...qe(
e)})}class Ks extends Ge{constructor(){super(...arguments),df.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return ye(n,{expected:st.joinValues(r),received:n.parsedType,code:ie.invalid_type}),Oe}if(Um(this,df)||H_(this,df,new Set(this._def.values)),!Um(this,df).has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return ye(n,{received:n.data,code:ie.invalid_enum_value,options:r}),Oe}return Kn(e.data)}get options(){return this.
_def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Ks.create(e,{...this._def,...n})}exclude(e,n=this._def){return Ks.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}df=new WeakMap,Ks.create=Y_;class bf extends Ge{constructor(){super(...arguments),ff.set(this,void 0)}_parse(e){
const n=st.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==be.string&&r.parsedType!==be.number){const i=st.objectValues(n);return ye(r,{expected:st.joinValues(i),received:r.parsedType,code:ie.invalid_type}),Oe}if(Um(this,ff)||H_(this,ff,new Set(st.getValidEnumValues(this._def.values))),!Um(this,ff).has(e.data)){const i=st.objectValues(n);return ye(r,{received:r.data,code:ie.invalid_enum_value,options:i}),Oe}return Kn(e.data)}get enum(){return this._def.values}}ff=
new WeakMap,bf.create=(t,e)=>new bf({values:t,typeName:oe.ZodNativeEnum,...qe(e)});class bu extends Ge{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==be.promise&&n.common.async===!1)return ye(n,{code:ie.invalid_type,expected:be.promise,received:n.parsedType}),Oe;const r=n.parsedType===be.promise?n.data:Promise.resolve(n.data);return Kn(r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}bu.create=(t,e)=>new bu(
{type:t,typeName:oe.ZodPromise,...qe(e)});class Zr extends Ge{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===oe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:a=>{ye(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const a=i.transform(r.data,s);if(r.common.async)return Promise.resolve(
a).then(async o=>{if(n.value==="aborted")return Oe;const u=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return u.status==="aborted"?Oe:u.status==="dirty"||n.value==="dirty"?yu(u.value):u});{if(n.value==="aborted")return Oe;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?Oe:o.status==="dirty"||n.value==="dirty"?yu(o.value):o}}if(i.type==="refinement"){const a=o=>{const u=i.refinement(o,s);if(r.common.async)return Promise.resolve(
u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?Oe:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?Oe:(o.status==="dirty"&&n.dirty(),a(o.value).then(
()=>({status:n.value,value:o.value}))))}if(i.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Ja(a))return a;const o=i.transform(a.value,s);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Ja(a)?Promise.resolve(i.transform(a.
value,s)).then(o=>({status:n.value,value:o})):a);st.assertNever(i)}}Zr.create=(t,e,n)=>new Zr({schema:t,typeName:oe.ZodEffects,effect:e,...qe(n)}),Zr.createWithPreprocess=(t,e,n)=>new Zr({schema:e,effect:{type:"preprocess",transform:t},typeName:oe.ZodEffects,...qe(n)});class Xr extends Ge{_parse(e){return this._getType(e)===be.undefined?Kn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Xr.create=(t,e)=>new Xr({innerType:t,typeName:oe.ZodOptional,...qe(e)});class js extends Ge{_parse(e){
return this._getType(e)===be.null?Kn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}js.create=(t,e)=>new js({innerType:t,typeName:oe.ZodNullable,...qe(e)});class Ef extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===be.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Ef.create=(t,e)=>new Ef({innerType:t,typeName:oe.ZodDefault,defaultValue:typeof e.
default=="function"?e.default:()=>e.default,...qe(e)});class kf extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return lf(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Er(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Er(r.common.issues)},
input:r.data})}}removeCatch(){return this._def.innerType}}kf.create=(t,e)=>new kf({innerType:t,typeName:oe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...qe(e)});class Vm extends Ge{_parse(e){if(this._getType(e)!==be.nan){const r=this._getOrReturnCtx(e);return ye(r,{code:ie.invalid_type,expected:be.nan,received:r.parsedType}),Oe}return{status:"valid",value:e.data}}}Vm.create=t=>new Vm({typeName:oe.ZodNaN,...qe(t)});const G9=Symbol("zod_brand");class mb extends Ge{_parse(e){
const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Gf extends Ge{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Oe:s.status==="dirty"?(n.dirty(),yu(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync(
{data:r.data,path:r.path,parent:r});return i.status==="aborted"?Oe:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,n){return new Gf({in:e,out:n,typeName:oe.ZodPipeline})}}class Rf extends Ge{_parse(e){const n=this._def.innerType._parse(e),r=i=>(Ja(i)&&(i.value=Object.freeze(i.value)),i);return lf(n)?n.then(i=>r(i)):r(n)}unwrap(){return this._def.innerType}}Rf.create=(t,e)=>new Rf({innerType:t,typeName:oe.
ZodReadonly,...qe(e)});function J_(t,e){const n=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof n=="string"?{message:n}:n}function Q_(t,e={},n){return t?vu.create().superRefine((r,i)=>{var s,a;const o=t(r);if(o instanceof Promise)return o.then(u=>{var c,l;if(!u){const f=J_(e,r),d=(l=(c=f.fatal)!==null&&c!==void 0?c:n)!==null&&l!==void 0?l:!0;i.addIssue({code:"custom",...f,fatal:d})}});if(!o){const u=J_(e,r),c=(a=(s=u.fatal)!==null&&s!==void 0?s:n)!==null&&a!==void 0?a:!0;
i.addIssue({code:"custom",...u,fatal:c})}}):vu.create()}const U9={object:Ut.lazycreate};var oe;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="Zod\
DiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(
oe||(oe={}));const z9=(t,e={message:`Input not instance of ${t.name}`})=>Q_(n=>n instanceof t,e),eA=ui.create,tA=Hs.create,W9=Vm.create,H9=Vs.create,nA=hf.create,V9=po.create,K9=zm.create,Z9=pf.create,X9=mf.create,Y9=vu.create,J9=Qa.create,Q9=fs.create,e6=Wm.create,t6=oi.create,n6=Ut.create,r6=Ut.strictCreate,i6=gf.create,s6=Rg.create,a6=yf.create,o6=Si.create,u6=zf.create,c6=Hm.create,l6=mo.create,d6=Au.create,f6=vf.create,h6=wf.create,p6=Ks.create,m6=bf.create,g6=bu.create,rA=Zr.create,y6=Xr.create,
v6=js.create,w6=Zr.createWithPreprocess,b6=Gf.create,E6=()=>eA().optional(),k6=()=>tA().optional(),R6=()=>nA().optional(),$6={string:t=>ui.create({...t,coerce:!0}),number:t=>Hs.create({...t,coerce:!0}),boolean:t=>hf.create({...t,coerce:!0}),bigint:t=>Vs.create({...t,coerce:!0}),date:t=>po.create({...t,coerce:!0})},D6=Oe;var C=Object.freeze({__proto__:null,defaultErrorMap:gu,setErrorMap:w9,getErrorMap:qm,makeIssue:Gm,EMPTY_PATH:b9,addIssueToContext:ye,ParseStatus:Nn,INVALID:Oe,DIRTY:yu,OK:Kn,isAborted:db,
isDirty:fb,isValid:Ja,isAsync:lf,get util(){return st},get objectUtil(){return lb},ZodParsedType:be,getParsedType:ds,ZodType:Ge,datetimeRegex:X_,ZodString:ui,ZodNumber:Hs,ZodBigInt:Vs,ZodBoolean:hf,ZodDate:po,ZodSymbol:zm,ZodUndefined:pf,ZodNull:mf,ZodAny:vu,ZodUnknown:Qa,ZodNever:fs,ZodVoid:Wm,ZodArray:oi,ZodObject:Ut,ZodUnion:gf,ZodDiscriminatedUnion:Rg,ZodIntersection:yf,ZodTuple:Si,ZodRecord:zf,ZodMap:Hm,ZodSet:mo,ZodFunction:Au,ZodLazy:vf,ZodLiteral:wf,ZodEnum:Ks,ZodNativeEnum:bf,ZodPromise:bu,
ZodEffects:Zr,ZodTransformer:Zr,ZodOptional:Xr,ZodNullable:js,ZodDefault:Ef,ZodCatch:kf,ZodNaN:Vm,BRAND:G9,ZodBranded:mb,ZodPipeline:Gf,ZodReadonly:Rf,custom:Q_,Schema:Ge,ZodSchema:Ge,late:U9,get ZodFirstPartyTypeKind(){return oe},coerce:$6,any:Y9,array:t6,bigint:H9,boolean:nA,date:V9,discriminatedUnion:s6,effect:rA,enum:p6,function:d6,instanceof:z9,intersection:a6,lazy:f6,literal:h6,map:c6,nan:W9,nativeEnum:m6,never:Q9,null:X9,nullable:v6,number:tA,object:n6,oboolean:R6,onumber:k6,optional:y6,ostring:E6,
pipeline:b6,preprocess:w6,promise:g6,record:u6,set:l6,strictObject:r6,string:eA,symbol:K9,transformer:rA,tuple:o6,undefined:Z9,union:i6,unknown:J9,void:e6,NEVER:D6,ZodIssueCode:ie,quotelessJson:v9,ZodError:Er});const iA="2024-11-05",T6=[iA,"2024-10-07"],Km="2.0",sA=C.union([C.string(),C.number().int()]),aA=C.string(),Yr=C.object({_meta:C.optional(C.object({progressToken:C.optional(sA)}).passthrough())}).passthrough(),wr=C.object({method:C.string(),params:C.optional(Yr)}),$f=C.object({_meta:C.optional(
C.object({}).passthrough())}).passthrough(),Di=C.object({method:C.string(),params:C.optional($f)}),Jr=C.object({_meta:C.optional(C.object({}).passthrough())}).passthrough(),Zm=C.union([C.string(),C.number().int()]),oA=C.object({jsonrpc:C.literal(Km),id:Zm}).merge(wr).strict(),S6=t=>oA.safeParse(t).success,uA=C.object({jsonrpc:C.literal(Km)}).merge(Di).strict(),C6=t=>uA.safeParse(t).success,cA=C.object({jsonrpc:C.literal(Km),id:Zm,result:Jr}).strict(),lA=t=>cA.safeParse(t).success;var un;(function(t){
t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError"})(un||(un={}));const dA=C.object({jsonrpc:C.literal(Km),id:Zm,error:C.object({code:C.number().int(),message:C.string(),data:C.optional(C.unknown())})}).strict(),_6=t=>dA.safeParse(t).success;C.union([oA,
uA,cA,dA]);const gb=Jr.strict(),yb=Di.extend({method:C.literal("notifications/cancelled"),params:$f.extend({requestId:Zm,reason:C.string().optional()})}),fA=C.object({name:C.string(),version:C.string()}).passthrough(),A6=C.object({experimental:C.optional(C.object({}).passthrough()),sampling:C.optional(C.object({}).passthrough()),roots:C.optional(C.object({listChanged:C.optional(C.boolean())}).passthrough())}).passthrough(),hA=wr.extend({method:C.literal("initialize"),params:Yr.extend({protocolVersion:C.
string(),capabilities:A6,clientInfo:fA})}),x6=C.object({experimental:C.optional(C.object({}).passthrough()),logging:C.optional(C.object({}).passthrough()),completions:C.optional(C.object({}).passthrough()),prompts:C.optional(C.object({listChanged:C.optional(C.boolean())}).passthrough()),resources:C.optional(C.object({subscribe:C.optional(C.boolean()),listChanged:C.optional(C.boolean())}).passthrough()),tools:C.optional(C.object({listChanged:C.optional(C.boolean())}).passthrough())}).passthrough(),
P6=Jr.extend({protocolVersion:C.string(),capabilities:x6,serverInfo:fA,instructions:C.optional(C.string())}),pA=Di.extend({method:C.literal("notifications/initialized")}),vb=wr.extend({method:C.literal("ping")}),N6=C.object({progress:C.number(),total:C.optional(C.number())}).passthrough(),wb=Di.extend({method:C.literal("notifications/progress"),params:$f.merge(N6).extend({progressToken:sA})}),Xm=wr.extend({params:Yr.extend({cursor:C.optional(aA)}).optional()}),Ym=Jr.extend({nextCursor:C.optional(
aA)}),mA=C.object({uri:C.string(),mimeType:C.optional(C.string())}).passthrough(),gA=mA.extend({text:C.string()}),yA=mA.extend({blob:C.string().base64()}),I6=C.object({uri:C.string(),name:C.string(),description:C.optional(C.string()),mimeType:C.optional(C.string())}).passthrough(),O6=C.object({uriTemplate:C.string(),name:C.string(),description:C.optional(C.string()),mimeType:C.optional(C.string())}).passthrough(),bb=Xm.extend({method:C.literal("resources/list")}),L6=Ym.extend({resources:C.array(
I6)}),Eb=Xm.extend({method:C.literal("resources/templates/list")}),F6=Ym.extend({resourceTemplates:C.array(O6)}),kb=wr.extend({method:C.literal("resources/read"),params:Yr.extend({uri:C.string()})}),M6=Jr.extend({contents:C.array(C.union([gA,yA]))}),j6=Di.extend({method:C.literal("notifications/resources/list_changed")}),B6=wr.extend({method:C.literal("resources/subscribe"),params:Yr.extend({uri:C.string()})}),q6=wr.extend({method:C.literal("resources/unsubscribe"),params:Yr.extend({uri:C.string()})}),
G6=Di.extend({method:C.literal("notifications/resources/updated"),params:$f.extend({uri:C.string()})}),U6=C.object({name:C.string(),description:C.optional(C.string()),required:C.optional(C.boolean())}).passthrough(),z6=C.object({name:C.string(),description:C.optional(C.string()),arguments:C.optional(C.array(U6))}).passthrough(),Rb=Xm.extend({method:C.literal("prompts/list")}),W6=Ym.extend({prompts:C.array(z6)}),$b=wr.extend({method:C.literal("prompts/get"),params:Yr.extend({name:C.string(),arguments:C.
optional(C.record(C.string()))})}),Jm=C.object({type:C.literal("text"),text:C.string()}).passthrough(),Qm=C.object({type:C.literal("image"),data:C.string().base64(),mimeType:C.string()}).passthrough(),eg=C.object({type:C.literal("audio"),data:C.string().base64(),mimeType:C.string()}).passthrough(),vA=C.object({type:C.literal("resource"),resource:C.union([gA,yA])}).passthrough(),H6=C.object({role:C.enum(["user","assistant"]),content:C.union([Jm,Qm,eg,vA])}).passthrough(),V6=Jr.extend({description:C.
optional(C.string()),messages:C.array(H6)}),K6=Di.extend({method:C.literal("notifications/prompts/list_changed")}),Z6=C.object({name:C.string(),description:C.optional(C.string()),inputSchema:C.object({type:C.literal("object"),properties:C.optional(C.object({}).passthrough())}).passthrough()}).passthrough(),Db=Xm.extend({method:C.literal("tools/list")}),X6=Ym.extend({tools:C.array(Z6)}),wA=Jr.extend({content:C.array(C.union([Jm,Qm,eg,vA])),isError:C.boolean().default(!1).optional()});wA.or(Jr.extend(
{toolResult:C.unknown()}));const Tb=wr.extend({method:C.literal("tools/call"),params:Yr.extend({name:C.string(),arguments:C.optional(C.record(C.unknown()))})}),Y6=Di.extend({method:C.literal("notifications/tools/list_changed")}),bA=C.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),J6=wr.extend({method:C.literal("logging/setLevel"),params:Yr.extend({level:bA})}),Q6=Di.extend({method:C.literal("notifications/message"),params:$f.extend({level:bA,logger:C.optional(C.
string()),data:C.unknown()})}),eH=C.object({name:C.string().optional()}).passthrough(),tH=C.object({hints:C.optional(C.array(eH)),costPriority:C.optional(C.number().min(0).max(1)),speedPriority:C.optional(C.number().min(0).max(1)),intelligencePriority:C.optional(C.number().min(0).max(1))}).passthrough(),nH=C.object({role:C.enum(["user","assistant"]),content:C.union([Jm,Qm,eg])}).passthrough(),rH=wr.extend({method:C.literal("sampling/createMessage"),params:Yr.extend({messages:C.array(nH),systemPrompt:C.
optional(C.string()),includeContext:C.optional(C.enum(["none","thisServer","allServers"])),temperature:C.optional(C.number()),maxTokens:C.number().int(),stopSequences:C.optional(C.array(C.string())),metadata:C.optional(C.object({}).passthrough()),modelPreferences:C.optional(tH)})}),EA=Jr.extend({model:C.string(),stopReason:C.optional(C.enum(["endTurn","stopSequence","maxTokens"]).or(C.string())),role:C.enum(["user","assistant"]),content:C.discriminatedUnion("type",[Jm,Qm,eg])}),iH=C.object({type:C.
literal("ref/resource"),uri:C.string()}).passthrough(),sH=C.object({type:C.literal("ref/prompt"),name:C.string()}).passthrough(),Sb=wr.extend({method:C.literal("completion/complete"),params:Yr.extend({ref:C.union([sH,iH]),argument:C.object({name:C.string(),value:C.string()}).passthrough()})}),aH=Jr.extend({completion:C.object({values:C.array(C.string()).max(100),total:C.optional(C.number().int()),hasMore:C.optional(C.boolean())}).passthrough()}),oH=C.object({uri:C.string().startsWith("file://"),
name:C.optional(C.string())}).passthrough(),uH=wr.extend({method:C.literal("roots/list")}),kA=Jr.extend({roots:C.array(oH)}),cH=Di.extend({method:C.literal("notifications/roots/list_changed")});C.union([vb,hA,Sb,J6,$b,Rb,bb,Eb,kb,B6,q6,Tb,Db]),C.union([yb,wb,pA,cH]),C.union([gb,EA,kA]),C.union([vb,rH,uH]),C.union([yb,wb,Q6,G6,j6,Y6,K6]),C.union([gb,P6,aH,V6,W6,L6,F6,M6,wA,X6]);class An extends Error{constructor(e,n,r){super(`MCP error ${e}: ${n}`),this.code=e,this.data=r,this.name="McpError"}}var lH=Object.
getOwnPropertyNames,dH=Object.getOwnPropertySymbols,fH=Object.prototype.hasOwnProperty;function RA(t,e){return function(r,i,s){return t(r,i,s)&&e(r,i,s)}}function tg(t){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,i);var s=i.cache,a=s.get(n),o=s.get(r);if(a&&o)return a===r&&o===n;s.set(n,r),s.set(r,n);var u=t(n,r,i);return s.delete(n),s.delete(r),u}}function $A(t){return lH(t).concat(dH(t))}var hH=Object.hasOwn||function(t,e){return fH.call(t,e)};function eo(t,e){
return t===e||!t&&!e&&t!==t&&e!==e}var pH="__v",mH="__o",gH="_owner",DA=Object.getOwnPropertyDescriptor,TA=Object.keys;function yH(t,e,n){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function vH(t,e){return eo(t.getTime(),e.getTime())}function wH(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function bH(t,e){return t===e}function SA(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(
r),s=t.entries(),a,o,u=0;(a=s.next())&&!a.done;){for(var c=e.entries(),l=!1,f=0;(o=c.next())&&!o.done;){if(i[f]){f++;continue}var d=a.value,h=o.value;if(n.equals(d[0],h[0],u,f,t,e,n)&&n.equals(d[1],h[1],d[0],h[0],t,e,n)){l=i[f]=!0;break}f++}if(!l)return!1;u++}return!0}var EH=eo;function kH(t,e,n){var r=TA(t),i=r.length;if(TA(e).length!==i)return!1;for(;i-- >0;)if(!_A(t,e,n,r[i]))return!1;return!0}function Df(t,e,n){var r=$A(t),i=r.length;if($A(e).length!==i)return!1;for(var s,a,o;i-- >0;)if(s=r[i],
!_A(t,e,n,s)||(a=DA(t,s),o=DA(e,s),(a||o)&&(!a||!o||a.configurable!==o.configurable||a.enumerable!==o.enumerable||a.writable!==o.writable)))return!1;return!0}function RH(t,e){return eo(t.valueOf(),e.valueOf())}function $H(t,e){return t.source===e.source&&t.flags===e.flags}function CA(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(r),s=t.values(),a,o;(a=s.next())&&!a.done;){for(var u=e.values(),c=!1,l=0;(o=u.next())&&!o.done;){if(!i[l]&&n.equals(a.value,o.value,a.value,
o.value,t,e,n)){c=i[l]=!0;break}l++}if(!c)return!1}return!0}function DH(t,e){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function TH(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function _A(t,e,n,r){return(r===gH||r===mH||r===pH)&&(t.$$typeof||e.$$typeof)?!0:hH(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}var SH="[object Arguments]",CH="[ob\
ject Boolean]",_H="[object Date]",AH="[object Error]",xH="[object Map]",PH="[object Number]",NH="[object Object]",IH="[object RegExp]",OH="[object Set]",LH="[object String]",FH="[object URL]",MH=Array.isArray,AA=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,xA=Object.assign,jH=Object.prototype.toString.call.bind(Object.prototype.toString);function BH(t){var e=t.areArraysEqual,n=t.areDatesEqual,r=t.areErrorsEqual,i=t.areFunctionsEqual,s=t.areMapsEqual,a=t.areNumbersEqual,
o=t.areObjectsEqual,u=t.arePrimitiveWrappersEqual,c=t.areRegExpsEqual,l=t.areSetsEqual,f=t.areTypedArraysEqual,d=t.areUrlsEqual;return function(p,w,v){if(p===w)return!0;if(p==null||w==null)return!1;var g=typeof p;if(g!==typeof w)return!1;if(g!=="object")return g==="number"?a(p,w,v):g==="function"?i(p,w,v):!1;var b=p.constructor;if(b!==w.constructor)return!1;if(b===Object)return o(p,w,v);if(MH(p))return e(p,w,v);if(AA!=null&&AA(p))return f(p,w,v);if(b===Date)return n(p,w,v);if(b===RegExp)return c(
p,w,v);if(b===Map)return s(p,w,v);if(b===Set)return l(p,w,v);var k=jH(p);return k===_H?n(p,w,v):k===IH?c(p,w,v):k===xH?s(p,w,v):k===OH?l(p,w,v):k===NH?typeof p.then!="function"&&typeof w.then!="function"&&o(p,w,v):k===FH?d(p,w,v):k===AH?r(p,w,v):k===SH?o(p,w,v):k===CH||k===PH||k===LH?u(p,w,v):!1}}function qH(t){var e=t.circular,n=t.createCustomConfig,r=t.strict,i={areArraysEqual:r?Df:yH,areDatesEqual:vH,areErrorsEqual:wH,areFunctionsEqual:bH,areMapsEqual:r?RA(SA,Df):SA,areNumbersEqual:EH,areObjectsEqual:r?
Df:kH,arePrimitiveWrappersEqual:RH,areRegExpsEqual:$H,areSetsEqual:r?RA(CA,Df):CA,areTypedArraysEqual:r?Df:DH,areUrlsEqual:TH};if(n&&(i=xA({},i,n(i))),e){var s=tg(i.areArraysEqual),a=tg(i.areMapsEqual),o=tg(i.areObjectsEqual),u=tg(i.areSetsEqual);i=xA({},i,{areArraysEqual:s,areMapsEqual:a,areObjectsEqual:o,areSetsEqual:u})}return i}function GH(t){return function(e,n,r,i,s,a,o){return t(e,n,o)}}function UH(t){var e=t.circular,n=t.comparator,r=t.createState,i=t.equals,s=t.strict;if(r)return function(u,c){
var l=r(),f=l.cache,d=f===void 0?e?new WeakMap:void 0:f,h=l.meta;return n(u,c,{cache:d,equals:i,meta:h,strict:s})};if(e)return function(u,c){return n(u,c,{cache:new WeakMap,equals:i,meta:void 0,strict:s})};var a={cache:void 0,equals:i,meta:void 0,strict:s};return function(u,c){return n(u,c,a)}}var Cb=Bs();Bs({strict:!0}),Bs({circular:!0}),Bs({circular:!0,strict:!0}),Bs({createInternalComparator:function(){return eo}}),Bs({strict:!0,createInternalComparator:function(){return eo}}),Bs({circular:!0,
createInternalComparator:function(){return eo}}),Bs({circular:!0,createInternalComparator:function(){return eo},strict:!0});function Bs(t){t===void 0&&(t={});var e=t.circular,n=e===void 0?!1:e,r=t.createInternalComparator,i=t.createState,s=t.strict,a=s===void 0?!1:s,o=qH(t),u=BH(o),c=r?r(u):GH(u);return UH({circular:n,comparator:u,createState:i,equals:c,strict:a})}function PA(t,e){const n=t.nodes.map(i=>{const s=e.nodes[i.id];if(!s)return i;const{x:a,y:o,width:u,height:c}=s;return{...i,width:u,height:c,
position:[a,o]}}),r=t.edges.map(i=>{const s=e.edges[i.id];return s?{...i,...s}:i});return{...t,bounds:{x:e.x,y:e.y,width:e.width,height:e.height},nodes:n,edges:r}}const NA=(t,e)=>t.width>e.width+10||t.height>e.height+10;function zH(t,e){if(t.hash===e.hash)return{diagram:PA(t,e)};if(Cb(t.autoLayout,e.autoLayout)&&t.nodes.every(r=>{const i=e.nodes[r.id];return!!i&&(r.children.length>0&&i.isCompound||r.children.length===0&&!i.isCompound)&&(i.isCompound||NA(r,i)===!1)})&&t.edges.every(r=>{const i=e.
edges[r.id];return!!i&&(!r.labelBBox&&!i.labelBBox||!!r.labelBBox&&!!i.labelBBox&&r.labelBBox.width<=i.labelBBox.width&&r.labelBBox.height<=i.labelBBox.height)}))return{diagram:PA(t,e)};const n=t.nodes.reduce((r,i)=>{const s=e.nodes[i.id];if(i.children.length>0||!s)return r;const a={id:i.id,center:{x:Math.round(s.x+s.width/2),y:Math.round(s.y+s.height/2)}};return s.isCompound||NA(i,s)||(a.fixedsize={width:s.width,height:s.height}),r.push(a),r},[]);return{relayout:{x:e.x,y:e.y,height:e.height,nodes:n,
edges:Yc(e.edges).flatMap(([r,i])=>i.dotpos?{id:r,dotpos:i.dotpos}:[])}}}function IA(t){return typeof t=="object"&&t!==null&&typeof t.id=="string"}function _b(t){return typeof t=="object"&&t!==null&&t.$$type==="Node"&&typeof t.id=="string"}function OA(t){return _b(t)||IA(t)}function Tf(t){return typeof t=="string"||OA(t)}function WH(t){return Array.isArray(t)&&t.every(Tf)}function HH(t){return["n","ne","e","se","s","sw","w","nw","c"].includes(t)}function LA(t){if(OA(t))return t;const[e,n,r]=t.split(
":");return HH(r)?{id:e,port:n,compass:r}:{id:e,port:n}}function VH(t){if(t.length<2&&(Tf(t[0])&&Tf(t[1]))===!1)throw Error("EdgeTargets must have at least 2 elements.");return t.map(e=>LA(e))}const ng=Object.seal({Graph:null,Digraph:null,Subgraph:null,Node:null,Edge:null});function KH(t){return Object.assign(Object.seal(Object.assign({},ng)),t)}function ZH(...t){const[e,...n]=t;return(...r)=>n.reduce((i,s)=>s(i),e(...r))}function xr(t,...e){return ZH(t,...e)}const XH=t=>(...e)=>n=>t(n,...e),YH=t=>({
[Symbol.iterator]:t}),Qr=XH((t,e)=>Array.from(YH(function*(){for(const n of t)yield e(n)})));class FA{options;getLocation(){return this.options?.locationFunction?.()??null}constructor(e){this.options=e}createElement(e,n,r=[]){return{location:this.getLocation(),...n,type:e,children:r}}}const pt=FA.prototype.createElement.bind(new FA),JH=/\r?\n/;function ei(t){return e=>e.join(t)}function QH(t){return e=>t+e+t}function qs(t,e){return n=>t+n+e}function rg(t){return e=>t+e}const MA=t=>t.replace(/\r/g,
"\\r").replace(/\n/g,"\\n").replace(/"/g,'\\"'),ig=t=>t.split(JH),Sf=(t,e,n)=>xr(ig,Qr(rg(t==="space"?" ".repeat(e):`
`)),ei(n)),to=t=>{switch(t){case"crlf":return`\r
`;case"lf":return`
`}},e5={match(t){return t.type==="AttributeList"},print(t,e){if(e.children.length===0)return`${e.kind.toLocaleLowerCase()} [];`;const n=to(t.endOfLine);return xr(Qr(t.print),ei(n),Sf(t.indentStyle,t.indentSize,n),qs(`${e.kind.toLocaleLowerCase()} [${n}`,`${n}];`))(e.children)}},t5={match(t){return t.type==="Attribute"},print(t,e){return`${t.print(e.key)} = ${t.print(e.value)};`}},n5={match(t){return t.type==="Comment"},print(t,e){const n=to(t.endOfLine);switch(e.kind){case"Block":return xr(ig,Qr(
rg(" * ")),ei(n),qs(`/**${n}`,`${n} */`))(e.value);case"Macro":return xr(ig,Qr(rg("# ")),ei(n))(e.value);case"Slash":default:return xr(ig,Qr(rg("// ")),ei(n))(e.value)}}},r5={match(t){return t.type==="Dot"},print(t,e){return e.children.map(t.print).join(to(t.endOfLine))}},i5={match(t){return t.type==="Edge"},print(t,e){const n=xr(Qr(t.print),ei(t.directed?" -> ":" -- "))(e.targets);if(e.children.length===0)return`${n};`;const r=to(t.endOfLine),i=xr(Qr(t.print),ei(r),Sf(t.indentStyle,t.indentSize,
r),qs(`[${r}`,`${r}];`))(e.children);return`${n} ${i}`}},s5={match(t){return t.type==="Graph"},print(t,e){t.directed=e.directed;const n=[];if(e.strict&&n.push("strict"),n.push(e.directed?"digraph":"graph"),e.id&&n.push(t.print(e.id)),e.children.length===0)return`${n.join(" ")} {}`;const r=to(t.endOfLine),i=xr(Qr(t.print),ei(r),Sf(t.indentStyle,t.indentSize,r),qs(`{${r}`,`${r}}`))(e.children);return`${n.join(" ")} ${i}`}},a5=xr(MA,QH('"')),o5=qs("<",">"),u5={match(t){return t.type==="Literal"},print(t,e){
switch(e.quoted){case"html":return o5(e.value);case!0:return a5(e.value);case!1:default:return MA(e.value)}}},c5={match(t){return t.type==="Node"},print(t,e){const n=t.print(e.id);if(e.children.length===0)return`${n};`;const r=to(t.endOfLine),i=xr(Qr(t.print),ei(r),Sf(t.indentStyle,t.indentSize,r),qs(`[${r}`,`${r}];`))(e.children);return`${n} ${i}`}},l5={match(t){return t.type==="NodeRefGroup"},print(t,e){return xr(Qr(t.print),ei(" "),qs("{","}"))(e.children)}},d5={match(t){return t.type==="Node\
Ref"},print(t,e){const n=[t.print(e.id)];return e.port&&n.push(t.print(e.port)),e.compass&&n.push(t.print(e.compass)),n.join(":")}},f5={match(t){return t.type==="Subgraph"},print(t,e){const n=["subgraph"];if(e.id&&n.push(t.print(e.id)),e.children.length===0)return`${n.join(" ")} {}`;const r=to(t.endOfLine),i=xr(Qr(t.print),ei(r),Sf(t.indentStyle,t.indentSize,r),qs(`{${r}`,`${r}}`))(e.children);return`${n.join(" ")} ${i}`}},h5=[e5,t5,n5,r5,i5,s5,u5,c5,l5,d5,f5];class p5{options;#e=[...h5];constructor(e={}){
this.options=e}print(e){const n=[...this.#e],{indentSize:r=2,indentStyle:i="space",endOfLine:s="lf"}=this.options,a={directed:!0,indentSize:r,indentStyle:i,endOfLine:s,print(o){for(const u of n)if(u.match(o))return u.print(a,o);throw Error()}};return a.print(e)}}function m5(t,e){const n=new p5(e).print(t);if(!n)throw new Error;return n}function sg(t,e){if(typeof e=="string"){const n=e.trim();return/^<.+>$/ms.test(n)?pt("Attribute",{key:pt("Literal",{value:t,quoted:!1},[]),value:pt("Literal",{value:n.
slice(1,n.length-1),quoted:"html"},[])},[]):pt("Attribute",{key:pt("Literal",{value:t,quoted:!1},[]),value:pt("Literal",{value:e,quoted:!0},[])},[])}return pt("Attribute",{key:pt("Literal",{value:t,quoted:!1},[]),value:pt("Literal",{value:String(e),quoted:!1},[])},[])}function no(t,e){return pt("Comment",{kind:e,value:t},[])}function jA(t,e){return Array.from(function*(){for(const[n,r]of e.values)yield sg(n,r);for(const n of Object.values(e.attributes))n.size>0&&(n.comment&&(yield no(n.comment,t.
commentKind)),yield t.convert(n));for(const n of e.nodes)n.comment&&(yield no(n.comment,t.commentKind)),yield t.convert(n);for(const n of e.subgraphs)n.comment&&(yield no(n.comment,t.commentKind)),yield t.convert(n);for(const n of e.edges)n.comment&&(yield no(n.comment,t.commentKind)),yield t.convert(n)}())}const g5={match(t){return t.$$type==="AttributeList"},convert(t,e){return pt("AttributeList",{kind:e.$$kind},e.values.map(([n,r])=>sg(n,r)))}},y5={match(t){return t.$$type==="Edge"},convert(t,e){
return pt("Edge",{targets:e.targets.map(n=>_b(n)?pt("NodeRef",{id:pt("Literal",{value:n.id,quoted:!0},[])},[]):IA(n)?pt("NodeRef",{id:pt("Literal",{value:n.id,quoted:!0},[]),port:n.port?pt("Literal",{value:n.port,quoted:!0},[]):void 0,compass:n.compass?pt("Literal",{value:n.compass,quoted:!0},[]):void 0},[]):pt("NodeRefGroup",{},n.map(r=>_b(r)?pt("NodeRef",{id:pt("Literal",{value:r.id,quoted:!0},[])},[]):pt("NodeRef",{id:pt("Literal",{value:r.id,quoted:!0},[]),port:r.port?pt("Literal",{value:r.port,
quoted:!0},[]):void 0,compass:r.compass?pt("Literal",{value:r.compass,quoted:!0},[]):void 0},[]))))},[...e.attributes.comment?[no(e.attributes.comment,t.commentKind)]:[],...e.attributes.values.map(([n,r])=>sg(n,r))])}},v5={match(t){return t.$$type==="Graph"},convert(t,e){return pt("Dot",{},[...e.comment?[no(e.comment,t.commentKind)]:[],pt("Graph",{directed:e.directed,strict:e.strict,id:e.id?pt("Literal",{value:e.id,quoted:!0},[]):void 0},jA(t,e))])}},w5={match(t){return t.$$type==="Node"},convert(t,e){
return pt("Node",{id:pt("Literal",{value:e.id,quoted:!0},[])},[...e.attributes.comment?[no(e.attributes.comment,t.commentKind)]:[],...e.attributes.values.map(([n,r])=>sg(n,r))])}},b5={match(t){return t.$$type==="Subgraph"},convert(t,e){return pt("Subgraph",{id:e.id?pt("Literal",{value:e.id,quoted:!0},[]):void 0},jA(t,e))}},E5=[g5,y5,w5,v5,b5];class k5{options;#e=[...E5];constructor(e={}){this.options=e}convert(e){const n=[...this.#e],{commentKind:r="Slash"}=this.options,i={commentKind:r,convert(s){
for(const a of n)if(a.match(s))return a.convert(i,s);throw Error()}};return i.convert(e)}}function R5(t,e){return new k5(e).convert(t)}const F=new Proxy(Object.freeze({}),{get:(t,e)=>e});class Ab{}class xb extends Ab{#e=new Map;constructor(e){super(),e!==void 0&&this.apply(e)}get values(){return Array.from(this.#e.entries())}get size(){return this.#e.size}get(e){return this.#e.get(e)}set(e,n){n!=null&&this.#e.set(e,n)}delete(e){this.#e.delete(e)}apply(e){const n=Array.isArray(e)?e:Object.entries(
e);for(const[r,i]of n)this.set(r,i)}clear(){this.#e.clear()}}class Pb extends xb{$$kind;get $$type(){return"AttributeList"}comment;constructor(e,n){super(n),this.$$kind=e}}class BA extends xb{#e=ng;id;comment;attributes=Object.freeze({graph:new Pb("Graph"),edge:new Pb("Edge"),node:new Pb("Node")});get nodes(){return Array.from(this.#t.nodes.values())}get edges(){return Array.from(this.#t.edges.values())}get subgraphs(){return Array.from(this.#t.subgraphs.values())}#t={nodes:new Map,edges:new Set,
subgraphs:new Set};with(e){this.#e=KH(e)}addNode(e){this.#t.nodes.set(e.id,e)}addEdge(e){this.#t.edges.add(e)}addSubgraph(e){this.#t.subgraphs.add(e)}existNode(e){return this.#t.nodes.has(e)}existEdge(e){return this.#t.edges.has(e)}existSubgraph(e){return this.#t.subgraphs.has(e)}createSubgraph(...e){const n=new this.#e.Subgraph(...e);return n.with(this.#e),this.addSubgraph(n),n}removeNode(e){this.#t.nodes.delete(typeof e=="string"?e:e.id)}removeEdge(e){this.#t.edges.delete(e)}removeSubgraph(e){
this.#t.subgraphs.delete(e)}createNode(e,n){const r=new this.#e.Node(e,n);return this.addNode(r),r}getSubgraph(e){return Array.from(this.#t.subgraphs.values()).find(n=>n.id===e)}getNode(e){return this.#t.nodes.get(e)}createEdge(e,n){const r=e.map(s=>WH(s)?VH(s):LA(s)),i=new this.#e.Edge(r,n);return this.addEdge(i),i}subgraph(...e){const n=e.find(a=>typeof a=="string"),r=e.find(a=>typeof a=="object"&&a!==null),i=e.find(a=>typeof a=="function"),s=n?this.getSubgraph(n)??this.createSubgraph(n):this.
createSubgraph();return r!==void 0&&s.apply(r),i!==void 0&&i(s),s}node(e,...n){if(typeof e=="string"){const r=e,i=n.find(o=>typeof o=="object"&&o!==null),s=n.find(o=>typeof o=="function"),a=this.getNode(r)??this.createNode(r);return i!==void 0&&a.attributes.apply(i),s!==void 0&&s(a),a}typeof e=="object"&&e!==null&&this.attributes.node.apply(e)}edge(e,...n){if(Array.isArray(e)){const r=e,i=n.find(o=>typeof o=="object"),s=n.find(o=>typeof o=="function"),a=this.createEdge(r,i);return s!==void 0&&s(
a),a}typeof e=="object"&&e!==null&&this.attributes.edge.apply(e)}graph(e){this.attributes.graph.apply(e)}}class qA extends BA{get $$type(){return"Graph"}id;strict;constructor(...e){super(),this.id=e.find(r=>typeof r=="string"),this.strict=e.find(r=>typeof r=="boolean")??!1;const n=e.find(r=>typeof r=="object"&&r!==null);n!==void 0&&this.apply(n)}}class $5 extends qA{get directed(){return!0}}let D5=class extends qA{get directed(){return!1}};class T5 extends BA{get $$type(){return"Subgraph"}id;constructor(...e){
super(),this.id=e.find(r=>typeof r=="string");const n=e.find(r=>typeof r=="object"&&r!==null);n!==void 0&&this.apply(n)}isSubgraphCluster(){return typeof this.id=="string"?this.id.startsWith("cluster"):!1}}class GA extends xb{comment}let S5=class extends Ab{id;get $$type(){return"Node"}comment;attributes;constructor(e,n){super(),this.id=e,this.attributes=new GA(n)}port(e){return typeof e=="string"?{id:this.id,port:e}:{id:this.id,...e}}};class C5 extends Ab{targets;get $$type(){return"Edge"}comment;attributes;constructor(e,n){
if(super(),this.targets=e,e.length<2&&(Tf(e[0])&&Tf(e[1]))===!1)throw Error("The element of Edge target is missing or not satisfied as Edge target.");this.attributes=new GA(n)}}Object.assign(ng,{Graph:D5,Digraph:$5,Subgraph:T5,Node:S5,Edge:C5});function UA(t,e){return(...n)=>{const r=t?this.Digraph:this.Graph,i=n.find(u=>typeof u=="string"),s=n.find(u=>typeof u=="object"),a=n.find(u=>typeof u=="function"),o=new r(i,e,s);return o.with(this),typeof a=="function"&&a(o),o}}function zA(t,e=ng){return Object.
freeze({digraph:UA.call(e,!0,t),graph:UA.call(e,!1,t)})}const WA=zA(!1),_5=WA.digraph;WA.graph;const A5=zA(!0);function HA(t,e){const n=R5(t,e?.convert);return m5(n,e?.print)}var Nb,VA;function x5(){if(VA)return Nb;VA=1;function t(r){let i=r.length-1,s=r[i];for(;s===" "||s==="	";)s=r[--i];return r.substring(0,i+1)}function e(r){return r.split(`
`).map(a=>t(a)).join(`
`)}Nb=function(r,i){if(i=i||{},r==null)return r;var s=i.width||50,a=typeof i.indent=="string"?i.indent:"  ",o=i.newline||`
`+a,u=typeof i.escape=="function"?i.escape:n,c=".{1,"+s+"}";i.cut!==!0&&(c+="([\\s\u200B]+|$)|[^\\s\u200B]+?([\\s\u200B]+|$)");var l=new RegExp(c,"g"),f=r.match(l)||[],d=a+f.map(function(h){return h.slice(-1)===`
`&&(h=h.slice(0,h.length-1)),u(h)}).join(o);return i.trim===!0&&(d=e(d)),d};function n(r){return r}return Nb}var P5=x5();const N5=fi(P5),ag={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:t=>t>=255?255:t<0?0:t,g:t=>t>=255?255:t<0?0:t,b:t=>t>=255?255:t<0?0:t,h:t=>t%360,s:t=>t>=100?100:t<0?0:t,l:t=>t>=100?100:t<0?0:t,a:t=>t>=1?1:t<0?0:t},toLinear:t=>{const e=t/255;return t>.03928?Math.pow((e+.055)/1.055,2.4):e/12.92},hue2rgb:(t,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<
1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t),hsl2rgb:({h:t,s:e,l:n},r)=>{if(!e)return n*2.55;t/=360,e/=100,n/=100;const i=n<.5?n*(1+e):n+e-n*e,s=2*n-i;switch(r){case"r":return ag.hue2rgb(s,i,t+1/3)*255;case"g":return ag.hue2rgb(s,i,t)*255;case"b":return ag.hue2rgb(s,i,t-1/3)*255}},rgb2hsl:({r:t,g:e,b:n},r)=>{t/=255,e/=255,n/=255;const i=Math.max(t,e,n),s=Math.min(t,e,n),a=(i+s)/2;if(r==="l")return a*100;if(i===s)return 0;const o=i-s,u=a>.5?o/(2-i-s):o/(i+s);if(r==="s")return u*100;switch(i){case t:
return((e-n)/o+(e<n?6:0))*60;case e:return((n-t)/o+2)*60;case n:return((t-e)/o+4)*60;default:return-1}}},I5={clamp:(t,e,n)=>e>n?Math.min(e,Math.max(n,t)):Math.min(n,Math.max(e,t)),round:t=>Math.round(t*1e10)/1e10},O5={dec2hex:t=>{const e=Math.round(t).toString(16);return e.length>1?e:`0${e}`}},He={channel:ag,lang:I5,unit:O5},Gs={};for(let t=0;t<=255;t++)Gs[t]=He.unit.dec2hex(t);const xn={ALL:0,RGB:1,HSL:2};class L5{constructor(){this.type=xn.ALL}get(){return this.type}set(e){if(this.type&&this.type!==
e)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=e}reset(){this.type=xn.ALL}is(e){return this.type===e}}class F5{constructor(e,n){this.color=n,this.changed=!1,this.data=e,this.type=new L5}set(e,n){return this.color=n,this.changed=!1,this.data=e,this.type.type=xn.ALL,this}_ensureHSL(){const e=this.data,{h:n,s:r,l:i}=e;n===void 0&&(e.h=He.channel.rgb2hsl(e,"h")),r===void 0&&(e.s=He.channel.rgb2hsl(e,"s")),i===void 0&&(e.l=He.channel.rgb2hsl(e,"l"))}_ensureRGB(){
const e=this.data,{r:n,g:r,b:i}=e;n===void 0&&(e.r=He.channel.hsl2rgb(e,"r")),r===void 0&&(e.g=He.channel.hsl2rgb(e,"g")),i===void 0&&(e.b=He.channel.hsl2rgb(e,"b"))}get r(){const e=this.data,n=e.r;return!this.type.is(xn.HSL)&&n!==void 0?n:(this._ensureHSL(),He.channel.hsl2rgb(e,"r"))}get g(){const e=this.data,n=e.g;return!this.type.is(xn.HSL)&&n!==void 0?n:(this._ensureHSL(),He.channel.hsl2rgb(e,"g"))}get b(){const e=this.data,n=e.b;return!this.type.is(xn.HSL)&&n!==void 0?n:(this._ensureHSL(),He.
channel.hsl2rgb(e,"b"))}get h(){const e=this.data,n=e.h;return!this.type.is(xn.RGB)&&n!==void 0?n:(this._ensureRGB(),He.channel.rgb2hsl(e,"h"))}get s(){const e=this.data,n=e.s;return!this.type.is(xn.RGB)&&n!==void 0?n:(this._ensureRGB(),He.channel.rgb2hsl(e,"s"))}get l(){const e=this.data,n=e.l;return!this.type.is(xn.RGB)&&n!==void 0?n:(this._ensureRGB(),He.channel.rgb2hsl(e,"l"))}get a(){return this.data.a}set r(e){this.type.set(xn.RGB),this.changed=!0,this.data.r=e}set g(e){this.type.set(xn.RGB),
this.changed=!0,this.data.g=e}set b(e){this.type.set(xn.RGB),this.changed=!0,this.data.b=e}set h(e){this.type.set(xn.HSL),this.changed=!0,this.data.h=e}set s(e){this.type.set(xn.HSL),this.changed=!0,this.data.s=e}set l(e){this.type.set(xn.HSL),this.changed=!0,this.data.l=e}set a(e){this.changed=!0,this.data.a=e}}const Ib=new F5({r:0,g:0,b:0,a:0},"transparent"),Eu={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:t=>{if(t.charCodeAt(0)!==35)return;const e=t.match(Eu.re);if(!e)return;const n=e[1],
r=parseInt(n,16),i=n.length,s=i%4===0,a=i>4,o=a?1:17,u=a?8:4,c=s?0:-1,l=a?255:15;return Ib.set({r:(r>>u*(c+3)&l)*o,g:(r>>u*(c+2)&l)*o,b:(r>>u*(c+1)&l)*o,a:s?(r&l)*o/255:1},t)},stringify:t=>{const{r:e,g:n,b:r,a:i}=t;return i<1?`#${Gs[Math.round(e)]}${Gs[Math.round(n)]}${Gs[Math.round(r)]}${Gs[Math.round(i*255)]}`:`#${Gs[Math.round(e)]}${Gs[Math.round(n)]}${Gs[Math.round(r)]}`}},ro={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,
hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:t=>{const e=t.match(ro.hueRe);if(e){const[,n,r]=e;switch(r){case"grad":return He.channel.clamp.h(parseFloat(n)*.9);case"rad":return He.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return He.channel.clamp.h(parseFloat(n)*360)}}return He.channel.clamp.h(parseFloat(t))},parse:t=>{const e=t.charCodeAt(0);if(e!==104&&e!==72)return;const n=t.match(ro.re);if(!n)return;const[,r,i,s,a,o]=n;return Ib.set({h:ro._hue2deg(r),s:He.channel.clamp.s(parseFloat(
i)),l:He.channel.clamp.l(parseFloat(s)),a:a?He.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},t)},stringify:t=>{const{h:e,s:n,l:r,a:i}=t;return i<1?`hsla(${He.lang.round(e)}, ${He.lang.round(n)}%, ${He.lang.round(r)}%, ${i})`:`hsl(${He.lang.round(e)}, ${He.lang.round(n)}%, ${He.lang.round(r)}%)`}},Cf={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",
blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8f\
bc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c\
5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"\
#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"\
#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"\
#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:t=>{t=t.toLowerCase();const e=Cf.colors[t];if(e)return Eu.parse(e)},stringify:t=>{const e=Eu.stringify(t);for(const n in Cf.colors)if(Cf.colors[n]===e)return n}},_f={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,
parse:t=>{const e=t.charCodeAt(0);if(e!==114&&e!==82)return;const n=t.match(_f.re);if(!n)return;const[,r,i,s,a,o,u,c,l]=n;return Ib.set({r:He.channel.clamp.r(i?parseFloat(r)*2.55:parseFloat(r)),g:He.channel.clamp.g(a?parseFloat(s)*2.55:parseFloat(s)),b:He.channel.clamp.b(u?parseFloat(o)*2.55:parseFloat(o)),a:c?He.channel.clamp.a(l?parseFloat(c)/100:parseFloat(c)):1},t)},stringify:t=>{const{r:e,g:n,b:r,a:i}=t;return i<1?`rgba(${He.lang.round(e)}, ${He.lang.round(n)}, ${He.lang.round(r)}, ${He.lang.
round(i)})`:`rgb(${He.lang.round(e)}, ${He.lang.round(n)}, ${He.lang.round(r)})`}},Us={format:{keyword:Cf,hex:Eu,rgb:_f,rgba:_f,hsl:ro,hsla:ro},parse:t=>{if(typeof t!="string")return t;const e=Eu.parse(t)||_f.parse(t)||ro.parse(t)||Cf.parse(t);if(e)return e;throw new Error(`Unsupported color format: "${t}"`)},stringify:t=>!t.changed&&t.color?t.color:t.type.is(xn.HSL)||t.data.r===void 0?ro.stringify(t):t.a<1||!Number.isInteger(t.r)||!Number.isInteger(t.g)||!Number.isInteger(t.b)?_f.stringify(t):Eu.
stringify(t)},M5=(t,e)=>{const n=Us.parse(t);for(const r in e)n[r]=He.channel.clamp[r](e[r]);return Us.stringify(n)},KA=t=>Us.format.hex.stringify(Us.parse(t)),j5=(t,e,n)=>{const r=Us.parse(t),i=r[e],s=He.channel.clamp[e](i+n);return i!==s&&(r[e]=s),Us.stringify(r)},B5=(t,e)=>j5(t,"a",-.3),q5=(t,e)=>{const n=Us.parse(t),r={};for(const i in e)e[i]&&(r[i]=n[i]+e[i]);return M5(t,r)},G5=(t,e)=>{const n=Us.parse(t),r={},i=(s,a,o)=>a>0?(o-s)*a/100:s*a/100;for(const s in e)r[s]=i(n[s],e[s],He.channel.max[s]);
return q5(t,r)};function br(t){return t.children.length>0}function Pn(t){switch(t){case"open":return"vee";default:return t}}function Ti(t){return Array.isArray(t)?[Ti(t[0]),Ti(t[1])]:(Fe(isFinite(t),`Invalid not finite point value ${t}`),Math.round(t))}const ZA=t=>(Fe(isFinite(t),`Invalid not finite inch value ${t}`),Math.floor(t*72)),At=t=>Math.ceil(t/72*1e3)/1e3,Pr=t=>Math.ceil(t);Pr(40).toString();function XA(t,e){return KA(G5(t,{l:-35-5*e,s:-15-5*e}))}function U5(t){return KA(B5(t))}function z5(t){
return t.trim().replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")}function YA(t,{maxchars:e,maxLines:n,sanitize:r=TU()}){let i=N5(t,{width:e,indent:"",escape:r}).split(`
`);return Rn(n)&&n>0&&i.length>n&&(i=i.slice(0,n-1)),i}function io({text:t,maxchars:e,fontsize:n,maxLines:r,bold:i,color:s}){let a=YA(t,{maxchars:e,maxLines:r,sanitize:z5}).join("<BR/>");i&&(a=`<B>${a}</B>`);const o=s?` COLOR="${s}"`:"";return`<FONT POINT-SIZE="${Pr(n)}"${o}>${a}</FONT>`}function Ob(t){return fn.textSizes[t]}function W5(t){switch(t){case"xs":case"sm":return 25;case"md":return 35;case"lg":case"xl":return 45;default:Ke(t)}}function H5(t,e,n){const r=["sm","xs"].includes(n.shape),i=fe(
t.icon),s=[io({text:t.title,fontsize:Ob(n.text),maxchars:W5(n.shape),maxLines:r?1:3})];if(n.shape!=="xs"&&(fe(t.technology?.trim())&&s.push(io({text:t.technology,fontsize:Math.ceil(Ob(n.text)*.65),maxchars:i?35:45,maxLines:1,color:e.loContrast})),fe(t.description?.trim())&&s.push(io({text:t.description,fontsize:Math.ceil(Ob(n.text)*.75),maxchars:i?35:45,maxLines:r?3:5,color:e.loContrast}))),s.length===1&&!i)return`<${s[0]}>`;const a=i?(o,u,c)=>{let l=`<TD ALIGN="TEXT" BALIGN="LEFT">${o}</TD>`;if(u===
0){const f=c.length>1?` ROWSPAN="${c.length}"`:"";let d=76;["xs","sm"].includes(n.shape)&&(d=16),(t.shape==="queue"||t.shape==="mobile")&&(d+=20),l=`<TD${f} WIDTH="${d}"> </TD>${l}`,l=`${l}<TD${f} WIDTH="16"> </TD>`}return`<TR>${l}</TR>`}:o=>`<TR><TD>${o}</TD></TR>`;return`<<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="4">${s.map(a).join("")}</TABLE>>`}function V5(t,e){const n=io({text:t.title.toUpperCase(),maxchars:50,fontsize:11,maxLines:1,bold:!0,color:e});return n.includes("<BR/>")?`<<TABLE\
 BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD ALIGN="TEXT" BALIGN="LEFT">${n}</TD></TR></TABLE>>`:`<${n}>`}const og=40,JA=5,Lb=`BGCOLOR="${fn.relationships[Nu].labelBgColor}A0"`;function QA({label:t,technology:e}){const n=[];if(fe(t?.trim())&&n.push(io({text:t,maxchars:og,fontsize:14,maxLines:JA,bold:t==="[...]"})),fe(e?.trim())&&n.push(io({text:`[ ${e} ]`,fontsize:12,maxLines:1,maxchars:og})),n.length===0)return null;const r=n.map(i=>`<TR><TD ALIGN="TEXT" BALIGN="LEFT">${i}</TD></TR>`).join(
"");return`<<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" ${Lb}>${r}</TABLE>>`}function K5(t,e){const n=`<TABLE BORDER="0" CELLPADDING="6" ${Lb}><TR><TD WIDTH="20" HEIGHT="20"><FONT POINT-SIZE="${Pr(14)}"><B>${t}</B></FONT></TD></TR></TABLE>`;return fe(e?.trim())?`<${['<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">',"<TR>",`<TD>${n}</TD>`,`<TD ${Lb} CELLPADDING="3">`,io({text:e,maxchars:og,fontsize:14,maxLines:5}),"</TD>","</TR>","</TABLE>"].join("")}>`:`<${n}>`}var Fb,ex;function Mb(){if(ex)
return Fb;ex=1;function t(e){if(typeof e!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=e}return typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=function(){return this}),t.of=function(){var e=arguments,n=e.length,r=0;return new t(function(){return r>=n?{done:!0}:{done:!1,value:e[r++]}})},t.empty=function(){var e=new t(function(){return{done:!0}});return e},t.fromSequence=function(e){var n=0,r=e.length;return new t(function(){return n>=r?{done:!0}:{done:!1,value:e[n++]}})},
t.is=function(e){return e instanceof t?!0:typeof e=="object"&&e!==null&&typeof e.next=="function"},Fb=t,Fb}var Z5=Mb();const Nr=fi(Z5);var ug={},tx;function X5(){return tx||(tx=1,ug.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u",ug.SYMBOL_SUPPORT=typeof Symbol<"u"),ug}var jb,nx;function rx(){if(nx)return jb;nx=1;var t=Mb(),e=X5(),n=e.ARRAY_BUFFER_SUPPORT,r=e.SYMBOL_SUPPORT;function i(s){return typeof s=="string"||Array.isArray(s)||n&&ArrayBuffer.isView(s)?t.fromSequence(s):typeof s!="object"||s===null?
null:r&&typeof s[Symbol.iterator]=="function"?s[Symbol.iterator]():typeof s.next=="function"?s:null}return jb=function(a){var o=i(a);if(!o)throw new Error("obliterator: target is not iterable nor a valid iterator.");return o},jb}var Bb,ix;function Y5(){if(ix)return Bb;ix=1;var t=rx();return Bb=function(n,r){for(var i=arguments.length>1?r:1/0,s=i!==1/0?new Array(i):[],a,o=0,u=t(n);;){if(o===i)return s;if(a=u.next(),a.done)return o!==r&&(s.length=o),s;s[o++]=a.value}},Bb}var J5=Y5();const sx=fi(J5);
var qb,ax;function Q5(){if(ax)return qb;ax=1;var t=Mb(),e=rx();return qb=function(){var r=arguments,i=null,s=-1;return new t(function(){var o=null;do{if(i===null){if(s++,s>=r.length)return{done:!0};i=e(r[s])}if(o=i.next(),o.done===!0){i=null;continue}break}while(!0);return o})},qb}var eV=Q5();const ps=fi(eV);function tV(){const t=arguments[0];for(let e=1,n=arguments.length;e<n;e++)if(arguments[e])for(const r in arguments[e])t[r]=arguments[e][r];return t}let cn=tV;typeof Object.assign=="function"&&
(cn=Object.assign);function Ir(t,e,n,r){const i=t._nodes.get(e);let s=null;return i&&(r==="mixed"?s=i.out&&i.out[n]||i.undirected&&i.undirected[n]:r==="directed"?s=i.out&&i.out[n]:s=i.undirected&&i.undirected[n]),s}function Dn(t){return typeof t=="object"&&t!==null}function ox(t){let e;for(e in t)return!1;return!0}function Or(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,writable:!0,value:n})}function ti(t,e,n){const r={enumerable:!0,configurable:!0};typeof n=="function"?r.get=
n:(r.value=n,r.writable=!1),Object.defineProperty(t,e,r)}function ux(t){return!(!Dn(t)||t.attributes&&!Array.isArray(t.attributes))}function nV(){let t=Math.floor(Math.random()*256)&255;return()=>t++}class Gb extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class we extends Gb{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,we.prototype.constructor)}}class le extends Gb{constructor(e){
super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,le.prototype.constructor)}}class Ne extends Gb{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ne.prototype.constructor)}}function cx(t,e){this.key=t,this.attributes=e,this.clear()}cx.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=
0,this.in={},this.out={},this.undirected={}};function lx(t,e){this.key=t,this.attributes=e,this.clear()}lx.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function dx(t,e){this.key=t,this.attributes=e,this.clear()}dx.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function ku(t,e,n,r,i){this.key=e,this.attributes=i,this.undirected=t,this.source=n,this.target=r}ku.prototype.attach=function(){let t="\
out",e="in";this.undirected&&(t=e="undirected");const n=this.source.key,r=this.target.key;this.source[t][r]=this,!(this.undirected&&n===r)&&(this.target[e][n]=this)},ku.prototype.attachMulti=function(){let t="out",e="in";const n=this.source.key,r=this.target.key;this.undirected&&(t=e="undirected");const i=this.source[t],s=i[r];if(typeof s>"u"){i[r]=this,this.undirected&&n===r||(this.target[e][n]=this);return}s.previous=this,this.next=s,i[r]=this,this.target[e][n]=this},ku.prototype.detach=function(){
const t=this.source.key,e=this.target.key;let n="out",r="in";this.undirected&&(n=r="undirected"),delete this.source[n][e],delete this.target[r][t]},ku.prototype.detachMulti=function(){const t=this.source.key,e=this.target.key;let n="out",r="in";this.undirected&&(n=r="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[n][e],delete this.target[r][t]):(this.next.previous=void 0,this.source[n][e]=this.next,this.target[r][t]=this.next):(this.previous.next=this.next,this.next!==
void 0&&(this.next.previous=this.previous))};const fx=0,hx=1,rV=2,px=3;function ms(t,e,n,r,i,s,a){let o,u,c,l;if(r=""+r,n===fx){if(o=t._nodes.get(r),!o)throw new le(`Graph.${e}: could not find the "${r}" node in the graph.`);c=i,l=s}else if(n===px){if(i=""+i,u=t._edges.get(i),!u)throw new le(`Graph.${e}: could not find the "${i}" edge in the graph.`);const f=u.source.key,d=u.target.key;if(r===f)o=u.target;else if(r===d)o=u.source;else throw new le(`Graph.${e}: the "${r}" node is not attached to \
the "${i}" edge (${f}, ${d}).`);c=s,l=a}else{if(u=t._edges.get(r),!u)throw new le(`Graph.${e}: could not find the "${r}" edge in the graph.`);n===hx?o=u.source:o=u.target,c=i,l=s}return[o,c,l]}function iV(t,e,n){t.prototype[e]=function(r,i,s){const[a,o]=ms(this,e,n,r,i,s);return a.attributes[o]}}function sV(t,e,n){t.prototype[e]=function(r,i){const[s]=ms(this,e,n,r,i);return s.attributes}}function aV(t,e,n){t.prototype[e]=function(r,i,s){const[a,o]=ms(this,e,n,r,i,s);return a.attributes.hasOwnProperty(
o)}}function oV(t,e,n){t.prototype[e]=function(r,i,s,a){const[o,u,c]=ms(this,e,n,r,i,s,a);return o.attributes[u]=c,this.emit("nodeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:u}),this}}function uV(t,e,n){t.prototype[e]=function(r,i,s,a){const[o,u,c]=ms(this,e,n,r,i,s,a);if(typeof c!="function")throw new we(`Graph.${e}: updater should be a function.`);const l=o.attributes,f=c(l[u]);return l[u]=f,this.emit("nodeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,
name:u}),this}}function cV(t,e,n){t.prototype[e]=function(r,i,s){const[a,o]=ms(this,e,n,r,i,s);return delete a.attributes[o],this.emit("nodeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:o}),this}}function lV(t,e,n){t.prototype[e]=function(r,i,s){const[a,o]=ms(this,e,n,r,i,s);if(!Dn(o))throw new we(`Graph.${e}: provided attributes are not a plain object.`);return a.attributes=o,this.emit("nodeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function dV(t,e,n){
t.prototype[e]=function(r,i,s){const[a,o]=ms(this,e,n,r,i,s);if(!Dn(o))throw new we(`Graph.${e}: provided attributes are not a plain object.`);return cn(a.attributes,o),this.emit("nodeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:o}),this}}function fV(t,e,n){t.prototype[e]=function(r,i,s){const[a,o]=ms(this,e,n,r,i,s);if(typeof o!="function")throw new we(`Graph.${e}: provided updater is not a function.`);return a.attributes=o(a.attributes),this.emit("nodeAttributesUpdat\
ed",{key:a.key,type:"update",attributes:a.attributes}),this}}const hV=[{name:t=>`get${t}Attribute`,attacher:iV},{name:t=>`get${t}Attributes`,attacher:sV},{name:t=>`has${t}Attribute`,attacher:aV},{name:t=>`set${t}Attribute`,attacher:oV},{name:t=>`update${t}Attribute`,attacher:uV},{name:t=>`remove${t}Attribute`,attacher:cV},{name:t=>`replace${t}Attributes`,attacher:lV},{name:t=>`merge${t}Attributes`,attacher:dV},{name:t=>`update${t}Attributes`,attacher:fV}];function pV(t){hV.forEach(function({name:e,
attacher:n}){n(t,e("Node"),fx),n(t,e("Source"),hx),n(t,e("Target"),rV),n(t,e("Opposite"),px)})}function mV(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ne(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ne(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);
const a=""+r,o=""+i;if(i=arguments[2],s=Ir(this,a,o,n),!s)throw new le(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Ne(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new le(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return s.attributes[i]}}function gV(t,e,n){t.prototype[e]=function(r){
let i;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ne(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new Ne(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,a=""+arguments[1];if(i=Ir(this,s,a,n),!i)throw new le(`Graph.${e}: could not find an edge for the given path ("${s}" - "${a}").`)}else{
if(n!=="mixed")throw new Ne(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,i=this._edges.get(r),!i)throw new le(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return i.attributes}}function yV(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ne(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);
if(arguments.length>2){if(this.multi)throw new Ne(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+i;if(i=arguments[2],s=Ir(this,a,o,n),!s)throw new le(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Ne(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edg\
e with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new le(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return s.attributes.hasOwnProperty(i)}}function vV(t,e,n){t.prototype[e]=function(r,i,s){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ne(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Ne(`Graph.${e}: cannot use a {source,target} combo when asking about\
 an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,u=""+i;if(i=arguments[2],s=arguments[3],a=Ir(this,o,u,n),!a)throw new le(`Graph.${e}: could not find an edge for the given path ("${o}" - "${u}").`)}else{if(n!=="mixed")throw new Ne(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new le(`Graph.${e}\
: could not find the "${r}" edge in the graph.`)}return a.attributes[i]=s,this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:i}),this}}function wV(t,e,n){t.prototype[e]=function(r,i,s){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ne(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Ne(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes \
in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,u=""+i;if(i=arguments[2],s=arguments[3],a=Ir(this,o,u,n),!a)throw new le(`Graph.${e}: could not find an edge for the given path ("${o}" - "${u}").`)}else{if(n!=="mixed")throw new Ne(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new le(`Graph.${e}: could not find th\
e "${r}" edge in the graph.`)}if(typeof s!="function")throw new we(`Graph.${e}: updater should be a function.`);return a.attributes[i]=s(a.attributes[i]),this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:i}),this}}function bV(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ne(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ne(`Graph.${e}\
: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+i;if(i=arguments[2],s=Ir(this,a,o,n),!s)throw new le(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Ne(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this.
_edges.get(r),!s)throw new le(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return delete s.attributes[i],this.emit("edgeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:i}),this}}function EV(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ne(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ne(`Graph.${e}: cannot use a {source,target\
} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+i;if(i=arguments[2],s=Ir(this,a,o,n),!s)throw new le(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Ne(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new le(
`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!Dn(i))throw new we(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=i,this.emit("edgeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function kV(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ne(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ne(`G\
raph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+i;if(i=arguments[2],s=Ir(this,a,o,n),!s)throw new le(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Ne(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+
r,s=this._edges.get(r),!s)throw new le(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!Dn(i))throw new we(`Graph.${e}: provided attributes are not a plain object.`);return cn(s.attributes,i),this.emit("edgeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:i}),this}}function RV(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ne(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.
length>2){if(this.multi)throw new Ne(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+i;if(i=arguments[2],s=Ir(this,a,o,n),!s)throw new le(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Ne(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this k\
ey could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new le(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(typeof i!="function")throw new we(`Graph.${e}: provided updater is not a function.`);return s.attributes=i(s.attributes),this.emit("edgeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}const $V=[{name:t=>`get${t}Attribute`,attacher:mV},{name:t=>`get${t}Attributes`,attacher:gV},{name:t=>`has${t}Attribute`,attacher:yV},{name:t=>`se\
t${t}Attribute`,attacher:vV},{name:t=>`update${t}Attribute`,attacher:wV},{name:t=>`remove${t}Attribute`,attacher:bV},{name:t=>`replace${t}Attributes`,attacher:EV},{name:t=>`merge${t}Attributes`,attacher:kV},{name:t=>`update${t}Attributes`,attacher:RV}];function DV(t){$V.forEach(function({name:e,attacher:n}){n(t,e("Edge"),"mixed"),n(t,e("DirectedEdge"),"directed"),n(t,e("UndirectedEdge"),"undirected")})}const TV=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"o\
utEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function SV(t,e,n,r){let i=!1;for(const s in e){if(s===r)continue;const a=e[s];if(i=n(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected),t&&i)return a.key}}function CV(t,e,n,r){let i,s,a,o=!1;for(const u in e)if(u!==r){i=e[u];
do{if(s=i.source,a=i.target,o=n(i.key,i.attributes,s.key,a.key,s.attributes,a.attributes,i.undirected),t&&o)return i.key;i=i.next}while(i!==void 0)}}function Ub(t,e){const n=Object.keys(t),r=n.length;let i,s=0;return new Nr(function(){do if(i)i=i.next;else{if(s>=r)return{done:!0};const o=n[s++];if(o===e){i=void 0;continue}i=t[o]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.
attributes,undirected:i.undirected}}})}function _V(t,e,n,r){const i=e[n];if(!i)return;const s=i.source,a=i.target;if(r(i.key,i.attributes,s.key,a.key,s.attributes,a.attributes,i.undirected)&&t)return i.key}function AV(t,e,n,r){let i=e[n];if(!i)return;let s=!1;do{if(s=r(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),t&&s)return i.key;i=i.next}while(i!==void 0)}function zb(t,e){let n=t[e];return n.next!==void 0?new Nr(function(){if(!n)return{done:!0};
const r={edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected};return n=n.next,{done:!1,value:r}}):Nr.of({edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected})}function xV(t,e){if(t.size===0)return[];if(e==="mixed"||e===t.type)return typeof Array.from=="funct\
ion"?Array.from(t._edges.keys()):sx(t._edges.keys(),t._edges.size);const n=e==="undirected"?t.undirectedSize:t.directedSize,r=new Array(n),i=e==="undirected",s=t._edges.values();let a=0,o,u;for(;o=s.next(),o.done!==!0;)u=o.value,u.undirected===i&&(r[a++]=u.key);return r}function mx(t,e,n,r){if(e.size===0)return;const i=n!=="mixed"&&n!==e.type,s=n==="undirected";let a,o,u=!1;const c=e._edges.values();for(;a=c.next(),a.done!==!0;){if(o=a.value,i&&o.undirected!==s)continue;const{key:l,attributes:f,
source:d,target:h}=o;if(u=r(l,f,d.key,h.key,d.attributes,h.attributes,o.undirected),t&&u)return l}}function PV(t,e){if(t.size===0)return Nr.empty();const n=e!=="mixed"&&e!==t.type,r=e==="undirected",i=t._edges.values();return new Nr(function(){let a,o;for(;;){if(a=i.next(),a.done)return a;if(o=a.value,!(n&&o.undirected!==r))break}return{value:{edge:o.key,attributes:o.attributes,source:o.source.key,target:o.target.key,sourceAttributes:o.source.attributes,targetAttributes:o.target.attributes,undirected:o.
undirected},done:!1}})}function Wb(t,e,n,r,i,s){const a=e?CV:SV;let o;if(n!=="undirected"&&(r!=="out"&&(o=a(t,i.in,s),t&&o)||r!=="in"&&(o=a(t,i.out,s,r?void 0:i.key),t&&o))||n!=="directed"&&(o=a(t,i.undirected,s),t&&o))return o}function NV(t,e,n,r){const i=[];return Wb(!1,t,e,n,r,function(s){i.push(s)}),i}function IV(t,e,n){let r=Nr.empty();return t!=="undirected"&&(e!=="out"&&typeof n.in<"u"&&(r=ps(r,Ub(n.in))),e!=="in"&&typeof n.out<"u"&&(r=ps(r,Ub(n.out,e?void 0:n.key)))),t!=="directed"&&typeof n.
undirected<"u"&&(r=ps(r,Ub(n.undirected))),r}function Hb(t,e,n,r,i,s,a){const o=n?AV:_V;let u;if(e!=="undirected"&&(typeof i.in<"u"&&r!=="out"&&(u=o(t,i.in,s,a),t&&u)||typeof i.out<"u"&&r!=="in"&&(r||i.key!==s)&&(u=o(t,i.out,s,a),t&&u))||e!=="directed"&&typeof i.undirected<"u"&&(u=o(t,i.undirected,s,a),t&&u))return u}function OV(t,e,n,r,i){const s=[];return Hb(!1,t,e,n,r,i,function(a){s.push(a)}),s}function LV(t,e,n,r){let i=Nr.empty();return t!=="undirected"&&(typeof n.in<"u"&&e!=="out"&&r in n.
in&&(i=ps(i,zb(n.in,r))),typeof n.out<"u"&&e!=="in"&&r in n.out&&(e||n.key!==r)&&(i=ps(i,zb(n.out,r)))),t!=="directed"&&typeof n.undirected<"u"&&r in n.undirected&&(i=ps(i,zb(n.undirected,r))),i}function FV(t,e){const{name:n,type:r,direction:i}=e;t.prototype[n]=function(s,a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];if(!arguments.length)return xV(this,r);if(arguments.length===1){s=""+s;const o=this._nodes.get(s);if(typeof o>"u")throw new le(`Graph.${n}: could not find the "${s}\
" node in the graph.`);return NV(this.multi,r==="mixed"?this.type:r,i,o)}if(arguments.length===2){s=""+s,a=""+a;const o=this._nodes.get(s);if(!o)throw new le(`Graph.${n}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(a))throw new le(`Graph.${n}:  could not find the "${a}" target node in the graph.`);return OV(r,this.multi,i,o,a)}throw new we(`Graph.${n}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function MV(t,e){const{name:n,type:r,direction:i}=e,
s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(c,l,f){if(!(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)){if(arguments.length===1)return f=c,mx(!1,this,r,f);if(arguments.length===2){c=""+c,f=l;const d=this._nodes.get(c);if(typeof d>"u")throw new le(`Graph.${s}: could not find the "${c}" node in the graph.`);return Wb(!1,this.multi,r==="mixed"?this.type:r,i,d,f)}if(arguments.length===3){c=""+c,l=""+l;const d=this._nodes.get(c);if(!d)throw new le(`Graph.${s}:  could not fi\
nd the "${c}" source node in the graph.`);if(!this._nodes.has(l))throw new le(`Graph.${s}:  could not find the "${l}" target node in the graph.`);return Hb(!1,r,this.multi,i,d,l,f)}throw new we(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const a="map"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(){const c=Array.prototype.slice.call(arguments),l=c.pop();let f;if(c.length===0){let d=0;r!=="directed"&&(d+=this.undirectedSize),r!=="undirected"&&(d+=
this.directedSize),f=new Array(d);let h=0;c.push((p,w,v,g,b,k,_)=>{f[h++]=l(p,w,v,g,b,k,_)})}else f=[],c.push((d,h,p,w,v,g,b)=>{f.push(l(d,h,p,w,v,g,b))});return this[s].apply(this,c),f};const o="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(){const c=Array.prototype.slice.call(arguments),l=c.pop(),f=[];return c.push((d,h,p,w,v,g,b)=>{l(d,h,p,w,v,g,b)&&f.push(d)}),this[s].apply(this,c),f};const u="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[u]=function(){let c=Array.prototype.
slice.call(arguments);if(c.length<2||c.length>4)throw new we(`Graph.${u}: invalid number of arguments (expecting 2, 3 or 4 and got ${c.length}).`);if(typeof c[c.length-1]=="function"&&typeof c[c.length-2]!="function")throw new we(`Graph.${u}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let l,f;c.length===2?(l=c[0],f=c[1],c=[]):c.length===3?(l=c[1],f=
c[2],c=[c[0]]):c.length===4&&(l=c[2],f=c[3],c=[c[0],c[1]]);let d=f;return c.push((h,p,w,v,g,b,k)=>{d=l(d,h,p,w,v,g,b,k)}),this[s].apply(this,c),d}}function jV(t,e){const{name:n,type:r,direction:i}=e,s="find"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(u,c,l){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return!1;if(arguments.length===1)return l=u,mx(!0,this,r,l);if(arguments.length===2){u=""+u,l=c;const f=this._nodes.get(u);if(typeof f>"u")throw new le(`Graph.${s}: could not fi\
nd the "${u}" node in the graph.`);return Wb(!0,this.multi,r==="mixed"?this.type:r,i,f,l)}if(arguments.length===3){u=""+u,c=""+c;const f=this._nodes.get(u);if(!f)throw new le(`Graph.${s}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(c))throw new le(`Graph.${s}:  could not find the "${c}" target node in the graph.`);return Hb(!0,r,this.multi,i,f,c,l)}throw new we(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const a="some"+n[0].
toUpperCase()+n.slice(1,-1);t.prototype[a]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop();return u.push((f,d,h,p,w,v,g)=>c(f,d,h,p,w,v,g)),!!this[s].apply(this,u)};const o="every"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[o]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop();return u.push((f,d,h,p,w,v,g)=>!c(f,d,h,p,w,v,g)),!this[s].apply(this,u)}}function BV(t,e){const{name:n,type:r,direction:i}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(a,o){if(r!==
"mixed"&&this.type!=="mixed"&&r!==this.type)return Nr.empty();if(!arguments.length)return PV(this,r);if(arguments.length===1){a=""+a;const u=this._nodes.get(a);if(!u)throw new le(`Graph.${s}: could not find the "${a}" node in the graph.`);return IV(r,i,u)}if(arguments.length===2){a=""+a,o=""+o;const u=this._nodes.get(a);if(!u)throw new le(`Graph.${s}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(o))throw new le(`Graph.${s}:  could not find the "${o}" target node in \
the graph.`);return LV(r,i,u,o)}throw new we(`Graph.${s}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function qV(t){TV.forEach(e=>{FV(t,e),MV(t,e),jV(t,e),BV(t,e)})}const GV=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"\
undirectedNeighbors",type:"undirected"}];function cg(){this.A=null,this.B=null}cg.prototype.wrap=function(t){this.A===null?this.A=t:this.B===null&&(this.B=t)},cg.prototype.has=function(t){return this.A!==null&&t in this.A||this.B!==null&&t in this.B};function Af(t,e,n,r,i){for(const s in r){const a=r[s],o=a.source,u=a.target,c=o===n?u:o;if(e&&e.has(c.key))continue;const l=i(c.key,c.attributes);if(t&&l)return c.key}}function Vb(t,e,n,r,i){if(e!=="mixed"){if(e==="undirected")return Af(t,null,r,r.undirected,
i);if(typeof n=="string")return Af(t,null,r,r[n],i)}const s=new cg;let a;if(e!=="undirected"){if(n!=="out"){if(a=Af(t,null,r,r.in,i),t&&a)return a;s.wrap(r.in)}if(n!=="in"){if(a=Af(t,s,r,r.out,i),t&&a)return a;s.wrap(r.out)}}if(e!=="directed"&&(a=Af(t,s,r,r.undirected,i),t&&a))return a}function UV(t,e,n){if(t!=="mixed"){if(t==="undirected")return Object.keys(n.undirected);if(typeof e=="string")return Object.keys(n[e])}const r=[];return Vb(!1,t,e,n,function(i){r.push(i)}),r}function xf(t,e,n){const r=Object.
keys(n),i=r.length;let s=0;return new Nr(function(){let o=null;do{if(s>=i)return t&&t.wrap(n),{done:!0};const u=n[r[s++]],c=u.source,l=u.target;if(o=c===e?l:c,t&&t.has(o.key)){o=null;continue}}while(o===null);return{done:!1,value:{neighbor:o.key,attributes:o.attributes}}})}function zV(t,e,n){if(t!=="mixed"){if(t==="undirected")return xf(null,n,n.undirected);if(typeof e=="string")return xf(null,n,n[e])}let r=Nr.empty();const i=new cg;return t!=="undirected"&&(e!=="out"&&(r=ps(r,xf(i,n,n.in))),e!==
"in"&&(r=ps(r,xf(i,n,n.out)))),t!=="directed"&&(r=ps(r,xf(i,n,n.undirected))),r}function WV(t,e){const{name:n,type:r,direction:i}=e;t.prototype[n]=function(s){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];s=""+s;const a=this._nodes.get(s);if(typeof a>"u")throw new le(`Graph.${n}: could not find the "${s}" node in the graph.`);return UV(r==="mixed"?this.type:r,i,a)}}function HV(t,e){const{name:n,type:r,direction:i}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(c,l){
if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;c=""+c;const f=this._nodes.get(c);if(typeof f>"u")throw new le(`Graph.${s}: could not find the "${c}" node in the graph.`);Vb(!1,r==="mixed"?this.type:r,i,f,l)};const a="map"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(c,l){const f=[];return this[s](c,(d,h)=>{f.push(l(d,h))}),f};const o="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(c,l){const f=[];return this[s](c,(d,h)=>{l(d,h)&&f.push(d)}),f};const u="reduce"+
n[0].toUpperCase()+n.slice(1);t.prototype[u]=function(c,l,f){if(arguments.length<3)throw new we(`Graph.${u}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let d=f;return this[s](c,(h,p)=>{d=l(d,h,p)}),d}}function VV(t,e){const{name:n,type:r,direction:i}=e,s=n[0].toUpperCase()+n.slice(1,-1),a="find"+s;t.prototype[a]=function(c,l){if(r!=="mixed"&&this.type!==
"mixed"&&r!==this.type)return;c=""+c;const f=this._nodes.get(c);if(typeof f>"u")throw new le(`Graph.${a}: could not find the "${c}" node in the graph.`);return Vb(!0,r==="mixed"?this.type:r,i,f,l)};const o="some"+s;t.prototype[o]=function(c,l){return!!this[a](c,l)};const u="every"+s;t.prototype[u]=function(c,l){return!this[a](c,(d,h)=>!l(d,h))}}function KV(t,e){const{name:n,type:r,direction:i}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)
return Nr.empty();a=""+a;const o=this._nodes.get(a);if(typeof o>"u")throw new le(`Graph.${s}: could not find the "${a}" node in the graph.`);return zV(r==="mixed"?this.type:r,i,o)}}function ZV(t){GV.forEach(e=>{WV(t,e),HV(t,e),VV(t,e),KV(t,e)})}function lg(t,e,n,r,i){const s=r._nodes.values(),a=r.type;let o,u,c,l,f,d;for(;o=s.next(),o.done!==!0;){let h=!1;if(u=o.value,a!=="undirected"){l=u.out;for(c in l){f=l[c];do d=f.target,h=!0,i(u.key,d.key,u.attributes,d.attributes,f.key,f.attributes,f.undirected),
f=f.next;while(f)}}if(a!=="directed"){l=u.undirected;for(c in l)if(!(e&&u.key>c)){f=l[c];do d=f.target,d.key!==c&&(d=f.source),h=!0,i(u.key,d.key,u.attributes,d.attributes,f.key,f.attributes,f.undirected),f=f.next;while(f)}}n&&!h&&i(u.key,null,u.attributes,null,null,null,null)}}function XV(t,e){const n={key:t};return ox(e.attributes)||(n.attributes=cn({},e.attributes)),n}function YV(t,e,n){const r={key:e,source:n.source.key,target:n.target.key};return ox(n.attributes)||(r.attributes=cn({},n.attributes)),
t==="mixed"&&n.undirected&&(r.undirected=!0),r}function JV(t){if(!Dn(t))throw new we('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in t))throw new we("Graph.import: serialized node is missing its key.");if("attributes"in t&&(!Dn(t.attributes)||t.attributes===null))throw new we("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function QV(t){if(!Dn(t))throw new we('Graph.impor\
t: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in t))throw new we("Graph.import: serialized edge is missing its source.");if(!("target"in t))throw new we("Graph.import: serialized edge is missing its target.");if("attributes"in t&&(!Dn(t.attributes)||t.attributes===null))throw new we("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in t&&typeof t.undirected!=
"boolean")throw new we("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const eK=nV(),tK=new Set(["directed","undirected","mixed"]),gx=new Set(["domain","_events","_eventsCount","_maxListeners"]),nK=[{name:t=>`${t}Edge`,generateKey:!0},{name:t=>`${t}DirectedEdge`,generateKey:!0,type:"directed"},{name:t=>`${t}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:t=>`${t}EdgeWithKey`},{name:t=>`${t}DirectedEdgeWithKey`,type:"directed"},{name:t=>`${t}U\
ndirectedEdgeWithKey`,type:"undirected"}],rK={allowSelfLoops:!0,multi:!1,type:"mixed"};function iK(t,e,n){if(n&&!Dn(n))throw new we(`Graph.addNode: invalid attributes. Expecting an object but got "${n}"`);if(e=""+e,n=n||{},t._nodes.has(e))throw new Ne(`Graph.addNode: the "${e}" node already exist in the graph.`);const r=new t.NodeDataClass(e,n);return t._nodes.set(e,r),t.emit("nodeAdded",{key:e,attributes:n}),r}function yx(t,e,n){const r=new t.NodeDataClass(e,n);return t._nodes.set(e,r),t.emit("\
nodeAdded",{key:e,attributes:n}),r}function vx(t,e,n,r,i,s,a,o){if(!r&&t.type==="undirected")throw new Ne(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(r&&t.type==="directed")throw new Ne(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(o&&!Dn(o))throw new we(`Graph.${e}: invalid attributes. Expecting an object but got "${o}"`);if(s=""+s,a=""+a,o=o||
{},!t.allowSelfLoops&&s===a)throw new Ne(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const u=t._nodes.get(s),c=t._nodes.get(a);if(!u)throw new le(`Graph.${e}: source node "${s}" not found.`);if(!c)throw new le(`Graph.${e}: target node "${a}" not found.`);const l={key:null,undirected:r,source:s,target:a,attributes:o};if(n)i=t._edgeKeyGenerator();else if(i=""+i,t._edges.has(i))throw new Ne(`Grap\
h.${e}: the "${i}" edge already exists in the graph.`);if(!t.multi&&(r?typeof u.undirected[a]<"u":typeof u.out[a]<"u"))throw new Ne(`Graph.${e}: an edge linking "${s}" to "${a}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const f=new ku(r,i,u,c,o);t._edges.set(i,f);const d=s===a;return r?(u.undirectedDegree++,c.undirectedDegree++,d&&(u.undirectedLoops++,t._undirectedSelfLoopCount++)):(u.outDegree++,c.
inDegree++,d&&(u.directedLoops++,t._directedSelfLoopCount++)),t.multi?f.attachMulti():f.attach(),r?t._undirectedSize++:t._directedSize++,l.key=i,t.emit("edgeAdded",l),i}function sK(t,e,n,r,i,s,a,o,u){if(!r&&t.type==="undirected")throw new Ne(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(r&&t.type==="directed")throw new Ne(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph\
. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(o){if(u){if(typeof o!="function")throw new we(`Graph.${e}: invalid updater function. Expecting a function but got "${o}"`)}else if(!Dn(o))throw new we(`Graph.${e}: invalid attributes. Expecting an object but got "${o}"`)}s=""+s,a=""+a;let c;if(u&&(c=o,o=void 0),!t.allowSelfLoops&&s===a)throw new Ne(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' optio\
n set to false.`);let l=t._nodes.get(s),f=t._nodes.get(a),d,h;if(!n&&(d=t._edges.get(i),d)){if((d.source.key!==s||d.target.key!==a)&&(!r||d.source.key!==a||d.target.key!==s))throw new Ne(`Graph.${e}: inconsistency detected when attempting to merge the "${i}" edge with "${s}" source & "${a}" target vs. ("${d.source.key}", "${d.target.key}").`);h=d}if(!h&&!t.multi&&l&&(h=r?l.undirected[a]:l.out[a]),h){const b=[h.key,!1,!1,!1];if(u?!c:!o)return b;if(u){const k=h.attributes;h.attributes=c(k),t.emit(
"edgeAttributesUpdated",{type:"replace",key:h.key,attributes:h.attributes})}else cn(h.attributes,o),t.emit("edgeAttributesUpdated",{type:"merge",key:h.key,attributes:h.attributes,data:o});return b}o=o||{},u&&c&&(o=c(o));const p={key:null,undirected:r,source:s,target:a,attributes:o};if(n)i=t._edgeKeyGenerator();else if(i=""+i,t._edges.has(i))throw new Ne(`Graph.${e}: the "${i}" edge already exists in the graph.`);let w=!1,v=!1;l||(l=yx(t,s,{}),w=!0,s===a&&(f=l,v=!0)),f||(f=yx(t,a,{}),v=!0),d=new ku(
r,i,l,f,o),t._edges.set(i,d);const g=s===a;return r?(l.undirectedDegree++,f.undirectedDegree++,g&&(l.undirectedLoops++,t._undirectedSelfLoopCount++)):(l.outDegree++,f.inDegree++,g&&(l.directedLoops++,t._directedSelfLoopCount++)),t.multi?d.attachMulti():d.attach(),r?t._undirectedSize++:t._directedSize++,p.key=i,t.emit("edgeAdded",p),[i,!0,w,v]}function Ru(t,e){t._edges.delete(e.key);const{source:n,target:r,attributes:i}=e,s=e.undirected,a=n===r;s?(n.undirectedDegree--,r.undirectedDegree--,a&&(n.undirectedLoops--,
t._undirectedSelfLoopCount--)):(n.outDegree--,r.inDegree--,a&&(n.directedLoops--,t._directedSelfLoopCount--)),t.multi?e.detachMulti():e.detach(),s?t._undirectedSize--:t._directedSize--,t.emit("edgeDropped",{key:e.key,attributes:i,source:n.key,target:r.key,undirected:s})}class Rt extends I1{constructor(e){if(super(),e=cn({},rK,e),typeof e.multi!="boolean")throw new we(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!tK.has(e.type))throw new we(`Graph.con\
structor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new we(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const n=e.type==="mixed"?cx:e.type==="directed"?lx:dx;Or(this,"NodeDataClass",n);const r="geid_"+eK()+"_";let i=0;const s=()=>{let a;do a=r+i++;while(this._edges.has(a));return a};Or(this,"_attributes",{}),Or(this,"_nodes",new Map),Or(
this,"_edges",new Map),Or(this,"_directedSize",0),Or(this,"_undirectedSize",0),Or(this,"_directedSelfLoopCount",0),Or(this,"_undirectedSelfLoopCount",0),Or(this,"_edgeKeyGenerator",s),Or(this,"_options",e),gx.forEach(a=>Or(this,a,this[a])),ti(this,"order",()=>this._nodes.size),ti(this,"size",()=>this._edges.size),ti(this,"directedSize",()=>this._directedSize),ti(this,"undirectedSize",()=>this._undirectedSize),ti(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),
ti(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),ti(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),ti(this,"multi",this._options.multi),ti(this,"type",this._options.type),ti(this,"allowSelfLoops",this._options.allowSelfLoops),ti(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,n){if(this.
type==="undirected")return!1;if(arguments.length===1){const r=""+e,i=this._edges.get(r);return!!i&&!i.undirected}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?r.out.hasOwnProperty(n):!1}throw new we(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,n){if(this.type==="directed")return!1;if(arguments.length===1){const r=""+
e,i=this._edges.get(r);return!!i&&i.undirected}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?r.undirected.hasOwnProperty(n):!1}throw new we(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,n){if(arguments.length===1){const r=""+e;return this._edges.has(r)}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?
typeof r.out<"u"&&r.out.hasOwnProperty(n)||typeof r.undirected<"u"&&r.undirected.hasOwnProperty(n):!1}throw new we(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,n){if(this.type==="undirected")return;if(e=""+e,n=""+n,this.multi)throw new Ne("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & targe\
t. See #.directedEdges instead.");const r=this._nodes.get(e);if(!r)throw new le(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new le(`Graph.directedEdge: could not find the "${n}" target node in the graph.`);const i=r.out&&r.out[n]||void 0;if(i)return i.key}undirectedEdge(e,n){if(this.type==="directed")return;if(e=""+e,n=""+n,this.multi)throw new Ne("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be mul\
tiple edges between source & target. See #.undirectedEdges instead.");const r=this._nodes.get(e);if(!r)throw new le(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new le(`Graph.undirectedEdge: could not find the "${n}" target node in the graph.`);const i=r.undirected&&r.undirected[n]||void 0;if(i)return i.key}edge(e,n){if(this.multi)throw new Ne("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges b\
etween source & target. See #.edges instead.");e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new le(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new le(`Graph.edge: could not find the "${n}" target node in the graph.`);const i=r.out&&r.out[n]||r.undirected&&r.undirected[n]||void 0;if(i)return i.key}areDirectedNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new le(`Graph.areDirectedNeighbors: could not find the "${e}" n\
ode in the graph.`);return this.type==="undirected"?!1:n in r.in||n in r.out}areOutNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new le(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in r.out}areInNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new le(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in r.in}areUndirectedNeighbors(e,n){e=
""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new le(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:n in r.undirected}areNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new le(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(n in r.in||n in r.out)||this.type!=="directed"&&n in r.undirected}areInboundNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)
throw new le(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in r.in||this.type!=="directed"&&n in r.undirected}areOutboundNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new le(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in r.out||this.type!=="directed"&&n in r.undirected}inDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.inDeg\
ree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree}outDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree}directedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree}undirectedDegree(e){e=""+e;const n=this.
_nodes.get(e);if(!n)throw new le(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree}inboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.inDegree),r}outboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.outboundDegree: coul\
d not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.outDegree),r}degree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.degree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.inDegree+n.outDegree),r}inDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.inDegreeWithoutSe\
lfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree-n.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree-n.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node i\
n the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree-n.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree-n.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the \
graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.inDegree,i+=n.directedLoops),r-i}outboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.outDegree,i+=n.directedLoops),r-i}degreeWithoutSelfLoops(e){
e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.inDegree+n.outDegree,i+=n.directedLoops*2),r-i}source(e){e=""+e;const n=this._edges.get(e);if(!n)throw new le(`Graph.source: could not find the "${e}" edge in the graph.`);return n.source.key}target(e){e=""+e;const n=this._edges.get(e);if(!n)throw new le(
`Graph.target: could not find the "${e}" edge in the graph.`);return n.target.key}extremities(e){e=""+e;const n=this._edges.get(e);if(!n)throw new le(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[n.source.key,n.target.key]}opposite(e,n){e=""+e,n=""+n;const r=this._edges.get(n);if(!r)throw new le(`Graph.opposite: could not find the "${n}" edge in the graph.`);const i=r.source.key,s=r.target.key;if(e===i)return s;if(e===s)return i;throw new le(`Graph.opposite: the "${e}\
" node is not attached to the "${n}" edge (${i}, ${s}).`)}hasExtremity(e,n){e=""+e,n=""+n;const r=this._edges.get(e);if(!r)throw new le(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return r.source.key===n||r.target.key===n}isUndirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new le(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return n.undirected}isDirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new le(`Graph.isDirected: could not f\
ind the "${e}" edge in the graph.`);return!n.undirected}isSelfLoop(e){e=""+e;const n=this._edges.get(e);if(!n)throw new le(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return n.source===n.target}addNode(e,n){return iK(this,e,n).key}mergeNode(e,n){if(n&&!Dn(n))throw new we(`Graph.mergeNode: invalid attributes. Expecting an object but got "${n}"`);e=""+e,n=n||{};let r=this._nodes.get(e);return r?(n&&(cn(r.attributes,n),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:r.
attributes,data:n})),[e,!1]):(r=new this.NodeDataClass(e,n),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:n}),[e,!0])}updateNode(e,n){if(n&&typeof n!="function")throw new we(`Graph.updateNode: invalid updater function. Expecting a function but got "${n}"`);e=""+e;let r=this._nodes.get(e);if(r){if(n){const s=r.attributes;r.attributes=n(s),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:r.attributes})}return[e,!1]}const i=n?n({}):{};return r=new this.NodeDataClass(
e,i),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:i}),[e,!0]}dropNode(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new le(`Graph.dropNode: could not find the "${e}" node in the graph.`);let r;if(this.type!=="undirected"){for(const i in n.out){r=n.out[i];do Ru(this,r),r=r.next;while(r)}for(const i in n.in){r=n.in[i];do Ru(this,r),r=r.next;while(r)}}if(this.type!=="directed")for(const i in n.undirected){r=n.undirected[i];do Ru(this,r),r=r.next;while(r)}this._nodes.delete(e),this.
emit("nodeDropped",{key:e,attributes:n.attributes})}dropEdge(e){let n;if(arguments.length>1){const r=""+arguments[0],i=""+arguments[1];if(n=Ir(this,r,i,this.type),!n)throw new le(`Graph.dropEdge: could not find the "${r}" -> "${i}" edge in the graph.`)}else if(e=""+e,n=this._edges.get(e),!n)throw new le(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return Ru(this,n),this}dropDirectedEdge(e,n){if(arguments.length<2)throw new Ne("Graph.dropDirectedEdge: it does not make sense to \
try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Ne("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,n=""+n;const r=Ir(this,e,n,"directed");if(!r)throw new le(`Graph.dropDirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return Ru(this,r),this}dropUndirectedEdge(e,n){
if(arguments.length<2)throw new Ne("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Ne("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const r=Ir(this,e,n,"undirected");if(!r)throw new le(`Graph.dropUndirectedEdge: cou\
ld not find a "${e}" -> "${n}" edge in the graph.`);return Ru(this,r),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let n;for(;n=e.next(),n.done!==!0;)n.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,n){
return this._attributes[e]=n,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,n){if(typeof n!="function")throw new we("Graph.updateAttribute: updater should be a function.");const r=this._attributes[e];return this._attributes[e]=n(r),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),
this}replaceAttributes(e){if(!Dn(e))throw new we("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!Dn(e))throw new we("Graph.mergeAttributes: provided attributes are not a plain object.");return cn(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")
throw new we("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,n){if(typeof e!="function")throw new we("Graph.updateEachNodeAttributes: expecting an updater function.");if(n&&!ux(n))throw new we("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._nodes.
values();let i,s;for(;i=r.next(),i.done!==!0;)s=i.value,s.attributes=e(s.key,s.attributes);this.emit("eachNodeAttributesUpdated",{hints:n||null})}updateEachEdgeAttributes(e,n){if(typeof e!="function")throw new we("Graph.updateEachEdgeAttributes: expecting an updater function.");if(n&&!ux(n))throw new we("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._edges.values();let i,s,a,o;for(;i=r.next(),i.done!==!0;)s=i.
value,a=s.source,o=s.target,s.attributes=e(s.key,s.attributes,a.key,o.key,a.attributes,o.attributes,s.undirected);this.emit("eachEdgeAttributesUpdated",{hints:n||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new we("Graph.forEachAdjacencyEntry: expecting a callback.");lg(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new we("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");lg(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!=
"function")throw new we("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");lg(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new we("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");lg(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):sx(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new we("Graph.forEachNode: expecting a callback.");const n=this.
_nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)i=r.value,e(i.key,i.attributes)}findNode(e){if(typeof e!="function")throw new we("Graph.findNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,e(i.key,i.attributes))return i.key}mapNodes(e){if(typeof e!="function")throw new we("Graph.mapNode: expecting a callback.");const n=this._nodes.values();let r,i;const s=new Array(this.order);let a=0;for(;r=n.next(),r.done!==!0;)i=r.value,s[a++]=e(
i.key,i.attributes);return s}someNode(e){if(typeof e!="function")throw new we("Graph.someNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,e(i.key,i.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new we("Graph.everyNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,!e(i.key,i.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new we(
"Graph.filterNodes: expecting a callback.");const n=this._nodes.values();let r,i;const s=[];for(;r=n.next(),r.done!==!0;)i=r.value,e(i.key,i.attributes)&&s.push(i.key);return s}reduceNodes(e,n){if(typeof e!="function")throw new we("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new we("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could \
with a simple array.");let r=n;const i=this._nodes.values();let s,a;for(;s=i.next(),s.done!==!0;)a=s.value,r=e(r,a.key,a.attributes);return r}nodeEntries(){const e=this._nodes.values();return new Nr(()=>{const n=e.next();if(n.done)return n;const r=n.value;return{value:{node:r.key,attributes:r.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let n=0;this._nodes.forEach((i,s)=>{e[n++]=XV(s,i)});const r=new Array(this._edges.size);return n=0,this._edges.forEach((i,s)=>{r[n++]=YV(
this.type,s,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:r}}import(e,n=!1){if(e instanceof Rt)return e.forEachNode((u,c)=>{n?this.mergeNode(u,c):this.addNode(u,c)}),e.forEachEdge((u,c,l,f,d,h,p)=>{n?p?this.mergeUndirectedEdgeWithKey(u,l,f,c):this.mergeDirectedEdgeWithKey(u,l,f,c):p?this.addUndirectedEdgeWithKey(u,l,f,c):this.addDirectedEdgeWithKey(u,l,f,c)}),this;if(!Dn(e))throw new we("Graph.import: invalid argu\
ment. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!Dn(e.attributes))throw new we("Graph.import: invalid attributes. Expecting a plain object.");n?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let r,i,s,a,o;if(e.nodes){if(s=e.nodes,!Array.isArray(s))throw new we("Graph.import: invalid nodes. Expecting an array.");for(r=0,i=s.length;r<i;r++){a=s[r],JV(a);const{key:u,attributes:c}=a;n?this.mergeNode(u,c):this.addNode(u,c)}}if(e.edges){
let u=!1;if(this.type==="undirected"&&(u=!0),s=e.edges,!Array.isArray(s))throw new we("Graph.import: invalid edges. Expecting an array.");for(r=0,i=s.length;r<i;r++){o=s[r],QV(o);const{source:c,target:l,attributes:f,undirected:d=u}=o;let h;"key"in o?(h=n?d?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:d?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,h.call(this,o.key,c,l,f)):(h=n?d?this.mergeUndirectedEdge:this.mergeDirectedEdge:d?this.addUndirectedEdge:this.addDirectedEdge,
h.call(this,c,l,f))}}return this}nullCopy(e){const n=new Rt(cn({},this._options,e));return n.replaceAttributes(cn({},this.getAttributes())),n}emptyCopy(e){const n=this.nullCopy(e);return this._nodes.forEach((r,i)=>{const s=cn({},r.attributes);r=new n.NodeDataClass(i,s),n._nodes.set(i,r)}),n}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new Ne(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean lo\
sing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new Ne("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new Ne("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not\
 because this would mean losing information about the current graph.");const n=this.emptyCopy(e),r=this._edges.values();let i,s;for(;i=r.next(),i.done!==!0;)s=i.value,vx(n,"copy",!1,s.undirected,s.key,s.source.key,s.target.key,cn({},s.attributes));return n}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((s,a)=>{e[a]=s.attributes});const n={},r={};this._edges.forEach((s,a)=>{const o=s.undirected?"--":"->";let u="",c=s.source.key,l=s.target.
key,f;s.undirected&&c>l&&(f=c,c=l,l=f);const d=`(${c})${o}(${l})`;a.startsWith("geid_")?this.multi&&(typeof r[d]>"u"?r[d]=0:r[d]++,u+=`${r[d]}. `):u+=`[${a}]: `,u+=d,n[u]=s.attributes});const i={};for(const s in this)this.hasOwnProperty(s)&&!gx.has(s)&&typeof this[s]!="function"&&typeof s!="symbol"&&(i[s]=this[s]);return i.attributes=this._attributes,i.nodes=e,i.edges=n,Or(i,"constructor",this.constructor),i}}typeof Symbol<"u"&&(Rt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Rt.prototype.
inspect),nK.forEach(t=>{["add","merge","update"].forEach(e=>{const n=t.name(e),r=e==="add"?vx:sK;t.generateKey?Rt.prototype[n]=function(i,s,a){return r(this,n,!0,(t.type||this.type)==="undirected",null,i,s,a,e==="update")}:Rt.prototype[n]=function(i,s,a,o){return r(this,n,!1,(t.type||this.type)==="undirected",i,s,a,o,e==="update")}})}),pV(Rt),DV(Rt),qV(Rt),ZV(Rt);class wx extends Rt{constructor(e){const n=cn({type:"directed"},e);if("multi"in n&&n.multi!==!1)throw new we("DirectedGraph.from: inco\
nsistent indication that the graph should be multi in given options!");if(n.type!=="directed")throw new we('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class bx extends Rt{constructor(e){const n=cn({type:"undirected"},e);if("multi"in n&&n.multi!==!1)throw new we("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="undirected")throw new we('UndirectedGraph.from: inconsistent "'+n.type+'" type in given o\
ptions!');super(n)}}class Ex extends Rt{constructor(e){const n=cn({multi:!0},e);if("multi"in n&&n.multi!==!0)throw new we("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(n)}}class kx extends Rt{constructor(e){const n=cn({type:"directed",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new we("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="directed")throw new we('MultiDirectedGrap\
h.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class Rx extends Rt{constructor(e){const n=cn({type:"undirected",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new we("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="undirected")throw new we('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}function $u(t){t.from=function(e,n){const r=cn({},e.options,n),i=new t(r);return i.
import(e),i}}$u(Rt),$u(wx),$u(bx),$u(Ex),$u(kx),$u(Rx),Rt.Graph=Rt,Rt.DirectedGraph=wx,Rt.UndirectedGraph=bx,Rt.MultiGraph=Ex,Rt.MultiDirectedGraph=kx,Rt.MultiUndirectedGraph=Rx,Rt.InvalidArgumentsGraphError=we,Rt.NotFoundGraphError=le,Rt.UsageGraphError=Ne;const Kb="dashed",Zb=fn.font,$x=lO("dot");class Xb{constructor(e){this.view=e,this.compoundIds=new Set(e.nodes.filter(br).map(r=>r.id)),this.edgesWithCompounds=new Set(this.compoundIds.size>0?e.edges.filter(r=>this.compoundIds.has(r.source)||
this.compoundIds.has(r.target)).map(r=>r.id):[]);for(const r of e.nodes)this.graphology.addNode(r.id,{origin:r,level:r.level,depth:r.depth??0,modelRef:B0.modelRef(r),deploymentRef:B0.deploymentRef(r),maxConnectedHierarchyDistance:0});for(const r of e.edges){let i=this.graphology.getNodeAttribute(r.source,"deploymentRef"),s=this.graphology.getNodeAttribute(r.target,"deploymentRef");(i===null||s===null)&&(i=this.graphology.getNodeAttribute(r.source,"modelRef"),s=this.graphology.getNodeAttribute(r.
target,"modelRef"));let a=-1;i!==null&&s!==null?a=h1(i,s):$x.warn(`Edge ${r.id} of view ${e.id} is invalid, sourceFqn: ${i}, targetFqn: ${s}`),this.graphology.addEdgeWithKey(r.id,r.source,r.target,{origin:r,hierarchyDistance:a,weight:1}),a>this.graphology.getNodeAttribute(r.source,"maxConnectedHierarchyDistance")&&this.graphology.mergeNodeAttributes(r.source,{maxConnectedHierarchyDistance:a}),a>this.graphology.getNodeAttribute(r.target,"maxConnectedHierarchyDistance")&&this.graphology.mergeNodeAttributes(
r.target,{maxConnectedHierarchyDistance:a})}this.graphology.forEachEdge((r,{hierarchyDistance:i},s,a,o,u)=>{const c=Math.max(o.maxConnectedHierarchyDistance,u.maxConnectedHierarchyDistance);if(c>i)this.graphology.mergeEdgeAttributes(r,{weight:c-i+1});else{const l=this.graphology.directedDegree(s),f=this.graphology.directedDegree(a);l===1&&f===1&&i>1&&this.graphology.mergeEdgeAttributes(r,{weight:i})}});const n=this.graphvizModel=this.createGraph();this.applyNodeAttributes(n.attributes.node),this.
applyEdgeAttributes(n.attributes.edge)}ids=new Set;subgraphs=new Map;nodes=new Map;edges=new Map;compoundIds;edgesWithCompounds;graphology=new Rt({allowSelfLoops:!0,multi:!0,type:"directed"});graphvizModel;get hasEdgesWithCompounds(){return this.edgesWithCompounds.size>0}postBuild(e){}build(e){const n=(i,s)=>{const a=this.generateGraphvizId(i),o=this.elementToSubgraph(i,s.subgraph(a));this.subgraphs.set(i.id,o);for(const u of i.children){const c=this.computedNode(u);if(br(c))n(c,o);else{const l=Vt(
this.getGraphNode(c.id),`Graphviz Node not found for ${c.id}`);o.node(l.id)}}},r=[];for(const i of this.view.nodes)if(br(i))Ft(i.parent)&&r.push(i);else{const s=this.generateGraphvizId(i),a=this.elementToNode(i,e.node(s));this.nodes.set(i.id,a)}for(const i of r)n(i,e);for(const i of this.view.edges){const s=this.addEdge(i,e);s&&this.edges.set(i.id,s)}}print(){const e=this.graphvizModel;return this.build(e),this.postBuild(e),HA(this.graphvizModel,{print:{indentStyle:"space",indentSize:2}})}createGraph(){
const e=this.view.autoLayout,n=_5({[F.likec4_viewId]:this.view.id,[F.bgcolor]:"transparent",[F.layout]:"dot",[F.compound]:!0,[F.rankdir]:e.direction,[F.TBbalance]:"min",[F.splines]:"spline",[F.outputorder]:"nodesfirst",[F.nodesep]:At(e.nodeSep??110),[F.ranksep]:At(e.rankSep??120),[F.pad]:At(15),[F.fontname]:Zb});return n.attributes.graph.apply({[F.fontsize]:Pr(15),[F.labeljust]:e.direction==="RL"?"r":"l",[F.labelloc]:e.direction==="BT"?"b":"t",[F.margin]:50.1}),n}applyNodeAttributes(e){e.apply({
[F.fontname]:Zb,[F.shape]:"rect",[F.fillcolor]:fn.elements[yo].fill,[F.fontcolor]:fn.elements[yo].hiContrast,[F.color]:fn.elements[yo].stroke,[F.style]:"filled",[F.penwidth]:0})}applyEdgeAttributes(e){e.apply({[F.arrowsize]:.75,[F.fontname]:Zb,[F.fontsize]:Pr(14),[F.penwidth]:Pr(2),[F.color]:fn.relationships[Nu].lineColor,[F.fontcolor]:fn.relationships[Nu].labelColor})}checkNodeId(e,n=!1){return n?e="cluster_"+e:e.toLowerCase().startsWith("cluster")&&(e="nd_"+e),this.ids.has(e)?null:(this.ids.add(
e),e)}generateGraphvizId(e){const n=br(e);let r=$g(e.id).toLowerCase(),i=this.checkNodeId(r,n);if(i!==null)return i;r=$g(e.id).toLowerCase();let s=1;do i=this.checkNodeId(r+"_"+s++,n);while(i===null);return i}elementToSubgraph(e,n){Fe(br(e),"node should be compound"),Fe($p(e.depth),"node.depth should be defined");const r=this.getElementColorValues(e.color),i=U5(r.loContrast);return n.apply({[F.likec4_id]:e.id,[F.likec4_level]:e.level,[F.likec4_depth]:e.depth,[F.fillcolor]:XA(r.fill,e.depth),[F.color]:XA(
r.stroke,e.depth),[F.style]:"filled",[F.margin]:Pr(e.children.length>1?40:32)}),tn(e.title.trim())||n.set(F.label,V5(e,i)),n}elementToNode(e,n){Fe(!br(e),"node should not be compound");const r=fe(e.icon),i=this.getElementColorValues(e.color);let s=e.style.size,a=e.style.textSize,o=e.style.padding;!s&&a&&(s=a),!a&&s&&(a=s),!o&&s&&(o=s),s??=A1,a??=x1,o??=P1;const u=fn.spacing[o];switch(n.attributes.apply({[F.likec4_id]:e.id,[F.likec4_level]:e.level,[F.label]:H5(e,i,{shape:s,text:a}),[F.margin]:`${At(
r?8:u)},${At(u)}`}),n.attributes.set(F.width,At(fn.sizes[s].width)),n.attributes.set(F.height,At(fn.sizes[s].height)),e.color!==yo&&n.attributes.apply({[F.fillcolor]:i.fill,[F.fontcolor]:i.hiContrast,[F.color]:i.stroke}),e.shape){case"cylinder":case"storage":{n.attributes.apply({[F.margin]:`${At(r?8:u)},${At(0)}`,[F.penwidth]:Pr(2),[F.shape]:"cylinder"});break}case"browser":{n.attributes.apply({[F.margin]:`${At(r?8:u+4)},${At(u+6)}`});break}case"mobile":{n.attributes.apply({[F.margin]:`${At(r?8:
u+4)},${At(u)}`});break}case"queue":{n.attributes.apply({[F.width]:At(fn.sizes[s].width),[F.height]:At(fn.sizes[s].height-8),[F.margin]:`${At(r?8:u+4)},${At(u)}`});break}}return n}leafElements(e){return e===null?this.view.nodes.filter(n=>!br(n)):this.computedNode(e).children.flatMap(n=>{const r=this.computedNode(n);return br(r)?this.leafElements(r.id):r})}descendants(e){return e===null?this.view.nodes.slice():this.computedNode(e).children.flatMap(n=>{const r=this.computedNode(n);return[r,...this.
descendants(r.id)]})}computedNode(e){return Vt(this.view.nodes.find(n=>n.id===e),`Node ${e} not found`)}getGraphNode(e){return this.nodes.get(e)??null}getSubgraph(e){return this.subgraphs.get(e)??null}edgeEndpoint(e,n){let r=this.computedNode(e),i=this.getGraphNode(e),s;return i||(Fe(br(r),"endpoint node should be compound"),s=this.getSubgraph(e)?.id,Fe(s,`subgraph ${e} not found`),r=Vt(n(this.leafElements(e)),`leaf element in ${e} not found`),i=Vt(this.getGraphNode(r.id),`source graphviz node ${r.
id} not found`)),[r,i,s]}findInternalEdges(e){if(e===null)return this.view.edges.slice();const n=this.computedNode(e);return et(this.descendants(e),Wr(r=>_T(r.inEdges,r.outEdges)),jo(),WU(_T(n.inEdges,n.outEdges)),Ht(r=>this.view.edges.find(i=>i.id===r)),Qe(fe))}withoutCompoundEdges(e){return this.edgesWithCompounds.size===0?e:{...e,inEdges:e.inEdges.filter(n=>!this.edgesWithCompounds.has(n)),outEdges:e.outEdges.filter(n=>!this.edgesWithCompounds.has(n))}}assignGroups(){const e=et(this.view.nodes,
Qe(br),Ht(r=>r.id),RT(p1),hU(),Ht(r=>{const i=this.findInternalEdges(r).filter(s=>s.source!==s.target&&!this.compoundIds.has(s.source)&&!this.compoundIds.has(s.target));return{id:r,edges:i}}),Qe(({edges:r})=>r.length>1&&r.length<8),tU(4)),n=new Set;for(const r of e){const i=r.edges.filter(s=>!n.has(s.source)&&!n.has(s.target));for(const s of i)try{const a=Vt(this.getGraphNode(s.source),`Graphviz Node not found for ${s.source}`),o=Vt(this.getGraphNode(s.target),`Graphviz Node not found for ${s.target}`);
n.add(s.source),n.add(s.target),a.attributes.set(F.group,r.id),o.attributes.set(F.group,r.id)}catch(a){$x.error(`Failed to assign group to edge ${s.id}`,{error:a})}}}applyManualLayout({height:e,...n}){const r=n.x<0?-n.x:0,i=n.y<0?-n.y:0,s=r>0||i>0;for(const{id:a,...o}of n.nodes){const u=this.getGraphNode(a);if(!u)continue;const c=At(o.center.x)+r,l=At(e-o.center.y);o.fixedsize?u.attributes.apply({[F.pos]:`${c},${l}!`,[F.pin]:!0,[F.width]:At(o.fixedsize.width),[F.height]:At(o.fixedsize.height),[F.
fixedsize]:!0}):u.attributes.set(F.pos,`${c},${l}`)}for(const[a,o]of this.edges.entries()){o.attributes.delete(F.weight),o.attributes.delete(F.minlen),o.attributes.delete(F.constraint);const u=n.edges.find(c=>c.id===a)?.dotpos;u&&!s&&o.attributes.set(F.pos,u)}return this.graphvizModel.apply({[F.layout]:"fdp",[F.overlap]:"vpsc",[F.sep]:"+50,50",[F.esep]:"+10,10",[F.start]:"random2",[F.splines]:"compound"}),this.graphvizModel.delete(F.compound),this.graphvizModel.delete(F.rankdir),this.graphvizModel.
delete(F.nodesep),this.graphvizModel.delete(F.ranksep),this.graphvizModel.delete(F.pack),this.graphvizModel.delete(F.pad),this.graphvizModel.delete(F.packmode),this.graphvizModel.attributes.graph.delete(F.margin),this}getRelationshipColorValues(e){return A0(e)?fn.relationships[e]:this.view.customColorDefinitions[e]?.relationships??fn.relationships[yo]}getElementColorValues(e){return A0(e)?fn.elements[e]:this.view.customColorDefinitions[e]?.elements??fn.elements[yo]}}class aK extends Xb{createGraph(){
const e=super.createGraph(),n=this.view.autoLayout;return e.delete(F.TBbalance),e.apply({[F.nodesep]:At(n.nodeSep??130),[F.ranksep]:At(n.rankSep??130)}),e}postBuild(e){et(this.view.nodes,Ht(n=>({node:n,graphvizNode:this.getGraphNode(n.id)})),qo(({node:n,graphvizNode:r})=>{if(r!=null)return Wf.modelRef(n)??void 0}),Rp(),Qe(Ar(2)),xU(n=>{e.subgraph({[F.rank]:"same"},r=>{for(const{graphvizNode:i}of n)r.node(Vt(i).id)})}),oU(()=>{e.set(F.newrank,!0),e.set(F.clusterrank,"global"),e.delete(F.pack),e.delete(
F.packmode)}))}elementToSubgraph(e,n){const r=super.elementToSubgraph(e,n);return e.children.length>1&&r.set(F.margin,Pr(50)),r}addEdge(e,n){const[r,i]=[e.source,e.target],[s,a,o]=this.edgeEndpoint(r,g=>Zc(g)),[u,c,l]=this.edgeEndpoint(i,Go),f=Un(l)||Un(o),d=n.edge([a,c],{[F.likec4_id]:e.id,[F.style]:e.line??Kb});l&&d.attributes.set(F.lhead,l),o&&d.attributes.set(F.ltail,o);const h=this.graphology.getEdgeAttribute(e.id,"weight");h>1&&!this.graphology.hasDirectedEdge(e.target,e.source)&&d.attributes.
set(F.weight,h);const p=QA(e);if(p&&d.attributes.set(f?F.xlabel:F.label,p),e.color){const g=this.getRelationshipColorValues(e.color);d.attributes.apply({[F.color]:g.lineColor,[F.fontcolor]:g.labelColor})}let[w,v]=[e.head??ra,e.tail??"none"];return w==="none"&&v==="none"?(d.attributes.apply({[F.arrowtail]:"none",[F.arrowhead]:"none",[F.dir]:"none"}),d):e.dir==="both"?(d.attributes.apply({[F.arrowhead]:Pn(w),[F.arrowtail]:Pn(e.tail??w),[F.dir]:"both"}),!f&&Wf.modelRef(s)!==Wf.modelRef(u)&&d.attributes.
set(F.constraint,!1),d):(w!==ra&&d.attributes.set(F.arrowhead,Pn(w)),v!=="none"&&d.attributes.set(F.arrowtail,Pn(v)),d)}}class D0 extends Xb{static toDot(e){return new D0(e).print()}postBuild(e){e.delete(F.TBbalance)}addEdge(e,n){const{nodes:r}=this.view,[i,s]=e.dir==="back"?[e.target,e.source]:[e.source,e.target],[a,o,u]=this.edgeEndpoint(i,_=>Zc(_)),[c,l,f]=this.edgeEndpoint(s,Go),d=n.edge([o,l],{[F.likec4_id]:e.id,[F.style]:e.line??Kb});if(f&&d.attributes.set(F.lhead,f),u&&d.attributes.set(F.
ltail,u),e.color&&e.color!==Nu){const _=this.getRelationshipColorValues(e.color);d.attributes.apply({[F.color]:_.lineColor,[F.fontcolor]:_.labelColor})}const h=[e.label?.trim(),e.technology?.trim()].filter(fe).join(`
`),p=m1(e.id),w=K5(p,h);d.attributes.set(F.label,w);const v=this.graphology.getEdgeAttribute(e.id,"weight");e.source!==e.target&&v>1&&d.attributes.set(F.weight,v);const g=r.findIndex(_=>_.id===i);r.findIndex(_=>_.id===s)<g&&e.dir!=="back"&&d.attributes.apply({[F.constraint]:!1});let[b,k]=[e.head??ra,e.tail??"none"];return e.dir==="back"?(d.attributes.apply({[F.arrowtail]:Pn(b),[F.minlen]:0,[F.dir]:"back"}),k!=="none"&&d.attributes.apply({[F.arrowhead]:Pn(k),[F.dir]:"both"}),d):b==="none"&&k==="n\
one"||b!=="none"&&k!=="none"?(d.attributes.apply({[F.arrowhead]:Pn(b),[F.arrowtail]:Pn(k),[F.dir]:"both"}),d):b==="none"?(d.attributes.delete(F.arrowhead),d.attributes.apply({[F.arrowtail]:Pn(k),[F.minlen]:0,[F.dir]:"back"}),d):(b!==ra&&d.attributes.set(F.arrowhead,Pn(b)),d)}}class oK extends Xb{postBuild(e){this.assignGroups();const n=new Set,r=this.view.nodes.reduce((s,a)=>(br(a)&&(n.add(a.id),s.push(a)),s),[]);let i=!1;for(const s of r){const a=et(s.children,Qe(l=>!this.compoundIds.has(l)),Ht(
l=>this.computedNode(l)),Qe(l=>l.inEdges.length===0&&l.outEdges.length===0));if(a.length<=2)continue;let o=2;switch(!0){case a.length>11:o=4;break;case a.length>4:o=3;break}const u=Vt(this.getSubgraph(s.id),`Subgraph not found for ${s.id}`);let c=null;ZU(a,o).forEach(l=>{const f=l.length>1?u.createSubgraph({[F.rank]:"same"}):null;l.forEach((d,h)=>{const p=this.getGraphNode(d.id);p&&(f?.node(p.id),h===0&&(c&&u.edge([c,p],{[F.style]:"invis"}),c=p))}),i=i||!!f})}i&&(e.set(F.newrank,!0),e.set(F.clusterrank,
"global"))}addEdge(e,n){const[r,i]=e.dir==="back"?[e.target,e.source]:[e.source,e.target],[s,a,o]=this.edgeEndpoint(r,k=>Zc(k)),[u,c,l]=this.edgeEndpoint(i,Go),f=e.parent,d=this.graphology.getEdgeAttributes(e.id),h=n.edge([a,c],{[F.likec4_id]:e.id,[F.style]:e.line??Kb});l&&h.attributes.set(F.lhead,l),o&&h.attributes.set(F.ltail,o);const p=Un(l)||Un(o);!this.graphology.hasDirectedEdge(e.target,e.source)&&d.weight>1&&h.attributes.set(F.weight,d.weight);const w=QA(e);if(w&&h.attributes.set(p?F.xlabel:
F.label,w),e.color){const k=this.getRelationshipColorValues(e.color);h.attributes.apply({[F.color]:k.lineColor,[F.fontcolor]:k.labelColor})}let[v,g]=[e.head??ra,e.tail??"none"];if(e.dir==="back")return h.attributes.apply({[F.arrowtail]:Pn(v),[F.dir]:"back"}),g!=="none"&&h.attributes.apply({[F.arrowhead]:Pn(g),[F.dir]:"both",[F.minlen]:0}),h;if(v==="none"&&g==="none")return h.attributes.apply({[F.arrowtail]:"none",[F.arrowhead]:"none",[F.dir]:"none",[F.minlen]:0,[F.constraint]:!1}),h;if(v!=="none"&&
g!=="none")return h.attributes.apply({[F.arrowhead]:Pn(v),[F.arrowtail]:Pn(g),[F.dir]:"both",[F.minlen]:0}),h;if(v!==ra&&h.attributes.set(F.arrowhead,Pn(v)),g!=="none"&&h.attributes.set(F.arrowtail,Pn(g)),this.view.edges.length===1)return h;let b;return f===null&&s.parent==null&&u.parent==null?b=this.view.edges.filter(k=>{if(k.id===e.id||k.parent!==null||k.source===e.source&&k.target===e.target||k.source===e.target&&k.target===e.source)return!1;const _=this.computedNode(k.source),I=this.computedNode(
k.target);return br(_)||br(I)?!1:_.parent==null&&I.parent==null}):b=this.findInternalEdges(f).filter(k=>!(k.id===e.id||k.source===e.source&&k.target===e.target||k.source===e.target&&k.target===e.source)),b.length===0&&(f===null||this.leafElements(f).length<=3)&&h.attributes.set(F.minlen,0),h}}function dg(t){const[e,n,r,i]=t?t.split(",").map(o=>Ti(+o)):[0,0,0,0],s=Math.round(r-e),a=Math.round(n-i);return{x:Math.round(e),y:Math.round(i),width:s,height:a}}function uK(t){try{const[e,n]=t.split(",");
return{x:Ti(parseFloat(e)),y:Ti(parseFloat(n))}}catch(e){throw new Error(`Failed on parsing pos: ${t}`,{cause:e})}}function Dx(t){const{x:e,y:n}=uK(t.pos),r=ZA(parseFloat(t.width)),i=ZA(parseFloat(t.height));return{x:e-Math.round(r/2),y:n-Math.round(i/2),width:r,height:i}}function Tx(t,[e,n]=[0,0]){if(!t||t.length===0)return null;let r=1/0,i=1/0,s=-1/0,a=-1/0,o=13;try{for(const c of t){if(c.op==="F"){o=Ti(c.size);continue}if(c.op==="T"){let l=Ti(c.pt[0])-e,f=Ti(c.width);switch(c.align){case"r":l-=
f;break;case"c":l-=Math.round(f/2);break}r=Math.min(r,l),s=Math.max(s,l+f);let d=Ti(c.pt[1])-n;i=Math.min(i,Math.round(d-o)),a=Math.max(a,d)}}}catch(c){return Fn.warn(`Failed on parsing label draw ops: 
{labelDrawOps}`,{e:c,labelDrawOps:t}),null}if(r===1/0)return null;const u=2;return{x:r-u,y:i-u,width:s-r+2*u,height:a-i+2*u}}function Sx({_draw_:t,likec4_id:e="???"},n="<unknown view>"){try{const r=t.filter(s=>s.op.toLowerCase()==="b");Fe(Ar(r,1),`view ${n} edge ${e} should have at least one bezier draw op`),r.length>1&&Fn.warn(`view ${n} edge ${e} has more than one bezier draw op, using the first one only`);const i=r[0].points.map(s=>Ti(s));return Fe(Ar(i,2),`view ${n} edge ${e} should have at \
least two points`),i}catch(r){throw new Error(`failed on parsing view ${n} edge ${e} _draw_:
${JSON.stringify(t,null,2)}`,{cause:r})}}function cK(t,{id:e,source:n,target:r,dir:i,label:s,description:a,...o},u){const c=Tx(t._ldraw_??t._tldraw_??t._hldraw_),l=t.dir==="back"||i==="back";return s=s&&c?YA(s,{maxchars:og,maxLines:JA}).join(`
`):null,{id:e,source:n,target:r,label:s,...fe(a)&&{description:a},...fe(t.pos)&&{dotpos:t.pos},points:Sx(t,u),labelBBox:c,...l?{dir:"back"}:{},...o}}function Cx(t,e){const n=dg(t.bb),{nodes:r,edges:i,manualLayout:s,...a}=e,o={...a,bounds:n,nodes:[],edges:[]},u=t.objects??[];for(const l of r){const f=u.find(d=>d.likec4_id===l.id);Fe(f,`View ${a.id} node ${l.id} not found in graphviz output`);try{const{x:d,y:h,width:p,height:w}="bb"in f?dg(f.bb):Dx(f),v=[d,h];o.nodes.push({...l,position:v,width:p,
height:w,labelBBox:Tx(f._ldraw_,v)??{x:d,y:h,width:p,height:w}})}catch(d){throw new Error(`Failed on parsing node ${l.id}:
${JSON.stringify(f,null,2)}`,{cause:d})}}const c=t.edges??[];for(const l of i){const f=c.find(d=>d.likec4_id===l.id);if(!f){Fn.warn`View ${a.id} edge ${l.id} not found in graphviz output, skipping`;continue}o.edges.push(cK(f,l,a.id))}return o}const fg=t=>String(t+1).padStart(2,"0");function lK(t){const e=dg(t.bb),n={nodes:[],edges:[],bounds:e},r=new Map,i=t.objects??[];for(const s of i){if(!s.likec4_type)continue;const a=fg(s._gvid),o=s.likec4_path??"",u=r.get(s._gvid),{x:c,y:l,width:f,height:d}="\
bb"in s?dg(s.bb):Dx(s),h={x:c,y:l};if(s.likec4_type==="view")Fe(s.likec4_id,`View ${s} has no likec4_id`),n.nodes.push({id:a,type:"view",parentId:u?.id??null,height:d,width:f,position:h,label:s.label??"",viewId:s.likec4_id});else{const p={id:a,type:s.likec4_type,parentId:u?.id??null,height:d,width:f,position:h,path:o,label:s.label??""},w=[..."subgraphs"in s?s.subgraphs:[],..."nodes"in s?s.nodes:[]];for(const v of w)r.set(v,p);n.nodes.push(p)}}for(const s of t.edges??[])try{const a=fg(s.tail),o=fg(
s.head);n.edges.push({id:`link${fg(s._gvid)}`,source:a,target:o,points:Sx(s)})}catch(a){Fn.warn(`Failed on parsing edge:
{edge}`,{error:a,edge:s})}return n}const _x=fn.font,hg="/";class T0{static toDot(e){return new T0(e).print()}subgraphs=new Map;graphvizModel;constructor(e){const n=this.graphvizModel=A5.graph({[F.layout]:"osage",[F.pack]:Pr(100),[F.packmode]:"array_ltc",[F.pad]:At(15),[F.fontname]:_x,[F.splines]:"polyline",[F.esep]:"+20"});n.attributes.graph.apply({[F.fontsize]:Pr(20),[F.labeljust]:"l",[F.labelloc]:"t"}),n.attributes.node.apply({[F.fontname]:_x,[F.shape]:"rect",[F.width]:At(400),[F.height]:At(300),
[F.fixedsize]:!0,[F.fontsize]:10}),n.attributes.edge.apply({[F.penwidth]:Pr(2)});const r=new Set(e.map(u=>u.relativePath??""));let i=0,s=[...e];const a=r.size>1;a&&s.sort((u,c)=>{const l=u.relativePath?.split(hg)??[""],f=c.relativePath?.split(hg)??[""];l.push(u.title??"Untitled"),f.push(c.title??"Untitled");const d=l.length,h=f.length;switch(i=Math.max(i,d,h),!0){case d>h:return-1;case d<h:return 1;default:{for(let p=0;p<d;p++){const w=l[p].localeCompare(f[p]);if(w!==0)return w}return 0}}});const o=new Map;
s.forEach((u,c)=>{this.addView(a?u:{...u,relativePath:""},c+i);const l=u.nodes.reduce((f,d)=>(d.navigateTo&&f.add(d.navigateTo),f),new Set);l.size>0&&o.set(u.id,l)});for(const[u,c]of o)for(const l of c)n.edge([u,l])}getParentForPath(e){if(e==="")return this.graphvizModel;const n=e.toLowerCase();let r=this.subgraphs.get(n);if(!r){const i=n.endsWith(".c4")||n.endsWith(".likec4"),s=e.includes(hg)?e.slice(0,e.lastIndexOf(hg)):"";r=this.getParentForPath(s).subgraph("cluster"+String(this.subgraphs.size+
1),{[F.likec4_type]:i?"file":"folder",[F.likec4_path]:e,[F.sortv]:this.subgraphs.size,[F.label]:fe(s)?e.slice(s.length+1):e}),this.subgraphs.set(n,r)}return r}addView(e,n=0){return this.getParentForPath(e.relativePath??"").node(e.id,{[F.likec4_type]:"view",[F.likec4_id]:e.id,[F.sortv]:n,[F.label]:e.title||"Untitled"})}print(){return HA(this.graphvizModel,{print:{indentStyle:"space",indentSize:2}})}}const Ax=t=>{switch(!0){case Iu.isDynamic(t):return new D0(t);case Iu.isDeployment(t):return new aK(
t);case Iu.isElement(t):return new oK(t);default:Ke(t)}},Du=Fn.getChild("graphviz-layouter");class xx{constructor(e){this.graphviz=e}get port(){return this.graphviz}changePort(e){this.graphviz=e}async dotToJson(e){let n;try{n=await this.graphviz.layoutJson(e)}catch(r){throw Du.error(Jn(r)),Du.error`Failed to convert DOT to JSON:\n${e}`,r}try{return JSON.parse(n)}catch(r){throw Du.error(Jn(r)),Du.error`Failed to parse JSON:\n${n}\n. Generated from DOT:\n${e}`,r}}async layout(e){try{let n=await this.
dot(e);const r=await this.dotToJson(n);let i=Cx(r,e);if(e.manualLayout){const s=zH(i,e.manualLayout);if(s.diagram)i=s.diagram;else{if(s.relayout.nodes.length>0){const a=Ax(e);if(a.hasEdgesWithCompounds)Du.warn(`Manual layout for view ${e.id} is ignored, as edges with compounds are not supported`);else{a.applyManualLayout(s.relayout);const o=await this.dotToJson(a.print());i=Cx(o,e)}}i.hasLayoutDrift=!0}}return n=n.split(`
`).filter(s=>!(s.includes("margin")&&s.includes("50.1"))).join(`
`),{dot:n,diagram:i}}catch(n){throw new Error(`Error during layout: ${e.id}`,{cause:n})}}async svg(e){let n=await this.dot(e);return n=n.split(`
`).filter(r=>!(r.includes("margin")&&r.includes("50.1"))).join(`
`),{svg:await this.graphviz.svg(n),dot:n}}async dot(e){let n=Ax(e).print();if(!Iu.isElement(e))return n;try{return await this.graphviz.unflatten(n)}catch(r){return Du.warn(`Error during unflatten: ${e.id}`,{error:r}),n}}async layoutOverviewGraph(e){if(e.length===0)return Promise.resolve({nodes:[],edges:[],bounds:{x:0,y:0,width:10,height:10}});const n=T0.toDot(e),r=await this.dotToJson(n);return lK(r)}}class dK{value;next;constructor(e){this.value=e}}class fK{#e;#t;#r;constructor(){this.clear()}enqueue(e){
const n=new dK(e);this.#e?(this.#t.next=n,this.#t=n):(this.#e=n,this.#t=n),this.#r++}dequeue(){const e=this.#e;if(e)return this.#e=this.#e.next,this.#r--,e.value}peek(){if(this.#e)return this.#e.value}clear(){this.#e=void 0,this.#t=void 0,this.#r=0}get size(){return this.#r}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}}function Px(t){Nx(t);const e=new fK;let n=0;const r=()=>{n<t&&e.size>0&&(e.dequeue()(),n++)},i=()=>{n--,r()},s=async(u,c,l)=>{const f=(async()=>u(...l))();c(f);
try{await f}catch{}i()},a=(u,c,l)=>{new Promise(f=>{e.enqueue(f)}).then(s.bind(void 0,u,c,l)),(async()=>(await Promise.resolve(),n<t&&r()))()},o=(u,...c)=>new Promise(l=>{a(u,l,c)});return Object.defineProperties(o,{activeCount:{get:()=>n},pendingCount:{get:()=>e.size},clearQueue:{value(){e.clear()}},concurrency:{get:()=>t,set(u){Nx(u),t=u,queueMicrotask(()=>{for(;n<t&&e.size>0;)r()})}}}),o}function Nx(t){if(!((Number.isInteger(t)||t===Number.POSITIVE_INFINITY)&&t>0))throw new TypeError("Expecte\
d `concurrency` to be a number from 1 and up")}const hK=Px(1);class xu{static _graphviz=null;graphviz(){return Promise.resolve().then(()=>xu._graphviz??=Sg.load())}async attempt(e,n,r){return await hK(async()=>{const i=Fn.getChild("graphviz-wasm");try{return await r()}catch(s){i.error("FAILED GraphvizWasm. {logMessage}",{error:s,logMessage:e}),console.error("FAILED DOT:"),console.error(n),Sg.unload(),xu._graphviz=null}i.warn("Retrying..."),await g1(50,300);try{return await r()}finally{Sg.unload(),
xu._graphviz=null}})}async unflatten(e){return await this.attempt("unflatten",e,async()=>(await this.graphviz()).unflatten(e,1,!1,3).replaceAll(/\t\[/g," [").replaceAll(/\t/g,"    "))}async acyclic(e){return await this.attempt("acyclic",e,async()=>{const n=(await this.graphviz()).acyclic(e,!0);return n.acyclic&&n.outFile||e})}async layoutJson(e){return await this.attempt("layout",e,async()=>(await this.graphviz()).layout(e,"json",void 0,{yInvert:!0}))}async svg(e){return await this.attempt("svg",
e,async()=>(await this.graphviz()).layout(e,"svg"))}}const Pf=Symbol.for("idattr"),pg={writeId(t,e){return t[Pf]=e,t},readId(t){return t[Pf]}},mg={writeId(t,e){return Ft(e)?t[Pf]=void 0:t[Pf]=e,t},readId(t){return t[Pf]}};function so(t){return t.textDocument.languageId===Yw.languageId}function Ix({value:t}){const e=parseFloat(t);return isNaN(e)?100:AT(e,{min:0,max:100})}function Tu({value:t}){switch(t){case"xs":case"sm":case"md":case"lg":case"xl":return t;case"xsmall":return"xs";case"small":return"\
sm";case"medium":return"md";case"large":return"lg";case"xlarge":return"xl";default:Ke(t)}}function pK(t,e){const n={};if(!t||t.length===0)return n;for(const r of t)if(e(r))switch(!0){case Wa(r):{const i=Nf(r);fe(i)&&(n.color=i);break}case pd(r):{n.line=r.value;break}case Gl(r):{switch(r.key){case"head":{n.head=r.value;break}case"tail":{n.tail=r.value;break}default:Ke(r)}break}default:Ke(r)}return n}function Yb(t,e){const{color:n,line:r,head:i,tail:s}=pK(t?.filter(UC),e);return{...n&&n!==Nu?{color:n}:
{},...r&&r!==y1?{line:r}:{},...i&&i!==ra?{head:i}:{},...s?{tail:s}:{}}}function Nf(t){return t?.themeColor??t?.customColor?.$refText}function Jb(t){const e=t.rankSep,n=t.nodeSep;let r;switch(t.direction){case"TopBottom":{r="TB";break}case"BottomTop":{r="BT";break}case"LeftRight":{r="LR";break}case"RightLeft":{r="RL";break}default:Ke(t.direction)}return{direction:r,...n&&{nodeSep:n},...e&&{rankSep:e}}}function mK(t){switch(t){case"TB":return"TopBottom";case"BT":return"BottomTop";case"LR":return"L\
eftRight";case"RL":return"RightLeft";default:Ke(t)}}function gg(t){return cr(t,e=>Ud(e)||Vo(e)||e_(e))}const Qb=t=>c_(t)||sm(t)||Iw(t)||Pw(t)||JC(t)||xw(t),e0=t=>l_(t)||Sw(t)||ZC(t)||s_(t)||KC(t);function gK(t){for(;;){if(e0(t)||Qb(t))return!1;if(Fw(t)||vd(t))return!0;if(t.$container)t=t.$container;else return!1}}function yK(t){for(;;){if(e0(t))return!1;if(Qb(t))return!0;if(t.$container)t=t.$container;else return!1}}function vK(t){for(;;){if(Qb(t))return!1;if(e0(t))return!0;if(t.$container)t=t.$container;else
return!1}}class wK{parser;locator;constructor(e){this.parser=e.likec4.ModelParser,this.locator=e.likec4.ModelLocator}getDocumentation(e){try{if(ar(e)){const n=vt(e),r=this.parser.forDocument(n).parseDeploymentNode(e),i=[r.id];return r.title!==e.name&&i.push(" ",`**${r.title}**`),i.join(`  
`)}if(yr(e)){const n=vt(e),r=this.parser.forDocument(n).parseDeployedInstance(e),[i,s]=Ln.isImportRef(r.element)?[r.element.project,r.element.model]:[n.likec4ProjectId,r.element.model],a=i?this.locator.getParsedElement(s,i):this.locator.getParsedElement(s),o=[r.id,`_instance of_ ${r.element}`];return a&&o.push(" ",`**${a.title}**`),o.join(`  
`)}if(_n(e)){const n=vt(e),r=this.parser.forDocument(n).parseElement(e);return r?[r.id," ",`**${r.title}**`].join(`  
`):void 0}}catch(n){Ae(n)}}}function bK(t,e){return[t,e]=t0(t,e)>0?[e,t]:[t,e],EK(t.range,e.range.start)}function t0(t,e){const n=t.range.start.line-e.range.start.line;return n!==0?n:t.range.start.character-e.range.start.character}function EK(t,e){return!(e.line<t.start.line||e.line>t.end.line||e.line==t.start.line&&e.character<t.start.character||e.line==t.end.line&&e.character>t.end.character)}function Ox(t){return t.range.start.line!=t.range.end.line}const te={newLine:xs.newLine({allowMore:!0}),
oneSpace:xs.oneSpace(),noSpace:xs.noSpace(),indent:xs.indent({allowMore:!0}),noIndent:xs.noIndent()};class kK extends $z{format(e){this.removeIndentFromTopLevelStatements(e),this.indentContentInBraces(e),this.formatSpecificationRule(e),this.formatGlobals(e),this.formatElementDeclaration(e),this.formatRelation(e),this.formatMetadataProperty(e),this.formatDeploymentNodeDeclaration(e),this.formatDeployedInstance(e),this.formatDeploymentRelation(e),this.formatView(e),this.formatViewRuleGroup(e),this.
formatViewRuleGlobalStyle(e),this.formatViewRuleGlobalPredicate(e),this.formatIncludeExcludeExpressions(e),this.formatWhereExpression(e),this.formatWhereRelationExpression(e),this.formatWhereElementExpression(e),this.formatRelationExpression(e),this.formatAutolayoutProperty(e),this.formatWithPredicate(e),this.formatViewRuleStyle(e),this.formatLeafProperty(e),this.formatLinkProperty(e),this.formatNavigateToProperty(e),this.formatTags(e)}formatTags(e){this.on(e,Hw,(n,r)=>{r.cst(Ro(n.$cstNode,"valu\
es").slice(1)).prepend(te.oneSpace),r.keywords(",").prepend(te.noSpace).append(te.oneSpace)})}formatDeploymentRelation(e){this.on(e,Ri,(n,r)=>{const i=n?.source?.$cstNode?[n?.source?.$cstNode]:[];r.cst(i).append(te.oneSpace),r.keywords("]->").prepend(te.noSpace),r.keywords("-[").append(te.noSpace),r.nodes(...Qe([n.target,n.tags],fe)).prepend(te.oneSpace),r.properties("title","technology").prepend(te.oneSpace)})}formatRelation(e){this.on(e,n=>os(n)||Ri(n),(n,r)=>{const i=n?.source?.$cstNode?[n?.source?.
$cstNode]:[];r.cst(i).append(te.oneSpace),r.keywords("]->").prepend(te.noSpace),r.keywords("-[").append(te.noSpace),r.nodes(...Qe([n.target,n.tags],fe)).prepend(te.oneSpace),r.properties("title","technology").prepend(te.oneSpace)}),this.on(e,Aw,(n,r)=>{r.keywords("->","<-").surround(te.oneSpace);const i=r.property("kind");i.nodes[0]?.text.startsWith(".")&&i.surround(te.oneSpace),r.keywords("]->").prepend(te.noSpace).append(te.oneSpace),r.keywords("-[").prepend(te.oneSpace).append(te.noSpace),r.properties(
"title").prepend(te.oneSpace)})}removeIndentFromTopLevelStatements(e){u_(e.$container)&&this.getNodeFormatter(e).keywords("specification","model","views","likec4lib","global","deployments","import").prepend(te.noIndent)}indentContentInBraces(e){if(hW(e)||p_(e)||cu(e)||du(e)||ou(e)||Fw(e)||tu(e)||Za(e)||ud(e)||od(e)||Za(e)||c_(e)||sm(e)||Iw(e)||gW(e)||Tm(e)||mW(e)||vd(e)||Pw(e)||JC(e)||Sw(e)||pu(e)||Im(e)||sW(e)||aW(e)||Zo(e)||Cw(e)||l_(e)||ZC(e)||uW(e)||KC(e)){const n=this.getNodeFormatter(e),r=n.
keywords("{"),i=n.keywords("}"),s=n.interior(r,i);let a=null;for(const o of s.nodes)(!a||!bK(a,o))&&n.cst([o]).prepend(te.indent),a=o;r.prepend(te.noIndent).prepend(te.oneSpace),i.prepend(te.noIndent).prepend(xs.newLine({allowMore:!0}))}}appendKeywordsWithSpace(e){this.on(e,t_)?.keywords("element").append(te.oneSpace)}formatView(e){this.on(e,om,(n,r)=>{(n.extends||n.viewOf||n.name)&&r.keywords("view").append(te.oneSpace),r.keywords("of","extends").surround(te.oneSpace)}),this.on(e,YC)?.keywords(
"dynamic","view").append(te.oneSpace),this.on(e,XC)?.keywords("deployment","view").append(te.oneSpace)}formatLeafProperty(e){if(ed(e)||Ad(e)||vW(e)||su(e)||zw(e)||h_(e)||Wa(e)||pd(e)||Gl(e)||Ns(e)||Sm(e)||Vp(e)||Rm(e)||jw(e)||Uw(e)||Bw(e)||Vw(e)){const n=this.getNodeFormatter(e),r=n.keyword(":"),i=n.keywords("title","description","technology","notation","color","line","head","tail","icon","shape","border","opacity","multiple","size","padding","textSize");r.nodes.length===0?i.append(te.oneSpace):
r.prepend(te.noSpace).append(te.oneSpace),n.keyword(";").prepend(te.noSpace).append(te.newLine)}}formatLinkProperty(e){this.on(e,bm,(n,r)=>{r.keyword("link").append(te.oneSpace),r.property("value").append(te.oneSpace),r.keyword(":").prepend(te.noSpace).append(te.oneSpace),r.keyword(";").prepend(te.noSpace).append(te.newLine)})}formatNavigateToProperty(e){this.on(e,km)?.property("key").append(te.oneSpace)}formatAutolayoutProperty(e){this.on(e,Md,(n,r)=>{r.keyword("autoLayout").append(te.oneSpace),
r.property("rankSep").prepend(te.oneSpace),r.property("nodeSep").prepend(te.oneSpace)})}formatMetadataProperty(e){this.on(e,pW,(n,r)=>{r.property("key").append(te.oneSpace),r.keyword(":").prepend(te.noSpace).append(te.oneSpace),r.keyword(";").prepend(te.noSpace).append(te.newLine)})}formatElementDeclaration(e){this.on(e,_n,(n,r)=>{const i=Cn(n.$cstNode,"kind"),s=Cn(n.$cstNode,"name");s&&i&&(t0(s,i)>0?r.cst([i]).append(te.oneSpace):(r.cst([s]).append(te.oneSpace),r.cst([i]).prepend(te.oneSpace))),
r.properties("props").prepend(te.oneSpace)})}formatGlobals(e){this.on(e,tu,(n,r)=>{r.keyword("style").append(te.oneSpace),r.property("id").append(te.oneSpace)}),this.on(e,Za,(n,r)=>{r.keyword("styleGroup").append(te.oneSpace)}),this.on(e,ud,(n,r)=>{r.keyword("predicateGroup").append(te.oneSpace)}),this.on(e,od,(n,r)=>{r.keyword("dynamicPredicateGroup").append(te.oneSpace)})}formatSpecificationRule(e){if((cu(e)||du(e)||Am(e)||ou(e))&&this.getNodeFormatter(e).keywords("element","relationship","tag",
"deploymentNode").append(te.oneSpace),_m(e)){const n=this.getNodeFormatter(e);n.keyword("color").append(te.oneSpace),n.property("name").append(te.oneSpace)}}formatWithPredicate(e){(hm(e)||Gw(e))&&this.getNodeFormatter(e).keyword("with").prepend(te.oneSpace)}formatDeploymentNodeDeclaration(e){this.on(e,ar,(n,r)=>{const i=Cn(n.$cstNode,"kind"),s=Cn(n.$cstNode,"name");s&&i&&(t0(s,i)>0?r.cst([i]).append(te.oneSpace):(r.cst([s]).append(te.oneSpace),r.cst([i]).prepend(te.oneSpace))),r.properties("titl\
e").prepend(te.oneSpace)})}formatDeployedInstance(e){this.on(e,yr,(n,r)=>{const i=n.$cstNode?.content.find(s=>s.text==="=");i&&r.cst([i]).surround(te.oneSpace),r.keyword("instanceOf").append(te.oneSpace),r.property("title").prepend(te.oneSpace)})}formatViewRuleGlobalStyle(e){this.on(e,Xw,(n,r)=>{r.keywords("global","style").append(te.oneSpace)})}formatViewRuleGlobalPredicate(e){const n=this.getNodeFormatter(e);(Zw(e)||QC(e))&&n.keywords("global","predicate").append(te.oneSpace)}formatViewRuleGroup(e){
this.on(e,Im,(n,r)=>{r.keyword("group").append(te.oneSpace)})}formatViewRuleStyle(e){this.on(e,pu)?.keyword("style").append(te.oneSpace),this.on(e,Kl)?.keyword("style").append(te.oneSpace),this.on(e,i_)?.keyword(",").prepend(te.noSpace).append(te.oneSpace),this.on(e,lW)?.keyword(",").prepend(te.noSpace).append(te.oneSpace)}formatWhereExpression(e){(qw(e)||Ow(e))&&this.getNodeFormatter(e).keyword("where").append(te.oneSpace)}formatWhereRelationExpression(e){if(this.on(e,rW,(n,r)=>{r.property("ope\
rator").surround(te.oneSpace)}),this.on(e,w_,(n,r)=>{r.keyword("not").append(te.oneSpace)}),VC(e)||kW(e)||v_(e)){const n=this.getNodeFormatter(e);n.property("operator").surround(te.oneSpace),n.property("not").surround(te.oneSpace)}}formatWhereElementExpression(e){if(this.on(e,tW,(n,r)=>{r.property("operator").surround(te.oneSpace)}),this.on(e,y_,(n,r)=>{r.keyword("not").append(te.oneSpace)}),WC(e)||EW(e)||bW(e)){const n=this.getNodeFormatter(e);n.property("operator").surround(te.oneSpace),n.property(
"not").surround(te.oneSpace)}}formatIncludeExcludeExpressions(e){if(vw(e)||Ud(e)||Vo(e)){const n=this.getNodeFormatter(e);(!e.$cstNode||!Ox(e.$cstNode))&&n.keywords("include","exclude").append(te.oneSpace)}if(i_(e)){const n=this.getNodeFormatter(e),r=this.findPredicateExpressionRoot(e),i=r?.$cstNode&&Ox(r?.$cstNode);i&&n.property("value").prepend(te.indent),n.keyword(",").prepend(te.noSpace).append(i?te.newLine:te.oneSpace)}}formatRelationExpression(e){this.on(e,dW,(n,r)=>{r.keyword("->").append(
te.oneSpace)}),this.on(e,o_,(n,r)=>{r.keyword("->").prepend(te.oneSpace)}),this.on(e,f_,(n,r)=>{r.keywords("->","<->").prepend(te.oneSpace),r.keywords("-[").prepend(te.oneSpace).append(te.noSpace),r.keywords("]->").prepend(te.noSpace).append(te.oneSpace);const i=r.property("kind");i.nodes[0]?.text.startsWith(".")&&i.surround(te.oneSpace)}),this.on(e,cW,(n,r)=>{r.property("target").prepend(te.oneSpace)})}findPredicateExpressionRoot(e){let n=e.$container;for(;;){if(!n||vw(n)||Ud(n)||Vo(n))return n;
n=n.$container}}on(e,n,r){const i=n(e)?this.getNodeFormatter(e):void 0;return r&&i&&r(e,i),i}}class RK extends QD{constructor(e){super(e),this.services=e}createDescription(e,n,r){const i=r??vt(e),s=super.createDescription(e,n,r);return i.likec4ProjectId??=this.services.shared.workspace.ProjectsManager.belongsTo(i.uri),s.likec4ProjectId=i.likec4ProjectId,s}}var Jt=xa();class $K extends eT{constructor(e){super(e),this.services=e}async updateContent(e,n=Jt.CancellationToken.None){const r=this.services.
workspace.ProjectsManager;e.likec4ProjectId=r.belongsTo(e.uri),await super.updateContent(e,n)}projectElements(e,n,r){const i=this.services.workspace.ProjectsManager;return rt(this.symbolIndex.keys()).filter(s=>i.belongsTo(s)===e&&(!r||r.has(s))).flatMap(s=>this.getFileDescriptions(s,n))}}class DK extends WD{constructor(e){super(e),this.services=e}get allExcludingBuiltin(){const e=this.services.workspace.ProjectsManager;return super.all.filter(n=>!so(n)||nf(n.uri)?!1:(n.likec4ProjectId??=e.belongsTo(
n.uri),!0))}projectDocuments(e){return this.allExcludingBuiltin.filter(n=>n.likec4ProjectId===e)}groupedByProject(){return qo(this.allExcludingBuiltin.toArray(),Ui("likec4ProjectId"))}}class TK extends tT{constructor(e){super(e),this.services=e,this.documentFactory=e.workspace.LangiumDocumentFactory}documentFactory;async loadAdditionalDocuments(e,n){const r=this.services.workspace.ProjectsManager;for(const i of e)try{const s=await this.fileSystemProvider.readDirectory(_t.parse(i.uri));for(const a of s)
try{await r.loadConfigFile(a)}catch(o){rf(o)}}catch(s){rf(s)}n(this.documentFactory.fromString(D_,_t.parse(CW))),await super.loadAdditionalDocuments(e,n)}includeEntry(e,n,r){return this.services.workspace.ProjectsManager.isConfigFile(n)?!1:n.isFile?!this.services.workspace.ProjectsManager.checkIfExcluded(n.uri):super.includeEntry(e,n,r)}workspace(){return this.folders&&v1(this.folders,1)?this.folders[0]:null}get workspaceUri(){const e=this.workspace();return Fe(e,"Workspace not initialized"),_t.
parse(e.uri)}get workspaceURL(){const e=this.workspace();return Fe(e,"Workspace not initialized"),new URL(e.uri)}}const SK=lt.getChild("LikeC4LanguageServices");class CK{constructor(e){this.services=e,this.views=e.likec4.Views,this.builder=e.likec4.ModelBuilder,this.projectsManager=e.shared.workspace.ProjectsManager}views;builder;projectsManager;get workspaceUri(){return this.services.shared.workspace.WorkspaceManager.workspaceUri}projects(){const e=this.services.shared.workspace.ProjectsManager,
n=et(this.services.shared.workspace.LangiumDocuments.groupedByProject(),Yc(),Ht(([s,a])=>{const o=s,{folder:u,config:c}=e.getProject(o);return{id:o,folder:u,config:c,documents:Ht(a,Ui("uri"))}}));if(Ar(n,1))return n;const{folder:r,config:i}=e.getProject(Tn.DefaultProjectId);return[{id:Tn.DefaultProjectId,folder:r,config:i,documents:null}]}async diagrams(){return await this.views.diagrams()}async computedModel(e){const n=this.projectsManager.ensureProjectId(e);return await this.builder.buildLikeC4Model(
n)}async layoutedModel(e){const n=this.projectsManager.ensureProjectId(e),r=await this.builder.parseModel(n);if(!r)throw new Error("Failed to parse model");const i=await this.views.diagrams(n);return ia.create({...r,__:"layouted",views:Xc(i,Ui("id"))})}getErrors(){return this.services.shared.workspace.LangiumDocuments.allExcludingBuiltin.toArray().flatMap(e=>(e.diagnostics??[]).filter(n=>n.severity===wa.Error).map(({message:n,range:r})=>({message:n,line:r.start.line,range:r,sourceFsPath:e.uri.fsPath})))}async notifyUpdate({
changed:e,removed:n}){if(!e&&!n)return!1;const r=this.services.shared.workspace.WorkspaceLock;try{let i=!1;return await r.write(async s=>{await this.services.shared.workspace.DocumentBuilder.update(e?[_t.file(e)]:[],n?[_t.file(n)]:[],s),i=!s.isCancellationRequested}),i}catch(i){return SK.error(Jn(i)),!1}}locate(e){switch(!0){case"element"in e:return this.services.likec4.ModelLocator.locateElement(e.element,e.projectId);case"relation"in e:return this.services.likec4.ModelLocator.locateRelation(e.
relation,e.projectId);case"view"in e:return this.services.likec4.ModelLocator.locateView(e.view,e.projectId);case"deployment"in e:return this.services.likec4.ModelLocator.locateDeploymentElement(e.deployment,e.projectId);default:Ke(e)}}}class n0{toDispose=[];isDisposed=!1;onDispose(...e){this.toDispose.push(...e)}dispose(){this.throwIfDisposed(),this.isDisposed=!0;let e;for(;e=this.toDispose.pop();)try{e.dispose()}catch(n){rf(n)}}throwIfDisposed(){if(this.isDisposed)throw new Error("This has alr\
eady been disposed")}}function ao(t){let e=Ww(t)?t.el.ref:t.modelElement.value.ref;return e?.$type==="Imported"&&(e=e.imported.ref),e?.$type==="Element"?e:void 0}function oo(t){const e=[t.$type==="StrictFqnRef"?t.value.$refText:t.el.$refText];let n=t.parent;for(;n;)e.push(n.$type==="StrictFqnRef"?n.value.$refText:n.el.$refText),n=n.parent;return e.length===1?e[0]:e.reverse().join(".")}function _K(t){for(;t.parent;)t=t.parent;return t.value.ref??null}function AK(t){let e;for(;e=t.value?.ref;){if(ar(
e))return null;if(yr(e))return e;if(Ft(t.parent))return null;t=t.parent}return null}function xK(t){const e=_K(t);return e?.$type==="Imported"?e:null}function PK(t){let e;for(;e=t.value?.ref;){if(Pp(e))return!0;if(Ft(t.parent))return!1;t=t.parent}return!1}function rn(t){if(ss(t)){for(;t.$type==="Imported"&&t.$container;)t=t.$container;Fe(Mw(t))}if(Mw(t))return t.project;const e=Mt(t)?vt(t):t;return Vt(e.likec4ProjectId,()=>`Invalid state, document ${e.uri} has no project ID assigned`)}function If(...t){
var e=t.length>1?t.join(":::"):t[0];return w1(e)}function Lx(t){try{return t()}catch(e){lt.debug("Safe call failed",{error:e});return}}class NK{constructor(e){this.services=e}async provideCodeLens(e,n,r){return so(e)?(e.state<=Ze.Linked&&(lt.debug(`Waiting for document ${e.uri.path} to be Linked`),await this.services.shared.workspace.DocumentBuilder.waitUntil(Ze.Linked,e.uri,r),lt.debug("Document is linked")),e.parseResult.value.views.flatMap(i=>i.views).flatMap(i=>{const s=pg.readId(i),a=i.$cstNode?.
range;if(!a||!s)return[];const o=rn(i);return{range:{start:a.start,end:{line:a.start.line,character:a.start.character+4}},command:{command:"likec4.open-preview",arguments:[s,o],title:"open preview"}}})):void 0}}const r0=["color","shape","icon","border","opacity","multiple","size","textSize"].join(",");class IK extends nC{constructor(e){super(e),this.services=e}completionOptions={triggerCharacters:["."]};completionForKeyword(e,n,r){if(this.filterKeyword(e,n))switch(!0){case n.value==="import":r(e,
{label:n.value,kind:Bt.Snippet,insertTextFormat:Gn.Snippet,insertText:`${n.value} { $0 } from '\${1|${this.services.shared.workspace.ProjectsManager.all.join(",")}|}'`});break;case(n.value==="deployment"&&mi(e.node,vd)):r(e,{label:n.value,detail:"Insert deployment view",kind:Bt.Class,insertTextFormat:Gn.Snippet,insertText:["deployment view ${1:view_${TM_FILENAME_BASE}_${CURRENT_SECOND}} {","	title '${2:Untitled}'","	","	include $0","}"].join(`
`)});break;case["title","description","technology"].includes(n.value):r(e,{label:n.value,kind:Bt.Property,insertTextFormat:Gn.Snippet,insertText:`${n.value} '\${0}'`});break;case n.value==="color":r(e,{label:n.value,kind:Bt.Property,insertTextFormat:Gn.Snippet,insertText:`${n.value} \${1|${b1.join(",")}|}$0`});break;case n.value==="opacity":r(e,{label:n.value,kind:Bt.Property,insertTextFormat:Gn.Snippet,insertText:`${n.value} \${0:100}%`});break;case["views","specification","model","deployment",
"with"].includes(n.value):r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:Bt.Module,insertTextFormat:Gn.Snippet,insertText:`${n.value} {
	$0
}`});break;case n.value==="group":r(e,{label:n.value,detail:"Insert group block",kind:Bt.Class,insertTextFormat:Gn.Snippet,insertText:["group '${1:Title}' {","	$0","}"].join(`
`)});break;case(n.value==="dynamic"&&mi(e.node,vd)):r(e,{label:n.value,detail:"Insert dynamic view",kind:Bt.Class,insertTextFormat:Gn.Snippet,insertText:["dynamic view ${1:view_${TM_FILENAME_BASE}_${CURRENT_SECOND}} {","	title '${2:Untitled}'","	","	$0","}"].join(`
`)});break;case(n.value==="style"&&e.node&&mi(e.node,tu)):r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:Bt.Module,insertTextFormat:Gn.Snippet,insertText:`${n.value} \${1:name} \${2:*} {
	\${3|${r0}|} $0
}`});break;case(n.value==="style"&&e.node&&mi(e.node,VU([vd,Za]))):r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:Bt.Module,insertTextFormat:Gn.Snippet,insertText:`${n.value} \${1:*} {
	\${2|${r0}|} $0
}`});break;case n.value==="style":r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:Bt.Module,insertTextFormat:Gn.Snippet,insertText:`${n.value} {
	\${1|${r0}|} $0
}`});break;case n.value==="extend":r(e,{label:n.value,detail:"Extend another view",kind:Bt.Class,insertTextFormat:Gn.Snippet,insertText:`extend $1 {
	$0
}`});break;case n.value==="autoLayout":r(e,{label:n.value,kind:Bt.Class,insertTextFormat:Gn.Snippet,insertText:"autoLayout ${1|TopBottom,BottomTop,LeftRight,RightLeft|}$0"});break;default:r(e,{label:n.value,kind:this.getKeywordCompletionItemKind(n),detail:"Keyword",sortText:"1"})}}}class OK extends rC{createDocumentHighlight(e){return Ee.DocumentHighlight.create(e.segment.range,Ee.DocumentHighlightKind.Read)}}class LK{constructor(e){this.services=e}async getDocumentLinks(e,n,r){return so(e)?gi(e.
parseResult.value).filter(bm).map(i=>{try{const s=Cn(i.$cstNode,"value")?.range,a=s&&this.resolveLink(e,i.value);if(a&&Fs(a))return{range:s,target:a}}catch(s){Ae(s)}return null}).nonNullable().toArray():[]}resolveLink(e,n){if(Fs(n)||sf(n))return n;if(Qw(n))return Om(e.uri.toString(),"../",n);const r=this.services.shared.workspace.ProjectsManager.getProject(e).folder;return Om(r.toString(),n)}relativeLink(e,n){if(sf(n))return x_(n);if(Qw(n)){const r=new URL(e.uri.toString(!0)),i=new URL(n,r).toString();
return x_(FW(i,this.services.shared.workspace.WorkspaceManager.workspaceURL.toString()))}return null}}const Fx=lt.getChild("DocumentSymbolProvider");class FK{constructor(e){this.services=e,this.nodeKindProvider=e.shared.lsp.NodeKindProvider,this.parser=e.likec4.ModelParser,this.locator=e.likec4.ModelLocator,this.nameProvider=e.references.NameProvider}nodeKindProvider;nameProvider;parser;locator;async getSymbols(e,n,r){if(!so(e))return[];e.state<=Ze.Linked&&(Fx.debug(`Waiting for document ${e.uri.
path} to be Linked`),await this.services.shared.workspace.DocumentBuilder.waitUntil(Ze.Linked,e.uri,r),Fx.debug("document is Linked"));const{parseResult:{value:{specifications:i,models:s,deployments:a,views:o,likec4lib:u}}}=e;return[...u.map(c=>()=>this.getLikec4LibSymbol(c)),...i.map(c=>()=>this.getSpecSymbol(c)),...s.map(c=>()=>this.getModelSymbol(c)),...a.map(c=>()=>this.getDeploymentModelSymbol(c)),...o.map(c=>()=>this.getModelViewsSymbol(c))].flatMap(c=>{try{return c()??[]}catch(l){return Ae(
l),[]}})}getLikec4LibSymbol(e){const n=e?.$cstNode;if(!n)return[];const r=e.icons.map(i=>this.getLibIconSymbol(i)).filter(fe);return r.length===0?[]:[{kind:Ur.Namespace,name:"icons",range:n.range,selectionRange:bc(n,"icons")?.range??n.range,children:r}]}getSpecSymbol(e){const n=e?.$cstNode;if(!n)return[];const r=Cn(n,"name");if(!r)return[];const i=et([...e.elements,...e.tags,...e.relationships],Ht(s=>{try{if(cu(s)||du(s)||ou(s))return this.getKindSymbol(s);if(Am(s))return this.getTagSymbol(s)}catch(a){
return Ae(a),null}Ke(s)}),Qe(fe));return i.length===0?[]:[{kind:Ur.Namespace,name:e.name,range:n.range,selectionRange:r.range,children:i}]}getModelSymbol(e){const n=e.$cstNode;if(!n)return[];const r=Cn(n,"name");return r?[{kind:this.symbolKind(e),name:e.name,range:n.range,selectionRange:r.range,children:e.elements.flatMap(i=>this.getElementsSymbol(i))}]:[]}getDeploymentModelSymbol(e){const n=e.$cstNode;if(!n)return[];const r=Cn(n,"name");return r?[{kind:this.symbolKind(e),name:e.name,range:n.range,
selectionRange:r.range,children:e.elements.flatMap(i=>this.getDeploymentElementSymbol(i))}]:[]}getElementsSymbol(e){try{if(Yo(e))return this.getExtendElementSymbol(e);if(_n(e))return this.getElementSymbol(e)}catch(n){Ae(n)}return[]}getExtendElementSymbol(e){const n=e.$cstNode,r=e.element.$cstNode,i=e.body;return!n||!r?[]:[{kind:this.symbolKind(e),name:oo(e.element),range:n.range,selectionRange:r.range,children:i.elements.flatMap(s=>this.getElementsSymbol(s))}]}getElementSymbol(e){const n=e.$cstNode,
r=Cn(n,"name");if(!r||!n)return[];const i=e.name,s=e.kind.$refText;return[{kind:this.symbolKind(e),name:i,range:n.range,selectionRange:r.range,detail:s,children:e.body?.elements.flatMap(a=>this.getElementsSymbol(a))??[]}]}getModelViewsSymbol(e){const n=e.$cstNode,r=Cn(n,"name");return!r||!n?[]:[{kind:this.symbolKind(e),name:e.name,range:n.range,selectionRange:r.range,children:e.views.flatMap(i=>this.getViewSymbol(i))}]}getKindSymbol(e){return!e.$cstNode||!e.kind.$cstNode||tn(e.kind.name)?null:{kind:this.
symbolKind(e),name:e.kind.name,range:e.$cstNode.range,selectionRange:e.kind.$cstNode.range}}getTagSymbol(e){return!e.$cstNode||!e.tag.$cstNode||tn(e.tag.name)?null:{kind:this.symbolKind(e),name:"#"+e.tag.name,range:e.$cstNode.range,selectionRange:e.tag.$cstNode.range}}getLibIconSymbol(e){return!e.$cstNode||tn(e.name)?null:{kind:this.symbolKind(e),name:e.name,range:e.$cstNode.range,selectionRange:e.$cstNode.range}}getViewSymbol(e){const n=e?.$cstNode;if(!n)return[];const r=e.name?Cn(n,"name"):null;
return r?[{kind:this.symbolKind(e),name:r.text,range:n.range,selectionRange:r.range,children:[]}]:[]}getDeploymentElementSymbol(e){try{if(ar(e))return this.getDeploymentNodeSymbol(e);if(yr(e))return this.getDeployedInstanceSymbol(e);if(Va(e))return[]}catch(n){Ae(n)}return[]}getDeploymentNodeSymbol(e){const n=e.$cstNode,r=this.nameProvider.getNameNode(e);if(!r||!n)return[];const i=this.nameProvider.getNameStrict(e),s=e.kind.$refText;return[{kind:this.symbolKind(e),name:i,range:n.range,selectionRange:r.
range,detail:s,children:e.body?.elements.flatMap(a=>this.getDeploymentElementSymbol(a))??[]}]}getDeployedInstanceSymbol(e){const n=e.$cstNode,r=this.nameProvider.getNameNode(e);if(!r||!n)return[];const i=vt(e),s=this.parser.forDocument(i).parseDeployedInstance(e),a=this.nameProvider.getNameStrict(e),o="instance of "+s.element;return[{kind:this.symbolKind(e),name:a,range:n.range,selectionRange:r.range,detail:o,children:[]}]}symbolKind(e){return this.nodeKindProvider.getSymbolKind(e)}}class MK extends oC{parser;locator;constructor(e){
super(e),this.parser=e.likec4.ModelParser,this.locator=e.likec4.ModelLocator}getAstNodeHoverContent(e){if(g_(e))return{contents:{kind:"markdown",value:"tag `"+e.name+"`"}};if(ar(e)){const n=vt(e),r=this.parser.forDocument(n).parseDeploymentNode(e),i=[r.id+"  "];return r.title!==e.name&&i.push(`### ${r.title}`),i.push("deployment node `"+r.kind+"` "),{contents:{kind:"markdown",value:i.join(`
`)}}}if(yr(e)){const n=vt(e),r=this.parser.forDocument(n).parseDeployedInstance(e),[i,s]=Ln.isImportRef(r.element)?[r.element.project,r.element.model]:[n.likec4ProjectId,r.element.model],a=i?this.locator.getParsedElement(s,i):this.locator.getParsedElement(s),o=[r.id+"  ",`instance of \`${r.element}\``];return a&&o.push(`### ${a.title}`,"element kind `"+a.kind+"` "),{contents:{kind:"markdown",value:o.join(`
`)}}}if(t_(e))return{contents:{kind:"markdown",value:"element kind `"+e.name+"`"}};if(oW(e))return{contents:{kind:"markdown",value:"deployment node `"+e.name+"`"}};if(_n(e)){const n=this.locator.getParsedElement(e);return n?{contents:{kind:"markdown",value:[n.id,`### ${n.title}`,"element kind `"+n.kind+"` "].join(`
`)}}:void 0}}}class jK extends hz{highlightElement(e,n){if(_n(e)||ar(e)||yr(e))return this.highlightNameAndKind(e,n);if(kw(e))return this.highlightView(e,n);if(yW(e))return n({node:e,property:"name",type:Je.function});if(fW(e))return n({node:e,property:"name",type:Je.type,modifier:[ut.definition]}),"prune";if((os(e)||f_(e)||Ri(e))&&"kind"in e&&n({node:e,property:"kind",type:Je.function}),km(e)||Cd(e))return n({node:e,property:"key",type:Je.property}),n({node:e,property:"value",type:Je.interface,
modifier:[ut.definition,ut.readonly]}),"prune";if(Lw(e)||k_(e))return n({cst:e.$cstNode,type:Je.variable,modifier:[ut.definition,ut.readonly]}),"prune";if(v_(e)&&fe(e.value)){n({node:e,property:"value",type:Je.function});return}if((WC(e)||VC(e))&&fe(e.value)){n({node:e,property:"value",type:Je.type,modifier:[ut.definition,ut.readonly]});return}if((b_(e)||E_(e))&&n({node:e,property:"participant",type:Je.keyword}),n_(e)&&fe(e.kind)){n({node:e,property:"kind",type:Je.type,modifier:[ut.definition]});
return}if(Za(e)||tu(e)){n({node:e,property:"id",type:Je.variable,modifier:[ut.definition,ut.readonly]});return}if(Xw(e)){n({node:e,property:"style",type:Je.variable,modifier:[ut.definition,ut.readonly]});return}if(ud(e)||od(e)){n({node:e,property:"name",type:Je.variable,modifier:[ut.definition,ut.readonly]});return}if(Zw(e)){n({node:e,property:"predicate",type:Je.variable,modifier:[ut.definition,ut.readonly]});return}if(r_(e)&&fe(e.tag)){n({node:e,property:"tag",type:Je.type,modifier:[ut.definition]});
return}if(a_(e)||m_(e))return n({node:e,property:"value",type:Je.variable,modifier:[ut.definition,ut.readonly]}),e.parent?void 0:"prune";if(Ww(e))return n({node:e,property:"el",type:Je.variable,modifier:[ut.definition,ut.readonly]}),e.parent?void 0:"prune";if(_m(e)){n({node:e,keyword:"color",type:Je.keyword}),n({node:e,property:"name",type:Je.type,modifier:[ut.declaration,ut.readonly]});return}if((cu(e)||du(e)||ou(e))&&n({node:e,property:"kind",type:Je.type,modifier:[ut.declaration,ut.readonly]}),
Hw(e))return n({node:e,property:"values",type:Je.interface}),"prune";if(g_(e))return n({node:e,property:"name",type:Je.type,modifier:[ut.definition]});if((Tm(e)||Zo(e))&&n({node:e,property:"key",type:Je.property}),Rm(e))return n({node:e,property:"key",type:Je.property}),n({node:e,property:"value",type:Je.number}),"prune";if(bm(e)||Ns(e)||zC(e))return n({node:e,property:"key",type:Je.property}),Ns(e)&&(e.libicon||e.value==="none")?(n({node:e,property:e.libicon?"libicon":"value",type:Je.enum,modifier:[
ut.defaultLibrary]}),"prune"):("value"in e&&e.value&&n({node:e,property:"value",type:Je.string}),"prune");if(Wa(e)||Sm(e)||Gl(e)||pd(e)||Vp(e)||Jz(e))return n({node:e,property:"key",type:Je.property}),"value"in e&&n({node:e,property:"value",type:Je.enum}),"prune"}highlightNameAndKind(e,n){if(n({node:e,property:"name",type:Je.variable,modifier:[ut.declaration,ut.readonly]}),yr(e)||n({node:e,property:"kind",type:Je.keyword,modifier:[]}),_n(e)){e.props.length>0&&n({node:e,property:"props",type:Je.string});
return}e.title&&n({node:e,property:"title",type:Je.string})}highlightView(e,n){e.name&&n({node:e,property:"name",type:Je.interface,modifier:[ut.declaration,ut.readonly,"local"]})}}const BK=6e4;class qK{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this.setNotificationHandler(yb,n=>{const r=this.
_requestHandlerAbortControllers.get(n.params.requestId);r?.abort(n.params.reason)}),this.setNotificationHandler(wb,n=>{this._onprogress(n)}),this.setRequestHandler(vb,n=>({}))}_setupTimeout(e,n,r,i,s=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(i,n),startTime:Date.now(),timeout:n,maxTotalTimeout:r,resetTimeoutOnProgress:s,onTimeout:i})}_resetTimeout(e){const n=this._timeoutInfo.get(e);if(!n)return!1;const r=Date.now()-n.startTime;if(n.maxTotalTimeout&&r>=n.maxTotalTimeout)throw this._timeoutInfo.
delete(e),new An(un.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:n.maxTotalTimeout,totalElapsed:r});return clearTimeout(n.timeoutId),n.timeoutId=setTimeout(n.onTimeout,n.timeout),!0}_cleanupTimeout(e){const n=this._timeoutInfo.get(e);n&&(clearTimeout(n.timeoutId),this._timeoutInfo.delete(e))}async connect(e){this._transport=e,this._transport.onclose=()=>{this._onclose()},this._transport.onerror=n=>{this._onerror(n)},this._transport.onmessage=(n,r)=>{lA(n)||_6(n)?this._onresponse(
n):S6(n)?this._onrequest(n,r):C6(n)?this._onnotification(n):this._onerror(new Error(`Unknown message type: ${JSON.stringify(n)}`))},await this._transport.start()}_onclose(){var e;const n=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);const r=new An(un.ConnectionClosed,"Connection closed");for(const i of n.values())i(r)}_onerror(e){var n;(n=this.onerror)===null||n===void 0||n.call(this,e)}_onnotification(e){
var n;const r=(n=this._notificationHandlers.get(e.method))!==null&&n!==void 0?n:this.fallbackNotificationHandler;r!==void 0&&Promise.resolve().then(()=>r(e)).catch(i=>this._onerror(new Error(`Uncaught error in notification handler: ${i}`)))}_onrequest(e,n){var r,i,s;const a=(r=this._requestHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackRequestHandler;if(a===void 0){(i=this._transport)===null||i===void 0||i.send({jsonrpc:"2.0",id:e.id,error:{code:un.MethodNotFound,message:"Method not f\
ound"}}).catch(c=>this._onerror(new Error(`Failed to send an error response: ${c}`)));return}const o=new AbortController;this._requestHandlerAbortControllers.set(e.id,o);const u={signal:o.signal,sessionId:(s=this._transport)===null||s===void 0?void 0:s.sessionId,sendNotification:c=>this.notification(c,{relatedRequestId:e.id}),sendRequest:(c,l,f)=>this.request(c,l,{...f,relatedRequestId:e.id}),authInfo:n?.authInfo};Promise.resolve().then(()=>a(e,u)).then(c=>{var l;if(!o.signal.aborted)return(l=this.
_transport)===null||l===void 0?void 0:l.send({result:c,jsonrpc:"2.0",id:e.id})},c=>{var l,f;if(!o.signal.aborted)return(l=this._transport)===null||l===void 0?void 0:l.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(c.code)?c.code:un.InternalError,message:(f=c.message)!==null&&f!==void 0?f:"Internal error"}})}).catch(c=>this._onerror(new Error(`Failed to send response: ${c}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){const{progressToken:n,...r}=e.
params,i=Number(n),s=this._progressHandlers.get(i);if(!s){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}const a=this._responseHandlers.get(i),o=this._timeoutInfo.get(i);if(o&&a&&o.resetTimeoutOnProgress)try{this._resetTimeout(i)}catch(u){a(u);return}s(r)}_onresponse(e){const n=Number(e.id),r=this._responseHandlers.get(n);if(r===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}
if(this._responseHandlers.delete(n),this._progressHandlers.delete(n),this._cleanupTimeout(n),lA(e))r(e);else{const i=new An(e.error.code,e.error.message,e.error.data);r(i)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,n,r){const{relatedRequestId:i,resumptionToken:s,onresumptiontoken:a}=r??{};return new Promise((o,u)=>{var c,l,f,d,h;if(!this._transport){u(new Error("Not connected"));return}((c=this._options)===
null||c===void 0?void 0:c.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),(l=r?.signal)===null||l===void 0||l.throwIfAborted();const p=this._requestMessageId++,w={...e,jsonrpc:"2.0",id:p};r?.onprogress&&(this._progressHandlers.set(p,r.onprogress),w.params={...e.params,_meta:{progressToken:p}});const v=k=>{var _;this._responseHandlers.delete(p),this._progressHandlers.delete(p),this._cleanupTimeout(p),(_=this._transport)===null||_===void 0||_.send({jsonrpc:"2.0",method:"n\
otifications/cancelled",params:{requestId:p,reason:String(k)}},{relatedRequestId:i,resumptionToken:s,onresumptiontoken:a}).catch(I=>this._onerror(new Error(`Failed to send cancellation: ${I}`))),u(k)};this._responseHandlers.set(p,k=>{var _;if(!(!((_=r?.signal)===null||_===void 0)&&_.aborted)){if(k instanceof Error)return u(k);try{const I=n.parse(k.result);o(I)}catch(I){u(I)}}}),(f=r?.signal)===null||f===void 0||f.addEventListener("abort",()=>{var k;v((k=r?.signal)===null||k===void 0?void 0:k.reason)});
const g=(d=r?.timeout)!==null&&d!==void 0?d:BK,b=()=>v(new An(un.RequestTimeout,"Request timed out",{timeout:g}));this._setupTimeout(p,g,r?.maxTotalTimeout,b,(h=r?.resetTimeoutOnProgress)!==null&&h!==void 0?h:!1),this._transport.send(w,{relatedRequestId:i,resumptionToken:s,onresumptiontoken:a}).catch(k=>{this._cleanupTimeout(p),u(k)})})}async notification(e,n){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);const r={...e,jsonrpc:"2.0"};await this.
_transport.send(r,n)}setRequestHandler(e,n){const r=e.shape.method.value;this.assertRequestHandlerCapability(r),this._requestHandlers.set(r,(i,s)=>Promise.resolve(n(e.parse(i),s)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,n){this._notificationHandlers.set(e.shape.method.value,r=>Promise.resolve(n(e.parse(r))))}removeNotificationHandler(e){
this._notificationHandlers.delete(e)}}function GK(t,e){return Object.entries(e).reduce((n,[r,i])=>(i&&typeof i=="object"?n[r]=n[r]?{...n[r],...i}:i:n[r]=i,n),{...t})}class UK extends qK{constructor(e,n){var r;super(n),this._serverInfo=e,this._capabilities=(r=n?.capabilities)!==null&&r!==void 0?r:{},this._instructions=n?.instructions,this.setRequestHandler(hA,i=>this._oninitialize(i)),this.setNotificationHandler(pA,()=>{var i;return(i=this.oninitialized)===null||i===void 0?void 0:i.call(this)})}registerCapabilities(e){
if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=GK(this._capabilities,e)}assertCapabilityForMethod(e){var n,r;switch(e){case"sampling/createMessage":if(!(!((n=this._clientCapabilities)===null||n===void 0)&&n.sampling))throw new Error(`Client does not support sampling (required for ${e})`);break;case"roots/list":if(!(!((r=this._clientCapabilities)===null||r===void 0)&&r.roots))throw new Error(`Client does not support listing roots\
 (required for ${e})`);break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(
`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(
`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools\
 (required for ${e})`);break}}async _oninitialize(e){const n=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:T6.includes(n)?n:iA,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.
request({method:"ping"},gb)}async createMessage(e,n){return this.request({method:"sampling/createMessage",params:e},EA,n)}async listRoots(e,n){return this.request({method:"roots/list",params:e},kA,n)}async sendLoggingMessage(e){return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_ch\
anged"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}const zK=Symbol("Let zodToJsonSchema decide on which parser to use"),Mx={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,
definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},WK=t=>typeof t=="string"?{...Mx,name:t}:{...Mx,...t},HK=t=>{const e=WK(t),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,i])=>[
i._def,{def:i._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function jx(t,e,n,r){r?.errorMessages&&n&&(t.errorMessage={...t.errorMessage,[e]:n})}function wt(t,e,n,r,i){t[e]=n,jx(t,e,r,i)}function VK(){return{}}function KK(t,e){const n={type:"array"};return t.type?._def&&t.type?._def?.typeName!==oe.ZodAny&&(n.items=gt(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&wt(n,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&wt(n,"maxItems",
t.maxLength.value,t.maxLength.message,e),t.exactLength&&(wt(n,"minItems",t.exactLength.value,t.exactLength.message,e),wt(n,"maxItems",t.exactLength.value,t.exactLength.message,e)),n}function ZK(t,e){const n={type:"integer",format:"int64"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?wt(n,"minimum",r.value,r.message,e):wt(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),wt(n,"minimum",r.value,r.message,e));
break;case"max":e.target==="jsonSchema7"?r.inclusive?wt(n,"maximum",r.value,r.message,e):wt(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),wt(n,"maximum",r.value,r.message,e));break;case"multipleOf":wt(n,"multipleOf",r.value,r.message,e);break}return n}function XK(){return{type:"boolean"}}function Bx(t,e){return gt(t.type._def,e)}const YK=(t,e)=>gt(t.innerType._def,e);function qx(t,e,n){const r=n??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((i,s)=>qx(t,
e,i))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return JK(t,e)}}const JK=(t,e)=>{const n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(const r of t.checks)switch(r.kind){case"min":wt(n,"minimum",r.value,r.message,e);break;case"max":wt(n,"maximum",r.value,r.message,e);break}return n};function QK(t,e){return{...gt(t.innerType._def,e),default:t.defaultValue()}}
function e7(t,e){return e.effectStrategy==="input"?gt(t.schema._def,e):{}}function t7(t){return{type:"string",enum:Array.from(t.values)}}const n7=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function r7(t,e){const n=[gt(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),gt(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(s=>!!s);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const i=[];return n.forEach(s=>{if(n7(s))i.push(...s.allOf),
s.unevaluatedProperties===void 0&&(r=void 0);else{let a=s;if("additionalProperties"in s&&s.additionalProperties===!1){const{additionalProperties:o,...u}=s;a=u}else r=void 0;i.push(a)}}),i.length?{allOf:i,...r}:void 0}function i7(t,e){const n=typeof t.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[t.value]}:{type:n==="bigint"?"integer":n,const:t.value}}let i0;const ni={cuid:/^[cC][^\s-]{8,}$/,
cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(i0===void 0&&(i0=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),i0),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,
ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,
base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Gx(t,e){const n={type:"string"};if(t.checks)for(const r of t.checks)switch(r.kind){case"min":wt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e);break;case"max":wt(n,"maxLength",typeof n.maxLength=="numbe\
r"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":ri(n,"email",r.message,e);break;case"format:idn-email":ri(n,"idn-email",r.message,e);break;case"pattern:zod":Zn(n,ni.email,r.message,e);break}break;case"url":ri(n,"uri",r.message,e);break;case"uuid":ri(n,"uuid",r.message,e);break;case"regex":Zn(n,r.regex,r.message,e);break;case"cuid":Zn(n,ni.cuid,r.message,e);break;case"cuid2":Zn(n,ni.cuid2,r.message,e);break;case"startsWith":Zn(n,RegExp(
`^${s0(r.value,e)}`),r.message,e);break;case"endsWith":Zn(n,RegExp(`${s0(r.value,e)}$`),r.message,e);break;case"datetime":ri(n,"date-time",r.message,e);break;case"date":ri(n,"date",r.message,e);break;case"time":ri(n,"time",r.message,e);break;case"duration":ri(n,"duration",r.message,e);break;case"length":wt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e),wt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"\
includes":{Zn(n,RegExp(s0(r.value,e)),r.message,e);break}case"ip":{r.version!=="v6"&&ri(n,"ipv4",r.message,e),r.version!=="v4"&&ri(n,"ipv6",r.message,e);break}case"base64url":Zn(n,ni.base64url,r.message,e);break;case"jwt":Zn(n,ni.jwt,r.message,e);break;case"cidr":{r.version!=="v6"&&Zn(n,ni.ipv4Cidr,r.message,e),r.version!=="v4"&&Zn(n,ni.ipv6Cidr,r.message,e);break}case"emoji":Zn(n,ni.emoji(),r.message,e);break;case"ulid":{Zn(n,ni.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"\
format:binary":{ri(n,"binary",r.message,e);break}case"contentEncoding:base64":{wt(n,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{Zn(n,ni.base64,r.message,e);break}}break}case"nanoid":Zn(n,ni.nanoid,r.message,e)}return n}function s0(t,e){return e.patternStrategy==="escape"?a7(t):t}const s7=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function a7(t){let e="";for(let n=0;n<t.length;n++)s7.has(t[n])||(e+="\\"),e+=t[n];return e}function ri(t,e,n,r){t.format||
t.anyOf?.some(i=>i.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&r.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...n&&r.errorMessages&&{errorMessage:{format:n}}})):wt(t,"format",e,n,r)}function Zn(t,e,n,r){t.pattern||t.allOf?.some(i=>i.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.
push({pattern:t.pattern,...t.errorMessage&&r.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:Ux(e,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):wt(t,"pattern",Ux(e,r),n,r)}function Ux(t,e){if(!e.applyRegexFlags||!t.flags)return t.source;const n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},r=n.
i?t.source.toLowerCase():t.source;let i="",s=!1,a=!1,o=!1;for(let u=0;u<r.length;u++){if(s){i+=r[u],s=!1;continue}if(n.i){if(a){if(r[u].match(/[a-z]/)){o?(i+=r[u],i+=`${r[u-2]}-${r[u]}`.toUpperCase(),o=!1):r[u+1]==="-"&&r[u+2]?.match(/[a-z]/)?(i+=r[u],o=!0):i+=`${r[u]}${r[u].toUpperCase()}`;continue}}else if(r[u].match(/[a-z]/)){i+=`[${r[u]}${r[u].toUpperCase()}]`;continue}}if(n.m){if(r[u]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(r[u]==="$"){i+=`($|(?=[\r
]))`;continue}}if(n.s&&r[u]==="."){i+=a?`${r[u]}\r
`:`[${r[u]}\r
]`;continue}i+=r[u],r[u]==="\\"?s=!0:a&&r[u]==="]"?a=!1:!a&&r[u]==="["&&(a=!0)}try{new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return i}function zx(t,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&t.keyType?._def.typeName===oe.ZodEnum)return{type:"o\
bject",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((r,i)=>({...r,[i]:gt(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",i]})??{}}),{}),additionalProperties:e.rejectedAdditionalProperties};const n={type:"object",additionalProperties:gt(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return n;if(t.keyType?._def.typeName===oe.ZodString&&t.keyType._def.checks?.length){
const{type:r,...i}=Gx(t.keyType._def,e);return{...n,propertyNames:i}}else{if(t.keyType?._def.typeName===oe.ZodEnum)return{...n,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===oe.ZodBranded&&t.keyType._def.type._def.typeName===oe.ZodString&&t.keyType._def.type._def.checks?.length){const{type:r,...i}=Bx(t.keyType._def,e);return{...n,propertyNames:i}}}return n}function o7(t,e){if(e.mapStrategy==="record")return zx(t,e);const n=gt(t.keyType._def,{...e,currentPath:[...e.currentPath,
"items","items","0"]})||{},r=gt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function u7(t){const e=t.values,r=Object.keys(t.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),i=Array.from(new Set(r.map(s=>typeof s)));return{type:i.length===1?i[0]==="string"?"string":"number":["string","number"],enum:r}}function c7(){return{not:{}}}function l7(t){return t.target==="op\
enApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const yg={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function d7(t,e){if(e.target==="openApi3")return Wx(t,e);const n=t.options instanceof Map?Array.from(t.options.values()):t.options;if(n.every(r=>r._def.typeName in yg&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((i,s)=>{const a=yg[s._def.typeName];return a&&!i.includes(a)?[...i,a]:i},[]);return{type:r.length>1?r:r[0]}}else if(n.
every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((i,s)=>{const a=typeof s._def.value;switch(a){case"string":case"number":case"boolean":return[...i,a];case"bigint":return[...i,"integer"];case"object":if(s._def.value===null)return[...i,"null"];case"symbol":case"undefined":case"function":default:return i}},[]);if(r.length===n.length){const i=r.filter((s,a,o)=>o.indexOf(s)===a);return{type:i.length>1?i:i[0],enum:n.reduce((s,a)=>s.includes(a._def.value)?s:[...s,a._def.value],
[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,i)=>[...r,...i._def.values.filter(s=>!r.includes(s))],[])};return Wx(t,e)}const Wx=(t,e)=>{const n=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((r,i)=>gt(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${i}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function f7(t,e){if(["ZodString","ZodNumber","ZodBig\
Int","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:yg[t.innerType._def.typeName],nullable:!0}:{type:[yg[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=gt(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=gt(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return n&&{
anyOf:[n,{type:"null"}]}}function h7(t,e){const n={type:"number"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"int":n.type="integer",jx(n,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?wt(n,"minimum",r.value,r.message,e):wt(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),wt(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?wt(n,"maximum",r.value,r.message,e):wt(n,"exclusiveMaximum",
r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),wt(n,"maximum",r.value,r.message,e));break;case"multipleOf":wt(n,"multipleOf",r.value,r.message,e);break}return n}function p7(t,e){const n=e.target==="openAi",r={type:"object",properties:{}},i=[],s=t.shape();for(const o in s){let u=s[o];if(u===void 0||u._def===void 0)continue;let c=g7(u);c&&n&&(u instanceof Xr&&(u=u._def.innerType),u.isNullable()||(u=u.nullable()),c=!1);const l=gt(u._def,{...e,currentPath:[...e.currentPath,"properties",o],
propertyPath:[...e.currentPath,"properties",o]});l!==void 0&&(r.properties[o]=l,c||i.push(o))}i.length&&(r.required=i);const a=m7(t,e);return a!==void 0&&(r.additionalProperties=a),r}function m7(t,e){if(t.catchall._def.typeName!=="ZodNever")return gt(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy===
"strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function g7(t){try{return t.isOptional()}catch{return!0}}const y7=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return gt(t.innerType._def,e);const n=gt(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},v7=(t,e)=>{if(e.pipeStrategy==="input")return gt(t.in._def,e);if(e.pipeStrategy==="output")return gt(t.out._def,e);const n=gt(t.in._def,{...e,currentPath:[
...e.currentPath,"allOf","0"]}),r=gt(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(i=>i!==void 0)}};function w7(t,e){return gt(t.type._def,e)}function b7(t,e){const r={type:"array",uniqueItems:!0,items:gt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&wt(r,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&wt(r,"maxItems",t.maxSize.value,t.maxSize.message,e),r}function E7(t,e){return t.rest?{type:"array",
minItems:t.items.length,items:t.items.map((n,r)=>gt(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:gt(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((n,r)=>gt(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function k7(){return{not:{}}}function R7(){return{}}const $7=(t,e)=>gt(
t.innerType._def,e),D7=(t,e,n)=>{switch(e){case oe.ZodString:return Gx(t,n);case oe.ZodNumber:return h7(t,n);case oe.ZodObject:return p7(t,n);case oe.ZodBigInt:return ZK(t,n);case oe.ZodBoolean:return XK();case oe.ZodDate:return qx(t,n);case oe.ZodUndefined:return k7();case oe.ZodNull:return l7(n);case oe.ZodArray:return KK(t,n);case oe.ZodUnion:case oe.ZodDiscriminatedUnion:return d7(t,n);case oe.ZodIntersection:return r7(t,n);case oe.ZodTuple:return E7(t,n);case oe.ZodRecord:return zx(t,n);case oe.
ZodLiteral:return i7(t,n);case oe.ZodEnum:return t7(t);case oe.ZodNativeEnum:return u7(t);case oe.ZodNullable:return f7(t,n);case oe.ZodOptional:return y7(t,n);case oe.ZodMap:return o7(t,n);case oe.ZodSet:return b7(t,n);case oe.ZodLazy:return()=>t.getter()._def;case oe.ZodPromise:return w7(t,n);case oe.ZodNaN:case oe.ZodNever:return c7();case oe.ZodEffects:return e7(t,n);case oe.ZodAny:return VK();case oe.ZodUnknown:return R7();case oe.ZodDefault:return QK(t,n);case oe.ZodBranded:return Bx(t,n);case oe.
ZodReadonly:return $7(t,n);case oe.ZodCatch:return YK(t,n);case oe.ZodPipeline:return v7(t,n);case oe.ZodFunction:case oe.ZodVoid:case oe.ZodSymbol:return;default:return(r=>{})()}};function gt(t,e,n=!1){const r=e.seen.get(t);if(e.override){const o=e.override?.(t,e,r,n);if(o!==zK)return o}if(r&&!n){const o=T7(r,e);if(o!==void 0)return o}const i={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,i);const s=D7(t,t.typeName,e),a=typeof s=="function"?gt(s(),e):s;if(a&&C7(t,e,a),e.postProcess){
const o=e.postProcess(a,t,e);return i.jsonSchema=a,o}return i.jsonSchema=a,a}const T7=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:S7(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,r)=>e.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},S7=(t,e)=>{let n=0;for(;n<t.length&&n<e.length&&
t[n]===e[n];n++);return[(t.length-n).toString(),...e.slice(n)].join("/")},C7=(t,e,n)=>(t.description&&(n.description=t.description,e.markdownDescription&&(n.markdownDescription=t.description)),n),_7=(t,e)=>{const n=HK(e),r=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((u,[c,l])=>({...u,[c]:gt(l._def,{...n,currentPath:[...n.basePath,n.definitionPath,c]},!0)??{}}),{}):void 0,i=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,s=gt(t._def,i===void 0?n:{...n,currentPath:[
...n.basePath,n.definitionPath,i]},!1)??{},a=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;a!==void 0&&(s.title=a);const o=i===void 0?r?{...s,[n.definitionPath]:r}:s:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,i].join("/"),[n.definitionPath]:{...r,[i]:s}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/\
schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var a0;(function(t){t.Completable="McpCompletable"})(a0||(a0={}));class o0 extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}o0.create=(t,e)=>new o0({type:t,typeName:a0.
Completable,complete:e.complete,...A7(e)});function A7(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:i}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,o)=>{var u,c;const{message:l}=t;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:(u=l??r)!==null&&u!==void 0?u:o.defaultError}:a.code!=="inval\
id_type"?{message:o.defaultError}:{message:(c=l??n)!==null&&c!==void 0?c:o.defaultError}},description:i}}class x7{constructor(e,n){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new UK(e,n)}async connect(e){return await this.server.connect(e)}async close(){await this.server.
close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(Db.shape.method.value),this.server.assertCanSetRequestHandler(Tb.shape.method.value),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(Db,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,n])=>({name:e,description:n.description,inputSchema:n.inputSchema?_7(n.inputSchema,{strictUnions:!0}):P7}))})),this.server.setRequestHandler(
Tb,async(e,n)=>{const r=this._registeredTools[e.params.name];if(!r)throw new An(un.InvalidParams,`Tool ${e.params.name} not found`);if(!r.enabled)throw new An(un.InvalidParams,`Tool ${e.params.name} disabled`);if(r.inputSchema){const i=await r.inputSchema.safeParseAsync(e.params.arguments);if(!i.success)throw new An(un.InvalidParams,`Invalid arguments for tool ${e.params.name}: ${i.error.message}`);const s=i.data,a=r.callback;try{return await Promise.resolve(a(s,n))}catch(o){return{content:[{type:"\
text",text:o instanceof Error?o.message:String(o)}],isError:!0}}}else{const i=r.callback;try{return await Promise.resolve(i(n))}catch(s){return{content:[{type:"text",text:s instanceof Error?s.message:String(s)}],isError:!0}}}}),this._toolHandlersInitialized=!0)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(Sb.shape.method.value),this.server.setRequestHandler(Sb,async e=>{switch(e.params.ref.type){case"ref/prompt":return this.handlePromptCompletion(
e,e.params.ref);case"ref/resource":return this.handleResourceCompletion(e,e.params.ref);default:throw new An(un.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,n){const r=this._registeredPrompts[n.name];if(!r)throw new An(un.InvalidParams,`Prompt ${n.name} not found`);if(!r.enabled)throw new An(un.InvalidParams,`Prompt ${n.name} disabled`);if(!r.argsSchema)return vg;const i=r.argsSchema.shape[e.params.argument.
name];if(!(i instanceof o0))return vg;const a=await i._def.complete(e.params.argument.value);return Hx(a)}async handleResourceCompletion(e,n){const r=Object.values(this._registeredResourceTemplates).find(a=>a.resourceTemplate.uriTemplate.toString()===n.uri);if(!r){if(this._registeredResources[n.uri])return vg;throw new An(un.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}const i=r.resourceTemplate.completeCallback(e.params.argument.name);if(!i)return vg;const s=await i(e.params.
argument.value);return Hx(s)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(bb.shape.method.value),this.server.assertCanSetRequestHandler(Eb.shape.method.value),this.server.assertCanSetRequestHandler(kb.shape.method.value),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(bb,async(e,n)=>{const r=Object.entries(this._registeredResources).filter(([s,a])=>a.enabled).map(([s,a])=>({uri:s,name:a.name,...a.
metadata})),i=[];for(const s of Object.values(this._registeredResourceTemplates)){if(!s.resourceTemplate.listCallback)continue;const a=await s.resourceTemplate.listCallback(n);for(const o of a.resources)i.push({...o,...s.metadata})}return{resources:[...r,...i]}}),this.server.setRequestHandler(Eb,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([n,r])=>({name:n,uriTemplate:r.resourceTemplate.uriTemplate.toString(),...r.metadata}))})),this.server.setRequestHandler(
kb,async(e,n)=>{const r=new URL(e.params.uri),i=this._registeredResources[r.toString()];if(i){if(!i.enabled)throw new An(un.InvalidParams,`Resource ${r} disabled`);return i.readCallback(r,n)}for(const s of Object.values(this._registeredResourceTemplates)){const a=s.resourceTemplate.uriTemplate.match(r.toString());if(a)return s.readCallback(r,a,n)}throw new An(un.InvalidParams,`Resource ${r} not found`)}),this.setCompletionRequestHandler(),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){
this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Rb.shape.method.value),this.server.assertCanSetRequestHandler($b.shape.method.value),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(Rb,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,n])=>({name:e,description:n.description,arguments:n.argsSchema?N7(n.argsSchema):void 0}))})),this.server.setRequestHandler($b,async(e,n)=>{const r=this._registeredPrompts[e.
params.name];if(!r)throw new An(un.InvalidParams,`Prompt ${e.params.name} not found`);if(!r.enabled)throw new An(un.InvalidParams,`Prompt ${e.params.name} disabled`);if(r.argsSchema){const i=await r.argsSchema.safeParseAsync(e.params.arguments);if(!i.success)throw new An(un.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${i.error.message}`);const s=i.data,a=r.callback;return await Promise.resolve(a(s,n))}else{const i=r.callback;return await Promise.resolve(i(n))}}),this.setCompletionRequestHandler(),
this._promptHandlersInitialized=!0)}resource(e,n,...r){let i;typeof r[0]=="object"&&(i=r.shift());const s=r[0];if(typeof n=="string"){if(this._registeredResources[n])throw new Error(`Resource ${n} is already registered`);const a={name:e,metadata:i,readCallback:s,enabled:!0,disable:()=>a.update({enabled:!1}),enable:()=>a.update({enabled:!0}),remove:()=>a.update({uri:null}),update:o=>{typeof o.uri<"u"&&o.uri!==n&&(delete this._registeredResources[n],o.uri&&(this._registeredResources[o.uri]=a)),typeof o.
name<"u"&&(a.name=o.name),typeof o.metadata<"u"&&(a.metadata=o.metadata),typeof o.callback<"u"&&(a.readCallback=o.callback),typeof o.enabled<"u"&&(a.enabled=o.enabled),this.sendResourceListChanged()}};return this._registeredResources[n]=a,this.setResourceRequestHandlers(),this.sendResourceListChanged(),a}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);const a={resourceTemplate:n,metadata:i,readCallback:s,enabled:!0,disable:()=>a.update(
{enabled:!1}),enable:()=>a.update({enabled:!0}),remove:()=>a.update({name:null}),update:o=>{typeof o.name<"u"&&o.name!==e&&(delete this._registeredResourceTemplates[e],o.name&&(this._registeredResourceTemplates[o.name]=a)),typeof o.template<"u"&&(a.resourceTemplate=o.template),typeof o.metadata<"u"&&(a.metadata=o.metadata),typeof o.callback<"u"&&(a.readCallback=o.callback),typeof o.enabled<"u"&&(a.enabled=o.enabled),this.sendResourceListChanged()}};return this._registeredResourceTemplates[e]=a,this.
setResourceRequestHandlers(),this.sendResourceListChanged(),a}}tool(e,...n){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let r;typeof n[0]=="string"&&(r=n.shift());let i;n.length>1&&(i=n.shift());const s=n[0],a={description:r,inputSchema:i===void 0?void 0:C.object(i),callback:s,enabled:!0,disable:()=>a.update({enabled:!1}),enable:()=>a.update({enabled:!0}),remove:()=>a.update({name:null}),update:o=>{typeof o.name<"u"&&o.name!==e&&(delete this._registeredTools[e],
o.name&&(this._registeredTools[o.name]=a)),typeof o.description<"u"&&(a.description=o.description),typeof o.paramsSchema<"u"&&(a.inputSchema=C.object(o.paramsSchema)),typeof o.callback<"u"&&(a.callback=o.callback),typeof o.enabled<"u"&&(a.enabled=o.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=a,this.setToolRequestHandlers(),this.sendToolListChanged(),a}prompt(e,...n){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let r;typeof n[0]=="st\
ring"&&(r=n.shift());let i;n.length>1&&(i=n.shift());const s=n[0],a={description:r,argsSchema:i===void 0?void 0:C.object(i),callback:s,enabled:!0,disable:()=>a.update({enabled:!1}),enable:()=>a.update({enabled:!0}),remove:()=>a.update({name:null}),update:o=>{typeof o.name<"u"&&o.name!==e&&(delete this._registeredPrompts[e],o.name&&(this._registeredPrompts[o.name]=a)),typeof o.description<"u"&&(a.description=o.description),typeof o.argsSchema<"u"&&(a.argsSchema=C.object(o.argsSchema)),typeof o.callback<
"u"&&(a.callback=o.callback),typeof o.enabled<"u"&&(a.enabled=o.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=a,this.setPromptRequestHandlers(),this.sendPromptListChanged(),a}isConnected(){return this.server.transport!==void 0}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}}const P7={
type:"object"};function N7(t){return Object.entries(t.shape).map(([e,n])=>({name:e,description:n.description,required:!n.isOptional()}))}function Hx(t){return{completion:{values:t.slice(0,100),total:t.length,hasMore:t.length>100}}}const vg={completion:{values:[],hasMore:!1}},I7="1.30.0",O7={version:I7};var u0,Vx;function L7(){return Vx||(Vx=1,u0=t=>{const e=t.match(/^[ \t]*(?=\S)/gm);return e?e.reduce((n,r)=>Math.min(n,r.length),1/0):0}),u0}var F7=L7();const M7=fi(F7);function Su(t){const e=M7(t);
if(e===0)return t;const n=new RegExp(`^[ \\t]{${e}}`,"gm");return t.replace(n,"")}const uo=["this","it","self","super","likec4lib","global"];function kt(t){return async function(e,n,r){try{const i=t(e,n,r);EU(i)&&await i;return}catch(i){const s=i instanceof Error?i.message:String(i);n("error",`Validation failed: ${s}`,{node:e}),lt.debug(`Validation failed: ${s}`,{error:i})}}}const{getDocument:j7}=Eo,B7=t=>{const e=t.likec4.DeploymentsIndex,n=t.references.NameProvider;return kt((r,i)=>{const s=n.
getName(r);if(!s){i("error","DeploymentNode must be named",{node:r});return}const a=Vt(n.getNameNode(r),"name CstNode not found").range;uo.includes(s)&&i("error",`Reserved word: ${s}`,{node:r,range:a});const o=rn(r),u=e.getFqn(r);e.byFqn(o,u).limit(2).toArray().length>1&&i("error",`Duplicate node name "${u}"`,{node:r,range:a})})},q7=t=>{const e=t.likec4.DeploymentsIndex,n=t.references.NameProvider;return kt((r,i)=>{const s=n.getName(r);if(!s){i("error","Deployed instance must be named, unique in\
side node",{node:r});return}const a=Vt(n.getNameNode(r),"name CstNode not found").range;uo.includes(s)&&i("error",`Reserved word: ${s}`,{node:r,range:a});const o=rn(r),u=e.getFqn(r);e.byFqn(o,u).limit(2).toArray().length>1&&i("error",`Duplicate instance name "${u}"`,{node:r,range:a})})},G7=t=>{const e=t.likec4.ModelParser;return kt((n,r)=>{if(!n.target?.value?.ref){let u=n.target?.$cstNode?.text??"";r("error",`DeploymentRelation target '${u}' not resolved`,{node:n,property:"target"});return}const i=j7(
n),s=e.forDocument(i);let a;try{a=s._resolveDeploymentRelationSource(n)}catch{r("error","DeploymentRelation source not resolved",{node:n,property:"source"});return}if(Ln.isImportRef(a)){r("error","DeploymentRelation cannot refer imported model (not implemented yet)",{node:n,property:"source"});return}if(Ln.isModelRef(a)){r("error","DeploymentRelation must refer deployment element",{node:n,property:"source"});return}const o=s.parseFqnRef(n.target);if(Ln.isImportRef(o)){r("error","DeploymentRelati\
on cannot refer imported model (not implemented yet)",{node:n,property:"target"});return}if(Ln.isModelRef(o)){r("error","DeploymentRelation must refer deployment element",{node:n,property:"target"});return}x0(a.deployment,o.deployment)&&r("error","Invalid parent-child relationship",{node:n})})},U7=t=>kt((e,n)=>{const r=e.deploymentNode.value.ref;(!r||!ar(r))&&n("error","ExtendDeployment allows only DeploymentNode",{node:e,property:"deploymentNode"})}),z7=t=>{const e=t.likec4.FqnIndex;return kt((n,r)=>{
const i=ao(n.source),s=i&&e.getFqn(i);s||r("error","Source not found (not parsed/indexed yet)",{node:n,property:"source"});const a=ao(n.target),o=a&&e.getFqn(a);o||r("error","Target not found (not parsed/indexed yet)",{node:n,property:"target"}),s&&o&&(Dg(s,o)||Dg(o,s))&&r("error","Invalid parent-child relationship",{node:n})})},{getDocument:W7}=Eo,H7=t=>{const e=t.likec4.FqnIndex,n=t.workspace.AstNodeLocator;return kt((r,i)=>{const s=e.getFqn(r);if(!s){i("error","Not indexed element",{node:r,property:"\
name"});return}uo.includes(r.name)&&i("error",`Reserved word: ${r.name}`,{node:r,property:"name"});const a=W7(r),o=a.uri,u=n.getAstNodePath(r),c=e.byFqn(rn(a),s).filter(l=>l.documentUri!==o||l.path!==u).head();if(c){const l=c.documentUri!==o;i("error",`Duplicate element name ${r.name!==s?r.name+" ("+s+")":r.name}`,{node:r,property:"name",...l&&{relatedInformation:[{location:{range:c.nameSegment?.range??c.selectionSegment?.range,uri:c.documentUri.toString()},message:"conflicting element"}]}})}})},
V7=t=>kt((e,n)=>{PK(e.modelElement)&&n("error","Only model elements allowed here",{node:e,property:"modelElement"})}),{getDocument:K7}=Eo,Z7=t=>{const e=t.shared.workspace.ProjectsManager;return kt((n,r)=>{const i=K7(n),s=rn(i);if(n.project===s){r("error","Imported project cannot be the same as the current project",{node:n,property:"project"});return}if(!e.all.includes(n.project)){r("error","Imported project not found",{node:n,property:"project"});return}})},X7=t=>(t.likec4.FqnIndex,kt((e,n)=>{})),
Y7=t=>kt((e,n)=>{const r=parseFloat(e.value);(isNaN(r)||r<0||r>100)&&n("warning","Value ignored, must be between 0% and 100%",{node:e,property:"value"})}),J7=t=>(e,n)=>{const r=e.$container;r.props.some(i=>Ns(i)&&i!==e)&&n("error","Icon must be defined once",{node:e}),Zo(r)&&sm(r.$container)&&r.$container.props.some(i=>Ns(i))&&n("warning","Redundant as icon defined on element",{node:e}),e.value?.startsWith("file://")&&n("error","Icon URI must not start with file://",{node:e,property:"value"})},Q7=t=>(e,n)=>{
mi(e,Aw)||n("error","Notes can be defined only inside dynamic view",{node:e})},eZ=t=>{const e=t.likec4.ModelParser;return kt((n,r)=>{const i=e.forDocument(vt(n)),s=Lx(()=>i._resolveRelationSource(n));if(!s){r("error","Source not resolved",{node:n,property:"source"});return}const a=Lx(()=>i.parseFqnRef(n.target));if(!a){r("error","Target not resolved",{node:n,property:"target"});return}Ln.isImportRef(s)&&(Ln.isImportRef(a)?r("warning","Relationship between imported elements may not be visible in \
origin projects",{node:n}):r("warning","Relationship from imported element to local element may not be visible in origin project",{node:n,property:"source"})),x0(Ln.toModelFqn(s),Ln.toModelFqn(a))&&r("error","Invalid parent-child relationship",{node:n})})},tZ=t=>kt((e,n)=>{e.$container.tags?.values&&e.tags?.values&&n("error","Relation cannot have tags in both header and body",{node:e.tags})}),nZ=t=>kt((e,n)=>{e.$containerIndex&&e.$containerIndex>0&&n("warning","Prefer one specification per docum\
ent",{node:e,property:"name"})}),rZ=t=>kt((e,n)=>{e.$containerIndex&&e.$containerIndex>0&&n("warning","Prefer one model per document",{node:e,property:"name"})}),iZ=t=>kt((e,n)=>{e.$containerIndex&&e.$containerIndex>0&&n("warning","Prefer one global block per document",{node:e,property:"name"})}),sZ=t=>{const e=t.shared.workspace.IndexManager;return kt((n,r)=>{uo.includes(n.name)&&r("error",`Reserved word: ${n.name}`,{node:n,property:"name"});const i=rn(n),s=e.projectElements(i,is).filter(a=>a.name===
n.name&&a.node!==n).head();if(s){const a=s.documentUri!==vt(n).uri;r("error",`Duplicate element kind '${n.name}'`,{node:n,property:"name",...a&&{relatedInformation:[{location:{range:s.nameSegment.range,uri:s.documentUri.toString()},message:"conflicting definition"}]}})}})},aZ=t=>{const e=t.shared.workspace.IndexManager;return kt((n,r)=>{uo.includes(n.name)&&r("error",`Reserved word: ${n.name}`,{node:n,property:"name"});const i=rn(n),s=e.projectElements(i,rs).filter(a=>a.name===n.name&&a.node!==n).
head();if(s){const a=s.documentUri!==vt(n).uri;r("error",`Duplicate deploymentNode kind '${n.name}'`,{node:n,property:"name",...a&&{relatedInformation:[{location:{range:s.nameSegment.range,uri:s.documentUri.toString()},message:"conflicting definition"}]}})}})},oZ=t=>{const e=t.shared.workspace.IndexManager;return kt((n,r)=>{const i="#"+n.name,s=rn(n),a=e.projectElements(s,Ls).filter(o=>o.name===i&&o.node!==n).head();if(a){const o=a.documentUri!==vt(n).uri;r("error",`Duplicate tag '${n.name}'`,{node:n,
property:"name",...o&&{relatedInformation:[{location:{range:a.nameSegment.range,uri:a.documentUri.toString()},message:"conflicting definition"}]}})}})},uZ=t=>{const e=t.shared.workspace.IndexManager;return kt((n,r)=>{uo.includes(n.name)&&r("error",`Reserved word: ${n.name}`,{node:n,property:"name"});const i=rn(n);e.projectElements(i,Os).filter(s=>s.name===n.name).limit(2).count()>1&&r("error",`Duplicate RelationshipKind '${n.name}'`,{node:n,property:"name"})})},Kx=t=>{const e=t.shared.workspace.
IndexManager;return kt((n,r)=>{const i=rn(n),s=e.projectElements(i,Qo),a=e.projectElements(i,Jo);s.concat(a).filter(o=>o.name===n.name).limit(2).count()>1&&r("error",`Duplicate GlobalPredicateGroup or GlobalDynamicPredicateGroup name '${n.name}'`,{node:n,property:"name"})})},cZ=t=>{const e=t.shared.workspace.IndexManager;return kt((n,r)=>{const i=rn(n);e.projectElements(i,cd).filter(s=>s.name===n.name).limit(2).count()>1&&r("error",`Duplicate GlobalStyleId name '${n.name}'`,{node:n,property:"nam\
e"})})},lZ=t=>{const e=t.shared.workspace.IndexManager;return kt((n,r)=>{if(!n.name)return;uo.includes(n.name)&&r("error",`Reserved word: ${n.name}`,{node:n,property:"name"});const i=rn(n);e.projectElements(i,za).filter(s=>s.name===n.name).limit(2).count()>1&&r("error",`Duplicate view '${n.name}'`,{node:n,property:"name"})})},dZ=t=>{const e=t.likec4.ModelParser;return kt((n,r)=>{const i=gg(n);if(i?.$type!=="DynamicViewIncludePredicate"&&i?.isInclude!==!0){r("error",'Invalid usage inside "exclude\
"',{node:n});return}const s=i.$type==="DynamicViewIncludePredicate",a=e.forDocument(vt(i));let o=vn.unwrap(a.parseFqnExprWith(n).custom.expr);switch(!0){case(vn.isWildcard(o)&&s):case(vn.isElementKindExpr(o)&&s):case(vn.isElementTagExpr(o)&&s):{r("warning","Predicate is ignored, as not supported in dynamic views",{node:n});return}case vn.isWildcard(o):case vn.isModelRef(o):case vn.isDeploymentRef(o):return;case vn.isElementKindExpr(o):case vn.isElementTagExpr(o):r("error","Invalid target (expect\
 reference to specific element)",{node:n,property:"subject"});return;default:Ke(o)}})},fZ=t=>{const e=t.likec4.ModelParser;return kt((n,r)=>{const i=e.forDocument(vt(n)).parseFqnRefExpr(n),s=gg(n),a=vK(n)&&!mi(n,o=>Kl(o)||pu(o));if(s?.$type==="DeploymentViewRulePredicate"||a){if(!mi(n,jp)){if(vn.isModelRef(i)){r("error","Deployment view predicate must reference deployment model",{node:n});return}if(vn.isDeploymentRef(i)&&Ln.isInsideInstanceRef(i.ref)){r("error","Must reference deployment nodes o\
r instances, but not internals",{node:n});return}}fe(n.selector)&&!ar(n.ref.value?.ref)&&r("warning",`Selector '${n.selector}' applies to deployment nodes only, ignored here`,{node:n,property:"selector"});return}if(s?.$type==="DynamicViewIncludePredicate")switch(!0){case vn.isElementKindExpr(i):case vn.isElementTagExpr(i):case vn.isWildcard(i):{r("warning","Predicate is ignored, as not supported in dynamic views",{node:n});return}}})},hZ=t=>kt((e,n)=>{if(e.to.$type==="WildcardExpression"&&!o_(e.
$container)){const r=cr(e,om);Ft(r?.viewOf)&&n("warning","Predicate is ignored as it concerns all relationships",{node:e})}}),pZ=t=>kt((e,n)=>{if(gg(e)?.$type==="ViewRulePredicate"&&e.$container.$type!=="DirectedRelationExpr"&&e.from.$type==="WildcardExpression"){const r=cr(e,om);r&&Ft(r.viewOf)&&n("warning","Predicate is ignored as it concerns all relationships",{node:e})}}),mZ=t=>{const e=t.likec4.ModelParser;return kt((n,r)=>{const i=cr(n,Vo);if(!i||i.isInclude!==!0)return;const s=vt(n),a=e.forDocument(
s);let o=Hf.unwrap(a.parseRelationExpr(n));const u="Model reference is allowed in exclude predicate only";if(Hf.isDirect(o)){(vn.isModelRef(o.source)||vn.isModelRef(o.target))&&r("error",u,{node:n});return}let c;if(Hf.isIncoming(o)?c=o.incoming:Hf.isOutgoing(o)?c=o.outgoing:c=o.inout,vn.isModelRef(c)){r("error",u,{node:n});return}})},gZ=t=>kt((e,n)=>{const r=gg(e);if(!(!r||r.$type=="DynamicViewIncludePredicate")&&!r.isInclude){n("error",'Invalid usage inside "exclude"',{node:e});return}});function yZ(t){
return e=>t.some(n=>n(e))}const vZ=yZ([Mw,ss,Fw,ud,od,tu,Za,hm,Gw,BC,jp,Cw,Aw,Vz,Vo,Zz,jp,Lw,Qz,Dw,Hw,eW,vw,kw,Tw,yr,ar,Ri,UC,Ps,os,Kz,zC,km,_n,xw,Yo,Va,cu,du,ou,Am,_m,p_]),wZ=t=>{let e=t;for(;e&&!u_(e);){if(vZ(e))return e;e=e.$container}};function bZ(t){const e=t.state>=Ze.Validated?t.diagnostics?.filter(r=>r.severity===wa.Error)??[]:[],n=new WeakSet;for(const{node:r}of e){if(Ft(r)||n.has(r))continue;n.add(r);const i=wZ(r);i&&n.add(i)}return{isValid:r=>!n.has(r),invalidNodes:n}}function EZ(t){lt.
debug("registerValidationChecks"),t.validation.ValidationRegistry.register({DeployedInstance:q7(t),DeploymentNodeKind:aZ(t),DeploymentNode:B7(t),DeploymentRelation:G7(t),ExtendDeployment:U7(),FqnRefExpr:fZ(t),RelationExpr:mZ(t),NotesProperty:Q7(),OpacityProperty:Y7(),IconProperty:J7(),SpecificationRule:nZ(),Model:rZ(),Globals:iZ(),GlobalPredicateGroup:Kx(t),GlobalDynamicPredicateGroup:Kx(t),GlobalStyleId:cZ(t),DynamicViewStep:z7(t),LikeC4View:lZ(t),Element:H7(t),ElementRef:V7(),ElementKind:sZ(t),
Relation:eZ(t),RelationBody:tZ(),Tag:oZ(t),FqnExprWith:dZ(t),RelationExprWith:gZ(),RelationshipKind:uZ(t),IncomingRelationExpr:hZ(),OutgoingRelationExpr:pZ(),ImportsFromPoject:Z7(t),Imported:X7(t)});const e=t.shared.lsp.Connection;e&&t.shared.workspace.DocumentBuilder.onUpdate((n,r)=>{for(const i of r)lt.debug(`clear diagnostics for deleted ${i.path}`),e.sendDiagnostics({uri:i.toString(),diagnostics:[]})})}function ii(t){return Un(t)?St(t).split(`
`).join(" "):void 0}function St(t){return Un(t)?Su(t).trim():void 0}class kZ{constructor(e,n){this.services=e,this.doc=n,this.isValid=bZ(n).isValid}isValid;get project(){return this.services.shared.workspace.ProjectsManager.getProject(this.doc)}resolveFqn(e){if(ss(e)){const n=rn(e),r=this.resolveFqn(Vt(e.imported.ref,`FqnRef is empty of imported: ${e.$cstNode?.text}`));return this.doc.c4Imports.set(n,r),E1(n,r)}return Yo(e)?oo(e.element):Va(e)?oo(e.deploymentNode):Pp(e)?this.services.likec4.DeploymentsIndex.
getFqn(e):this.services.likec4.FqnIndex.getFqn(e)}getAstNodePath(e){return this.services.workspace.AstNodeLocator.getAstNodePath(e)}getMetadata(e){if(!e||!this.isValid(e)||tn(e.props))return;const n=et(e.props,Ht(r=>[r.key,St(r.value)]),Qe(([r,i])=>fe(i)),OU());return tn(n)?void 0:n}convertTags(e){return this.parseTags(e)}parseTags(e){let n=e?.tags;if(!n)return null;let r=[];for(;n;){try{if(this.isValid(n)){const i=n.values.map(s=>s.ref?.name).filter(fe);i.length>0&&r.push(...i)}}catch{}n=n.prev}
return r=jo(r.reverse()),ur(r)?r:null}convertLinks(e){return this.parseLinks(e)}parseLinks(e){if(!(!e?.props||e.props.length===0))return et(e.props,Qe(bm),Wr(n=>{if(!this.isValid(n))return[];const r=n.value;if(fe(r)){const i=fe(n.title)?ii(n.title):void 0,s=this.services.lsp.DocumentLinkProvider.relativeLink(this.doc,r);return{url:r,...i&&{title:i},...s&&s!==r&&{relative:s}}}return[]}))}parseIconProperty(e){if(!e||!this.isValid(e))return;const{libicon:n,value:r}=e;switch(!0){case!!n:return n.ref?.
name;case(r&&r==="none"):return r;case(r&&Fs(r)):return r.startsWith("file:")?void 0:r;case(r&&Qw(r)):return Om(this.doc.uri.toString(),"../",r);case(r&&sf(r)):return P_(this.project.folder.toString(),r);default:return}}parseElementStyle(e){if(!e)return{};if($T(e)){const n=this.parseStyleProps(e?.find(Zo)?.props),r=this.parseIconProperty(e?.find(Ns));return r&&(n.icon=r),n}return this.parseStyleProps(e.props)}parseStyleProps(e){const n={};if(!e||e.length===0)return n;for(const r of e)if(this.isValid(
r))switch(!0){case Vp(r):{fe(r.value)&&(n.border=r.value);break}case Wa(r):{const i=Nf(r);fe(i)&&(n.color=i);break}case Sm(r):{fe(r.value)&&(n.shape=r.value);break}case Ns(r):{const i=this.parseIconProperty(r);fe(i)&&(n.icon=i);break}case Rm(r):{n.opacity=Ix(r);break}case jw(r):{n.multiple=Zv(r.value)?r.value:!1;break}case Uw(r):{fe(r.value)&&(n.size=Tu(r));break}case Bw(r):{fe(r.value)&&(n.padding=Tu(r));break}case Vw(r):{fe(r.value)&&(n.textSize=Tu(r));break}default:Ke(r)}return n}}function RZ(t,e,n){
return{id:e.id,parent:e.parent?{id:e.parent.id,title:e.parent.title,kind:e.parent.kind}:null,projectId:n,title:e.title,kind:e.kind,shape:e.shape,technology:e.technology,description:e.description,tags:e.tags,children:Ou(Lu(e.children(),r=>({id:r.id,title:r.title,kind:e.kind}))),relations:{incoming:Ou(Lu(e.incoming(),r=>({id:r.id,title:r.title,description:r.description,technology:r.technology,source:{id:r.source.id,title:r.source.title,kind:r.source.kind},...r.target.id===e.id?{type:"direct"}:{type:"\
implicit, to nested",target:{id:r.target.id,title:r.target.title,kind:r.target.kind}}}))),outgoing:Ou(Lu(e.outgoing(),r=>({id:r.id,title:r.title,description:r.description,technology:r.technology,target:{id:r.target.id,title:r.target.title,kind:r.target.kind},...r.source.id===e.id?{type:"direct"}:{type:"implicit, from nested",source:{id:r.source.id,title:r.source.title,kind:r.source.kind}}})))},views:Ou(Lu(e.views(),r=>({id:r.id,title:r.title}))),sourceFile:t.locate({element:e.id,projectId:n})}}function $Z(t,e,n){
return{id:e.id,title:e.title,projectId:n,viewType:e.__,description:e.$view.description??"",tags:e.tags,nodes:Ou(Lu(e.nodes(),r=>({id:r.id,title:r.title,represents:r.element?{element:r.element.id}:{}}))),sourceFile:t.locate({view:e.id,projectId:n})}}const Zx=lt.getChild("LikeC4MCPServices");function co(t){const e=ii(t)?.replaceAll('"',"'");return e?`"${e}"`:"null"}function Xx(t,e,n){const r=[...t];return r.length===0?[e]:Wr(r,n)}var Yx;(t=>(t.instructions=`This server provides access to LikeC4 mo\
del.

Key capabilities:
- List all available LikeC4 projects in the workspace
- Search for LikeC4 project and return its summary, that includes specifications, all elements and views
- Search for LikeC4 element by title
- Read details about LikeC4 element by id
- Read details about LikeC4 view by id

`,t.listProjects={name:"list-projects",description:"Lists all available LikeC4 projects in the workspace"},t.readProjectSummary={name:"read-project-summary",description:Su(`
      Searches for LikeC4 project and returns its summary, specifications, elements and views

      Args:
        project: Project name
    `),paramsSchema:{project:C.string().optional()}},t.searchElement={name:"search-element",description:Su(`
      Search for LikeC4 elements that have the search string in their names
      Can be used to resolve projects for further requests (like read-element or read-project-summary)

      Args:
        search: non-empty string
    `),paramsSchema:{search:C.string()}},t.readElement={name:"read-element",description:Su(`
      Read details about a LikeC4 element

      Args:
        id: Element id (FQN)
        project: Project name (optional, will use default project if not specified)
    `),paramsSchema:{id:C.string().min(1),project:C.string().optional()}},t.readView={name:"read-view",description:Su(`
      Read details about a LikeC4 view

      Args:
        id: View id
        project: Project name (optional, will use default project if not specified)
    `),paramsSchema:{id:C.string().min(1),project:C.string().optional()}}))(Yx||={});class DZ{constructor(e){this.services=e,this.languageServices=e.likec4.LanguageServices}languageServices;async listProjects(){const e=await this.languageServices.projects(),n=[];for(const r of e)if(r.documents){n.push("<likec4project>",`id: "${r.id}"`,`folder: ${r.folder.toString()}`,"sources:",...r.documents.map(i=>`- ${i.toString()}`),"");try{const i=await this.languageServices.computedModel(r.id),s=[...i.elements()];
s.length>0&&n.push("elements:",...s.flatMap(o=>[`- id: ${o.id}`,`  kind: ${o.kind}`,`  title: ${co(o.title)}`,""]),"");const a=[...i.views()];a.length>0&&n.push("views:",...a.flatMap(o=>[`- id: ${o.id}`,`  title: ${co(o.title)}`,""]),"")}catch(i){Zx.error(Jn(i))}n.push("</likec4project>")}return n.length===0&&n.push("<likec4project>",'id: "default"',`folder: ${this.languageServices.workspaceUri.toString()}`,"</likec4project>"),n.join(`
`)}async readProjectSummary(e){const n=e??Tn.DefaultProjectId,r=this.languageServices.projects().find(c=>c.id===n);if(!r)return"Project not found";const i=await this.languageServices.computedModel(r.id),s=[`project: "${r.id}"`,`folder: ${r.folder.toString()}`];r.documents&&s.push("sources:",...r.documents.map(c=>`- ${c.toString()}`),""),s.push("<specifications>");const a=Object.keys(i.$model.specification.elements);a.length>0&&s.push("element kinds:",...a.map(c=>`- ${c}`),"");const o=Object.keys(
i.$model.specification.relationships);o.length>0&&s.push("relationship kinds:",...o.map(c=>`- ${c}`),"");const u=Object.keys(i.$model.specification.deployments);return u.length>0&&s.push("deployment node kinds:",...u.map(c=>`- ${c}`),""),i.allTags().length>0&&s.push("tags:",...i.allTags().map(c=>`- ${c}`),""),s.push("</specifications>",""),s.push("<elements>",...Xx(i.elements(),"No elements",c=>[`- id: ${c.id}`,...c.parent?[`  parentId: ${c.parent.id}`]:[],`  kind: ${c.kind}`,`  shape: ${c.shape}`,
`  title: ${co(c.title)}`,`  description: ${co(c.description)}`,`  technology: ${co(c.technology)}`,`  tags: ${JSON.stringify(c.tags)}`,""]),"</elements>","<views>",...Xx(i.views(),"No views",c=>[`- id: ${c.id}`,`  viewType: ${c.__}`,`  title: ${co(c.title)}`,""]),"</views>"),s.join(`
`)}async searchElement(e){const n=e.search.toLowerCase(),r=[];for(const i of this.languageServices.projects())try{const s=[...(await this.languageServices.computedModel(i.id)).elements()].filter(a=>a.title.toLowerCase().includes(n));s.length>0&&r.push("<project>",`project: "${i.id}"`,"found:",...s.flatMap(a=>[`- id: ${a.id}`,`  kind: ${a.kind}`,`  title: ${co(a.title)}`,""]),"</project>")}catch(s){Zx.error(Jn(s))}return r.length>0?r.join(`
`):"No elements with this name found"}async readElement(e){const n=e.project??Tn.DefaultProjectId,r=this.languageServices.projects().find(s=>s.id===n);if(!r)return`Project "${n}" not found`;const i=(await this.languageServices.computedModel(r.id)).findElement(e.id);return i?JSON.stringify(RZ(this.languageServices,i,r.id)):`Element "${e.id}" not found in project "${n}"`}async readView(e){const n=e.project??Tn.DefaultProjectId,r=this.languageServices.projects().find(s=>s.id===n);if(!r)return`Proje\
ct "${n}" not found`;const i=(await this.languageServices.computedModel(r.id)).findView(e.id);return i?JSON.stringify($Z(this.languageServices,i,r.id)):`View "${e.id}" not found in project "${n}"`}}class TZ{start(e){return Promise.reject(new Error("Not implemented"))}stop(){return Promise.reject(new Error("Not implemented"))}}function Of(t){return{content:[{type:"text",text:t}]}}class SZ{constructor(e){this.services=e}create(e){const{instructions:n,listProjects:r,readProjectSummary:i,searchElement:s,
readElement:a,readView:o}=Yx,u=new x7({name:"LikeC4",version:O7.version},{instructions:n,...e,capabilities:{tools:{},...e?.capabilities}}),c=this.services.mcp.Tools;return u.tool(r.name,r.description,async()=>Of(await c.listProjects())),u.tool(i.name,i.description,i.paramsSchema,async l=>Of(await c.readProjectSummary(l.project))),u.tool(s.name,s.description,s.paramsSchema,async l=>Of(await c.searchElement(l))),u.tool(a.name,a.description,a.paramsSchema,async l=>Of(await c.readElement(l))),u.tool(
o.name,o.description,o.paramsSchema,async l=>Of(await c.readView(l))),u}}class Jx extends n0{constructor(e,n="fqn-index"){super(),this.services=e,this.cachePrefix=n,this.langiumDocuments=e.shared.workspace.LangiumDocuments,this.projects=e.shared.workspace.ProjectsManager,this.documentCache=new q0(r=>this.createDocumentIndex(r)),this.workspaceCache=new vp(e.shared,Ze.IndexedContent),this.onDispose(e.shared.workspace.DocumentBuilder.onDocumentPhase(Ze.IndexedContent,r=>{so(r)&&this.documentCache.set(
r,this.createDocumentIndex(r))}))}projects;langiumDocuments;documentCache;workspaceCache;documents(e){return this.langiumDocuments.projectDocuments(e).filter(n=>so(n)&&n.state>=Ze.IndexedContent)}get(e){return e.state<Ze.IndexedContent&&Ae(`Document ${e.uri.path} is not indexed`),this.documentCache.get(e)}resolve(e){return e.$type==="Imported"?this.getFqn(e.imported.ref):e.$type==="Element"?this.getFqn(e):this.services.likec4.DeploymentsIndex.getFqn(e)}getFqn(e){Fe(_n(e)||Pp(e));let n=mg.readId(
e);if(fe(n))return n;const r=vt(e);return Fe(so(r)),Ae(`Document ${r.uri.path} is not indexed, but getFqn was called`),this.get(r),Vt(mg.readId(e),"Element fqn must be set, invalid state")}byFqn(e,n){return rt(this.workspaceCache.get(`${this.cachePrefix}:${e}:fqn:${n}`,()=>this.documents(e).toArray().flatMap(r=>this.get(r).byFqn(n))))}rootElements(e){return rt(this.workspaceCache.get(`${this.cachePrefix}:${e}:rootElements`,()=>{const n=this.documents(e).reduce((r,i)=>(this.get(i).rootElements().
forEach(s=>{r.set(s.name,s)}),r),new Yn);return c0(n).sort((r,i)=>Cg(r.name,i.name))}))}directChildrenOf(e,n){return rt(this.workspaceCache.get(`${this.cachePrefix}:${e}:directChildrenOf:${n}`,()=>{const r=this.documents(e).reduce((i,s)=>(this.get(s).children(n).forEach(a=>{i.set(a.name,a)}),i),new Yn);return c0(r).sort((i,s)=>Cg(i.name,s.name))}))}uniqueDescedants(e,n){return rt(this.workspaceCache.get(`${this.cachePrefix}:${e}:uniqueDescedants:${n}`,()=>{const{children:r,descendants:i}=this.documents(
e).reduce((o,u)=>{const c=this.get(u);return c.children(n).forEach(l=>{o.children.set(l.name,l)}),c.descendants(n).forEach(l=>{o.descendants.set(l.name,l)}),o},{children:new Yn,descendants:new Yn}),s=c0(r).sort((o,u)=>Cg(o.name,u.name)),a=[...i.associations()].flatMap(([o,u])=>u.length===1&&!r.has(o)?u:[]);return[...s,...L1(a)]}))}createDocumentIndex(e){const n=e.parseResult.value.models.flatMap(f=>f.elements);if(n.length===0)return Cu.EMPTY;const r=e.likec4ProjectId??=this.projects.belongsTo(e),
i=new Array,s=new Yn,a=new Yn,o=new Yn,u=this.services.workspace.AstNodeDescriptionProvider,c=(f,d,h)=>{const p={...u.createDescription(f,d,e),id:h,likec4ProjectId:r};return mg.writeId(f,h),o.set(h,p),p},l=(f,d)=>{let h;if(_n(f)){h=N1(f.name,d);const w=c(f,f.name,h);d?s.set(d,w):i.push(w)}else h=oo(f.element);let p=[];if(Rn(f.body)&&!tn(f.body.elements)){for(const w of f.body.elements)if(!os(w))try{p.push(...l(w,h))}catch(v){Ae(v)}}p=[...s.get(h)??[],...p];for(const w of p)a.set(h,w);if(Yo(f))for(const w of F1(
h))for(const v of p)a.set(w,v);return a.get(h)??[]};for(const f of n)try{if(os(f))continue;l(f,null)}catch(d){Ae(d)}return new Cu(i,s,a,o,r)}}function c0(t){return[...t.associations()].flatMap(([e,n])=>n.length===1?n:[])}class Cu{constructor(e,n,r,i,s){this._rootElements=e,this._children=n,this._descendants=r,this._byfqn=i,this.projectId=s}static EMPTY=new Cu([],new Yn,new Yn,new Yn,Tn.DefaultProjectId);rootElements(){return this._rootElements}byFqn(e){return this._byfqn.get(e)??[]}children(e){return this.
_children.get(e)??[]}descendants(e){return this._descendants.get(e)??[]}}class CZ extends Jx{constructor(e){super(e,"deployments-index"),this.services=e,this.Names=e.references.NameProvider}Names;createDocumentIndex(e){const n=e.parseResult.value.deployments.flatMap(d=>d.elements);if(n.length===0)return Cu.EMPTY;const r=e.likec4ProjectId??=this.projects.belongsTo(e),i=new Array,s=new Yn,a=new Yn,o=new Yn,u=this.Names,c=this.services.workspace.AstNodeDescriptionProvider,l=(d,h,p)=>{const w={...c.
createDescription(d,h,e),id:p,likec4ProjectId:r};return mg.writeId(d,p),o.set(p,w),w},f=(d,h)=>{let p;if(Va(d))p=oo(d.deploymentNode);else{const v=u.getName(d);if(!fe(v))return[];p=k1(v,h);const g=l(d,v,p);if(h?s.set(h,g):i.push(g),yr(d))return[]}let w=[];if(Rn(d.body)){for(const v of d.body.elements)if(!Ri(v))try{w.push(...f(v,p))}catch(g){Ae(g)}}w=[...s.get(p)??[],...w];for(const v of w)a.set(p,v);if(Va(d))for(const v of R1(p))for(const g of w)a.set(v,g);return a.get(p)??[]};for(const d of n)try{
if(Ri(d))continue;f(d,null)}catch(h){Ae(h)}return new Cu(i,s,a,o,r)}}const Qx=t=>Number.isFinite(t)?t:0;function _Z(t){return{days:Math.trunc(t/864e5),hours:Math.trunc(t/36e5%24),minutes:Math.trunc(t/6e4%60),seconds:Math.trunc(t/1e3%60),milliseconds:Math.trunc(t%1e3),microseconds:Math.trunc(Qx(t*1e3)%1e3),nanoseconds:Math.trunc(Qx(t*1e6)%1e3)}}function AZ(t){return{days:t/86400000n,hours:t/3600000n%24n,minutes:t/60000n%60n,seconds:t/1000n%60n,milliseconds:t%1000n,microseconds:0n,nanoseconds:0n}}
function xZ(t){switch(typeof t){case"number":{if(Number.isFinite(t))return _Z(t);break}case"bigint":return AZ(t)}throw new TypeError("Expected a finite number or bigint")}const PZ=t=>t===0||t===0n,NZ=(t,e)=>e===1||e===1n?t:`${t}s`,IZ=1e-7,OZ=24n*60n*60n*1000n;function wg(t,e){const n=typeof t=="bigint";if(!n&&!Number.isFinite(t))throw new TypeError("Expected a finite number or bigint");e={...e};const r=t<0?"-":"";t=t<0?-t:t,e.colonNotation&&(e.compact=!1,e.formatSubMilliseconds=!1,e.separateMilliseconds=
!1,e.verbose=!1),e.compact&&(e.unitCount=1,e.secondsDecimalDigits=0,e.millisecondsDecimalDigits=0);let i=[];const s=(l,f)=>{const d=Math.floor(l*10**f+IZ);return(Math.round(d)/10**f).toFixed(f)},a=(l,f,d,h)=>{if(!((i.length===0||!e.colonNotation)&&PZ(l)&&!(e.colonNotation&&d==="m"))){if(h??=String(l),e.colonNotation){const p=h.includes(".")?h.split(".")[0].length:h.length,w=i.length>0?2:1;h="0".repeat(Math.max(0,w-p))+h}else h+=e.verbose?" "+NZ(f,l):d;i.push(h)}},o=xZ(t),u=BigInt(o.days);if(e.hideYearAndDays?
a(BigInt(u)*24n+BigInt(o.hours),"hour","h"):(e.hideYear?a(u,"day","d"):(a(u/365n,"year","y"),a(u%365n,"day","d")),a(Number(o.hours),"hour","h")),a(Number(o.minutes),"minute","m"),!e.hideSeconds)if(e.separateMilliseconds||e.formatSubMilliseconds||!e.colonNotation&&t<1e3){const l=Number(o.seconds),f=Number(o.milliseconds),d=Number(o.microseconds),h=Number(o.nanoseconds);if(a(l,"second","s"),e.formatSubMilliseconds)a(f,"millisecond","ms"),a(d,"microsecond","\xB5s"),a(h,"nanosecond","ns");else{const p=f+
d/1e3+h/1e6,w=typeof e.millisecondsDecimalDigits=="number"?e.millisecondsDecimalDigits:0,v=p>=1?Math.round(p):Math.ceil(p),g=w?p.toFixed(w):v;a(Number.parseFloat(g),"millisecond","ms",g)}}else{const l=(n?Number(t%OZ):t)/1e3%60,f=typeof e.secondsDecimalDigits=="number"?e.secondsDecimalDigits:1,d=s(l,f),h=e.keepDecimalsOnWholeSeconds?d:d.replace(/\.0+$/,"");a(Number.parseFloat(h),"second","s",h)}if(i.length===0)return r+"0"+(e.verbose?" milliseconds":"ms");const c=e.colonNotation?":":" ";return typeof e.
unitCount=="number"&&(i=i.slice(0,Math.max(e.unitCount,1))),r+i.join(c)}function LZ(t){const e=new Map;for(const n of t)if(Iu.isElement(n)&&n.viewOf&&Ft(n.extends)){const r=e.get(n.viewOf)??[];r.push(n.id),e.set(n.viewOf,r)}for(const{id:n,nodes:r}of t)for(const i of r){const s=Wf.modelRef(i);if(i.navigateTo||!s)continue;const a=ST(e.get(s)??[],o=>o!==n);a&&(i.navigateTo=a)}return t}function FZ(t,e="/"){const n=et(t,Ht(u=>u.docUri),Qe(fe),jo());if(n.length===0)return"";if(n.length===1){const u=mu(
n[0]).pathname.split(e);return u.length<=1?e:(u.pop(),u.join(e)+e)}Fe(Ar(n,2),"Expected at least 2 unique URIs");const[r,...i]=n,s=mu(r).pathname.split(e);let a=s.length;for(const u of i){if(u===r)continue;const c=mu(u).pathname.split(e);for(let l=0;l<a;l++)c[l]!==s[l]&&(a=l);if(a===0)return""}const o=s.slice(0,a).join(e);return o.endsWith(e)?o:o+e}function MZ(t){const e="/",n=FZ(t,e);return t.map(r=>{if(!r.docUri)return{view:r,parts:[]};let i=mu(r.docUri).pathname;return n.length>0?(Fe(i.startsWith(
n),`Expect path "${i}" to start with common prefix: "${n}"`),i=i.slice(n.length)):i=i.includes(e)?i.slice(i.lastIndexOf(e)+1):i,{view:r,parts:i.split(e)}}).sort((r,i)=>{if(r.parts.length!==i.parts.length)return r.parts.length-i.parts.length;for(let s=0;s<r.parts.length;s++){const a=P0(r.parts[s],i.parts[s]);if(a!==0)return a}return P0(r.view.title??r.view.id,i.view.title??i.view.id)}).map(({parts:r,view:i})=>({...i,relativePath:r.join(e)}))}class eP{mergedData=new Map;merge(e){for(const n of e){
const{id:r,links:i,tags:s,metadata:a}=n,o=this.mergedData.get(r)??{links:[],tags:[],metadata:{}};i&&o.links.push(...i),s&&(o.tags=jo([...o.tags,...s])),a&&(o.metadata={...o.metadata,...a}),this.mergedData.set(r,o)}}apply(e){const n=this.mergedData.get(e.id);if(!n)return e;let r=n.links;e.links&&e.links.length>0&&(r=[...e.links,...r]);let i=n.tags;e.tags&&e.tags.length>0&&(i=jo([...e.tags,...i]));let s=n.metadata;return e.metadata&&(s={...e.metadata,...n.metadata}),{...e,tags:Ar(i,1)?i:null,links:Ar(
r,1)?r:null,...!tn(s)&&{metadata:s}}}}class jZ{specs={tags:new Set,elements:{},deployments:{},relationships:{},colors:{}};globals={predicates:{},dynamicPredicates:{},styles:{}};imports=new $1(Set);constructor(e){for(const n of e){const{c4Specification:r,c4Globals:i,c4Imports:s}=n;r.tags.forEach(a=>this.specs.tags.add(a)),Object.assign(this.specs.elements,r.elements),Object.assign(this.specs.relationships,r.relationships),Object.assign(this.specs.colors,r.colors),Object.assign(this.specs.deployments,
r.deployments),Object.assign(this.globals.predicates,i.predicates),Object.assign(this.globals.dynamicPredicates,i.dynamicPredicates),Object.assign(this.globals.styles,i.styles);for(const[a,o]of s)this.imports.set(a,o)}}toModelElement=({tags:e,links:n,style:{color:r,shape:i,icon:s,opacity:a,border:o,size:u,multiple:c,padding:l,textSize:f},id:d,kind:h,title:p,description:w,technology:v,metadata:g})=>{try{const b=this.specs.elements[h];return b?(r??=b.style.color,i??=b.style.shape,s??=b.style.icon,
a??=b.style.opacity,o??=b.style.border,v??=b.technology,c??=b.style.multiple,u??=b.style.size,l??=b.style.padding,f??=b.style.textSize,{...r&&{color:r},...i&&{shape:i},...s&&{icon:s},...g&&!tn(g)&&{metadata:g},...b.notation&&{notation:b.notation},style:{...o&&{border:o},...u&&{size:u},...l&&{padding:l},...f&&{textSize:f},...Zv(c)&&{multiple:c},...$p(a)&&{opacity:a}},links:n??null,tags:e??null,technology:v??null,description:w??null,title:p,kind:h,id:d}):(lt.warn`No kind '${h}' found for ${d}`,null)}catch(b){
Ae(b)}return null};toModelRelation=({astPath:e,source:n,target:r,kind:i,links:s,id:a,...o})=>{const u=sa.toModelFqn(r),c=sa.toModelFqn(n);return Un(i)&&this.specs.relationships[i]?{...this.specs.relationships[i],...o,...s&&{links:s},source:c,target:u,kind:i,id:a}:{...s&&{links:s},...o,source:c,target:u,id:a}};toDeploymentElement=e=>{if("element"in e&&!("kind"in e))return{...e,element:sa.toModelFqn(e.element)};if("element"in e)return null;try{const n=this.specs.deployments[e.kind];if(!n)return lt.
warn`No kind ${e.kind} found for ${e.id}`,null;let{technology:r=n.technology,notation:i=n.notation,style:s}=e;return{...e,...i&&{notation:i},...r&&{technology:r},style:{border:"dashed",opacity:10,...n.style,...s}}}catch(n){Ae(n)}return null};toDeploymentRelation=({astPath:e,source:n,target:r,kind:i,links:s,id:a,...o})=>Un(i)&&this.specs.relationships[i]?{...this.specs.relationships[i],...o,...s&&{links:s},source:n,target:r,kind:i,id:a}:{...s&&{links:s},...o,source:n,target:r,id:a}}function BZ(t){
const e=new jZ(t),n=Bo(e.specs.colors,d=>D1(d.color)),r=new eP,i=new eP,s=et(t,Wr(d=>(r.merge(d.c4ExtendElements),Ht(d.c4Elements,e.toModelElement))),Qe(fe),N0,Vv((d,h)=>{const p=O0(h.id);return p&&Ft(d[p])?(lt.debug`No parent found for ${h.id}`,d):(d[h.id]=r.apply(h),d)},{})),a=et(t,Wr(d=>Ht(d.c4Relations,e.toModelRelation)),Qe(d=>d?Ft(s[d.source])&&!I0(d.source)||Ft(s[d.target])&&!I0(d.target)?(lt.debug`Invalid relation ${d.id}
  source: ${d.source} resolved: ${!!s[d.source]}
  target: ${d.target} resolved: ${!!s[d.target]}\n`,!1):!0:!1),Xc(Ui("id"))),o=et(t,Wr(d=>(i.merge(d.c4ExtendDeployments),Ht(d.c4Deployments,e.toDeploymentElement))),Qe(fe),N0,Vv((d,h)=>{const p=O0(h.id);return p&&Ft(d[p])?(lt.debug`No parent found for deployment element ${h.id}`,d):(d[h.id]=T1.isDeploymentNode(h)?i.apply(h):h,d)},{})),u=et(t,Wr(d=>Ht(d.c4DeploymentRelations,e.toDeploymentRelation)),Qe(d=>d?Ft(o[d.source.id])||Ft(o[d.target.id])?(lt.debug`Invalid deployment relation ${d.id}
  source: ${d.source.id} resolved: ${!!o[d.source.id]}
  target: ${d.target.id} resolved: ${!!o[d.target.id]}\n`,!1):!0:!1),Vv((d,h)=>Rn(d[h.id])?(lt.debug`Duplicate deployment relation ${h.id}`,d):(d[h.id]=h,d),{}));function c(d){const h=d.uri.toString();return p=>{let{id:w,title:v,description:g,astPath:b,...k}=p;return p.__==="element"&&Ft(v)&&"viewOf"in p&&(v=s[p.viewOf]?.title??null),Ft(v)&&w==="index"&&(v="Landscape view"),{...k,customColorDefinitions:n,docUri:h,description:g,title:v,id:w}}}const l=et(t,Wr(d=>Ht(d.c4Views,c(d))),MZ);l.some(d=>d.
id==="index")||l.unshift({__:"element",id:"index",title:"Landscape view",description:null,tags:null,links:null,customColorDefinitions:n,rules:[{include:[{wildcard:!0}]}]});const f=et(l,Xc(Ui("id")),O1);return{data:{specification:{tags:Array.from(e.specs.tags),elements:e.specs.elements,relationships:e.specs.relationships,deployments:e.specs.deployments},elements:s,relations:a,globals:e.globals,views:f,deployments:{elements:o,relations:u},imports:{}},imports:e.imports}}const qZ=t=>`parsed-without-\
imports-${t}`,tP=t=>`parsed-model-${t}`,nP=t=>`computed-model-${t}`,zs=lt.getChild("ModelBuilder");class GZ extends n0{projects;parser;listeners=[];cache;DocumentBuilder;mutex;constructor(e){super(),this.projects=e.shared.workspace.ProjectsManager,this.parser=e.likec4.ModelParser,this.cache=e.ValidatedWorkspaceCache,this.DocumentBuilder=e.shared.workspace.DocumentBuilder,this.mutex=e.shared.workspace.WorkspaceLock,this.onDispose(this.DocumentBuilder.onUpdate((n,r)=>{r.length>0&&this.notifyListeners(
r)})),this.onDispose(this.DocumentBuilder.onBuildPhase(Ze.Validated,(n,r)=>{const i=n.map(Ui("uri")).filter(kU(nf));i.length>0&&this.notifyListeners(i)})),zs.debug`created`}unsafeSyncParseModelData(e){const n=this.cache,r=zs.getChild(["project",e]),i=qZ(e);return n.has(i)&&r.debug`unsafeSyncBuildModelData from cache, project ${e}`,n.get(i,()=>{try{const s=this.documents(e);return s.length===0?(zs.debug`no documents to build model, project ${e}`,null):(r.debug`unsafeSyncBuildModelData, project ${e}`,
BZ(s))}catch(s){return Ae(s),null}})}unsafeSyncJoinedModelData(e){const n=this.cache,r=tP(e);return n.get(r,()=>{const i=this.unsafeSyncParseModelData(e);if(!i)return null;if(i.imports.size>0){zs.debug`processing imports of ${e}`;const s=[...i.imports.associations()].reduce((a,[o,u])=>{const c=this.unsafeSyncParseModelData(o);if(c){const l=et([...u],Wr(f=>c.data.elements[f]??[]));Ar(l,1)&&(a[o]=l)}return a},{});return{...i.data,imports:s}}return i.data})}async parseModel(e,n=Jt.CancellationToken.
None){const r=this.projects.ensureProjectId(e),i=zs.getChild(["project",r]),s=this.cache.get(tP(r));if(s)return i.debug`parseModel from cache, project ${r}`,s;const a=performance.now();return await this.mutex.read(async()=>{await en(n);const o=this.unsafeSyncJoinedModelData(r);return i.debug(`parseModel, project ${r} in ${wg(performance.now()-a)}`),o})}previousViews={};unsafeSyncBuildModel(e){const n=this.cache,r=this.cache;return n.get(nP(e),()=>{const i=this.unsafeSyncJoinedModelData(e);if(!i)
return ia.EMPTY;const{views:s,...a}=i,o=ia.makeCompute(i),u=[];for(const l of Rp(s)){const f=o(l);if(!f.isSuccess){zs.warn(Jn(f.error));continue}u.push(f.view)}LZ(u);const c=ki(u,l=>{const f=rP(e,l.id),d=this.previousViews[f],h=d&&Cb(l,d)?d:l;return r.set(f,h),[l.id,h]});return this.previousViews={...this.previousViews,...c},ia.create({...a,views:c})})}async buildLikeC4Model(e,n=Jt.CancellationToken.None){const r=this.projects.ensureProjectId(e),i=zs.getChild(["project",r]),s=this.cache.get(nP(r));
if(s)return i.debug("buildLikeC4Model from cache"),s;const a=performance.now();return await this.mutex.read(async()=>{await en(n);const o=this.unsafeSyncBuildModel(r);return i.debug(`buildLikeC4Model in ${wg(performance.now()-a)}`),o})}async computeView(e,n,r=Jt.CancellationToken.None){const i=this.projects.ensureProjectId(n),s=zs.getChild(["project",i]),a=this.cache,o=rP(i,e);if(a.has(o))return a.get(o);const u=await this.parseModel(i,r);return u?a.get(o,()=>{const c=u.views[e];if(!c)return s.warn`computeView: cant find view ${e}`,
null;s.debug`computeView: ${e}`;const l=ia.makeCompute(u)(c);if(!l.isSuccess)return Ae(l.error),null;let f=l.view;const d=et(u.views,Rp(),Qe(S1),Qe(p=>p.id!==e),qo(p=>p.viewOf));for(const p of f.nodes)if(!p.navigateTo){const w=d[p.id];w&&(p.navigateTo=w[0].id)}const h=this.previousViews[o];return h&&Cb(f,h)?f=h:this.previousViews[o]=f,f}):null}onModelParsed(e){return this.listeners.push(e),Ta.create(()=>{const n=this.listeners.indexOf(e);n>=0&&this.listeners.splice(n,1)})}documents(e){return this.
parser.documents(e).toArray()}notifyListeners(e){for(const n of this.listeners)try{n(e)}catch(r){Ae(r)}}}function rP(t,e){return`computed-view-${t}-${e}`}const{findNodeForKeyword:UZ,findNodeForProperty:bg}=by,{getDocument:zZ}=Eo;class WZ{constructor(e){this.services=e,this.fqnIndex=e.likec4.FqnIndex,this.deploymentsIndex=e.likec4.DeploymentsIndex,this.langiumDocuments=e.shared.workspace.LangiumDocuments,this.parser=e.likec4.ModelParser,this.projects=e.shared.workspace.ProjectsManager}fqnIndex;deploymentsIndex;langiumDocuments;parser;projects;documents(e){
return this.parser.documents(e)}getParsedElement(...e){let n,r;if(e.length===2?(n=e[0],r=e[1]):(n=e[0],r=Kv(n)?this.projects.ensureProjectId():rn(n)),Kv(n)){const s=n,a=this.fqnIndex.byFqn(r,n).head();if(!a)return null;const o=this.langiumDocuments.getDocument(a.documentUri);return o?this.parser.parse(o).c4Elements.find(u=>u.id===s)??null:null}const i=this.fqnIndex.getFqn(n);return this.parser.parse(zZ(n)).c4Elements.find(s=>s.id===i)??null}locateElement(e,n){let[r,i]=L0(e);r??=this.projects.ensureProjectId(
n);const s=this.fqnIndex.byFqn(r,i).head(),a=s?.nameSegment??s?.selectionSegment;return!s||!a?null:{uri:s.documentUri.toString(),range:a.range}}locateDeploymentElement(e,n){let[r,i]=L0(e);r??=this.projects.ensureProjectId(n);const s=this.deploymentsIndex.byFqn(r,i).head(),a=s?.nameSegment??s?.selectionSegment;return!s||!a?null:{uri:s.documentUri.toString(),range:a.range}}locateRelation(e,n){const r=this.projects.ensureProjectId(n);for(const i of this.documents(r)){const s=i.c4Relations.find(u=>u.
id===e)??i.c4DeploymentRelations.find(u=>u.id===e);if(!s)continue;const a=this.services.workspace.AstNodeLocator.getAstNode(i.parseResult.value,s.astPath);if(!os(a)&&!Ri(a))continue;let o=a.title?bg(a.$cstNode,"title"):void 0;if(o??=a.kind?bg(a.$cstNode,"kind"):void 0,o??=bg(a.$cstNode,"target"),o??=a.$cstNode,!!o)return{uri:i.uri.toString(),range:o.range}}return null}locateViewAst(e,n){const r=this.projects.ensureProjectId(n);for(const i of this.documents(r)){const s=i.c4Views.find(o=>o.id===e);
if(!s)continue;const a=this.services.workspace.AstNodeLocator.getAstNode(i.parseResult.value,s.astPath);if(kw(a))return{doc:i,view:s,viewAst:a}}return null}locateView(e,n){const r=this.locateViewAst(e,n);if(!r)return null;const i=r.viewAst;let s=i.name?bg(i.$cstNode,"name"):void 0;return s??=UZ(i.$cstNode,"view"),s??=i.$cstNode,s?{uri:r.doc.uri.toString(),range:s.range}:null}}function*HZ(t){const e=F0.from(t.parseResult.value.deployments.flatMap(i=>i.elements)),n=[];let r;for(;r=e.shift();){if(Ri(
r)){n.push(r);continue}if(r.body&&r.body.elements.length>0)for(const i of r.body.elements)e.push(i);yield r}yield*n}function VZ(t){return class extends t{parseDeployment(){const e=this.doc;for(const n of HZ(e))try{switch(!0){case Ri(n):{this.isValid(n)&&e.c4DeploymentRelations.push(this.parseDeploymentRelation(n));break}case yr(n):e.c4Deployments.push(this.parseDeployedInstance(n));break;case ar(n):{e.c4Deployments.push(this.parseDeploymentNode(n));break}case Va(n):{const r=this.parseExtendDeployment(
n);r&&e.c4ExtendDeployments.push(r);break}default:Ke(n)}}catch(r){Ae(r)}}parseDeploymentNode(e){const n=this.isValid,r=this.resolveFqn(e),i=Vt(e.kind.ref,"DeploymentKind not resolved").name,s=this.convertTags(e.body),a=this.parseElementStyle(e.body?.props),o=this.getMetadata(e.body?.props.find(Ps)),u=et(e.body?.props??[],Qe(n),Qe(ed),ki(h=>[h.key,h.value||void 0])),c=St(e.title??u.title),l=St(u.description),f=ii(u.technology),d=this.convertLinks(e.body);return{id:r,kind:i,title:c??$g(r),...o&&{metadata:o},
...s&&{tags:s},...d&&ur(d)&&{links:d},...fe(f)&&{technology:f},...fe(l)&&{description:l},style:a}}parseDeployedInstance(e){const n=this.isValid,r=this.resolveFqn(e),i=this.parseFqnRef(e.target.modelElement);Fe(Ln.isModelRef(i)||Ln.isImportRef(i),"Target must be a model reference");const s=this.convertTags(e.body),a=this.parseElementStyle(e.body?.props),o=this.getMetadata(e.body?.props.find(Ps)),u=et(e.body?.props??[],Qe(n),Qe(ed),ki(h=>[h.key,h.value||void 0])),c=St(e.title??u.title),l=St(u.description),
f=ii(u.technology),d=this.convertLinks(e.body);return{id:r,element:i,...o&&{metadata:o},...c&&{title:c},...s&&{tags:s},...d&&ur(d)&&{links:d},...fe(f)&&{technology:f},...fe(l)&&{description:l},style:a}}parseExtendDeployment(e){if(!this.isValid(e))return null;const n=this.resolveFqn(e),r=this.parseTags(e.body),i=this.getMetadata(e.body?.props.find(Ps)),s=this.getAstNodePath(e),a=this.parseLinks(e.body)??[];return!r&&tn(i??{})&&tn(a)?null:{id:n,astPath:s,...i&&{metadata:i},...r&&{tags:r},...a&&ur(
a)&&{links:a}}}_resolveDeploymentRelationSource(e){if(Rn(e.source))return this.parseFqnRef(e.source);if(e.$container.$type==="DeploymentNodeBody"||e.$container.$type==="DeployedInstanceBody")return{deployment:this.resolveFqn(e.$container.$container)};throw new Error("RelationRefError: Invalid container for sourceless relation")}parseDeploymentRelation(e){const n=this.isValid,r=this.getAstNodePath(e),i=Ln.toDeploymentRef(this._resolveDeploymentRelationSource(e)),s=Ln.toDeploymentRef(this.parseFqnRef(
e.target)),a=this.convertTags(e)??this.convertTags(e.body),o=this.convertLinks(e.body),u=e.kind?.ref?.name,c=this.getMetadata(e.body?.props.find(Ps)),l=ki(e.body?.props.filter(Ad)??[],v=>[v.key,v.value]),f=et(e.body?.props??[],Qe(Cd),Ht(v=>v.value.view.ref?.name),Qe(fe),Go()),d=St(e.title??l.title),h=St(l.description),p=ii(e.technology)??St(l.technology),w=e.body?.props.find(Tm);return{id:If("deployment",r,i.id,s.id),source:i,target:s,...d&&{title:d},...c&&{metadata:c},...fe(p)&&{technology:p},...fe(
h)&&{description:h},...u&&{kind:u},...a&&{tags:a},...ur(o)&&{links:o},...Yb(w?.props,n),...f&&{navigateTo:f},astPath:r}}}}function KZ(t){const e=t.length;let n=0,r=0;for(;r<e;){let i=t.charCodeAt(r++);if((i&4294967168)===0){n++;continue}else if((i&4294965248)===0)n+=2;else{if(i>=55296&&i<=56319&&r<e){const s=t.charCodeAt(r);(s&64512)===56320&&(++r,i=((i&1023)<<10)+(s&1023)+65536)}(i&4294901760)===0?n+=3:n+=4}}return n}function ZZ(t,e,n){const r=t.length;let i=n,s=0;for(;s<r;){let a=t.charCodeAt(
s++);if((a&4294967168)===0){e[i++]=a;continue}else if((a&4294965248)===0)e[i++]=a>>6&31|192;else{if(a>=55296&&a<=56319&&s<r){const o=t.charCodeAt(s);(o&64512)===56320&&(++s,a=((a&1023)<<10)+(o&1023)+65536)}(a&4294901760)===0?(e[i++]=a>>12&15|224,e[i++]=a>>6&63|128):(e[i++]=a>>18&7|240,e[i++]=a>>12&63|128,e[i++]=a>>6&63|128)}e[i++]=a&63|128}}const XZ=new TextEncoder,YZ=50;function JZ(t,e,n){XZ.encodeInto(t,e.subarray(n))}function QZ(t,e,n){t.length>YZ?JZ(t,e,n):ZZ(t,e,n)}const eX=4096;function iP(t,e,n){
let r=e;const i=r+n,s=[];let a="";for(;r<i;){const o=t[r++];if((o&128)===0)s.push(o);else if((o&224)===192){const u=t[r++]&63;s.push((o&31)<<6|u)}else if((o&240)===224){const u=t[r++]&63,c=t[r++]&63;s.push((o&31)<<12|u<<6|c)}else if((o&248)===240){const u=t[r++]&63,c=t[r++]&63,l=t[r++]&63;let f=(o&7)<<18|u<<12|c<<6|l;f>65535&&(f-=65536,s.push(f>>>10&1023|55296),f=56320|f&1023),s.push(f)}else s.push(o);s.length>=eX&&(a+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(a+=String.fromCharCode(
...s)),a}const tX=new TextDecoder,nX=200;function rX(t,e,n){const r=t.subarray(e,e+n);return tX.decode(r)}function iX(t,e,n){return n>nX?rX(t,e,n):iP(t,e,n)}class Eg{constructor(e,n){this.type=e,this.data=n}}class kr extends Error{constructor(e){super(e);const n=Object.create(kr.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:kr.name})}}const Lf=4294967295;function sX(t,e,n){const r=n/4294967296,i=n;t.setUint32(e,r),t.setUint32(e+4,
i)}function sP(t,e,n){const r=Math.floor(n/4294967296),i=n;t.setUint32(e,r),t.setUint32(e+4,i)}function aP(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function aX(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const oX=-1,uX=4294967296-1,cX=17179869184-1;function lX({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=cX)if(e===0&&t<=uX){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,i=new Uint8Array(8),
s=new DataView(i.buffer);return s.setUint32(0,e<<2|n&3),s.setUint32(4,r),i}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),sP(r,4,t),n}}function dX(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,i=Math.floor(r/1e9);return{sec:n+i,nsec:r-i*1e9}}function fX(t){if(t instanceof Date){const e=dX(t);return lX(e)}else return null}function hX(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{
const n=e.getUint32(0),r=e.getUint32(4),i=(n&3)*4294967296+r,s=n>>>2;return{sec:i,nsec:s}}case 12:{const n=aP(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new kr(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function pX(t){const e=hX(t);return new Date(e.sec*1e3+e.nsec/1e6)}const mX={type:oX,encode:fX,decode:pX};class kg{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(mX)}register({type:e,encode:n,
decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const i=-1-e;this.builtInEncoders[i]=n,this.builtInDecoders[i]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const i=this.builtInEncoders[r];if(i!=null){const s=i(e,n);if(s!=null){const a=-1-r;return new Eg(a,s)}}}for(let r=0;r<this.encoders.length;r++){const i=this.encoders[r];if(i!=null){const s=i(e,n);if(s!=null){const a=r;return new Eg(a,s)}}}return e instanceof Eg?e:null}decode(e,n,r){const i=n<0?this.builtInDecoders[-1-
n]:this.decoders[n];return i?i(e,n,r):new Eg(n,e)}}kg.defaultCodec=new kg;function gX(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function l0(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):gX(t)?new Uint8Array(t):Uint8Array.from(t)}const yX=100,vX=2048;class S0{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??kg.defaultCodec,this.context=e?.context,this.useBigInt64=
e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??yX,this.initialBufferSize=e?.initialBufferSize??vX,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new S0({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.
maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=
!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.
pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),i=new DataView(n);r.set(this.bytes),this.view=i,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.
useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(
0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=KZ(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),QZ(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,n){const r=this.
extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(
`Too large binary: ${n}`);const r=l0(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const i of e)this.doEncode(i,n+1)}countWithoutUndefined(e,n){let r=0;for(const i of n)e[i]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.sortKeys&&r.sort();const i=this.ignoreUndefined?this.countWithoutUndefined(
e,r):r.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else if(i<4294967296)this.writeU8(223),this.writeU32(i);else throw new Error(`Too large map object: ${i}`);for(const s of r){const a=e[s];this.ignoreUndefined&&a===void 0||(this.encodeString(s),this.doEncode(a,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),i=r.length;if(i>=4294967296)throw new Error(`Too large extension object: ${i}`);this.writeU8(201),this.writeU32(i),
this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(
1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){
this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),sX(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),sP(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),
this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}function wX(t,e){return new S0(e).encodeSharedRef(t)}function d0(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const bX=16,EX=16;class kX{constructor(e=bX,n=EX){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const i=this.
caches[r-1];e:for(const s of i){const a=s.bytes;for(let o=0;o<r;o++)if(a[o]!==e[n+o])continue e;return s.str}return null}store(e,n){const r=this.caches[e.length-1],i={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=i:r.push(i)}decode(e,n,r){const i=this.find(e,n,r);if(i!=null)return this.hit++,i;this.miss++;const s=iP(e,n,r),a=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(a,s),s}}const f0="array",Ff="map_key",oP="map_value",RX=t=>{if(typeof t=="string"||typeof t==
"number")return t;throw new kr("The type of key must be string or number but "+typeof t)};class $X{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=f0,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=Ff,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.
stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===f0){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===Ff||e.type===oP){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.
type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const Mf=-1,h0=new DataView(new ArrayBuffer(0)),DX=new Uint8Array(h0.buffer);try{h0.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const uP=new RangeError("Insufficient data"),TX=new kX;class C0{constructor(e){this.totalPos=0,this.pos=0,this.view=h0,this.bytes=
DX,this.headByte=Mf,this.stack=new $X,this.entered=!1,this.extensionCodec=e?.extensionCodec??kg.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??Lf,this.maxBinLength=e?.maxBinLength??Lf,this.maxArrayLength=e?.maxArrayLength??Lf,this.maxMapLength=e?.maxMapLength??Lf,this.maxExtLength=e?.maxExtLength??Lf,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:TX,this.mapKeyConverter=e?.mapKeyConverter??RX}clone(){
return new C0({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=Mf,this.stack.reset()}setBuffer(e){const n=l0(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){
if(this.headByte===Mf&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=l0(e),i=new Uint8Array(n.length+r.length);i.set(n),i.set(r,n.length),this.setBuffer(i)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),
this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const o of e){if(n)throw this.
entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(o);try{r=this.doDecodeSync(),n=!0}catch(u){if(!(u instanceof RangeError))throw u}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:i,pos:s,totalPos:a}=this;throw new RangeError(`Insufficient data in parsing ${d0(i)} at ${a} (${s} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.
decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,i=-1;for await(const s of e){if(n&&i===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s),r&&(i=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--i!==0;);}catch(a){if(!(a instanceof RangeError))throw a}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;
if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const i=e-128;if(i!==0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e<160){const i=e-144;if(i!==0){this.pushArrayState(i),this.complete();continue e}else n=[]}else{const i=e-160;n=this.decodeString(i,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.
readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const i=this.lookU8();n=this.decodeString(i,1)}else if(e===218){const i=this.lookU16();n=this.decodeString(i,2)}else if(e===219){const i=this.lookU32();n=this.decodeString(i,4)}else if(e===220){const i=this.readU16();if(i!==0){
this.pushArrayState(i),this.complete();continue e}else n=[]}else if(e===221){const i=this.readU32();if(i!==0){this.pushArrayState(i),this.complete();continue e}else n=[]}else if(e===222){const i=this.readU16();if(i!==0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e===223){const i=this.readU32();if(i!==0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e===196){const i=this.lookU8();n=this.decodeBinary(i,1)}else if(e===197){const i=this.lookU16();n=this.decodeBinary(
i,2)}else if(e===198){const i=this.lookU32();n=this.decodeBinary(i,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const i=this.lookU8();n=this.decodeExtension(i,1)}else if(e===200){const i=this.lookU16();n=this.decodeExtension(i,2)}else if(e===201){const i=this.lookU32();n=this.decodeExtension(i,4)}else throw new kr(
`Unrecognized type byte: ${d0(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const i=r.top();if(i.type===f0)if(i.array[i.position]=n,i.position++,i.position===i.size)n=i.array,r.release(i);else continue e;else if(i.type===Ff){if(n==="__proto__")throw new kr("The key __proto__ is not allowed");i.key=this.mapKeyConverter(n),i.type=oP;continue e}else if(i.map[i.key]=n,i.readCount++,i.readCount===i.size)n=i.map,r.release(i);else{i.key=null,i.type=Ff;continue e}}return n}}readHeadByte(){return this.
headByte===Mf&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=Mf}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new kr(`Unrecognized array type byte: ${d0(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new kr(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new kr(
`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){if(e>this.maxStrLength)throw new kr(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw uP;const r=this.pos+n;let i;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(
e)?i=this.keyDecoder.decode(this.bytes,r,e):i=iX(this.bytes,r,e),this.pos+=n+e,i}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Ff:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new kr(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw uP;const r=this.pos+n,i=this.bytes.subarray(r,r+e);return this.pos+=n+e,i}decodeExtension(e,n){if(e>this.maxExtLength)throw new kr(`Max length exceeded: ext length (${e}) > maxExt\
Length (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),i=this.decodeBinary(e,n+1);return this.extensionCodec.decode(i,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.
view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=aX(this.view,this.pos);return this.pos+=8,e}readI64(){const e=aP(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(
this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}}function SX(t,e){return new C0(e).decode(t)}const CX=t=>typeof ArrayBuffer=="function"&&t instanceof ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]",_X=(t,e=0,n=t.byteLength-e)=>{if(!CX(t))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof t} (${t})`);return Tg.from(t,e,n)},cP=(t,e)=>{if(typeof t!="string")throw new TypeError(`The "input\
" argument must be of type string. Received type ${typeof t} (${t})`);return e?Tg.from(t,e):Tg.from(t)},AX=/^[A-Za-z0-9+/]*={0,2}$/,xX=t=>{if(t.length*3%4!==0)throw new TypeError("Incorrect padding on base64 string.");if(!AX.exec(t))throw new TypeError("Invalid base64 string.");const e=cP(t,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},PX=t=>{const e=cP(t,"utf8");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT)},NX=t=>{let e;if(typeof t==
"string"?e=PX(t):e=t,typeof e!="object"||typeof e.byteOffset!="number"||typeof e.byteLength!="number")throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");return _X(e.buffer,e.byteOffset,e.byteLength).toString("base64")},{getDocument:IX}=Eo;function OX({nodes:t,edges:e,...n}){return{...n,nodes:Bo(t,({x:r,y:i,width:s,height:a,isCompound:o,...u})=>({...u,b:[r,i,s,a],c:o})),edges:Bo(e,({points:r,controlPoints:i,labelBBox:s,dotpos:a,...o})=>({...!!i&&{cp:i},
...!!s&&{l:s},...!!a&&{dp:a},...o,p:r}))}}function LX({nodes:t,edges:e,autoLayout:n,...r}){return{...r,autoLayout:C1(n)?{direction:n}:n,nodes:Bo(t,({b:i,c:s,...a})=>({x:i[0],y:i[1],width:i[2],height:i[3],isCompound:s,...a})),edges:Bo(e,({p:i,cp:s,l:a,dp:o,...u})=>({...!!s&&{controlPoints:s},...!!a&&{labelBBox:a},...!!o&&{dotpos:o},...u,points:i}))}}const lP=500;function FX(t){const e=wX(OX(t)),n=NX(e),r=[];let i=0;for(;i<n.length;)r.push(" * "+n.slice(i,Math.min(i+lP,n.length))),i+=lP;return r.unshift(
"/**"," * @likec4-generated(v1)"),r.push(" */"),r.join(`
`)}function dP(t){return t.includes("@likec4-generated")}function MX(t){if(!dP(t))throw new Error(`Not a likec4-generated comment: ${t}`);const e=t.trim().split(`
`).filter(r=>!r.includes("**")&&!r.includes("@likec4-")&&!r.includes("*/")).map(r=>r.replaceAll("*","").trim()).join(""),n=xX(e);return LX(SX(n))}function p0(t){const e=Vg(t.$cstNode,["BLOCK_COMMENT"]);if(!(!e||!dP(e.text)))try{return MX(e.text)}catch(n){const r=IX(t);Ae(n),lt.warn(`Ignoring manual layout of "${t.name??"unnamed"}" at ${r.uri.fsPath}:${1+(e.range.start.line||0)}`);return}}function jX(t){return class extends t{parseDeploymentView(e){const n=e.body;Fe(n,"DynamicElementView body is \
not defined");const r=n.props.filter(this.isValid),i=this.getAstNodePath(e);let s=e.name;s||(s="deployment_"+If(this.doc.uri.toString(),i));const a=ii(r.find(f=>f.key==="title")?.value)??null,o=St(r.find(f=>f.key==="description")?.value)??null,u=this.convertTags(n),c=this.convertLinks(n);pg.writeId(e,s);const l=p0(e);return{__:"deployment",id:s,astPath:i,title:a,description:o,tags:u,links:ur(c)?c:null,rules:n.rules.flatMap(f=>{try{return this.isValid(f)?this.parseDeploymentViewRule(f):[]}catch(d){
return Ae(d),[]}}),...l&&{manualLayout:l}}}parseDeploymentViewRule(e){if(Vo(e))return this.parseDeploymentViewRulePredicate(e);if(Md(e))return Jb(e);if(Kl(e))return this.parseDeploymentViewRuleStyle(e);Ke(e)}parseDeploymentViewRulePredicate(e){const n=[];let r=e.expr;for(;r;){try{const i=r.value;Un(i)&&this.isValid(i)&&n.unshift(this.parseExpressionV2(i))}catch(i){Ae(i)}r=r.prev}return e.isInclude?{include:n}:{exclude:n}}parseDeploymentViewRuleStyle(e){const n=this.parseStyleProps(e.props.filter(
Dw)),r=St(e.props.find(su)?.value);return{targets:this.parseFqnExpressions(e.targets),style:n,...r&&{notation:r}}}}}const fP=({operator:t,not:e},n)=>t.startsWith("!=")?{neq:n}:t.startsWith("=")?{eq:n}:e?{neq:n}:{eq:n};function hP(t){return!b_(t)&&!E_(t)?null:t.participant}function jf(t){switch(!0){case iW(t):{const e=t.value?.ref?.name,n=hP(t);Fe(e,"Expected tag name");const r={tag:fP(t,e)};return n?{participant:n,operator:r}:r}case nW(t):{const e=t.value?.ref?.name,n=hP(t);Fe(e,"Expected kind n\
ame");const r={kind:fP(t,e)};return n?{participant:n,operator:r}:r}case(y_(t)||w_(t)):return{not:jf(t.value)};case wW(t):{const e=jf(t.left),n=jf(t.right),r=t.operator.toLowerCase();switch(r){case"and":{const i=[j0(e)?e.and:e,j0(n)?n.and:n].flat();return Fe(ur(i),"Expected non-empty array"),{and:i}}case"or":{const i=[M0(e)?e.or:e,M0(n)?n.or:n].flat();return Fe(ur(i),"Expected non-empty array"),{or:i}}default:Ke(r)}}default:Ke(t)}}function BX(t){return class extends t{parseFqnRef(e){const n=Vt(e.
value?.ref,`FqnRef is empty ${e.$cstNode?.range.start.line}:${e.$cstNode?.range.start.character}`);if(ss(n)){const r={project:rn(n),model:this.resolveFqn(Vt(n.imported.ref,`FqnRef is empty of imported: ${n.$cstNode?.text}`))};return this.doc.c4Imports.set(r.project,r.model),r}if(_n(n)){const r=xK(e);if(r){const o={project:rn(r),model:this.resolveFqn(n)};return this.doc.c4Imports.set(o.project,o.model),o}const i=AK(e);if(!i)return{model:this.resolveFqn(n)};const s=this.resolveFqn(i),a=this.resolveFqn(
n);return{deployment:s,element:a}}if(Pp(n))return{deployment:this.resolveFqn(n)};Ke(n)}parseExpressionV2(e){if(GC(e))return this.parseFqnExprOrWith(e);if(Yz(e))return this.parseRelationExprOrWith(e);Ke(e)}parseFqnExprOrWith(e){if(hm(e))return this.parseFqnExprWith(e);if(qC(e))return this.parseFqnExprOrWhere(e);Ke(e)}parseFqnExprWith(e){const n=this.parseFqnExprOrWhere(e.subject);return(e.custom?.props??[]).reduce((r,i)=>{if(!this.isValid(i))return r;if(km(i)){const s=i.value.view.$refText;return fe(
s)&&(r.custom.navigateTo=s),r}if(ed(i))return Rn(i.value)&&(r.custom[i.key]=St(i.value)||""),r;if(Ns(i)){const s=this.parseIconProperty(i);return Rn(s)&&(r.custom[i.key]=s),r}if(Wa(i)){const s=Nf(i);return Rn(s)&&(r.custom[i.key]=s),r}if(Sm(i)||Vp(i))return Rn(i.value)&&(r.custom[i.key]=i.value),r;if(Rm(i))return Rn(i.value)&&(r.custom[i.key]=Ix(i)),r;if(su(i))return fe(i.value)&&(r.custom[i.key]=St(i.value)),r;if(jw(i))return Zv(i.value)&&(r.custom[i.key]=i.value),r;if(Uw(i)||Vw(i)||Bw(i))return fe(
i.value)&&(r.custom[i.key]=Tu(i)),r;Ke(i)},{custom:{expr:n}})}parseFqnExprOrWhere(e){if(Ow(e))return this.parseFqnExprWhere(e);if(BC(e))return this.parseFqnExpr(e);Ke(e)}parseFqnExprWhere(e){return Fe(!Ow(e.subject),"FqnExprWhere is not allowed as subject of FqnExprWhere"),{where:{expr:this.parseFqnExpr(e.subject),condition:e.where?jf(e.where):{kind:{neq:"--always-true--"}}}}}parseFqnExpr(e){if(k_(e))return{wildcard:!0};if(n_(e))return Fe(e.kind?.ref,"ElementKindExpr kind is not resolved: "+e.$cstNode?.
text),{elementKind:e.kind.ref.name,isEqual:e.isEqual};if(r_(e)){Fe(e.tag?.ref,"ElementTagExpr tag is not resolved: "+e.$cstNode?.text);let n=e.tag.$refText;return n.startsWith("#")&&(n=n.slice(1)),{elementTag:n,isEqual:e.isEqual}}if(Lw(e))return this.parseFqnRefExpr(e);Ke(e)}parseFqnRefExpr(e){const n=this.parseFqnRef(e.ref);switch(!0){case e.selector==="._":return{ref:n,selector:"expanded"};case e.selector===".**":return{ref:n,selector:"descendants"};case e.selector===".*":return{ref:n,selector:"\
children"};default:return{ref:n}}}parseFqnExpressions(e){const n=[];let r=e;for(;r;){try{Un(r.value)&&this.isValid(r.value)&&n.push(this.parseFqnExpr(r.value))}catch(i){Ae(i)}r=r.prev}return n.reverse()}parseRelationExprOrWith(e){if(Gw(e))return this.parseRelationExprWith(e);if(Xz(e))return this.parseRelationExprOrWhere(e);Ke(e)}parseRelationExprWith(e){const n=this.parseRelationExprOrWhere(e.subject);return(e.custom?.props??[]).reduce((r,i)=>{if(Ad(i)||su(i)||d_(i))return Rn(i.value)&&(r.customRelation[i.
key]=St(i.value)??""),r;if(Gl(i))return fe(i.value)&&(r.customRelation[i.key]=i.value),r;if(Wa(i)){const s=Nf(i);return fe(s)&&(r.customRelation[i.key]=s),r}if(pd(i))return fe(i.value)&&(r.customRelation[i.key]=i.value),r;if(Cd(i)){const s=i.value.view.ref?.name;return fe(s)&&(r.customRelation.navigateTo=s),r}Ke(i)},{customRelation:{expr:n}})}parseRelationExprOrWhere(e){if(qw(e))return this.parseRelationExprWhere(e);if(jp(e))return this.parseRelationExpr(e);Ke(e)}parseRelationExprWhere(e){return Fe(
!qw(e.subject),"RelationExprWhere is not allowed as subject of RelationExprWhere"),{where:{expr:this.parseRelationExpr(e.subject),condition:e.where?jf(e.where):{kind:{neq:"--always-true--"}}}}}parseRelationExpr(e){switch(e.$type){case"DirectedRelationExpr":return{source:this.parseFqnExpr(e.source.from),target:this.parseFqnExpr(e.target),isBidirectional:e.source.isBidirectional};case"InOutRelationExpr":return{inout:this.parseFqnExpr(e.inout.to)};case"OutgoingRelationExpr":return{outgoing:this.parseFqnExpr(
e.from)};case"IncomingRelationExpr":return{incoming:this.parseFqnExpr(e.to)};default:Ke(e)}}}}function qX(t){return class extends t{parseGlobals(){const{parseResult:e,c4Globals:n}=this.doc,r=this.isValid,i=e.value.globals.filter(r),s=i.flatMap(o=>o.predicates.filter(r));for(const o of s)try{const u=o.name;if(!fe(u))continue;if(u in n.predicates){lt.warn(`Global predicate named "${u}" is already defined`);continue}this.parseAndStoreGlobalPredicateGroupOrDynamic(o,u,n)}catch(u){Ae(u)}const a=i.flatMap(
o=>o.styles.filter(r));for(const o of a)try{const u=o.id.name;if(!fe(u))continue;if(u in n.styles){lt.warn(`Global style named "${u}" is already defined`);continue}const c=this.parseGlobalStyleOrGroup(o);c.length>0&&(n.styles[u]=c)}catch(u){Ae(u)}}parseAndStoreGlobalPredicateGroupOrDynamic(e,n,r){if(ud(e)){const i=this.parseGlobalPredicateGroup(e);i.length>0&&(r.predicates[n]=i);return}if(od(e)){const i=this.parseGlobalDynamicPredicateGroup(e);i.length>0&&(r.dynamicPredicates[n]=i);return}Ke(e)}parseGlobalPredicateGroup(e){
return e.predicates.map(n=>this.parseViewRulePredicate(n))}parseGlobalDynamicPredicateGroup(e){return e.predicates.map(n=>this.parseDynamicViewIncludePredicate(n))}parseGlobalStyleOrGroup(e){if(tu(e))return[this.parseViewRuleStyle(e)];if(Za(e))return e.styles.map(n=>this.parseViewRuleStyle(n));Ke(e)}}}function GX(t){return class extends t{parseImports(){const e=this.doc.parseResult.value.imports??[];for(const n of e){const r=n.project;let i=n.imports;for(;i;){try{this.doc.c4Imports.set(r,this.resolveFqn(
Vt(i.imported.ref,`ElementRef is empty of imported: ${i.imported.$refText}`)))}catch(s){Ae(s)}i=i.prev}}}}}const UX=lt.getChild("ModelParser");function*zX(t){const e=F0.from(t.parseResult.value.models.flatMap(i=>i.elements)),n=[];let r;for(;r=e.shift();){if(os(r)){n.push(r);continue}if(r.body&&r.body.elements&&r.body.elements.length>0)for(const i of r.body.elements)e.push(i);yield r}yield*n}function WX(t){return class extends t{parseModel(){const e=this.doc;for(const n of zX(e))try{if(_n(n)){e.c4Elements.
push(this.parseElement(n));continue}if(os(n)){this.isValid(n)&&e.c4Relations.push(this.parseRelation(n));continue}if(Yo(n)){const r=this.parseExtendElement(n);r&&e.c4ExtendElements.push(r);continue}Ke(n)}catch(r){const i=this.getAstNodePath(n),s=Jn(r),a=r instanceof Error?r.message:String(s);UX.warn(`Error on {eltype}: ${a}
 document: {path}
 astpath: {astPath}
${s}`,{path:e.uri.path,eltype:n.$type,astPath:i})}}parseElement(e){const n=this.isValid,r=this.resolveFqn(e),i=Vt(e.kind.ref,"Element kind is not resolved").name,s=this.parseTags(e.body),a=this.parseElementStyle(e.body?.props),o=this.getMetadata(e.body?.props.find(Ps)),u=this.getAstNodePath(e);let[c,l,f]=e.props??[];const d=et(e.body?.props??[],Qe(n),Qe(ed),ki(p=>[p.key,p.value||void 0]));c=St(c??d.title),l=St(d.description??l),f=ii(d.technology??f);const h=this.parseLinks(e.body);return{id:r,kind:i,
astPath:u,title:c??e.name,...o&&{metadata:o},...s&&{tags:s},...h&&ur(h)&&{links:h},...fe(f)&&{technology:f},...fe(l)&&{description:l},style:a}}parseExtendElement(e){const n=this.resolveFqn(e),r=this.parseTags(e.body),i=this.getMetadata(e.body?.props.find(Ps)),s=this.getAstNodePath(e),a=this.parseLinks(e.body)??[];return!r&&tn(i??{})&&tn(a)?null:{id:n,astPath:s,...i&&{metadata:i},...r&&{tags:r},...a&&ur(a)&&{links:a}}}_resolveRelationSource(e){if(Rn(e.source)){const n=this.parseFqnRef(e.source);return Fe(
sa.isModelRef(n)||sa.isImportRef(n),"Relation source must be a model reference"),n}if(!sm(e.$container))throw new Error("RelationRefError: Invalid container for sourceless relation");return{model:this.resolveFqn(e.$container.$container)}}parseRelation(e){const n=this.isValid,r=this._resolveRelationSource(e),i=this.parseFqnRef(e.target);Fe(sa.isModelRef(i)||sa.isImportRef(i),"Target must be a model reference");const s=this.parseTags(e)??this.parseTags(e.body),a=this.parseLinks(e.body),o=e.kind?.ref?.
name,u=this.getMetadata(e.body?.props.find(Ps)),c=this.getAstNodePath(e),l=ki(e.body?.props.filter(Ad).filter(v=>Un(v.value))??[],v=>[v.key,v.value]),f=et(e.body?.props??[],Qe(Cd),Ht(v=>v.value.view.ref?.name),Qe(fe),Go()),d=St(e.title??l.title)??"",h=St(l.description),p=ii(e.technology)??St(l.technology),w=e.body?.props.find(Tm);return{id:If(c,r.model,i.model),astPath:c,source:r,target:i,title:d,...u&&{metadata:u},...fe(p)&&{technology:p},...fe(h)&&{description:h},...o&&{kind:o},...s&&{tags:s},
...ur(a)&&{links:a},...Yb(w?.props,n),...f&&{navigateTo:f}}}}}function HX(t){return class extends t{parsePredicate(e){return this.parseExpressionV2(e)}parseElementPredicate(e){if(hm(e))return this.parseFqnExprWith(e);if(qC(e))return this.parseFqnExprOrWhere(e);Ke(e)}parseElementPredicateOrWhere(e){return this.parseFqnExprOrWhere(e)}parseElementExpression(e){return this.parseFqnExpr(e)}parseElementPredicateWhere(e){return this.parseFqnExprWhere(e)}parseElementPredicateWith(e){return this.parseFqnExprWith(
e)}parseRelationPredicate(e){return this.parseRelationExprOrWith(e)}parseRelationPredicateOrWhere(e){return this.parseRelationExprOrWhere(e)}parseRelationPredicateWhere(e){return this.parseRelationExprWhere(e)}parseRelationPredicateWith(e){return this.parseRelationExprWith(e)}parseRelationExpression(e){return this.parseRelationExpr(e)}}}function VX(t){return class extends t{parseSpecification(){const{parseResult:{value:{specifications:e}},c4Specification:n}=this.doc,r=this.isValid,i=e.flatMap(c=>c.
elements.filter(this.isValid));for(const{kind:c,props:l}of i)try{const f=c.name;if(!fe(f))continue;if(f in n.elements){lt.warn(`Element kind "${f}" is already defined`);continue}const d=this.parseElementStyle(l.find(Zo)),h=et(l.filter(zw)??[],Qe(p=>this.isValid(p)&&Un(p.value)),ki(p=>[p.key,St(p.value)]));n.elements[f]={...h,style:d}}catch(f){Ae(f)}const s=e.flatMap(c=>c.relationships.filter(this.isValid));for(const{kind:c,props:l}of s)try{const f=c.name;if(!fe(f))continue;if(f in n.relationships){
lt.warn(`Relationship kind "${f}" is already defined`);continue}const d=et(l.filter(h_)??[],Qe(h=>this.isValid(h)&&Un(h.value)),ki(h=>[h.key,St(h.value)]));n.relationships[f]={...d,...Yb(l,this.isValid)}}catch(f){Ae(f)}const a=e.flatMap(c=>c.tags.filter(this.isValid));for(const c of a){const l=c.tag.name;fe(l)&&n.tags.add(l)}const o=e.flatMap(c=>c.deploymentNodes.filter(r));for(const c of o)try{Object.assign(n.deployments,this.parseSpecificationDeploymentNodeKind(c))}catch(l){Ae(l)}const u=e.flatMap(
c=>c.colors.filter(r));for(const{name:c,color:l}of u)try{const f=c.name;if(f in n.colors){lt.warn(`Custom color "${f}" is already defined`);continue}n.colors[f]={color:l}}catch(f){Ae(f)}}parseSpecificationDeploymentNodeKind({kind:e,props:n}){const r=e.name;if(!fe(r))throw new Error("DeploymentNodeKind name is not resolved");const i=this.parseElementStyle(n.find(Zo)),s=et(n.filter(zw)??[],Qe(a=>this.isValid(a)&&Un(a.value)),ki(a=>[a.key,St(a.value)]));return{[r]:{...s,style:i}}}}}function KX(t){return class extends t{parseViews(){
const e=this.isValid;for(const n of this.doc.parseResult.value.views){const r=n.styles.flatMap(i=>{try{return e(i)?this.parseViewRuleStyleOrGlobalRef(i):[]}catch(s){return Ae(s),[]}});for(const i of n.views)try{if(!e(i))continue;switch(!0){case om(i):this.doc.c4Views.push(this.parseElementView(i,r));break;case YC(i):this.doc.c4Views.push(this.parseDynamicElementView(i,r));break;case XC(i):this.doc.c4Views.push(this.parseDeploymentView(i));break;default:Ke(i)}}catch(s){Ae(s)}}}parseElementView(e,n){
const r=e.body;Fe(r,"ElementView body is not defined");const i=this.getAstNodePath(e);let s=null;if("viewOf"in e){const h=ao(e.viewOf),p=h&&this.resolveFqn(h);p?s=p:lt.warn("viewOf is not resolved: "+e.$cstNode?.text)}let a=e.name;a||(a="view_"+If(this.doc.uri.toString(),i,s??""));const o=ii(r.props.find(h=>h.key==="title")?.value)??null,u=St(r.props.find(h=>h.key==="description")?.value)??null,c=this.convertTags(r),l=this.convertLinks(r),f=p0(e),d={__:"element",id:a,astPath:i,title:o,description:u,
tags:c,links:ur(l)?l:null,rules:[...n,...r.rules.flatMap(h=>{try{return this.isValid(h)?this.parseViewRule(h):[]}catch(p){return Ae(p),[]}})],...s&&{viewOf:s},...f&&{manualLayout:f}};if(pg.writeId(e,d.id),"extends"in e){const h=e.extends.view.ref;return Fe(h?.name,"view extends is not resolved: "+e.$cstNode?.text),Object.assign(d,{extends:h.name})}return d}parseViewRule(e){if(Ud(e))return this.parseViewRulePredicate(e);if(Zw(e))return this.parseViewRuleGlobalPredicateRef(e);if(Tw(e))return this.
parseViewRuleStyleOrGlobalRef(e);if(Md(e))return Jb(e);if(Im(e))return this.parseViewRuleGroup(e);Ke(e)}parseViewRulePredicate(e){const n=[];let r=e.exprs;for(;r;){const{value:i,prev:s}=r;try{if(fe(i)&&this.isValid(i)){const a=this.parsePredicate(i);n.unshift(a)}}catch(a){Ae(a)}if(!s)break;r=s}return e.isInclude?{include:n}:{exclude:n}}parseViewRuleGlobalPredicateRef(e){return{predicateId:e.predicate.$refText}}parseViewRuleStyleOrGlobalRef(e){if(pu(e))return this.parseViewRuleStyle(e);if(Xw(e))return this.
parseViewRuleGlobalStyle(e);Ke(e)}parseViewRuleGroup(e){const n=[];for(const r of e.groupRules)try{if(!this.isValid(r))continue;if(Ud(r)){n.push(this.parseViewRulePredicate(r));continue}if(Im(r)){n.push(this.parseViewRuleGroup(r));continue}Ke(r)}catch(i){Ae(i)}return{title:ii(e.title)??null,groupRules:n,...this.parseStyleProps(e.props)}}parseViewRuleStyle(e){const n=e.props.filter(Dw),r=e.targets,i=e.props.find(su);return this.parseRuleStyle(n,r,i)}parseRuleStyle(e,n,r){const i=this.parseStyleProps(
e),s=St(r?.value);return{targets:this.parseFqnExpressions(n).filter(a=>_1.Expression.isFqnExpr(a)),...s&&{notation:s},style:{...i}}}parseViewRuleGlobalStyle(e){return{styleId:e.style.$refText}}parseDynamicElementView(e,n){const r=e.body;Fe(r,"DynamicElementView body is not defined");const i=this.isValid,s=r.props.filter(i),a=this.getAstNodePath(e);let o=e.name;o||(o="dynamic_"+If(this.doc.uri.toString(),a));const u=ii(s.find(h=>h.key==="title")?.value)??null,c=St(s.find(h=>h.key==="description")?.
value)??null,l=this.convertTags(r),f=this.convertLinks(r);pg.writeId(e,o);const d=p0(e);return{__:"dynamic",id:o,astPath:a,title:u,description:c,tags:l,links:ur(f)?f:null,rules:[...n,...r.rules.flatMap(h=>{try{return i(h)?this.parseDynamicViewRule(h):[]}catch(p){return Ae(p),[]}},[])],steps:r.steps.reduce((h,p)=>{try{i(p)&&(Cw(p)?h.push(this.parseDynamicParallelSteps(p)):h.push(this.parseDynamicStep(p)))}catch(w){Ae(w)}return h},[]),...d&&{manualLayout:d}}}parseDynamicViewRule(e){if(e_(e))return this.
parseDynamicViewIncludePredicate(e);if(QC(e))return this.parseViewRuleGlobalPredicateRef(e);if(Tw(e))return this.parseViewRuleStyleOrGlobalRef(e);if(Md(e))return Jb(e);Ke(e)}parseDynamicViewIncludePredicate(e){const n=[];let r=e.exprs;for(;r;){try{if(Un(r.value)&&this.isValid(r.value)&&GC(r.value)){const i=this.parseElementPredicate(r.value);n.unshift(i)}}catch(i){Ae(i)}r=r.prev}return{include:n}}parseDynamicParallelSteps(e){return{__parallel:e.steps.map(n=>this.parseDynamicStep(n))}}parseDynamicStep(e){
const n=ao(e.source);if(!n)throw new Error("Invalid reference to source");const r=ao(e.target);if(!r)throw new Error("Invalid reference to target");let i=this.resolveFqn(n),s=this.resolveFqn(r);const a=St(e.title)??null;let o={source:i,target:s,title:a};if(e.isBackward&&(o={source:s,target:i,title:a,isBackward:!0}),!$T(e.custom?.props))return o;for(const u of e.custom.props)try{switch(!0){case Cd(u):{const c=u.value.view.ref?.name;fe(c)&&(o.navigateTo=c);break}case Ad(u):case su(u):case d_(u):{Rn(
u.value)&&(o[u.key]=St(u.value)??"");break}case Gl(u):{Rn(u.value)&&(o[u.key]=u.value);break}case Wa(u):{const c=Nf(u);Rn(c)&&(o[u.key]=c);break}case pd(u):{Rn(u.value)&&(o[u.key]=u.value);break}default:Ke(u)}}catch(c){Ae(c)}return o}}}const ZX=et(kZ,BX,GX,WX,VZ,jX,HX,VX,KX,qX);class XX extends ZX{}const pP=lt.getChild("ModelParser");class YX{constructor(e){this.services=e,e.shared.workspace.DocumentBuilder.onDocumentPhase(Ze.Linked,n=>{try{nf(n.uri)||this.cachedParsers.set(n,this.createParser(n))}catch(r){
pP.warn(Jn(r))}}),e.shared.workspace.DocumentBuilder.onDocumentPhase(Ze.Validated,n=>{n.diagnostics?.some(r=>r.severity===wa.Error)&&this.cachedParsers.delete(n)})}cachedParsers=new q0(e=>this.createParser(e));documents(e){return this.services.shared.workspace.LangiumDocuments.projectDocuments(e).map(n=>this.parse(n))}parse(e){try{return this.forDocument(e).doc}catch(n){throw new Error(`Error parsing document ${e.uri.toString()}`,{cause:n})}}forDocument(e){return e.state<Ze.Linked&&pP.warn(`Docu\
ment ${e.uri.toString()} is not linked`),this.cachedParsers.get(e)}createParser(e){const n={c4Specification:{tags:new Set,elements:{},relationships:{},colors:{},deployments:{}},c4Elements:[],c4ExtendElements:[],c4ExtendDeployments:[],c4Relations:[],c4Deployments:[],c4DeploymentRelations:[],c4Globals:{predicates:{},dynamicPredicates:{},styles:{}},c4Views:[],c4Imports:new Yn(Set)};e=Object.assign(e,n);const r=new XX(this.services,e);return r.parseSpecification(),r.parseImports(),r.parseModel(),r.parseGlobals(),
r.parseDeployment(),r.parseViews(),r}}const{findNodeForKeyword:JX}=by,QX=(t,e,n=0)=>{const r=n>0?" ".repeat(n):"";return[r+`style ${t} {`,...Yc(e).map(([i,s])=>r+`  ${i} ${i==="opacity"?s.toString()+"%":s}`),r+"}"]},eY=(t,e)=>n=>{if(!pu(n)&&!Kl(n))return!1;const r=n.targets.value;if(!r||fe(n.targets.prev)||r.$type!=="FqnRefExpr"||fe(r.selector))return!1;const i=r.ref?.value?.ref;return(i?e.resolve(i):null)===t};function tY(t,{view:e,viewAst:n,targets:r,style:i}){Fe(n.body,`View ${e.id} has no bo\
dy`);const s=n.$cstNode;Fe(s,"viewCstNode");const a=Zc(n.body.rules)?.$cstNode?.range.end??n.body.$cstNode?.range.end;Fe(a,"insertPos is not defined");const o=s.range.start.character+2,u=t.likec4.FqnIndex,c=Qe(n.body.rules,v=>pu(v)||Kl(v)),l=e.__==="element"?e.viewOf:null,f=[],d=[];r.forEach(v=>{const g=CT(c,eY(v,u)),b=l&&Dg(l,v)?v.substring(l.length+1):v;g?f.push({fqn:b,rule:g}):d.push({fqn:b})});const h={start:a,end:a},p=v=>{v.start.line<=h.start.line&&(v.start.line==h.start.line?h.start.character=
Math.min(v.start.character,h.start.character):h.start=v.start),v.end.line>=h.end.line&&(v.end.line==h.end.line?h.end.character=Math.max(v.end.character,h.end.character):h.end=v.end)},w=[];if(d.length>0){const v=d.flatMap(({fqn:g})=>QX(g,i,o));w.push(sr.insert(a,`
`+v.join(`
`))),h.start={line:a.line+1,character:o},h.end={line:a.line+v.length,character:Zc(v)?.length??0}}if(f.length>0)for(const{rule:v}of f){const g=v.$cstNode;Fe(g,"RuleCstNode not found");for(const[b,k]of Yc(i)){const _=b==="opacity"?k.toString()+"%":k,I=v.props.find(ae=>ae.key===b);if(I&&I.$cstNode){const{range:{start:ae,end:$e}}=I.$cstNode;p({start:ae,end:$e}),w.push(sr.replace({start:ae,end:$e},b+" "+_));continue}const Z=JX(g,"{")?.range.end;Fe(Z,"Opening brace not found");const J=" ".repeat(2+g.range.
start.character),ue=J+b+" "+_;w.push(sr.insert(Z,`
`+ue)),p({start:{line:Z.line+1,character:J.length},end:{line:Z.line+1,character:ue.length}})}}return{modifiedRange:h,edits:w}}const{findNodeForKeyword:nY}=by;function rY(t,{view:e,viewAst:n,layout:r}){Fe(n.body,`View ${e.id} has no body`);const i=n.$cstNode;Fe(i,"viewCstNode");const s=mK(r.direction),a=CT(n.body.rules,Md);let o=`autoLayout ${s}`;if($p(r.rankSep)&&(o+=` ${r.rankSep}`,$p(r.nodeSep)&&(o+=` ${r.nodeSep}`)),a&&a.$cstNode)return sr.replace(a.$cstNode.range,o);const u=nY(n.body.$cstNode,
"}")?.range.start;Fe(u,"Closing brace not found");const c=`	${o}
	`;return sr.insert(u,c)}function iY(t,e=1,n={}){const{indent:r=" ",includeEmptyLines:i=!1}=n;if(typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(e<0)throw new RangeError(`Expected \`count\` to be at least 0, got \`${e}\``);if(typeof r!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r}\``);if(e===
0)return t;const s=i?/^/gm:/^(?!\s*$)/gm;return t.replace(s,r.repeat(e))}function sY(t,{viewAst:e,layout:n}){Fe(e.$cstNode,"invalid view.$cstNode");const r=Vg(e.$cstNode,["BLOCK_COMMENT"]);let i=FX(n);return e.$cstNode.range.start.character>0&&(i=iY(i,e.$cstNode.range.start.character)),r?sr.replace(r.range,i.trimStart()):sr.insert({line:e.$cstNode.range.start.line,character:0},i+`
`)}class aY{constructor(e){this.services=e,this.locator=e.likec4.ModelLocator}locator;async applyChange(e){const n=this.services.shared.lsp.Connection;Fe(n,"LSP Connection not available");let r=null;try{await this.services.shared.workspace.WorkspaceLock.write(async()=>{const{doc:i,edits:s,modifiedRange:a}=this.convertToTextEdit(e),o={uri:i.textDocument.uri,version:i.textDocument.version};if(!s.length)return;const u=await n.workspace.applyEdit({label:`LikeC4 - change view ${e.viewId}`,edit:{changes:{
[o.uri]:s}}});if(!u.applied){n.window.showErrorMessage(`Failed to apply changes ${u.failureReason}`);return}r={uri:o.uri,range:a}})}catch(i){Fn.error(`Failed to apply change ${e.change.op} ${e.viewId}`,{error:i})}return r}convertToTextEdit({viewId:e,projectId:n,change:r}){const i=this.locator.locateViewAst(e,n);if(!i)throw new Error(`LikeC4ModelChanges: view not found: ${e}`);switch(r.op){case"change-element-style":return{doc:i.doc,...tY(this.services,{...i,targets:r.targets,style:r.style})};case"\
change-autolayout":{const a=rY(this.services,{...i,layout:r.layout});return{doc:i.doc,modifiedRange:a.range,edits:[a]}}case"save-manual-layout":const s=sY(this.services,{...i,layout:r.layout});return{doc:i.doc,modifiedRange:s.range,edits:[s]};default:Ke(r)}}}class oY extends HD{constructor(e){super(),this.services=e}getNameStrict(e){return Vt(this.getName(e),`Failed getName for ${this.services.workspace.AstNodeLocator.getAstNodePath(e)}`)}getName(e){if(yp(e))return e.name;if(ss(e))return e.imported.
$refText;if(yr(e))return e.target.modelElement.value.$refText}getNameNode(e){if(yp(e))return super.getNameNode(e);if(ss(e))return e.imported.$refNode;if(yr(e))return e.target.modelElement.value.$refNode}}function uY(t){return et(t,qo(e=>`${e.type}.${e.name}`),Yc(),Wr(([e,n])=>n.length===1?n:[]))}class cY extends KD{constructor(e){super(e)}async computeExports(e,n){const r=[];try{const{specifications:i,models:s,views:a,globals:o,likec4lib:u,deployments:c,imports:l}=e.parseResult.value;this.exportLibrary(
u,r,e),this.exportSpecification(i,r,e),this.exportModel(s,r,e),this.exportViews(a,r,e),this.exportGlobals(o,r,e),this.exportDeployments(c,r,e)}catch(i){Ae(i)}return r}exportViews(e,n,r){const i=e?.flatMap(s=>s.views);if(!(Ft(i)||i.length===0))for(const s of i)try{fe(s.name)&&n.push(this.descriptions.createDescription(s,s.name,r))}catch(a){Ae(a)}}exportGlobals(e,n,r){if(!(Ft(e)||e.length===0)){for(const i of e.flatMap(s=>s.predicates))try{const s=i;fe(s.name)&&n.push(this.descriptions.createDescription(
s,s.name,r))}catch(s){Ae(s)}for(const i of e.flatMap(s=>s.styles))try{const s=i.id;fe(s.name)&&n.push(this.descriptions.createDescription(s,s.name,r))}catch(s){Ae(s)}}}exportModel(e,n,r){if(!(Ft(e)||e.length===0))for(const i of e.flatMap(s=>s.elements))try{_n(i)&&fe(i.name)&&n.push(this.descriptions.createDescription(i,i.name,r))}catch(s){Ae(s)}}exportLibrary(e,n,r){if(!Ft(e))try{for(const i of e.flatMap(s=>s.icons))n.push(this.descriptions.createDescription(i,i.name,r))}catch(i){Ae(i)}}exportSpecification(e,n,r){
if(!(Ft(e)||e.length===0))for(const i of e.flatMap(s=>[...s.elements,...s.relationships,...s.deploymentNodes,...s.tags,...s.colors]))try{switch(!0){case ou(i):case cu(i):{fe(i.kind.name)&&n.push(this.descriptions.createDescription(i.kind,i.kind.name,r));continue}case Am(i):{fe(i.tag.name)&&n.push(this.descriptions.createDescription(i.tag,"#"+i.tag.name,r));continue}case du(i):{fe(i.kind.name)&&n.push(this.descriptions.createDescription(i.kind,i.kind.name,r),this.descriptions.createDescription(i.
kind,"."+i.kind.name,r));continue}case _m(i):{fe(i.name.name)&&n.push(this.descriptions.createDescription(i.name,i.name.name,r));continue}default:Ke(i)}}catch(s){Ae(s)}}exportDeployments(e,n,r){const i=e?.flatMap(s=>s.elements);if(!(Ft(i)||i.length===0))for(const s of i)try{ar(s)&&fe(s.name)&&n.push(this.descriptions.createDescription(s,s.name,r))}catch(a){Ae(a)}}computeLocalScopes(e,n){return new Promise(r=>{const i=e.parseResult.value,s=[],a=new $a;for(const o of i.models)try{s.push(...this.processContainer(
o,a,e))}catch(u){Ae(u)}for(const o of i.deployments)try{s.push(...this.processDeployments(o,a,e))}catch(u){Ae(u)}for(const o of i.imports.flatMap(u=>u.imports))try{let u=o;for(;u;)s.push(this.descriptions.createDescription(u,u.imported.$refText,e)),u=u.prev}catch(u){Ae(u)}uY(s).forEach(o=>{a.add(i,o)}),r(a)})}processContainer(e,n,r){const i=new $a,s=[];for(const o of e.elements){if(os(o))continue;let u;if(_n(o)?(fe(o.name)&&i.add(o.name,this.descriptions.createDescription(o,o.name,r)),u=o.body,u&&
(n.add(u,this.descriptions.createDescription(o,"this",r)),n.add(u,this.descriptions.createDescription(o,"it",r)))):Yo(o)&&(u=o.body),u&&u.elements.length>0)try{s.push(...this.processContainer(u,n,r))}catch(c){Ae(c)}}s.length&&et(s,Qe(o=>!i.has(o.name)),qo(o=>o.name),DT((o,u)=>{o.length===1&&i.add(u,o[0])}));const a=[...i.values()];return n.addAll(e,a),a}processDeployments(e,n,r){const i=new $a,s=[];for(const o of e.elements){if(Ri(o))continue;let u=o.body;if(!Va(o)){let c=this.nameProvider.getName(
o);if(fe(c)){const l=this.descriptions.createDescription(o,c,r);i.add(c,l)}u&&(n.add(u,this.descriptions.createDescription(o,"this",r)),n.add(u,this.descriptions.createDescription(o,"it",r)))}if(u)try{s.push(...this.processDeployments(u,n,r))}catch(c){Ae(c)}}s.length&&et(s,Qe(o=>!i.has(o.name)),qo(o=>o.name),DT((o,u)=>{o.length===1&&i.add(u,o[0])}));const a=[...i.values()];return n.addAll(e,a),a}}const{getDocument:mP}=Eo;class lY extends YD{deploymentsIndex;fqnIndex;indexManager;constructor(e){super(
e),this.indexManager=e.shared.workspace.IndexManager,this.fqnIndex=e.likec4.FqnIndex,this.deploymentsIndex=e.likec4.DeploymentsIndex}getScope(e){try{const n=rn(e.container),r=this.reflection.getReferenceType(e);try{const i=e.container;if(a_(i))return new Da(this.streamForFqnRef(n,i,e));if(m_(i))return this.getScopeForStrictFqnRef(n,i,e);if(r!==vr)return this.getProjectScope(n,r,e);if(ss(i)){const s=rn(i);return new Da(this.fqnIndex.rootElements(s))}if(Ww(i)&&e.property==="el"){const s=i.parent;return s?
new Da(this.fqnIndex.directChildrenOf(n,oo(s))):this.getProjectScope(n,r,e)}return new Da(rt(this.computeScope(n,e)))}catch(i){return Ae(i),this.getProjectScope(n,r,e)}}catch(n){return Ae(n),sG}}*genUniqueDescedants(e){const n=e();if(!n)return;const r=rn(n);if(_n(n)){const i=this.fqnIndex.getFqn(n);yield*this.fqnIndex.uniqueDescedants(r,i);return}if(ar(n)){const i=this.deploymentsIndex.getFqn(n);yield*this.deploymentsIndex.uniqueDescedants(r,i)}}*genScopeExtendElement({element:e}){e.el.$nodeDescription&&
(yield e.el.$nodeDescription),yield*this.genUniqueDescedants(()=>ao(e))}*genScopeElementView({viewOf:e,extends:n}){if(e){e.modelElement.value.$nodeDescription&&(yield e.modelElement.value.$nodeDescription),yield*this.genUniqueDescedants(()=>ao(e));return}if(n){const r=n.view.ref;r&&(yield*this.genScopeElementView(r))}}getScopeForStrictFqnRef(e,n,r){const i=n.parent;return i?new Da(this.deploymentsIndex.directChildrenOf(e,oo(i)).filter(s=>this.reflection.isSubtype(s.type,Vr))):this.getProjectScope(
e,Vr,r)}*genScopeExtendDeployment({deploymentNode:e}){e.value.$nodeDescription&&(yield e.value.$nodeDescription),yield*this.genUniqueDescedants(()=>{const n=e.value.ref;return n&&ar(n)?n:void 0})}streamForFqnRef(e,n,r){const i=n.parent;if(!i)return rt(this.genScopeForParentlessFqnRef(e,n,r));const s=i.value.ref;return s?ss(s)?rt(this.genUniqueDescedants(()=>s.imported.ref)):ar(s)?rt(this.genUniqueDescedants(()=>s)):yr(s)?rt(this.genUniqueDescedants(()=>{const a=s.target.modelElement.value.ref;return ss(
a)?a.imported.ref:_n(a)?a:void 0})):_n(s)?rt(this.genUniqueDescedants(()=>s)):Ke(s):Mu}*genScopeForParentlessFqnRef(e,n,r){mi(n,xw)||yK(n)?yield*this.computeScope(e,r,vr):gK(n)?(yield*this.computeScope(e,r,vr),yield*this.computeScope(e,r,Vr),yield*this.computeScope(e,r,ns)):(yield*this.computeScope(e,r,Vr),yield*this.computeScope(e,r,ns),mi(n,Sw)&&(yield*this.computeScope(e,r,vr)));const i=mP(n).precomputedScopes;i&&(yield*i.values().filter(s=>this.reflection.isSubtype(s.type,Is)))}*computeScope(e,n,r=this.
reflection.getReferenceType(n)){const i=this.reflection.isSubtype(r,vr),s=this.reflection.isSubtype(r,xp),a=mP(n.container).precomputedScopes;if(!a){yield*this.getProjectScope(e,r,n).getAllElements();return}const o=c=>this.reflection.isSubtype(c.type,r);let u=n.container;for(;u;){const c=a.get(u).filter(o);c.length>0&&(yield*c),s&&s_(u)&&(yield*this.genScopeExtendDeployment(u.$container)),i&&Iw(u)&&(yield*this.genScopeExtendElement(u.$container)),i&&Pw(u)&&(yield*this.genScopeElementView(u.$container)),
u=u.$container}yield*this.getProjectScope(e,r,n).getAllElements()}getProjectScope(e,n,r){return n===as?super.getGlobalScope(n,r):this.globalScopeCache.get(`${e}::${n}`,()=>new ZD(this.indexManager.projectElements(e,n)))}getGlobalScope(e,n){if(e===as)return super.getGlobalScope(e,n);const r=rn(n.container);return this.getProjectScope(r,e,n)}}var gP;(t=>t.type=new Jt.NotificationType("likec4/onDidChangeModel"))(gP||={});var yP;(t=>t.req=new Jt.RequestType("likec4/fetchComputedModel"))(yP||={});var vP;
(t=>t.req=new Jt.RequestType0("likec4/fetchViewsFromAllProjects"))(vP||={});var wP;(t=>t.req=new Jt.RequestType("likec4/computeView"))(wP||={});var bP;(t=>t.req=new Jt.RequestType("likec4/fetchLayoutedModel"))(bP||={});var EP;(t=>t.req=new Jt.RequestType("likec4/layout-view"))(EP||={});var kP;(t=>t.Req=new Jt.RequestType("likec4/validate-layout"))(kP||={});var RP;(t=>t.req=new Jt.RequestType0("likec4/fetch-projects"))(RP||={});var $P;(t=>t.Req=new Jt.RequestType("likec4/build"))($P||={});var DP;
(t=>t.Req=new Jt.RequestType("likec4/locate"))(DP||={});var TP;(t=>t.Req=new Jt.RequestType("likec4/change-view"))(TP||={});var SP;(t=>t.req=new Jt.RequestType0("likec4/metrics"))(SP||={});const Lr=lt.getChild("rpc");class dY extends n0{constructor(e){super(),this.services=e}init(){const e=this.services.likec4.ModelBuilder,n=this.services.likec4.ModelLocator,r=this.services.likec4.ModelChanges,i=this.services.likec4.Views,s=this.services.shared.lsp.Connection,a=this.services.shared.workspace.ProjectsManager;
if(!s){Lr.info("[ServerRpc] no connection, not initializing");return}Lr.info("[ServerRpc] init");const o=this.services.shared.workspace.LangiumDocuments,u=this.services.shared.workspace.DocumentBuilder,c=RU(()=>{Lr.debug`sendNotification ${"onDidChangeModel"}`,s.sendNotification(gP.type,"").catch(d=>(Lr.warn(`[ServerRpc] error sending onDidChangeModel: ${d}`),Promise.resolve()))},{triggerAt:"end",minQuietPeriodMs:100,maxBurstDurationMs:500,minGapMs:300});let l=!0;this.onDispose(e.onModelParsed(()=>c.
call()),s.onRequest(yP.req,async({projectId:d,cleanCaches:h},p)=>{if(Lr.debug`received request ${"fetchComputedModel"} for project ${d}`,h){const v=(d?o.projectDocuments(d):o.all).map(g=>g.uri).toArray();await u.update(v,[],p)}const w=await e.buildLikeC4Model(d,p);return w!==ia.EMPTY?{model:w.$model}:{model:null}}),s.onRequest(wP.req,async({viewId:d,projectId:h},p)=>({view:await e.computeView(d,h,p)})),s.onRequest(bP.req,async({projectId:d},h)=>{const p=await e.parseModel(d,h);if(p===null)return{
model:null};const w=await i.diagrams(d,h);return{model:{...p,__:"layouted",views:Xc(w,v=>v.id)}}}),s.onRequest(EP.req,async({viewId:d,projectId:h},p)=>(Lr.debug`received request ${"layoutView"} of ${d} from project ${h}`,{result:await i.layoutView(d,h,p)})),s.onRequest(kP.Req,async({projectId:d},h)=>{const p=await i.layoutAllViews(d,h);return{result:f(p.map(w=>w.diagram))}}),s.onRequest(RP.req,async d=>{Lr.debug`received request ${"FetchProjects"}`;const h=o.groupedByProject();return{projects:Bo(
h,p=>Ht(p,w=>w.uri.toString()))}}),s.onRequest(vP.req,async d=>{Lr.debug`received request ${"FetchViewsFromAllProjects"}`;const h=a.all.map(async w=>{const v=await i.computedViews(w,d);return et(v,Ht(g=>({id:g.id,title:g.title??g.id,projectId:w})),RT((g,b)=>g.id==="index"?-1:b.id==="index"?1:g.title.localeCompare(b.title)))}),p=await Promise.allSettled(h);return await en(d),{views:et(p,Qe(w=>w.status==="fulfilled"),Wr(w=>w.value))}}),s.onRequest($P.Req,async({docs:d},h)=>{const p=d.map(g=>_t.parse(
g)),w=g=>p.every(b=>!Tt.equals(b,g)),v=o.allExcludingBuiltin.toArray().filter(g=>w(g.uri)).map(g=>g.uri);Lr.debug(`[ServerRpc] received request to build:
  changed (total ${p.length}):${d.map(g=>`
    - `+g).join("")}
  deleted (total ${v.length}):${v.map(g=>`
    - `+g.toString()).join(`
`)}`),!l&&p.length+v.length>0&&await Promise.allSettled([...p,...v].map(async g=>{const b=g.toString();Lr.debug(`clear diagnostics for ${b}`);try{await s.sendDiagnostics({uri:b,diagnostics:[]})}catch(k){Lr.warn(`error clearing diagnostics for ${b}: ${k}`)}})),l=!1,await en(h),await u.update(p,v,h)}),s.onRequest(DP.Req,d=>{switch(!0){case"element"in d:return n.locateElement(d.element,d.projectId);case"relation"in d:return n.locateRelation(d.relation,d.projectId);case"view"in d:return n.locateView(
d.view,d.projectId);case"deployment"in d:return n.locateDeploymentElement(d.deployment,d.projectId);default:Ke(d)}}),s.onRequest(TP.Req,async(d,h)=>(Lr.debug`received request ${"changeView"} of ${d.viewId} from project ${d.projectId}`,await r.applyChange(d))),s.onRequest(SP.req,async d=>{const h=[...a.all].map(async v=>{const g=await e.buildLikeC4Model(v,d);return g===ia.EMPTY?Promise.reject(new Error("Model is empty")):{elementKinds:Kc(g.$model.specification.elements).length,relationshipKinds:Kc(
g.$model.specification.relationships).length,tags:g.$model.specification.tags.length,elements:Kc(g.$model.elements).length,relationships:Kc(g.$model.relations).length,views:Kc(g.$model.views).length,projects:1}}),p=await Promise.allSettled(h);await en(d);const w=p.filter(v=>v.status==="fulfilled").map(v=>v.value);return{metrics:w.length>0?w.reduce((v,g)=>({elementKinds:v.elementKinds+g.elementKinds,relationshipKinds:v.relationshipKinds+g.relationshipKinds,tags:v.tags+g.tags,elements:v.elements+g.
elements,relationships:v.relationships+g.relationships,views:v.views+g.views,projects:v.projects+1})):null}}),Ta.create(()=>{c.cancel()}));function f(d){return et(d,Qe(h=>!!h.hasLayoutDrift),Ht(h=>({uri:n.locateView(h.id).uri,viewId:h.id,severity:Ee.DiagnosticSeverity.Warning,message:`Layout drift detected for view '${h.id}'`,range:n.locateView(h.id).range})))}}}class fY{constructor(e){this.services=e}getSymbolKind(e){const n=Mt(e)?e.$type:e.type,r=(...i)=>i.some(s=>this.services.AstReflection.isSubtype(
n,s));switch(!0){case r(vr,Ka,Vr,ns,Is):return Ur.Constructor;case r(nu,iu,ru,eu,fu):return Ur.Namespace;case r(za):return Ur.Class;case r(Ls,as,Ha,hu):return Ur.EnumMember;case r(Os,lu):return Ur.Event;case r(is,rs,uu,au):return Ur.TypeParameter}return Ur.Field}getCompletionItemKind(e){const n=Mt(e)?e.$type:e.type,r=(...i)=>i.some(s=>this.services.AstReflection.isSubtype(n,s));switch(!0){case r(Ha):return Bt.Color;case r(vr,Vr,ns,Ka,Is):return Bt.Constructor;case r(nu,iu,ru,eu,fu):return Bt.Module;case r(
za):return Bt.Class;case r(Ls,as,Ha,hu):return Bt.EnumMember;case r(Os,lu):return Bt.Event;case r(is,uu,rs,au):return Bt.TypeParameter;default:return Bt.Reference}}}class hY extends cC{}var m0={exports:{}},CP;function pY(){return CP||(CP=1,function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(u,c,l){this.fn=u,this.context=c,this.once=l||!1}function s(u,c,l,f,d){if(typeof l!="function")throw new TypeError(
"The listener must be a function");var h=new i(l,f||u,d),p=n?n+c:c;return u._events[p]?u._events[p].fn?u._events[p]=[u._events[p],h]:u._events[p].push(h):(u._events[p]=h,u._eventsCount++),u}function a(u,c){--u._eventsCount===0?u._events=new r:delete u._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],l,f;if(this._eventsCount===0)return c;for(f in l=this._events)e.call(l,f)&&c.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(
Object.getOwnPropertySymbols(l)):c},o.prototype.listeners=function(c){var l=n?n+c:c,f=this._events[l];if(!f)return[];if(f.fn)return[f.fn];for(var d=0,h=f.length,p=new Array(h);d<h;d++)p[d]=f[d].fn;return p},o.prototype.listenerCount=function(c){var l=n?n+c:c,f=this._events[l];return f?f.fn?1:f.length:0},o.prototype.emit=function(c,l,f,d,h,p){var w=n?n+c:c;if(!this._events[w])return!1;var v=this._events[w],g=arguments.length,b,k;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),g){case 1:
return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,l),!0;case 3:return v.fn.call(v.context,l,f),!0;case 4:return v.fn.call(v.context,l,f,d),!0;case 5:return v.fn.call(v.context,l,f,d,h),!0;case 6:return v.fn.call(v.context,l,f,d,h,p),!0}for(k=1,b=new Array(g-1);k<g;k++)b[k-1]=arguments[k];v.fn.apply(v.context,b)}else{var _=v.length,I;for(k=0;k<_;k++)switch(v[k].once&&this.removeListener(c,v[k].fn,void 0,!0),g){case 1:v[k].fn.call(v[k].context);break;case 2:v[k].fn.call(v[k].context,
l);break;case 3:v[k].fn.call(v[k].context,l,f);break;case 4:v[k].fn.call(v[k].context,l,f,d);break;default:if(!b)for(I=1,b=new Array(g-1);I<g;I++)b[I-1]=arguments[I];v[k].fn.apply(v[k].context,b)}}return!0},o.prototype.on=function(c,l,f){return s(this,c,l,f,!1)},o.prototype.once=function(c,l,f){return s(this,c,l,f,!0)},o.prototype.removeListener=function(c,l,f,d){var h=n?n+c:c;if(!this._events[h])return this;if(!l)return a(this,h),this;var p=this._events[h];if(p.fn)p.fn===l&&(!d||p.once)&&(!f||p.
context===f)&&a(this,h);else{for(var w=0,v=[],g=p.length;w<g;w++)(p[w].fn!==l||d&&!p[w].once||f&&p[w].context!==f)&&v.push(p[w]);v.length?this._events[h]=v.length===1?v[0]:v:a(this,h)}return this},o.prototype.removeAllListeners=function(c){var l;return c?(l=n?n+c:c,this._events[l]&&a(this,l)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o}(m0)),m0.exports}var mY=pY();const gY=fi(
mY);class _P extends Error{constructor(e){super(e),this.name="TimeoutError"}}class yY extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const AP=t=>globalThis.DOMException===void 0?new yY(t):new DOMException(t),xP=t=>{const e=t.reason===void 0?AP("This operation was aborted."):t.reason;return e instanceof Error?e:AP(e)};function vY(t,e){const{milliseconds:n,fallback:r,message:i,customTimers:s={setTimeout,clearTimeout}}=e;let a,o;const c=new Promise((l,f)=>{if(typeof n!=
"number"||Math.sign(n)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${n}\``);if(e.signal){const{signal:h}=e;h.aborted&&f(xP(h)),o=()=>{f(xP(h))},h.addEventListener("abort",o,{once:!0})}if(n===Number.POSITIVE_INFINITY){t.then(l,f);return}const d=new _P;a=s.setTimeout.call(void 0,()=>{if(r){try{l(r())}catch(h){f(h)}return}typeof t.cancel=="function"&&t.cancel(),i===!1?l():i instanceof Error?f(i):(d.message=i??`Promise timed out after ${n} milliseconds`,f(d))},n),
(async()=>{try{l(await t)}catch(h){f(h)}})()}).finally(()=>{c.clear(),o&&e.signal&&e.signal.removeEventListener("abort",o)});return c.clear=()=>{s.clearTimeout.call(void 0,a),a=void 0},c}function wY(t,e,n){let r=0,i=t.length;for(;i>0;){const s=Math.trunc(i/2);let a=r+s;n(t[a],e)<=0?(r=++a,i-=s+1):i=s}return r}class bY{#e=[];enqueue(e,n){n={priority:0,...n};const r={priority:n.priority,id:n.id,run:e};if(this.size===0||this.#e[this.size-1].priority>=n.priority){this.#e.push(r);return}const i=wY(this.#e,
r,(s,a)=>a.priority-s.priority);this.#e.splice(i,0,r)}setPriority(e,n){const r=this.#e.findIndex(s=>s.id===e);if(r===-1)throw new ReferenceError(`No promise function with the id "${e}" exists in the queue.`);const[i]=this.#e.splice(r,1);this.enqueue(i.run,{priority:n,id:e})}dequeue(){return this.#e.shift()?.run}filter(e){return this.#e.filter(n=>n.priority===e.priority).map(n=>n.run)}get size(){return this.#e.length}}class EY extends gY{#e;#t;#r=0;#h;#o;#p=0;#i;#u;#n;#m;#s=0;#c;#a;#g;#w=1n;timeout;constructor(e){
if(super(),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:bY,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got\
 \`${e.interval?.toString()??""}\` (${typeof e.interval})`);this.#e=e.carryoverConcurrencyCount,this.#t=e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,this.#h=e.intervalCap,this.#o=e.interval,this.#n=new e.queueClass,this.#m=e.queueClass,this.concurrency=e.concurrency,this.timeout=e.timeout,this.#g=e.throwOnTimeout===!0,this.#a=e.autoStart===!1}get#b(){return this.#t||this.#r<this.#h}get#E(){return this.#s<this.#c}#k(){this.#s--,this.#l(),this.emit("next")}#R(){this.#v(),this.#y(),this.#u=
void 0}get#$(){const e=Date.now();if(this.#i===void 0){const n=this.#p-e;if(n<0)this.#r=this.#e?this.#s:0;else return this.#u===void 0&&(this.#u=setTimeout(()=>{this.#R()},n)),!0}return!1}#l(){if(this.#n.size===0)return this.#i&&clearInterval(this.#i),this.#i=void 0,this.emit("empty"),this.#s===0&&this.emit("idle"),!1;if(!this.#a){const e=!this.#$;if(this.#b&&this.#E){const n=this.#n.dequeue();return n?(this.emit("active"),n(),e&&this.#y(),!0):!1}}return!1}#y(){this.#t||this.#i!==void 0||(this.#i=
setInterval(()=>{this.#v()},this.#o),this.#p=Date.now()+this.#o)}#v(){this.#r===0&&this.#s===0&&this.#i&&(clearInterval(this.#i),this.#i=void 0),this.#r=this.#e?this.#s:0,this.#d()}#d(){for(;this.#l(););}get concurrency(){return this.#c}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#c=e,this.#d()}async#D(e){return new Promise((n,r)=>{e.addEventListener("abort",()=>{r(e.reason)},{once:!0})})}setPriority(e,n){
this.#n.setPriority(e,n)}async add(e,n={}){return n.id??=(this.#w++).toString(),n={timeout:this.timeout,throwOnTimeout:this.#g,...n},new Promise((r,i)=>{this.#n.enqueue(async()=>{this.#s++,this.#r++;try{n.signal?.throwIfAborted();let s=e({signal:n.signal});n.timeout&&(s=vY(Promise.resolve(s),{milliseconds:n.timeout})),n.signal&&(s=Promise.race([s,this.#D(n.signal)]));const a=await s;r(a),this.emit("completed",a)}catch(s){if(s instanceof _P&&!n.throwOnTimeout){r();return}i(s),this.emit("error",s)}finally{
this.#k()}},n),this.emit("add"),this.#l()})}async addAll(e,n){return Promise.all(e.map(async r=>this.add(r,n)))}start(){return this.#a?(this.#a=!1,this.#d(),this):this}pause(){this.#a=!0}clear(){this.#n=new this.#m}async onEmpty(){this.#n.size!==0&&await this.#f("empty")}async onSizeLessThan(e){this.#n.size<e||await this.#f("next",()=>this.#n.size<e)}async onIdle(){this.#s===0&&this.#n.size===0||await this.#f("idle")}async#f(e,n){return new Promise(r=>{const i=()=>{n&&!n()||(this.off(e,i),r())};
this.on(e,i)})}get size(){return this.#n.size}sizeBy(e){return this.#n.filter(e).length}get pending(){return this.#s}get isPaused(){return this.#a}}class kY{constructor(e){this.services=e,this.ModelBuilder=e.likec4.ModelBuilder}cache=new WeakMap;viewsWithReportedErrors=new Set;ModelBuilder;queue=new EY({concurrency:4,timeout:1e4,throwOnTimeout:!0});get layouter(){return this.services.likec4.Layouter}async computedViews(e,n=Jt.CancellationToken.None){const r=await this.ModelBuilder.buildLikeC4Model(
e,n);return Rp(r.$model.views)}async layoutAllViews(e,n=Jt.CancellationToken.None){const r=await this.computedViews(e,n);if(r.length===0)return[];const i=lt.getChild(["views",e??""]);i.debug`layoutAll: ${r.length} views`;const s=[],a=[];for(const o of r)this.viewsWithReportedErrors.delete(o.id),a.push(Promise.resolve().then(async()=>{const u=await this.queue.add(async()=>(i.debug`layouting view ${o.id}...`,await this.layouter.layout(o)));return u?(i.debug`done layout view ${o.id}`,this.viewsWithReportedErrors.
delete(o.id),this.cache.set(o,u),u):Promise.reject(new Error(`Failed to layout view ${o.id}`))}).catch(u=>(i.warn(`fail layout view ${o.id}`,{e:u}),this.cache.delete(o),Promise.reject(u))));for(const o of await Promise.allSettled(a))o.status==="fulfilled"?s.push(o.value):i.error(Jn(o.reason));return s.length!==r.length?i.warn`layouted ${s.length} of ${r.length} views`:s.length>0&&i.debug`layouted all ${s.length} views`,s}async layoutView(e,n,r=Jt.CancellationToken.None){const i=(await this.ModelBuilder.
buildLikeC4Model(n,r)).findView(e)?.$view,s=lt.getChild(["views",n??""]);if(!i)return s.warn`layoutView ${e} not found`,null;let a=this.cache.get(i);if(a)return s.debug`layout ${e} from cache`,await Promise.resolve(a);try{const o=performance.now(),u=await this.queue.add(async()=>(s.debug`layouting view ${i.id}...`,await this.layouter.layout(i)));if(!u)throw new Error(`Failed to layout view ${e}`);return this.viewsWithReportedErrors.delete(e),this.cache.set(i,u),s.debug(`layout {viewId} ready in ${wg(
performance.now()-o)}`,{viewId:e}),u}catch(o){if(!this.viewsWithReportedErrors.has(e)){const u=Jn(o);this.services.shared.lsp.Connection?.window.showErrorMessage(`LikeC4: ${u}`),this.viewsWithReportedErrors.add(e),rf(o)}return Promise.reject(o)}}async diagrams(e,n=Jt.CancellationToken.None){return(await this.layoutAllViews(e,n)).map(r=>r.diagram)}async viewsAsGraphvizOut(e,n=Jt.CancellationToken.None){const r="All-LayoutedViews-DotWithSvg",i=this.services.ValidatedWorkspaceCache;if(i.has(r))return await Promise.
resolve(i.get(r));const s=(await this.computedViews(e,n)).map(async u=>{const{dot:c,svg:l}=await this.layouter.svg(u);return{id:u.id,dot:c,svg:l}}),a=[],o=await Promise.allSettled(s);for(const u of o)u.status==="fulfilled"?a.push(u.value):Ae(u.reason);return i.set(r,a),a}async overviewGraph(){const e="OverviewGraph",n=this.services.ValidatedWorkspaceCache;if(n.has(e))return await Promise.resolve(n.get(e));const r=await this.computedViews(),i=await this.layouter.layoutOverviewGraph(r);return n.set(
e,i),i}}const RY={lsp:{NodeKindProvider:t=>new fY(t),WorkspaceSymbolProvider:t=>new hY(t)},workspace:{IndexManager:t=>new $K(t),LangiumDocuments:t=>new DK(t),ProjectsManager:t=>new Tn(t),WorkspaceManager:t=>new TK(t)}};function Lt(t){return e=>new t(e)}const $Y={documentation:{DocumentationProvider:Lt(wK)},ValidatedWorkspaceCache:t=>new vp(t.shared,Ze.Validated),Rpc:Lt(dY),mcp:{Tools:Lt(DZ),Server:Lt(TZ),ServerFactory:Lt(SZ)},likec4:{LanguageServices:Lt(CK),Layouter:t=>(lt.debug("Creating Graphv\
izLayouter with GraphvizWasmAdapter"),new xx(new xu)),Views:Lt(kY),DeploymentsIndex:Lt(CZ),ModelChanges:Lt(aY),FqnIndex:Lt(Jx),ModelParser:Lt(YX),ModelBuilder:Lt(GZ),ModelLocator:Lt(WZ)},lsp:{CompletionProvider:Lt(IK),DocumentHighlightProvider:Lt(OK),DocumentSymbolProvider:Lt(FK),SemanticTokenProvider:Lt(jK),HoverProvider:Lt(MK),CodeLensProvider:Lt(NK),DocumentLinkProvider:Lt(LK),Formatter:Lt(kK)},workspace:{AstNodeDescriptionProvider:Lt(RK)},references:{NameProvider:Lt(oY),ScopeComputation:Lt(cY),
ScopeProvider:Lt(lY)}};function DY(t,e,n,r){const i=TY(t),s=[bz({shared:i}),TW,$Y,e,n,r].reduce(PP,{}),a=Ep(s);return i.ServiceRegistry.register(a),EZ(a),t.connection?a.Rpc.init():i.workspace.ConfigurationProvider.initialized({}),{shared:i,likec4:a}}function TY(t={}){const e={...vT,...t};return Ep(kz(e),DW,RY)}function PP(t,e){if(e){for(const[n,r]of Object.entries(e))if(r!==void 0){const i=t[n];i!==null&&r!==null&&typeof i=="object"&&typeof r=="object"?t[n]=PP(i,r):t[n]=r}}return t}const SY=t=>({
start:Es.hrtime.bigint(),command:t.map(e=>CY(s1(e))).join(" "),state:{stdout:"",stderr:"",output:""}}),CY=t=>/[^\w./-]/.test(t)?`'${t.replaceAll("'","'\\''")}'`:t,_Y=({stdin:t,stdout:e,stderr:n,stdio:r=[t,e,n],env:i,preferLocal:s,cwd:a=".",...o})=>{const u=a instanceof URL?t1(a):ws.resolve(a),c=i?{...Es.env,...i}:void 0,l=r[0]?.string;return{...o,input:l,stdio:l===void 0?r:["pipe",...r.slice(1)],env:s?AY(c??Es.env,u):c,cwd:u}},AY=({Path:t="",PATH:e=t,...n},r)=>{const i=e.split(ws.delimiter),s=NP(
[],ws.resolve(r)).map(a=>ws.join(a,"node_modules/.bin")).filter(a=>!i.includes(a));return{...n,PATH:[...s,e].filter(Boolean).join(ws.delimiter)}},NP=(t,e)=>t.at(-1)===e?t:NP([...t,e],ws.resolve(e,"..")),xY=async(t,e,n)=>await PY(t,n)?[g0(t),e.map(r=>LY(r)),{...n,shell:!0}]:[t,e,n],PY=async(t,{shell:e,cwd:n,env:r=Es.env})=>Es.platform==="win32"&&!e&&!await NY(t,n,r),NY=async(t,e,{Path:n="",PATH:r=n})=>IP.some(i=>t.toLowerCase().endsWith(i))||(IY[`${t}\0${e}\0${r}`]??=await OY(t,e,r)),IY={},OY=async(t,e,n)=>{
const r=n.split(ws.delimiter).filter(Boolean).map(i=>i.replace(/^"(.*)"$/,"$1"));try{await Promise.all(IP.flatMap(i=>[e,...r].map(s=>`${ws.resolve(s,t)}${i}`)).map(async i=>{try{await q1(i)}catch{return}throw 0}))}catch{return!0}return!1},IP=[".exe",".com"],LY=t=>g0(g0(`"${t.replaceAll(/(\\*)"/g,'$1$1\\"').replace(/(\\*)$/,"$1$1")}"`)),g0=t=>t.replaceAll(/([()\][%!^"`<>&|;, *?])/g,"^$1"),FY=async(t,{input:e},n)=>{const r=await t;e!==void 0&&r.stdin.end(e);const i=U0(r,"close");try{return await Promise.
race([i,...r.stdio.filter(Boolean).map(s=>MY(s))]),jY(n,LP(r)),FP(n)}catch(s){throw await Promise.allSettled([i]),OP(s,r,n)}},MY=async t=>{for await(const[e]of B1(t,"error"))if(!["ERR_STREAM_PREMATURE_CLOSE","EPIPE"].includes(e?.code))throw e},jY=({command:t},{exitCode:e,signalName:n})=>{if(n!==void 0)throw new lo(`Command was terminated with ${n}: ${t}`);if(e!==void 0)throw new lo(`Command failed with exit code ${e}: ${t}`)},OP=(t,e,n)=>Object.assign(BY(t,n),LP(e),FP(n)),BY=(t,{command:e})=>t instanceof
lo?t:new lo(`Command failed: ${e}`,{cause:t});class lo extends Error{name="SubprocessError"}const LP=({exitCode:t,signalCode:e})=>({...t<1?{}:{exitCode:t},...e===null?{}:{signalName:e}}),FP=({state:{stdout:t,stderr:e,output:n},command:r,start:i})=>({stdout:y0(t),stderr:y0(e),output:y0(n),command:r,durationMs:Number(Es.hrtime.bigint()-i)/1e6}),y0=t=>t.at(-1)===`
`?t.slice(0,t.at(-2)==="\r"?-2:-1):t,qY=async(t,e,n,r)=>{try{[t,e]=["node","node.exe"].includes(t.toLowerCase())?[Es.execPath,[...Es.execArgv.filter(s=>!s.startsWith("--inspect")),...e]]:[t,e];const i=j1(...await xY(t,e,n));return MP(i.stdout,r,"stdout"),MP(i.stderr,r,"stderr"),i.once("error",()=>{}),await U0(i,"spawn"),i}catch(i){throw OP(i,{},r)}},MP=(t,{state:e},n)=>{t&&(t.setEncoding("utf8"),e.isIterating||(e.isIterating=!1,t.on("data",r=>{e[n]+=r,e.output+=r})))},GY=async t=>{const[[e,n]]=await Promise.
all([Promise.allSettled(t),UY(t)]);if(n.reason)throw n.reason.pipedFrom=e.reason??e.value,n.reason;if(e.reason)throw e.reason;return{...n.value,pipedFrom:e.value}},UY=async t=>{try{const[{stdout:e},{stdin:n}]=await Promise.all(t.map(({nodeChildProcess:r})=>r));if(n===null)throw new Error('The "stdin" option must be set on the first "spawn()" call in the pipeline.');if(e===null)throw new Error('The "stdout" option must be set on the last "spawn()" call in the pipeline.');G1(e,n).catch(()=>{})}catch(e){
throw await Promise.allSettled(t.map(({nodeChildProcess:n})=>zY(n))),e}},zY=async t=>{const{stdin:e}=await t;e.end()},jP=async function*(t,{state:e},n){if(e.isIterating===!1)throw new Error(`The subprocess must be iterated right away, for example:
	for await (const line of spawn(...)) { ... }`);e.isIterating=!0;try{const{[n]:r}=await t.nodeChildProcess;if(!r)return;let i="";for await(const s of r.iterator({destroyOnReturn:!1})){const a=`${i}${s}`.split(/\r?\n/);i=a.pop(),yield*a}i&&(yield i)}finally{await t}},WY=async function*(...t){try{let e=[];for(;t.length>0;){e=t.map((a,o)=>e[o]??HY(a));const[{value:n,done:r},i]=await Promise.race(e.map((a,o)=>Promise.all([a,o]))),[s]=t.splice(i,1);e.splice(i,1),r||(t.push(s),yield n)}}finally{await Promise.
all(t.map(e=>e.return()))}},HY=async t=>{try{return await t.next()}catch(e){await t.throw(e)}};function Bf(t,e,n,r){const[i=[],s={}]=Array.isArray(e)?[e,n]:[[],e],a=SY([t,...i]),o=_Y(s),u=qY(t,i,o,a);let c=FY(u,o,a);Object.assign(c,{nodeChildProcess:u}),c=r?GY([r,c]):c;const l=jP(c,a,"stdout"),f=jP(c,a,"stderr");return Object.assign(c,{nodeChildProcess:u,stdout:l,stderr:f,[Symbol.asyncIterator]:()=>WY(l,f),pipe:(d,h,p)=>Bf(d,h,p,c)})}var si={},fo={},BP;function VY(){if(BP)return fo;BP=1,Object.defineProperty(
fo,"__esModule",{value:!0}),fo.sync=fo.isexe=void 0;const t=Pu,e=z0,n=async(a,o={})=>{const{ignoreErrors:u=!1}=o;try{return i(await(0,e.stat)(a),o)}catch(c){const l=c;if(u||l.code==="EACCES")return!1;throw l}};fo.isexe=n;const r=(a,o={})=>{const{ignoreErrors:u=!1}=o;try{return i((0,t.statSync)(a),o)}catch(c){const l=c;if(u||l.code==="EACCES")return!1;throw l}};fo.sync=r;const i=(a,o)=>a.isFile()&&s(a,o),s=(a,o)=>{const u=o.uid??process.getuid?.(),c=o.groups??process.getgroups?.()??[],l=o.gid??process.
getgid?.()??c[0];if(u===void 0||l===void 0)throw new Error("cannot get uid or gid");const f=new Set([l,...c]),d=a.mode,h=a.uid,p=a.gid,w=parseInt("100",8),v=parseInt("010",8),g=parseInt("001",8),b=w|v;return!!(d&g||d&v&&f.has(p)||d&w&&h===u||d&b&&u===0)};return fo}var ho={},qP;function KY(){if(qP)return ho;qP=1,Object.defineProperty(ho,"__esModule",{value:!0}),ho.sync=ho.isexe=void 0;const t=Pu,e=z0,n=async(a,o={})=>{const{ignoreErrors:u=!1}=o;try{return s(await(0,e.stat)(a),a,o)}catch(c){const l=c;
if(u||l.code==="EACCES")return!1;throw l}};ho.isexe=n;const r=(a,o={})=>{const{ignoreErrors:u=!1}=o;try{return s((0,t.statSync)(a),a,o)}catch(c){const l=c;if(u||l.code==="EACCES")return!1;throw l}};ho.sync=r;const i=(a,o)=>{const{pathExt:u=process.env.PATHEXT||""}=o,c=u.split(";");if(c.indexOf("")!==-1)return!0;for(let l=0;l<c.length;l++){const f=c[l].toLowerCase(),d=a.substring(a.length-f.length).toLowerCase();if(f&&d===f)return!0}return!1},s=(a,o,u)=>a.isFile()&&i(o,u);return ho}var v0={},GP;function ZY(){
return GP||(GP=1,Object.defineProperty(v0,"__esModule",{value:!0})),v0}var UP;function XY(){return UP||(UP=1,function(t){var e=si&&si.__createBinding||(Object.create?function(c,l,f,d){d===void 0&&(d=f);var h=Object.getOwnPropertyDescriptor(l,f);(!h||("get"in h?!l.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return l[f]}}),Object.defineProperty(c,d,h)}:function(c,l,f,d){d===void 0&&(d=f),c[d]=l[f]}),n=si&&si.__setModuleDefault||(Object.create?function(c,l){Object.defineProperty(
c,"default",{enumerable:!0,value:l})}:function(c,l){c.default=l}),r=si&&si.__importStar||function(c){if(c&&c.__esModule)return c;var l={};if(c!=null)for(var f in c)f!=="default"&&Object.prototype.hasOwnProperty.call(c,f)&&e(l,c,f);return n(l,c),l},i=si&&si.__exportStar||function(c,l){for(var f in c)f!=="default"&&!Object.prototype.hasOwnProperty.call(l,f)&&e(l,c,f)};Object.defineProperty(t,"__esModule",{value:!0}),t.sync=t.isexe=t.posix=t.win32=void 0;const s=r(VY());t.posix=s;const a=r(KY());t.
win32=a,i(ZY(),t);const u=(process.env._ISEXE_TEST_PLATFORM_||process.platform)==="win32"?a:s;t.isexe=u.isexe,t.sync=u.sync}(si)),si}var w0,zP;function YY(){if(zP)return w0;zP=1;const{isexe:t,sync:e}=XY(),{join:n,delimiter:r,sep:i,posix:s}=bs,a=process.platform==="win32",o=new RegExp(`[${s.sep}${i===s.sep?"":i}]`.replace(/(\\)/g,"\\$1")),u=new RegExp(`^\\.${o.source}`),c=p=>Object.assign(new Error(`not found: ${p}`),{code:"ENOENT"}),l=(p,{path:w=process.env.PATH,pathExt:v=process.env.PATHEXT,delimiter:g=r})=>{
const b=p.match(o)?[""]:[...a?[process.cwd()]:[],...(w||"").split(g)];if(a){const k=v||[".EXE",".CMD",".BAT",".COM"].join(g),_=k.split(g).flatMap(I=>[I,I.toLowerCase()]);return p.includes(".")&&_[0]!==""&&_.unshift(""),{pathEnv:b,pathExt:_,pathExtExe:k}}return{pathEnv:b,pathExt:[""]}},f=(p,w)=>{const v=/^".*"$/.test(p)?p.slice(1,-1):p;return(!v&&u.test(w)?w.slice(0,2):"")+n(v,w)},d=async(p,w={})=>{const{pathEnv:v,pathExt:g,pathExtExe:b}=l(p,w),k=[];for(const _ of v){const I=f(_,p);for(const Z of g){
const J=I+Z;if(await t(J,{pathExt:b,ignoreErrors:!0})){if(!w.all)return J;k.push(J)}}}if(w.all&&k.length)return k;if(w.nothrow)return null;throw c(p)},h=(p,w={})=>{const{pathEnv:v,pathExt:g,pathExtExe:b}=l(p,w),k=[];for(const _ of v){const I=f(_,p);for(const Z of g){const J=I+Z;if(e(J,{pathExt:b,ignoreErrors:!0})){if(!w.all)return J;k.push(J)}}}if(w.all&&k.length)return k;if(w.nothrow)return null;throw c(p)};return w0=d,d.sync=h,w0}var JY=YY();const WP=fi(JY),b0=Px(Math.max(1,U1.cpus().length));
class QY{dotpath;unflattenpath;constructor(e){this.dotpath=e||WP.sync("dot"),this.unflattenpath=WP.sync("unflatten")}async unflatten(e){return await b0(async()=>{const n=Fn.getChild("graphviz-binary");let r;try{const i=await Bf(this.unflattenpath,["-l 1","-c 3"],{timeout:1e4,stdin:{string:e}});r=i.stdout,tn(i.stderr)||n.warn`Command ${i.command} has stderr:\n${i.stderr}`}catch(i){n.error("FAILED GraphvizBinaryAdapter.unflatten",{error:i}),i instanceof lo&&!tn(i.stdout)&&(n.warn`Command: '${i.command}' returned result but also failed (exitcode ${i.
exitCode}): "${i.stderr}"`,r=i.stdout)}return r&&(e=r.replaceAll(/\t\[/g," [").replaceAll(/\t/g,"    ")),e})}async layoutJson(e){return await b0(async()=>{const n=Fn.getChild("graphviz-binary");let r;try{const i=await Bf(this.dotpath,["-Tjson","-y"],{timeout:1e4,stdin:{string:e}});r=i.stdout,tn(i.stderr)||n.warn`Command ${i.command} has stderr:\n${i.stderr}`}catch(i){if(n.error("FAILED GraphvizBinaryAdapter.layoutJson",{error:i}),n.warn(`FAILED DOT:
${e}`),i instanceof lo&&!tn(i.stdout))n.warn(`Command: '${i.command}' returned result but also failed (exitcode ${i.exitCode}): "${i.stderr}"`),r=i.stdout;else throw i}return r})}async acyclic(e){return Promise.reject(new Error("Method not implemented."))}async svg(e){return await b0(async()=>{const n=Fn.getChild("graphviz-binary");let r;try{const i=await Bf(this.dotpath,["-Tsvg","-y"],{timeout:1e4,stdin:{string:e}});r=i.stdout,tn(i.stderr)||n.warn`Command ${i.command} has stderr:\n${i.stderr}`}catch(i){
if(n.error("FAILED GraphvizBinaryAdapter.svg",{error:i}),n.warn(`FAILED DOT:
${e}`),i instanceof lo&&!tn(i.stdout))n.warn`Command: '${i.command}' returned result but also failed (exitcode ${i.exitCode}): "${i.stderr}"`,r=i.stdout;else throw i}return r})}}const eJ="likec4",HP="1.30.0",E0=Fn.getChild("cli");nn.bold(nn.bgRed(nn.white("ERROR"))),nn.bold(nn.yellow("WARN")),nn.bold(nn.green("INFO"));function VP(t){const e=Fn.getChild(t);return{info(n){e.info(n)},warn(n){if(n instanceof Error){e.warn(`${nn.red(n.name+" "+n.message)}`,{msg:n});return}if(typeof n=="string"){e.warn(
n);return}e.warn`${n}`},warnOnce(n){e.warn(n)},error(n,r){let i=r?.error??n;if(i instanceof Error){if(n===i){e.error(`${nn.red(i.name+" "+i.message)}`,{error:i});return}e.error(`${n}`,{error:i});return}if(typeof n=="string"){e.error(`${nn.red(n)}`);return}e.error`${n}`},clearScreen:function(n){},hasErrorLogged:function(n){throw new Error("Function not implemented.")},hasWarned:!1}}const k0=()=>{},tJ={info:k0,warn:k0,error:k0},nJ=1e6;function KP(t){const[e,n]=G0(t),r=e*1e3+n/nJ;return{ms:r,pretty:wg(
r)}}function rJ(t){const e=G0();return{stopAndLog(n="done in "){n=nn.green(`${n}${KP(e).pretty}`),(t||E0).info(n)}}}function iJ(t,e){console.log(M1(t,{padding:1,margin:1,dimBorder:!0,...e}))}class sJ{constructor(e){this.services=e}isInitialized=!1;async initWorkspace(e){if(this.isInitialized)throw new Error("Workspace already initialized");const n=this.services.logger,r=this.services.shared.workspace.WorkspaceManager;n.info(`${nn.dim("workspace:")} ${e.uri}`),r.initialize({capabilities:{},processId:null,
rootUri:null,workspaceFolders:[e]}),await r.initializeWorkspace([e])}async init(){if(this.isInitialized)throw new Error("Workspace already initialized");this.isInitialized=!0;const e=this.services.logger;this.services.likec4.ModelBuilder;const n=this.services.shared.workspace.LangiumDocuments,r=this.services.shared.workspace.DocumentBuilder,i=n.all.toArray(),s=i.filter(a=>!nf(a.uri));if(s.length===0)throw e.error("no LikeC4 sources found"),new Error("no LikeC4 sources found");e.info(`${nn.dim("w\
orkspace:")} found ${s.length} source files`),s.length>1?await r.update(s.map(a=>a.uri),[],void 0):await r.build(i,{validation:!0})}}function aJ(t){return e=>new t(e)}const oJ={logger:()=>{throw new Error("Logger must be provided")},likec4:{Layouter:()=>{throw new Error("Layouter must be provided")}},cli:{Workspace:aJ(sJ)}};function ZP(t){const e=zg(t,{useFileSystem:!0,logger:"default",graphviz:"wasm"});let n;switch(e.logger){case!1:n=tJ;break;case"vite":n=VP("lang");break;case"default":n=E0.getChild(
"lang");break;default:n=e.logger;break}const r=e.graphviz==="binary";n.info(`${nn.dim("version")} ${HP}`),n.info(`${nn.dim("layout")} ${r?"binary":"wasm"}`);const i={logger:()=>n,likec4:{Layouter:()=>new xx(r===!0?new QY:new xu)}};return DY(e.useFileSystem?p9:{},oJ,i).likec4}const XP=t=>new Error(`Invalid model:
${t.getErrors().map(e=>`  ${e.sourceFsPath}:${e.line} ${e.message.slice(0,200)}`).join(`
`)}`);class Ws{constructor(e,n,r){this.workspace=e,this.langium=n,this.isPrintErrorEnabled=r,this.logger=n.logger,this.isPrintErrorEnabled&&this.printErrors()}static async fromSource(e,n){const r=ZP(zg(n,{useFileSystem:!1,logger:!1,graphviz:"wasm"})),i=_t.from({scheme:"virtual",path:"/workspace"});await r.cli.Workspace.initWorkspace({uri:i.toString(),name:"virtual"});const s=Tt.joinPath(i,"source.likec4");r.shared.workspace.LangiumDocuments.createDocument(s,e),await r.cli.Workspace.init();const a=new Ws(
i.path,r,n?.printErrors??!0);return n?.throwIfInvalid===!0&&a.hasErrors()?(a.dispose(),Promise.reject(XP(a))):a}static likec4Instances=new Map;static async fromWorkspace(e="",n){const r=QP(e);if(!JP(r))throw new Error(`Workspace not found: ${r}`);let i=Ws.likec4Instances.get(r);if(!i){const s=ZP(zg(n,{useFileSystem:!0,logger:"default",graphviz:"wasm"}));await s.cli.Workspace.initWorkspace({uri:n1(r).toString(),name:e1(r)}),await s.cli.Workspace.init(),i=new Ws(r,s,n?.printErrors??!0),Ws.likec4Instances.
set(r,i)}return n?.throwIfInvalid===!0&&i.hasErrors()?(i.dispose(),Promise.reject(XP(i))):i}logger;get languageServices(){return this.langium.likec4.LanguageServices}get viewsService(){return this.langium.likec4.Views}get LangiumDocuments(){return this.langium.shared.workspace.LangiumDocuments}ensureSingleProject(){const e=this.langium.likec4.LanguageServices.projects();if(e.length>1)throw this.logger.error(`Multiple projects found:
${e.map(n=>`  - ${n.folder.fsPath}`).join(`
`)}

${nn.red("Please specify a project folder")}
`),new Error("Multiple projects found")}async diagrams(e){return await this.langium.likec4.Views.diagrams(e)}computedModel(e){const n=this.langium.shared.workspace.ProjectsManager.ensureProjectId(e);return this.langium.likec4.ModelBuilder.unsafeSyncBuildModel(n)}async projects(){const e=this.langium.shared.workspace.ProjectsManager.defaultProjectId;if(e)return[e];const n=(await Promise.allSettled(this.langium.shared.workspace.ProjectsManager.all.map(async r=>await this.langium.likec4.ModelBuilder.
parseModel(r)?r:void 0))).filter(r=>r.status==="fulfilled").flatMap(r=>r.value??[]);return Ar(n,1)?n:["default"]}async layoutedModel(e){const n=this.langium.shared.workspace.ProjectsManager.ensureProjectId(e),r=await this.langium.likec4.ModelBuilder.parseModel(n);if(!r)throw new Error("Failed to parse model");const i=await this.viewsService.diagrams(n);return z1.create({...r,__:"layouted",views:Xc(i,Ui("id"))})}getErrors(){return this.LangiumDocuments.all.toArray().flatMap(e=>(e.diagnostics??[]).
filter(n=>n.severity===wa.Error).map(({message:n,range:r})=>({message:n,line:r.start.line,range:r,sourceFsPath:e.uri.fsPath})))}hasErrors(){return this.LangiumDocuments.all.some(e=>e.diagnostics?.some(n=>n.severity===wa.Error)??!1)}printErrors(){let e=!1;for(const n of this.LangiumDocuments.all){const r=n.diagnostics?.filter(i=>i.severity===1);if(r&&r.length>0){e=!0;const i=r.flatMap(s=>{const a=s.range.start.line,o=s.message.split(`
`);return o.length>10&&(o.length=10,o.push("...")),o.map((u,c)=>c===0?"    "+nn.dim(`Line ${a}: `)+nn.red(u):" ".repeat(10)+nn.red(u))}).join(`
`);this.logger.error(`Invalid ${n.uri.fsPath}
${i}`)}}return e}async notifyUpdate({changed:e,removed:n}){const r=this.langium.shared.workspace.WorkspaceLock;try{let i=!1;return await r.write(async s=>{await this.langium.shared.workspace.DocumentBuilder.update(e?[_t.file(e)]:[],n?[_t.file(n)]:[],s),i=!s.isCancellationRequested}),i}catch(i){return this.logger.error(Jn(i)),!1}}onModelUpdate(e){const n=this.langium.likec4.ModelBuilder.onModelParsed(()=>e());return()=>{n.dispose()}}dispose(){for(const[e,n]of Ws.likec4Instances)n===this&&Ws.likec4Instances.
delete(e)}}export{iJ as A,AT as B,et as C,KP as D,X1 as E,eJ as F,tn as G,HP as H,rJ as I,Su as J,Ar as K,Ws as L,fO as M,ZE as N,_E as O,wo as T,jo as a,Qe as b,fe as c,F_ as d,Go as e,Ro as f,vt as g,VP as h,Mt as i,P_ as j,ST as k,ki as l,Ht as m,Ft as n,Fn as o,Ui as p,fi as q,Fs as r,LW as s,Kv as t,nn as u,E0 as v,A_ as w,Bf as x,Jn as y,LC as z};
